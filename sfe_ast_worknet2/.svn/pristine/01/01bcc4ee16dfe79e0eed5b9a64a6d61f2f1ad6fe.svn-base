<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panSearch=null;$.panTree=null;$.panList=null;$.lblName=null;$.txtName=null;$.btnSearch=null;$.treDept=null;$.grdEmp=null;$.btnConfirm=null;$.btnCancel=null;$.varDeptId="";$.varFirstId="";$.varExceptYn="N";function createJSON_Q(workType){var json=createExecuteParamInfo("P_GetComboData",[workType,"#DEPT_PAY_LIST#","","",$.txtName.getText()]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_GetComboData",[workType,"#EMP_PAY_LIST#","","",$.varDeptId||""]);return json}function searchDeptTree(){$.varFirstId="";var ds=commCodeData2($,"Q_TREE","#DEPT_PAY_LIST#",$.txtName.getText());if(ds&&ds.resultList[0].length==1){$.varFirstId=ds.resultList[0][0].id}if($.varExceptYn=="Y"){ds.resultList[0].push({parent_id:"ROOT",id:"EXCEPT",name:"기타",ico_id:"1",order_seq:9999})}$.treDept.clearAll();$.treDept.load(ds.resultList[0],"id","parent_id","name","ico_id","order_seq");$.grdEmp.setData("")}function searchEmpList(){var json=createJSON_Q2("Q");callQuery(["req",json],"Q",$)}function dataSelect(){var rId=$.grdEmp.getSelectedRowIdx();if(rId==null){return}g_popupStack.setData($.grdEmp.getValue(rId));g_popupStack.close()}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,750,450);$.panMain.setText("");$.panMain.setBottomLine(true);$.panSearch=new FingerPanel(host,"panSearch",0,0,750,50);$.panSearch.setText("");$.panSearch.setBottomLine(true);$.panTree=new FingerPanel(host,"panTree",0,55,260,350);$.panTree.setText("");$.panTree.setBottomLine(false);$.panList=new FingerPanel(host,"panList",265,55,485,350);$.panList.setText("");$.panList.setBottomLine(false);$.lblName=new FingerLabel(host,"lblName",0,15,80,20);$.lblName.setText("부서/성명");$.txtName=new FingerEdit(host,"txtName",85,15,150,20);$.btnSearch=new FingerButton(host,"btnSearch",270,15,80,20);$.btnSearch.setText("검색");$.treDept=new FingerTree(host,"treDept",0,0,260,350);$.grdEmp=new FingerDataGrid(host,"grdEmp",0,0,485,350);$.btnConfirm=new FingerButton(host,"btnConfirm",610,415,80,20);$.btnConfirm.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",680,415,80,20);$.btnCancel.setText("취소");$.panSearch.setBorder(true);$.panTree.setBorder(true);$.panList.setBorder(false);$.grdEmp.colIdx=$.grdEmp.setColumns([new FingerDataGridColumn("emp_code",100,"left","ro","사번"),new FingerDataGridColumn("emp_full_name",100,"left","ro","사원명"),new FingerDataGridColumn("dept_name",180,"left","ro","부서명"),new FingerDataGridColumn("emp_state_name",78,"left","ro","재직여부"),new FingerDataGridColumn("dept_code",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("site_code",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("site_name",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("emp_state",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("enter_date",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("retire_date",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("bank_code",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("bank_name",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("bank_account",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("bank_depositor",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("last_calc_date",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("calc_start_date",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("emp_state",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("pension_change_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("midway_income_tax_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("midway_local_tax_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("nation_code",0,"left","ro","",{hidden:true})]);$.grdEmp.init({scroll:"xy"});$.grdEmp.setColumnHidden(["dept_code","email_address"],true);$.grdEmp.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panSearch);$.panMain.add($.panTree);$.panMain.add($.panList);$.panMain.add($.btnCancel);$.panMain.add($.btnConfirm);$.panSearch.add($.lblName);$.panSearch.add($.txtName);$.panSearch.add($.btnSearch);$.panTree.add($.treDept);$.panList.add($.grdEmp);if($.p_argument&&$.p_argument!=""){$.txtName.setText($.p_argument.emp_name);if($.p_argument.exceptYn){$.varExceptYn="Y"}}searchDeptTree()};$.callback=function(type,ds){if(type=="Q"){if($.varExceptYn=="Y"&&$.varDeptId=="EXCEPT"){ds.resultList[0].push({employee_id:"ka999999",emp_name:"기타",email_address:"",office_tel:"",mobile_phone:"",position_code:"",position_name:"",dept_code:"EXCEPT",dept_name:"기타",enter_date:"",retire_date:"",site_code:"1",emp_state:"",DflAccount:"",bank_account:"",bank:"",account:"",acct_name:""})}setDataGrid([$.grdEmp],ds)}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchDeptTree()}else{if(id=="btnConfirm"){dataSelect()}else{if(id=="btnCancel"){g_popupStack.close()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){if(id=="grdEmp"){dataSelect()}};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtName"&&value=="13"){searchDeptTree()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){if(id=="treDept"){$.grdEmp.setData("");$.varDeptId=(value.id=="ROOT"?"0000":value.id);searchEmpList()}};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){if(id=="treDept"){$.treDept.openNode("ROOT");if($.varFirstId){$.treDept.setFocusNode($.varFirstId)}}};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){}};</script>