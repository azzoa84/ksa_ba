<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panLeft=null;$.panRight=null;$.panList=null;$.lblYear=null;$.lblSite=null;$.lblType=null;$.lblEarner=null;$.lblMemo=null;$.dteYear=null;$.cmbSite=null;$.cmbType=null;$.txtEarner=null;$.bteEarner=null;$.lblHandOutDate=null;$.lblHometaxId=null;$.lblEmp=null;$.lblTel=null;$.lblDept=null;$.dteHandOutDate=null;$.txtHomeTaxId=null;$.txtEmp=null;$.txtTel=null;$.txtDept=null;$.btnFile=null;$.grdList=null;$.btnSearch=null;$.memMemo=null;function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRA9200_Q",[workType,$.dteYear.getValue()||"",$.cmbSite.getValue()||"",$.txtEarner.getValue()||"",$.dteHandOutDate.getValue()||"","",$.memMemo.getValue()||"",$.txtHomeTaxId.getValue()||"",$.txtEmp.getValue()||"",$.txtTel.getValue()||"",$.txtDept.getValue()||"",$.cmbType.getValue()||""]);return json}function createJSON_S(workType){var found="";found="귀속연도:"+($.dteYear.getValue()||"-")+"/사업장:"+($.cmbSite.getText()||"-")+"/지급분기:"+($.cmbType.getText()||"-")+"/소득자:"+($.txtEarner.getValue()||"-")+"/파일경로:"+($.bteFilePath.getText()||"-")+"/제출일자:"+(extFormat($.dteHandOutDate.getValue(),"yyyyMMdd")||"-")+"/홈택스 아이디:"+($.txtHomeTaxId.getValue()||"-")+"/담당자:"+($.txtEmp.getValue()||"-")+"/담당자 전화번호:"+($.txtTel.getValue()||"-")+"/담당자 부서:"+($.txtDept.getValue()||"-");var json=createExecuteParamInfo("HR..P_HRA9200_S",[workType,$.dteYear.getValue(),$.cmbSite.getValue(),"#UserID#","#HostInfo#",found,$.memMemo.getValue()]);return json}function searchList(workType){if(workType!="HISTORY"){if(!validateControls([$.dteYear,$.cmbSite,$.dtePayStart,$.dtePayEnd,$.cmbType,$.bteEarner,$.dteHandOutDate,$.txtHomeTaxId,$.txtEmp,$.txtTel,$.txtDept])){return}}var json=createJSON_Q(workType);callExecute(["req",json],workType,$)}function saveHistory(){var json=createJSON_S("N");callExecute(["req",json],"N",$)}function downLoadFile(fileName,contents){var url="data:application/octet-stream,"+contents;var link=document.createElement("a");link.href=url;link.style="visibility:hidden";link.download=fileName;document.body.appendChild(link);link.click();document.body.removeChild(link)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",250,0,700,550);$.panMain.setText("");$.panMain.setBottomLine(true);$.panLeft=new FingerPanel(host,"panLeft",0,0,345,215);$.panLeft.setText("파일생성조건");$.panLeft.setBottomLine(true);$.panRight=new FingerPanel(host,"panRight",355,0,345,215);$.panRight.setText("신고자료정보");$.panRight.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,265,700,280);$.panList.setText("파일생성이력");$.panList.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,10,90,20);$.lblYear.setText("귀속연도");$.lblSite=new FingerLabel(host,"lblSite",0,40,90,20);$.lblSite.setText("사업장");$.lblType=new FingerLabel(host,"lblType",0,70,90,20);$.lblType.setText("지급분기");$.lblEarner=new FingerLabel(host,"lblEarner",0,100,90,20);$.lblEarner.setText("소득자");$.lblMemo=new FingerLabel(host,"lblMemo",0,130,90,20);$.lblMemo.setText("비고");$.dteYear=new FingerDateEdit(host,"dteYear",95,10,100,20);$.cmbSite=new FingerComboBox(host,"cmbSite",95,40,230,20);$.cmbType=new FingerComboBox(host,"cmbType",95,70,230,20);$.txtEarner=new FingerEdit(host,"txtEarner",95,100,80,20);$.bteEarner=new FingerButtonEdit(host,"bteEarner",180,100,135,20);$.bteEarner.setText("");$.lblHandOutDate=new FingerLabel(host,"lblHandOutDate",10,10,100,20);$.lblHandOutDate.setText("제출일자");$.lblHometaxId=new FingerLabel(host,"lblHometaxId",10,40,100,20);$.lblHometaxId.setText("홈택스아이디");$.lblEmp=new FingerLabel(host,"lblEmp",10,70,100,20);$.lblEmp.setText("담당자");$.lblTel=new FingerLabel(host,"lblTel",0,100,110,20);$.lblTel.setText("담당자 전화번호");$.lblDept=new FingerLabel(host,"lblDept",10,130,100,20);$.lblDept.setText("담당자 부서");$.dteHandOutDate=new FingerDateEdit(host,"dteHandOutDate",115,10,100,20);$.txtHomeTaxId=new FingerEdit(host,"txtHomeTaxId",115,40,200,20);$.txtEmp=new FingerEdit(host,"txtEmp",115,70,200,20);$.txtTel=new FingerEdit(host,"txtTel",115,100,200,20);$.txtDept=new FingerEdit(host,"txtDept",115,130,200,20);$.btnFile=new FingerButton(host,"btnFile",300,235,120,20);$.btnFile.setText("파일생성");$.grdList=new FingerDataGrid(host,"grdList",0,0,700,235);$.btnSearch=new FingerButton(host,"btnSearch",457.5,272.5,95,30);$.btnSearch.setText("조회");$.memMemo=new FingerMemoEdit(host,"memMemo",95,130,220,20);$.grdList.setColumns([new FingerDataGridColumn("seq",100,"left","string","차수"),new FingerDataGridColumn("insert_userid",100,"left","string","생성자"),new FingerDataGridColumn("insert_time",150,"left","string","생성일시"),new FingerDataGridColumn("insert_pc",200,"left","string","생성PC"),new FingerDataGridColumn("create_cond",300,"left","string","생성조건"),new FingerDataGridColumn("memo",300,"left","string","비고")]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setBorder(false);$.dteYear.setDateFormat("yyyy");$.dteYear.setAllowBlank(false,"귀속연도");$.cmbSite.setAllowBlank(false,"사업장");$.cmbType.setAllowBlank(false,"거주구분");$.dteHandOutDate.setAllowBlank(false,"제출일자");$.txtHomeTaxId.setAllowBlank(false,"홈택스아이디");$.txtEmp.setAllowBlank(false,"담당자");$.txtTel.setAllowBlank(false,"담당자 전화번호");$.txtDept.setAllowBlank(false,"담당자 부서");var today=getToday();$.dteYear.setValue(today.substr(0,4));$.dteHandOutDate.setValue(today);$.txtEmp.setValue(g_main.session.obj.UserName);$.txtDept.setValue(g_main.session.obj.DeptName);$.txtEarner.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panLeft);$.panMain.add($.panRight);$.panMain.add($.btnFile);$.panMain.add($.btnSearch);$.panLeft.add($.lblYear);$.panLeft.add($.lblSite);$.panLeft.add($.lblType);$.panLeft.add($.lblEarner);$.panLeft.add($.lblMemo);$.panLeft.add($.dteYear);$.panLeft.add($.cmbSite);$.panLeft.add($.cmbType);$.panLeft.add($.txtEarner);$.panLeft.add($.bteEarner);$.panLeft.add($.memMemo);$.panRight.add($.lblHandOutDate);$.panRight.add($.lblHometaxId);$.panRight.add($.lblEmp);$.panRight.add($.lblTel);$.panRight.add($.lblDept);$.panRight.add($.dteHandOutDate);$.panRight.add($.txtHomeTaxId);$.panRight.add($.txtEmp);$.panRight.add($.txtTel);$.panRight.add($.txtDept);$.panList.add($.grdList);$.cmbSite.setColumnConfig({id:"site_code"});$.cmbSite.setColumnConfig({id:"site_name"});$.cmbSite.setColumnConfig({id:"descr"});$.cmbSite.setColumn("site_code","site_name");var ds=bizComponentData2($,"Q1","L_ORG001|L_COM021");setComboBind([$.cmbSite,$.cmbType],ds);var month=getToday("").substr(4,2);if(month>=1&&month<=3){$.cmbType.setValue("1")}else{if(month>=4&&month<=6){$.cmbType.setValue("2")}else{if(month>=7&&month<=9){$.cmbType.setValue("3")}else{if(month>=10&&month<=12){$.cmbType.setValue("4")}}}}};$.callback=function(type,ds){if(type=="HISTORY"){setDataGrid([$.grdList],ds)}else{if(type=="FILE"){var rs=ds.resultList;if(rs[1].length<3){MessageBoxShow("기타소득 내역이 없습니다.");return}var biz_regno="",file_name="",contents="";biz_regno=unmask(rs[0][0].biz_regno);file_name="I"+biz_regno.substr(0,7)+"."+biz_regno.substr(7,3);for(var i in rs[1]){contents+=((contents?"\r\n":"")+rs[1][i].day_contents)}var params={contents:contents,encodingType:"EUC-KR"};var result=jQuery.ajax({accepts:{json:"application/json; charset=UTF-8"},type:"POST",async:false,url:g_ContextPath+"/encodingURL.do",data:params}).responseText;var data=JSON.parse(result);if(data&&data.errorCode=="1000"){downLoadFile(file_name,data.contents);saveHistory()}else{MessageBoxShow("파일 생성 중 오류가 발생하였습니다.")}}else{if(type=="N"){searchList("HISTORY")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("HISTORY")}else{if(id=="btnFile"){searchList("FILE")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEarner"){var param={earner_code:$.txtEarner.getValue()||"",earner_name:$.bteEarner.getText()||""};g_main.openPopup("popEarner.html","popEarner","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){if(id=="bteEarner"){if($.bteEarner.getText()==""){$.txtEarner.setValue("")}}};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEarner"){if($.popUpCallId=="bteEarner"){$.txtEarner.setValue(popResult.earner_code);$.bteEarner.setValue(popResult.earner_code);$.bteEarner.setText(popResult.earner_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){}};</script>