<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.lblDate=null;$.dteStartDate=null;$.dteEndDate=null;$.lblEx1=null;$.lblCpType=null;$.cmbCpType=null;$.lblDept=null;$.cmbDept=null;$.cmbEmp=null;$.lblStatus=null;$.cmbStatus=null;$.lblRetire=null;$.txtRetire=null;$.btnSearch=null;$.panList=null;$.grdList=null;$.btnTakingOver=null;$.btnWfReset=null;$.cmbPm=null;$.btnConfirm=null;$.btnCancel=null;$.lbl_product=null;$.cmb_product=null;$.btnDownloadFile=null;$.strcpDescr="";$.searchflag="N";$.bAllReport=false;$.bMyReport=false;$.bConfirm=false;$.bIsPopup=false;$.txtpromocode="";function createJSON_Q(workType){if(workType=="Q"||workType=="Q1"||workType=="Q2"||workType=="Q3"||workType=="Q4"){var json=createExecuteParamInfo("P_crmCPMaster_Q",[workType,$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.cmb_product.getValue()||"",$.cmbCpType.getValue(),$.cmbStatus.getValue(),$.searchflag=="Y"?"D999":$.cmbDept.getValue(),$.searchflag=="Y"?"ka999999":$.cmbEmp.getValue(),"",$.txtRetire.getValue(),g_main.session.getValue("EmpCode"),$.txtpromocode])}else{var json=createExecuteParamInfo("P_crmCPMaster_Q",[workType,$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_type"),$.cmbStatus.getValue(),$.searchflag=="Y"?"D999":$.cmbDept.getValue(),$.searchflag=="Y"?"ka999999":$.cmbEmp.getValue(),"",$.txtRetire.getValue(),g_main.session.getValue("EmpCode"),""])}return json}function createJSON_Q2(systemRoleCode){var json=createExecuteParamInfo("P_crmSystemRole_Q",["Q",systemRoleCode,g_main.session.getValue("DeptCode"),g_main.session.getValue("EmpCode")]);return json}function createJSON_S(workType){var json="";var rows=[];if(workType=="WF_RESET"){for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"CheckYN")=="Y"){rows.push([workType,$.grdList.getValue(i,"cp_id"),$.grdList.getValue(i,"cp_type"),$.strcpDescr,g_main.session.getValue("EmpCode"),g_main.session.getValue("EmpCode")])}}}else{rows.push([workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_type"),$.strcpDescr,g_main.session.getValue("EmpCode"),g_main.session.getValue("EmpCode")])}json=createExecuteParamInfo("P_crmCPMaster_S",rows);return json}function searchClick(){if($.bIsPopup){if($.txtpromocode=="0026"){log("0?");$.txtRetire.setValue("ka999999");$.txtRetire.setVisible(false);searchList("Q3");$.txtRetire.setValue("");$.txtRetire.setVisible(false)}else{if($.txtpromocode=="0031"){log("1?");$.txtRetire.setValue("ka999999");$.txtRetire.setVisible(false);searchList("Q4");$.txtRetire.setValue("");$.txtRetire.setVisible(false)}else{log("??");$.txtRetire.setValue("ka999999");$.txtRetire.setVisible(false);searchList("Q1");$.txtRetire.setValue("");$.txtRetire.setVisible(false)}}}else{if($.cmbDept.getValue()==""&&$.cmbEmp.getValue()==""){if(!$.txtRetire.getValue()){$.txtRetire.setValue("ka999999");$.txtRetire.setVisible(false);searchList("Q");$.txtRetire.setValue("");$.txtRetire.setVisible(true)}else{$.searchflag="Y";searchList("Q");$.searchflag="N"}}else{if(!$.txtRetire.getValue()){if(($.cmbCpType.getValue()=="CP01"||$.cmbCpType.getValue()=="CP02"||$.cmbCpType.getValue()=="CP03")&&$.cmb_product.getValue()){searchList("Q2")}else{searchList("Q")}}else{MessageBoxShow("담당자 정보 또는 퇴사자 정보만 입력해주십시오");return}}}}function searchList(workType){if(!validateControls([$.dteStartDate,$.dtaEndDate,$.cmbDept])){return}if(workType=="Q"||workType=="Q1"||workType=="Q2"||workType=="Q3"||workType=="Q4"){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}else{var json=createJSON_Q(workType);return callQuerySync(["req",json],workType)}}function fnGetRoleInfo(systemRoleCode){var json=createJSON_Q2(systemRoleCode);return callQuerySync(["req",json],"Q")}function cmbDeptChange(){var strQuery=" and dept_code = '"+$.cmbDept.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmp.clear();$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds)}function wfReset(){if($.grdList.getSelectedRowIdx()<0){return}else{for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"cp_type")=="CP03"&&$.grdList.getValue(i,"CheckYN")=="Y"){MessageBoxShow("제품디테일링(사후)는 예산중복처리 불가한 건입니다.");return}else{if($.grdList.getValue(i,"cp_type")=="CP20"&&$.grdList.getValue(i,"CheckYN")=="Y"){MessageBoxShow("자문(사전)은 예산중복처리 불가한 건입니다.");return}else{if($.grdList.getValue(i,"cp_type")=="CP04"&&$.grdList.getValue(i,"CheckYN")=="Y"){MessageBoxShow("자문(사후)는 예산중복처리 불가한 건입니다.");return}else{if($.grdList.getValue(i,"cp_type")=="CP19"&&$.grdList.getValue(i,"CheckYN")=="Y"){MessageBoxShow("강연(사전)은 예산중복처리 불가한 건입니다.");return}}}}}}confirmBoxShow("선택한 CP 한 건에 대해서 예산 중복처리가 가능합니다. 처리하시겠습니까?",function(){if(g_main.msgShare==true){var json=createJSON_S("WF_RESET");callQuery(["req",json],"WF_RESET",$)}})}function createJSON_Q4(workType){var json=createExecuteParamInfo("P_crmCPDetailAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id")]);return json}function searchCrmCPDetailAfter(){var json=createJSON_Q4("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q5(workType){var json=createExecuteParamInfo("P_crmCPSeminarBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSeminarBefore(){var json=createJSON_Q5("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q6(workType){var json=createExecuteParamInfo("P_crmCPSeminarAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSeminarAfter(){var json=createJSON_Q6("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q7(workType){var json=createExecuteParamInfo("P_crmCPSeminarStayBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSeminarStayBefore(){var json=createJSON_Q7("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q8(workType){var json=createExecuteParamInfo("P_crmCPSeminarStayAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSeminarStayAfter(){var json=createJSON_Q8("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q9(workType){var json=createExecuteParamInfo("P_crmCPDPADBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPDPADBefore(){var json=createJSON_Q9("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmCPDPADAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPDPADAfter(){var json=createJSON_Q3("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q10(workType){var json=createExecuteParamInfo("P_crmCPLectureBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPLectureBefore(){var json=createJSON_Q10("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q11(workType){var json=createExecuteParamInfo("P_crmCPLectureAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPLectureAfter(){var json=createJSON_Q11("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q12(workType){var json=createExecuteParamInfo("P_crmCPAdviceBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPAdviceBefore(){var json=createJSON_Q12("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q13(workType){var json=createExecuteParamInfo("P_crmCPAdviceAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPAdviceAfter(){var json=createJSON_Q13("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q14(workType){var json=createExecuteParamInfo("P_crmCPResearchBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPResearchBefore(){var json=createJSON_Q14("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q15(workType){var json=createExecuteParamInfo("P_crmCPResearchAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPResearchAfter(){var json=createJSON_Q15("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q16(workType){var json=createExecuteParamInfo("P_crmCPDonationBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPDonationBefore(){var json=createJSON_Q16("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q17(workType){var json=createExecuteParamInfo("P_crmCPDonationAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPDonationAfter(){var json=createJSON_Q17("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q18(workType){var json=createExecuteParamInfo("P_crmCPSupportApp_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSupportApp(){var json=createJSON_Q18("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q19(workType){var json=createExecuteParamInfo("P_crmCPSupportAppAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSupportAppAfter(){var json=createJSON_Q19("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q20(workType){var json=createExecuteParamInfo("P_crmCPSymposiumBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSymposiumBefore(){var json=createJSON_Q20("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q21(workType){var json=createExecuteParamInfo("P_crmCPSymposiumAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSymposiumAfter(){var json=createJSON_Q21("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q22(workType){var json=createExecuteParamInfo("P_crmCPInterSymposiumBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPInterSymposiumBefore(){var json=createJSON_Q22("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q23(workType){var json=createExecuteParamInfo("P_crmCPInterSymposiumAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPInterSymposiumAfter(){var json=createJSON_Q23("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q24(workType){var json=createExecuteParamInfo("P_crmCPPromoteBefore_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPPromoteBefore(){var json=createJSON_Q24("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q25(workType){var json=createExecuteParamInfo("P_crmCPPromoteAfter_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPPromoteAfter(){var json=createJSON_Q25("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q26(workType){var json=createExecuteParamInfo("P_crmCPSympAttendBef_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSymposium(){var json=createJSON_Q26("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q27(workType){var json=createExecuteParamInfo("P_crmCPAbroadSpeaker_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPAbroadSpeaker(){var json=createJSON_Q27("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q28(workType){var json=createExecuteParamInfo("P_crmCPForeignerSpeaker_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPForeignerSpeaker(){var json=createJSON_Q28("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q29(workType){var json=createExecuteParamInfo("P_crmCPClinicalTrial_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPClinicalTrial(){var json=createJSON_Q29("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q30(workType){var json=createExecuteParamInfo("P_crmCPSympAttendAft_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPSympAttendAft(){var json=createJSON_Q30("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q31(workType){var json=createExecuteParamInfo("P_crmCPExternalAct_Q",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id")]);return json}function searchCrmCPExternalAct(){var json=createJSON_Q31("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q32(loadQuery){if(loadQuery=="P_crmCPDetailAfter_Q"||loadQuery=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(loadQuery,["Q",$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id")])}else{var json=createExecuteParamInfo(loadQuery,["Q",$.grdList.getValue($.grdList.getSelectedRowIdx(),"cp_id"),"#UserID#"])}return json}function searchCP(loadQuery){var json=createJSON_Q32(loadQuery);return callQuerySync(["req",json],"Q")}function DownloadFile(){if($.cmbCpType.getValue()==""){MessageBoxShow("CP유형을 선택하시기 바랍니다.");return}else{var params={category:$.cmbCpType.getValue(),cp_date_fr:$.dteStartDate.getValue(),cp_date_to:$.dteEndDate.getValue(),file_category:"ALL"};fileZipDownload2(params)}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,85);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",0,15,100,20);$.lblDate.setText("실시일자");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",105,15,140,20);$.dteEndDate=new FingerDateEdit(host,"dteEndDate",270,15,140,20);$.lblEx1=new FingerLabel(host,"lblEx1",245,15,15,20);$.lblEx1.setText("~");$.lblCpType=new FingerLabel(host,"lblCpType",405,15,100,20);$.lblCpType.setText("cp유형");$.cmbCpType=new FingerComboBox(host,"cmbCpType",510,15,410,20);$.lblDept=new FingerLabel(host,"lblDept",0,45,100,20);$.lblDept.setText("부서/담당자");$.cmbDept=new FingerComboBox(host,"cmbDept",105,45,165,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",270,45,145,20);$.lblStatus=new FingerLabel(host,"lblStatus",405,45,100,20);$.lblStatus.setText("승인상태");$.cmbStatus=new FingerComboBox(host,"cmbStatus",510,45,140,20);$.lblRetire=new FingerLabel(host,"lblRetire",675,45,100,20);$.lblRetire.setText("퇴사자 성명");$.txtRetire=new FingerEdit(host,"txtRetire",780,45,135,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,45,80,20);$.btnSearch.setText("조회");$.panList=new FingerPanel(host,"panList",0,95,1200,665);$.panList.setText("CP 목록");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,565);$.btnTakingOver=new FingerButton(host,"btnTakingOver",815,-40,100,30);$.btnTakingOver.setText("인수인계");$.btnWfReset=new FingerButton(host,"btnWfReset",900,-40,150,30);$.btnWfReset.setText("중복 예산집행 처리");$.cmbPm=new FingerComboBox(host,"cmbPm",415,0,140,20);$.btnConfirm=new FingerButton(host,"btnConfirm",1055,580,80,20);$.btnConfirm.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",1120,580,80,20);$.btnCancel.setText("취소");$.lbl_product=new FingerLabel(host,"lbl_product",890,15,100,20);$.lbl_product.setText("품목");$.cmb_product=new FingerComboBox(host,"cmb_product",995,15,115,20);$.btnDownloadFile=new FingerButton(host,"btnDownloadFile",670,-40,160,30);$.btnDownloadFile.setText("첨부파일  다운로드");$.panQuery.setBorder(true);$.dteStartDate.setAllowBlank(false,"시작일");$.dteEndDate.setAllowBlank(false,"종료일");$.cmbPm.setVisible(false);$.lbl_product.setVisible(false);$.cmb_product.setVisible(false);$.btnDownloadFile.setVisible(false);$.cmb_product.setEmptyRow(true);$.grdList.setColumns([new FingerDataGridColumn("CheckYN",50,"center","checkbox","선택",{hidden:((g_main.session.getValue("DeptCode")==g_main.session.getValue("CPDeptCode"))||(g_main.session.getValue("DeptCode")=="A120"||g_main.session.getValue("DeptCode")=="A200"))?false:true}),new FingerDataGridColumn("cp_doc_no",100,"left","string","문서번호",{hidden:true}),new FingerDataGridColumn("cp_id",100,"left","string","CP번호"),new FingerDataGridColumn("load_query",100,"left","string","조회쿼리",{hidden:true}),new FingerDataGridColumn("cp_name",150,"left","string","CP명",{isLink:true}),new FingerDataGridColumn("cp_form_id",100,"left","string","폼아이디",{hidden:true}),new FingerDataGridColumn("cp_dept_code",115,"left","string","부서"),new FingerDataGridColumn("cp_emp_id",90,"left","string","담당자",{hidden:true}),new FingerDataGridColumn("cp_emp_name",80,"left","string","담당자"),new FingerDataGridColumn("product_name",90,"left","string","품목"),new FingerDataGridColumn("report_date",90,"left","string","실시일자",{format:"s_ymd"}),new FingerDataGridColumn("total_amt",90,"right","string","금액",{format:"int",footer:{css:{"text-align":"right"},content:"summColumn"}}),new FingerDataGridColumn("cp_status",83,"left","string","승인상태"),new FingerDataGridColumn("cp_type",100,"left","string","CP유형",{hidden:true}),new FingerDataGridColumn("cp_descr",200,"left","string","메모"),new FingerDataGridColumn("cp_descr2",200,"left","string","메모2"),new FingerDataGridColumn("cp_descr3",200,"left","string","메모3"),new FingerDataGridColumn("wf_doc_id",130,"left","string","예산결재문서번호"),new FingerDataGridColumn("create_user",100,"left","string","작성자",{hidden:true}),new FingerDataGridColumn("modify_id",100,"left","string","입력오류수정건여부",{hidden:true}),new FingerDataGridColumn("takeover_yn",100,"left","string","인수인계여부",{hidden:true}),new FingerDataGridColumn("substitute_id",100,"left","string","인계자",{hidden:true}),new FingerDataGridColumn("height_size",100,"left","string","폼높이",{hidden:true}),new FingerDataGridColumn("width_size",100,"left","string","폼너비",{hidden:true})]);$.grdList.init({panel:$.panList,scroll:"xy",footer:true});$.grdList.setEditable(false);$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panQuery.add($.lblDate);$.panQuery.add($.dteStartDate);$.panQuery.add($.dteEndDate);$.panQuery.add($.lblEx1);$.panQuery.add($.lblCpType);$.panQuery.add($.cmbCpType);$.panQuery.add($.lblDept);$.panQuery.add($.cmbDept);$.panQuery.add($.cmbEmp);$.panQuery.add($.lblStatus);$.panQuery.add($.cmbStatus);$.panQuery.add($.lblRetire);$.panQuery.add($.txtRetire);$.panQuery.add($.btnSearch);$.panQuery.add($.cmbPm);$.panQuery.add($.lbl_product);$.panQuery.add($.cmb_product);$.panList.add($.grdList);$.panList.add($.btnCancel);$.panList.add($.btnConfirm);$.panList.add($.btnTakingOver);$.panList.add($.btnWfReset);$.panList.add($.btnDownloadFile);$.btnWfReset.setEnable(false);$.btnTakingOver.setEnable(false);$.dteStartDate.setValue(getToday().substring(0,6)+"01");$.dteEndDate.setValue(getCalcMonth(getToday(),1));$.lblRetire.setVisible(false);$.txtRetire.setVisible(false);$.cmbDept.setEmptyRow(true);$.cmbEmp.setEmptyRow(true);$.cmbCpType.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.txtpromocode="";var ds=bizComponentData2($,"Q1","L_CRM0051|L_CRM0116|L_CRM0111|L_CRM0131");$.cmbDept.setColumn("dept_code","dept_name");$.cmbCpType.setColumn("cp_code","cp_name");$.cmb_product.setColumn("product_code","product_name");setComboBind([$.cmbDept,$.cmbCpType,$.cmbStatus,$.cmb_product],ds);$.cmbDept.setValue(g_main.session.getValue("DeptCode"));cmbDeptChange();$.cmbEmp.setValue(g_main.session.getValue("EmpCode"));$.grdList.setColumnDropDownList("cp_dept_code",ds.resultList[0],{key:"dept_code",name:"dept_name"});$.grdList.setColumnDropDownList("cp_status",ds.resultList[2]);var dt=commSystemRole("Q","CPPrint");if(dt!=null&&dt.resultList[0].length>0){if(dt.resultList[0][0].Category=="DEPT"&&dt.resultList[0][0].Code==g_main.session.getValue("DeptCode")){if(dt.resultList[0][0].print_role=="Y"){if(dt.resultList[0][0].etc_role2=="Y"){$.bAllReport=true;$.bMyReport=true}else{$.bAllReport=false;$.bMyReport=true}}else{$.bAllReport=false;$.bMyReport=true}if(dt.resultList[0][0].etc_role1=="Y"){$.bConfirm=true}}if(dt.resultList[0][0].Category=="EMP"&&dt.resultList[0][0].Code==g_main.session.getValue("EmpCode")){if(dt.resultList[0][0].print_role=="Y"){if(dt.resultList[0][0].etc_role2=="Y"){$.bAllReport=true;$.bMyReport=true}else{$.bAllReport=false;$.bMyReport=true}}else{$.bAllReport=false;$.bMyReport=true}if(dt.resultList[0][0].etc_role1=="Y"){$.bConfirm=true}}}else{}if(!$.bConfirm||!$.bAllReport){$.cmbDept.setEnable(false);$.cmbEmp.setEnable(false);$.cmbEmp.setValue(g_main.session.getValue("UserCode"));$.cmbEmp.setValue(g_main.session.getValue("EmpCode"))}if(g_main.session.getValue("DutyCode")!="09"){$.cmbEmp.setEnable(true)}if(g_main.session.getValue("DeptCode")==g_main.session.getValue("CPDeptCode")){$.lblRetire.setVisible(true);$.txtRetire.setVisible(true);$.cmbDept.setEnable(true);$.btnTakingOver.setEnable(true);$.btnWfReset.setEnable(true);$.btnDownloadFile.setVisible(true)}if(g_main.session.getValue("DeptCode")=="A120"||g_main.session.getValue("EmpCode")=="AKR-A00001"){$.lblRetire.setVisible(true);$.txtRetire.setVisible(true);$.cmbDept.setEnable(true);$.cmbEmp.setEnable(true);$.btnDownloadFile.setVisible(true)}if(g_main.session.getValue("DeptCode")=="S400"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'S4%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("S400");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="S500"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'S5%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("S500");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="T300"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'T3%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("T300");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="S300"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'S3%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("S300");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="T100"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'T1%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("T100");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="F000"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'F%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("F000");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="F200"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'F2%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("F200");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="F300"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'F3%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("F300");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="F500"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'F5%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("F500");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="U100"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'U1%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("U100");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="A100"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'A1%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("A100");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="E100"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and delete_yn = 'N' and dept_code LIKE 'E1%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("E100");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}else{if(g_main.session.getValue("DeptCode")=="J100"){$.cmbDept.clear();var ds=bizComponentData2($,"Q4","L_CRM0051"," and dept_code LIKE 'J1%'");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);$.cmbDept.setValue("J100");$.cmbDept.setEnable(true);$.cmbDept.setAllowBlank(false,"부서")}}}}}}}}}}}}}if(g_main.session.getValue("DeptCode").substring(0,2)=="F2"||g_main.session.getValue("DeptCode").substring(0,2)=="F3"){$.lbl_product.setVisible(true);$.cmb_product.setVisible(true)}if($.p_argument){$.cmbDept.setEnable(false);$.cmbEmp.setEnable(false);$.cmbStatus.setEnable(false);$.cmbStatus.setValue("90");$.cmbCpType.setEnable(false);var arg=$.p_argument;$.cmbCpType.setValue(arg.CP_CODE);$.txtpromocode=arg.PROMO_CODE;if($.cmbCpType.getValue()=="CP02"){if(g_main.session.getValue("DeptCode")=="F510"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP01","CP02","CP21","CP22"]);$.cmbCpType.setValue("CP01");$.cmbCpType.setAllowBlank(false,"CP유형")}}else{if($.cmbCpType.getValue()=="CP27"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP26","CP27"]);$.cmbCpType.setValue("CP26");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP29"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP28","CP29","CP39","CP40"]);$.cmbCpType.setValue("CP28");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP10"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP09","CP10"]);$.cmbCpType.setValue("CP10");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP33"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP25","CP33"]);$.cmbCpType.setValue("CP25");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP08"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP08","CP37"]);$.cmbCpType.setValue("CP08");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP39"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP39","CP40"]);$.cmbCpType.setValue("CP39");$.cmbCpType.setAllowBlank(false,"CP유형")}else{if($.cmbCpType.getValue()=="CP04"&&g_main.session.getValue("DeptCode").substr(0,2)=="E1"){$.cmbCpType.setEnable(true);$.cmbCpType.setFilterByArray(["CP04","CP36"]);$.cmbCpType.setValue("CP36");$.cmbCpType.setAllowBlank(false,"CP유형")}}}}}}}}if(arg.type){$.cmbStatus.setValue("10")}$.bIsPopup=true}if($.bIsPopup){$.btnConfirm.setVisible(true);$.btnCancel.setVisible(true);searchClick()}else{$.grdList.setSize(null,618);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false)}};$.callback=function(type,ds){if(type=="Q"||type=="Q1"||type=="Q2"||type=="Q3"||type=="Q4"){setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}else{if(type=="WF_RESET"){searchClick()}else{if(type=="CONFIRM"||type=="CANCEL"||type=="CPCONFIRM"||type=="CPCANCEL"||type=="MACONFIRM"||type=="MACANCEL"||type=="GACONFIRM"||type=="GACANCEL"||type=="MACONFIRM2"||type=="MACANCEL2"||type=="MEMO"||type=="MAMEMO"||type=="GAMEMO"||type=="REJECT"){if(ds.errorCode=="P_crmCPMaster_S_002"){MessageBoxShow("예산에서 사용된 문서는 변경할 수 없습니다.")}searchClick()}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSearch"){searchClick()}else{if(id=="btnWfReset"){wfReset()}else{if(id=="btnTakingOver"){var count=0;var str_emp_id1="";var str_emp_id2="";var param=[];for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"CheckYN")=="Y"){if(count==0){str_emp_id1=$.grdList.getValue(i,"cp_emp_id");str_emp_id2=$.grdList.getValue(i,"cp_emp_id")}else{if(count>0){str_emp_id2=$.grdList.getValue(i,"cp_emp_id")}}if(str_emp_id1!=str_emp_id2){MessageBoxShow("인계자는 한명이어야 합니다.");return}var temp={cp_id:$.grdList.getValue(i,"cp_id"),cp_name:$.grdList.getValue(i,"cp_name"),cp_dept_code:$.grdList.getValue(i,"cp_dept_code"),cp_emp_id:$.grdList.getValue(i,"cp_emp_id"),cp_emp_name:$.grdList.getValue(i,"cp_emp_name"),report_date:$.grdList.getValue(i,"report_date"),total_amt:$.grdList.getValue(i,"total_amt"),cp_status:$.grdList.getValue(i,"cp_status")};param.push(temp);count++}}if(count==0){MessageBoxShow("인수인계 내역이 없습니다. 다시 확인해 주세요.");return}else{g_main.openPopup("popCPTakingOver.html","popCPTakingOver","",0,0,"","",param,"","")}}else{if(id=="btnConfirm"){var share=[];var rId=$.grdList.getSelectedRowIdx();if(!rId){MessageBoxShow("내용을 선택하세요.");return}var data=$.grdList.getValue(rId);data.cp_code=$.cmbCpType.getValue();g_popupStack.setData(data);g_popupStack.close()}else{if(id=="btnCancel"){g_popupStack.close()}else{if(id=="btnDownloadFile"){DownloadFile()}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDept"){var strQuery=" and dept_code = '"+$.cmbDept.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmp.clear();$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){if(cInd=="cp_name"){$.varRowId=rId;$.popUpCallId="grdList";var x=0;var y=0;x=Number($.grdList.getValue(rId,"width_size"));y=Number($.grdList.getValue(rId,"height_size"));var ds=searchCP($.grdList.getValue(rId,"load_query"));if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;if($.bIsPopup){param[0][0].CallType="BUCall"}param[0][0].Confirm=$.bConfirm;param[0][0].AllReport=$.bAllReport;param[0][0].MyReport=$.bMyReport;param[0][0].cp_status=$.grdList.getValue(rId,"cp_status");param[0][0].cp_descr=$.grdList.getValue(rId,"cp_descr");var strSaveYN=$.grdList.getValue(rId,"cp_status")=="90"?"N":$.grdList.getValue(rId,"cp_emp_id")==g_main.session.getValue("EmpCode")||$.grdList.getValue(rId,"create_user")==g_main.session.getValue("EmpCode")?"Y":"N";if($.grdList.getValue(rId,"cp_type")=="CP03"&&Number($.grdList.getValue(rId,"total_amt"))<=200000&&$.grdList.getValue(rId,"wf_doc_id")==""&&($.grdList.getValue(rId,"cp_emp_id")==g_main.session.getValue("EmpCode")||$.grdList.getValue(rId,"create_user")==g_main.session.getValue("EmpCode"))){strSaveYN="Y"}else{if($.grdList.getValue(rId,"cp_status")!="90"&&$.grdList.getValue(rId,"modify_id")!="None"){strSaveYN="Y"}else{if($.grdList.getValue(rId,"cp_status")!="90"&&$.grdList.getValue(rId,"substitute_id")==g_main.session.getValue("EmpCode")){strSaveYN="Y"}}}param[0][0].save_yn=strSaveYN;var popName=$.grdList.getValue(rId,"cp_form_id");var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.grdList.getValue(rId,"cp_name"),x,y,"","",param,"","")}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if($.bIsPopup){}else{if(popResult.save_mode!=""){if(popResult.save_mode=="DEL"){searchList("Q")}else{$.strcpDescr=popResult.cp_descr;var json=createJSON_S(popResult.save_mode);callQuery(["req",json],popResult.save_mode,$)}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>