<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.panMappingTable=null;$.panInputAuth=null;$.panApprovalAuth=null;$.grdMappingTable=null;$.grdInputAuth=null;$.grdApprovalAuth=null;$.lblFY=null;$.dteFY=null;$.lblBgtVersion=null;$.cmbBgtVersion=null;$.btnSearch=null;$.btnFormDownload=null;$.btnExcelUpload=null;$.chkMatching=null;$.htmlMappingCnt=null;$.lblDept=null;$.txtDept=null;$.session=g_main.session.obj;$.hiddenColumn=["costcenter_code_lv1","costcenter_code_lv2","costcenter_code_lv3","dept_code","product_code","budget_code"];$.rowId="";$.verCode="";$.noMappingCnt=0;$.deleteType="";$.popCallId="";$.selectRowId="";$.isDebug=false;function createJSON_Q(workType,excelData){var verCode="";var deptCode="";var budgetCode="";var productCode="";var costCenterLv1="";var costCenterLv2="";var costCenterLv3="";var deptName="";var productName="";var budgetName="";var seq="";if(workType=="Q_CHK"){costCenterLv1=excelData.lv1Str;costCenterLv2=excelData.lv2Str;costCenterLv3=excelData.lv3Str;deptName=excelData.deptNameStr;productName=excelData.productNameStr;budgetName=excelData.budgetNameStr;seq=excelData.seq}else{if(workType=="Q_DETAIL"){var checkedRows=$.grdMappingTable.getCheckedRows("chk",true);var suffix="|";for(var i=0;i<checkedRows.length;i++){var rowData=checkedRows[i];if(i==checkedRows.length-1){suffix=""}verCode+=rowData.ver_code+suffix;deptCode+=rowData.dept_code+suffix;budgetCode+=rowData.budget_code+suffix;productCode+=rowData.product_code+suffix}}}var json=createExecuteParamInfo("P_bgtMappingTable_Q",[workType,($.dteFY.getValue()||""),($.txtDept.getValue()||""),($.cmbBgtVersion.getValue()||""),verCode,deptCode,budgetCode,productCode,costCenterLv1,costCenterLv2,costCenterLv3,deptName,productName,budgetName,seq,"#UserID#"]);return json}function createJSON_S(workType){var changedRows=$.grdMappingTable.getAllRows();var rows=[];var rowData={};var json="";var iCount=1;if(changedRows.length==0){return false}for(var i in changedRows){rows.push(["N",$.cmbBgtVersion.getValue(),changedRows[i].dept_code||"",changedRows[i].budget_code||"",changedRows[i].product_code||"",changedRows[i].costcenter_code_lv1||"",changedRows[i].costcenter_code_lv2||"",changedRows[i].costcenter_code_lv3||"","",iCount,"#UserID#"]);iCount++}json=createExecuteParamInfo("P_bgtMappingTable_S",rows);return json}function createJSON_S1(workType){var dt=[];var rows=[];if(workType=="D"){dt=$.grdMappingTable.getCheckedRows("chk")}else{dt=$.grdMappingTable.getAllRows()}for(var i in dt){rows.push([workType,dt[i].ver_code,dt[i].dept_code,dt[i].budget_code,dt[i].product_code,"","","","",0,"#UserID#"])}json=createExecuteParamInfo("P_bgtMappingTable_S",rows);return json}function createJSON_S2(workType){var type=workType.substr(0,1);var iCount=1;var employeeList="";var rows=[];var checkedRows=$.grdMappingTable.getCheckedRows("chk");if(type=="N"){if(workType=="N_PLAN"){employeeList=getEmployeeConcat($.grdInputAuth,"N")}else{employeeList=getEmployeeConcat($.grdApprovalAuth,"N")}}else{if(workType=="D_PLAN"){employeeList=getEmployeeConcat($.grdInputAuth,"D")}else{employeeList=getEmployeeConcat($.grdApprovalAuth,"D")}}for(var i in checkedRows){rows.push([workType,checkedRows[i].ver_code,checkedRows[i].dept_code,checkedRows[i].budget_code,checkedRows[i].product_code,"","","",employeeList,iCount,"#UserID#"]);iCount++}json=createExecuteParamInfo("P_bgtMappingTable_S",rows);return json}function getEmployeeConcat(gridId,type){var dt=[];if(type=="N"){dt=gridId.getAllRows()}else{dt=gridId.getCheckedRows("chk")}var str="";var suffix="|";for(var i=0;i<dt.length;i++){var rowData=dt[i];if(i==dt.length-1){suffix=""}str+=rowData.employee_id+suffix}return str}function searchList(workType,rowData){var json=createJSON_Q(workType,rowData);callQuery(["req",json],workType,$)}function saveMappingTable(workType){var json=createJSON_S(workType);if(json){callExecute(["req",json],"SAVE",$)}}function deleteMappingTable(workType){var json=createJSON_S1(workType);if(json){callExecute(["req",json],"DEL",$)}}function saveAuthTable(workType){var json=createJSON_S2(workType);if(json){callExecute(["req",json],"AUTH",$)}}function excelRowDataChk(rowData,excelData){var json=createJSON_Q("Q_CHK",excelData);var ds=callExecuteSync(["req",json],"CHK");var dt=[];var content="";if(ds&&ds.errorCode=="MSG0001"){var rs=ds.resultList[0];var rowData="";content=rs.length+"건의 업로드 결과입니다.<br>(* 아래 표시된 행은 매칭이 되지 않은 행입니다.) <br>";content+="------------------------------------------------------------------------------<br><br>";for(var i=0;i<rs.length;i++){rowData=rs[i];dt.push(rowData);if(rowData.content.indexOf("|MATCH|")>-1){continue}content+=rowData.content+"<br>"}g_main.openPopup("popMessage.html","popMessage","업로드 결과",430,410,"","",{msg:content},"","");$.grdMappingTable.addRows(dt);setMappingCntTxt();switchIndicator(false)}else{MessageBoxShow("엑셀 업로드 도중 오류가 발생했습니다.<br>관리자에게 문의하십시오.");switchIndicator(false)}}function setGridColumnVisible(bo){for(var i=0;i<$.hiddenColumn.length;i++){var col=$.hiddenColumn[i];$.grdMappingTable.setColumnHidden(col,bo)}}function matchProductName(productCode){var matchData=$.productData.filter(function(row){return row.product_code===productCode});return matchData[0].product_name}function mappingTableSaveChk(){if(!$.grdMappingTable.getRowCount()){MessageBoxShow("저장할 내역이 없습니다.");return false}if(!$.cmbBgtVersion.getValue()){MessageBoxShow("예산버전을 선택해 주세요.");return false}var dt=$.grdMappingTable.getAllRows();var key="";for(var i=0;i<dt.length;i++){key=dt[i].dept_code+dt[i].budget_code+dt[i].product_code;if(!dt[i].dept_code||!dt[i].budget_code||!dt[i].costcenter_code_lv1||!dt[i].costcenter_code_lv2||!dt[i].costcenter_code_lv3){MessageBoxShow("코스트센터, 부서, 예산항목은 필수 입력입니다.");$.grdMappingTable.selectRow(i);return false}for(var j=i+1;j<dt.length;j++){var rowData=dt[j];if(key==(rowData.dept_code+rowData.budget_code+rowData.product_code)){MessageBoxShow("부서, 예산항목, 품목은 중복이 불가합니다.");$.grdMappingTable.selectRow(j);return false}}}return true}function setMappingCntTxt(){$.noMappingCnt=mappingNotChkCnt();$.htmlMappingCnt.setHTML("(매칭안된데이터 : "+$.noMappingCnt+"건)")}function mappingNotChkCnt(){var dt=$.grdMappingTable.getAllRows();var rowData="";var iCount=0;for(var i=0;i<dt.length;i++){rowData=dt[i];if(!rowData.dept_code||!rowData.budget_code||(rowData.product_name&&!rowData.product_code)||!rowData.costcenter_code_lv1||!rowData.costcenter_code_lv2||!rowData.costcenter_code_lv3){iCount++}}return iCount}function getFYDate(){var nowDate=getToday();var year=Number(nowDate.substr(0,4));var month=Number(nowDate.substr(4,2));if(month<4){$.dteFY.setValue(year-1)}else{if(month>9){$.dteFY.setValue(year+1)}else{$.dteFY.setValue(year)}}}function addAuthEmployeeChk(){var checkedRow=$.grdMappingTable.getCheckedRows("chk");if(!checkedRow.length){MessageBoxShow("권한을 추가할 예산을 선택하세요.");return false}for(var i=0;i<checkedRow.length;i++){var rowData=checkedRow[i];if(rowData.rowType=="N"){MessageBoxShow("신규 건이 존재합니다.<br>저장 이후 진행해 주세요.");return false}}return true}function setHtmlButtonEvent(){$.htmlMappingCnt.setHTML("(매칭안된데이터 : 0건)");$.htmlMappingCnt.setStyle("font-size","18px");$.htmlMappingCnt.setStyle("color","#00a0c6");$.htmlMappingCnt.setStyle("line-height","34px");$.htmlMappingCnt.setStyle("z-index","100");$.htmlMappingCnt.setButtonMode(true)}function reDrawGrid(){var dt=deepCopyObj($.grdMappingTable.getAllRows());var topData=[];var bottomData=[];var mergeData=[];if(dt.length){for(var i=0;i<dt.length;i++){var rowData=dt[i];if(!rowData.dept_code||!rowData.budget_code||(rowData.product_name&&!rowData.product_code)||!rowData.costcenter_code_lv1||!rowData.costcenter_code_lv2||!rowData.costcenter_code_lv3){topData.push(rowData)}else{bottomData.push(rowData)}}mergeData=topData.concat(bottomData);setDataGrid([$.grdMappingTable],mergeData,true)}}function getHelpComment(value){var str=value+'&nbsp;&nbsp;<span style="font-size: 12px; color:red;">(* 추가/삭제 시, 자동저장)</span>';return str}function costLv1MatchingStyle(a,b,c,d){return getMatchingCellStyle("LV1",b)}function costLv2MatchingStyle(a,b,c,d){return getMatchingCellStyle("LV2",b)}function costLv3MatchingStyle(a,b,c,d){return getMatchingCellStyle("LV3",b)}function deptMatchingStyle(a,b,c,d){return getMatchingCellStyle("DEPT",b)}function budgetMatchingStyle(a,b,c,d){return getMatchingCellStyle("BUDGET",b)}function productMatchingStyle(a,b,c,d){return getMatchingCellStyle("PROD",b)}function getMatchingCellStyle(value,obj){var str="";var cssStr={background:"#f7b6b6 !important"};if(value=="LV1"){if(!obj.costcenter_code_lv1){str=cssStr}}else{if(value=="LV2"){if(!obj.costcenter_code_lv2){str=cssStr}}else{if(value=="LV3"){if(!obj.costcenter_code_lv3){str=cssStr}}else{if(value=="DEPT"){if(!obj.dept_code){str=cssStr}}else{if(value=="BUDGET"){if(!obj.budget_code){str=cssStr}}else{if(value=="PROD"){if(!obj.product_code&&obj.product_name){str=cssStr}}}}}}}return str}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1195,980);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,55);$.panTop.setText("");$.panTop.setBottomLine();$.panMappingTable=new FingerPanel(host,"panMappingTable",0,65,1200,550);$.panMappingTable.setText("예산매핑테이블");$.panMappingTable.setBottomLine(true);$.panInputAuth=new FingerPanel(host,"panInputAuth",0,630,505,300);$.panInputAuth.setText("입력 권한");$.panInputAuth.setBottomLine(true);$.panApprovalAuth=new FingerPanel(host,"panApprovalAuth",515,630,505,300);$.panApprovalAuth.setText("승인 권한");$.panApprovalAuth.setBottomLine(true);$.grdMappingTable=new FingerDataGrid(host,"grdMappingTable",0,0,1200,505);$.grdInputAuth=new FingerDataGrid(host,"grdInputAuth",0,0,505,255);$.grdApprovalAuth=new FingerDataGrid(host,"grdApprovalAuth",0,0,505,255);$.lblFY=new FingerLabel(host,"lblFY",0,15,100,20);$.lblFY.setText("기준FY");$.dteFY=new FingerDateEdit(host,"dteFY",105,15,110,20);$.lblBgtVersion=new FingerLabel(host,"lblBgtVersion",225,15,100,20);$.lblBgtVersion.setText("예산버전");$.cmbBgtVersion=new FingerComboBox(host,"cmbBgtVersion",330,15,205,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.btnFormDownload=new FingerButton(host,"btnFormDownload",810,15,120,20);$.btnFormDownload.setText("양식다운로드");$.btnExcelUpload=new FingerButton(host,"btnExcelUpload",915,15,110,20);$.btnExcelUpload.setText("엑셀업로드");$.chkMatching=new FingerCheckBox(host,"chkMatching",364,-32,140,20);$.chkMatching.setText("매칭 된 코드표시");$.htmlMappingCnt=new FingerHTMLView(host,"htmlMappingCnt",160,-39,220,35);$.lblDept=new FingerLabel(host,"lblDept",535,15,100,20);$.lblDept.setText("부서명");$.txtDept=new FingerEdit(host,"txtDept",640,15,140,20);$.panTop.setBorder(true);$.panMappingTable.addButtons(["btnExcelDown","btnDelete","btnSave","btnAdd"]);$.panMappingTable.addButton("btnAllDelete","전체삭제(초기화)");$.panMappingTable.setButtonAction("btnAllDelete","custom",120);$.panInputAuth.addButtons(["btnDelete","btnAdd"]);$.panApprovalAuth.addButtons(["btnDelete","btnAdd"]);$.panInputAuth.setText(getHelpComment("입력 권한"));$.panApprovalAuth.setText(getHelpComment("승인 권한"));$.cmbBgtVersion.setEmptyRow(true);$.dteFY.setDateFormat("yyyy");$.dteFY.setAllowBlank(false,"기준FY");$.cmbBgtVersion.setAllowBlank(false,"예산버전");$.chkMatching.setStyle("zIndex","999");$.grdMappingTable.setColumns([new FingerDataGridColumn("chk",50,"center","checkbox","masterCheckbox",{excelHidden:true}),new FingerDataGridColumn("costcenter_code_lv1",100,"left","string",[{text:"LV1코드",css:"col_chk"}],{readonly:true,cssFormat:costLv1MatchingStyle}),new FingerDataGridColumn("costcenter_code_lv1_name",100,"left","string",[{text:"SG&A_LV1",css:"col_edit"}],{readonly:true,cssFormat:costLv1MatchingStyle}),new FingerDataGridColumn("costcenter_code_lv2",100,"left","string",[{text:"LV2코드",css:"col_chk"}],{readonly:true,cssFormat:costLv2MatchingStyle}),new FingerDataGridColumn("costcenter_code_lv2_name",100,"left","string",[{text:"SG&A_LV2",css:"col_edit"}],{readonly:true,cssFormat:costLv2MatchingStyle}),new FingerDataGridColumn("costcenter_code_lv3",100,"left","string",[{text:"LV3코드",css:"col_chk"}],{readonly:true,cssFormat:costLv3MatchingStyle}),new FingerDataGridColumn("costcenter_code_lv3_name",150,"left","string",[{text:"SG&A_LV3",css:"col_edit"}],{readonly:true,cssFormat:costLv3MatchingStyle}),new FingerDataGridColumn("dept_code",100,"left","string",[{text:"부서코드",css:"col_chk"}],{readonly:true,cssFormat:deptMatchingStyle}),new FingerDataGridColumn("dept_name",100,"left","string",[{text:"부서명",css:"col_edit"}],{readonly:true,cssFormat:deptMatchingStyle}),new FingerDataGridColumn("product_code",100,"left","string",[{text:"품목코드",css:"col_chk"}],{readonly:true,cssFormat:productMatchingStyle}),new FingerDataGridColumn("product_name",100,"left","string","품목",{readonly:true,cssFormat:productMatchingStyle}),new FingerDataGridColumn("budget_code",160,"left","string",[{text:"예산항목코드",css:"col_chk"}],{readonly:true,cssFormat:budgetMatchingStyle}),new FingerDataGridColumn("budget_name",160,"left","string",[{text:"예산항목",css:"col_edit"}],{readonly:true,cssFormat:budgetMatchingStyle}),new FingerDataGridColumn("ucoa_code",150,"left","string","U-Coa",{readonly:true}),new FingerDataGridColumn("input_auth",170,"left","string","입력권한",{readonly:true}),new FingerDataGridColumn("approval_auth",170,"left","string","승인권한",{readonly:true})]);$.grdMappingTable.init({scroll:"xy",leftSplit:1,select:"cell"});$.grdMappingTable.setBorder(false);$.grdMappingTable.setEditable(true);$.grdInputAuth.setColumns([new FingerDataGridColumn("chk",44,"center","checkbox","masterCheckbox"),new FingerDataGridColumn("dept_name",242,"left","string","부서",{readonly:true}),new FingerDataGridColumn("emp_name",202,"left","string","담당자",{readonly:true})]);$.grdInputAuth.init({scroll:"xy",leftSplit:1});$.grdInputAuth.setBorder(false);$.grdApprovalAuth.setColumns([new FingerDataGridColumn("chk",44,"center","checkbox","masterCheckbox"),new FingerDataGridColumn("dept_name",242,"left","string","부서",{readonly:true}),new FingerDataGridColumn("emp_name",202,"left","string","담당자",{readonly:true})]);$.grdApprovalAuth.init({scroll:"xy",leftSplit:1});$.grdApprovalAuth.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panMappingTable);$.panMain.add($.panInputAuth);$.panMain.add($.panApprovalAuth);$.panTop.add($.lblFY);$.panTop.add($.dteFY);$.panTop.add($.lblBgtVersion);$.panTop.add($.cmbBgtVersion);$.panTop.add($.btnSearch);$.panTop.add($.btnFormDownload);$.panTop.add($.btnExcelUpload);$.panTop.add($.lblDept);$.panTop.add($.txtDept);$.panMappingTable.add($.grdMappingTable);$.panMappingTable.add($.htmlMappingCnt);$.panMappingTable.add($.chkMatching);$.panInputAuth.add($.grdInputAuth);$.panApprovalAuth.add($.grdApprovalAuth);var ds="";ds=bizComponentData2($,"Q1","L_CRM275");$.grdMappingTable.setColumnDropDownList("ucoa_code",ds.resultList[0]);setHtmlButtonEvent();setGridColumnVisible(true);getFYDate()};$.callback=function(type,ds){if(type=="Q"){if(ds&&ds.errorCode=="MSG0001"){for(var i=0;i<ds.resultList[0].length;i++){var rowData=ds.resultList[0][i];if(rowData.input_auth){rowData.input_auth=rowData.input_auth.substr(0,rowData.input_auth.length-1)}if(rowData.approval_auth){rowData.approval_auth=rowData.approval_auth.substr(0,rowData.approval_auth.length-1)}}}setDataGrid([$.grdMappingTable],ds);setMappingCntTxt()}else{if(type=="Q_VER"){$.cmbBgtVersion.clear();if(ds&&ds.errorCode=="MSG0001"){setComboBind([$.cmbBgtVersion],ds)}}else{if(type=="Q_DETAIL"){setDataGrid([$.grdInputAuth,$.grdApprovalAuth],ds)}else{if(type=="SAVE"){if(ds){MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q","")}}else{if(type=="AUTH"){if(ds){MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q_DETAIL","");searchList("Q","")}}else{if(type=="DEL"){if(ds){$.grdInputAuth.clear();$.grdApprovalAuth.clear();MessageBoxShow("정상적으로 삭제되었습니다.");searchList("Q","")}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!$.panTop.validateControls()){return}searchList("Q","")}else{if(id=="htmlMappingCnt"){reDrawGrid()}else{if(id=="btnFormDownload"){window.onbeforeunload=null;excelDataFileDown("/bgtMappingTableForm.xlsx")}else{if(id=="btnExcelUpload"){$.popUpCallId=id;var param={};param.placeHolder="내용만 복사해서 붙여넣으세요.\r\n첫 행에 첫 열은 필수로 입력하셔야 합니다.";param.cId=["costcenter_code_lv1_name","costcenter_code_lv2_name","costcenter_code_lv3_name","dept_name","product_name","budget_name"];param.isLoadingOn=true;g_main.openPopup("popPaste.html","popPaste","엑셀자료삽입",600,355,"","",param,"","");return;var popResult={paste:[{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"광고선전비_종병학회"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"광고선전비_종병질환홍보"},{rowType:"N",costcenter_code_lv1_name:"SM333",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"교육훈련비_종병학회등록"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"복리후생비_종병시상비"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"자문용역_종병"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL",budget_name:"판촉물_종병"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"",product_name:"SGL",budget_name:"정보수집전달_종병디테일링_MKT"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"SGL11",budget_name:"정보수집전달_종병중점PLAN"},{rowType:"N",costcenter_code_lv1_name:"SM",costcenter_code_lv2_name:"MSADM",costcenter_code_lv3_name:"Marketing OOP",dept_name:"경영전략부",product_name:"",budget_name:"정보수집전달_종병학술대회개최운영지원"}]};var dt=popResult.paste;var msg="";var iCount="1";var lv1Str="";var lv2Str="";var lv3Str="";var deptNameStr="";var productNameStr="";var budgetNameStr="";var seq="";var excelData={};var suffix="||";for(var i=0;i<dt.length;i++){if(i==dt.length-1){suffix=""}lv1Str+=dt[i].costcenter_code_lv1_name.trim()+suffix;lv2Str+=dt[i].costcenter_code_lv2_name.trim()+suffix;lv3Str+=dt[i].costcenter_code_lv3_name.trim()+suffix;deptNameStr+=dt[i].dept_name.trim()+suffix;productNameStr+=dt[i].product_name.trim()+suffix;budgetNameStr+=dt[i].budget_name.trim()+suffix;seq+=iCount+suffix;iCount++}excelData.lv1Str=lv1Str;excelData.lv2Str=lv2Str;excelData.lv3Str=lv3Str;excelData.deptNameStr=deptNameStr;excelData.productNameStr=productNameStr;excelData.budgetNameStr=budgetNameStr;excelData.seq=seq;excelRowDataChk("Q_CHK",excelData)}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){if(id=="chkMatching"){var bo=(value=="Y"?false:true);setGridColumnVisible(bo)}};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteFY"){if(!value){return}searchList("Q_VER","")}};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdMappingTable"){$.rowId=rId;if(cInd=="dept_name"){g_main.openPopup("popDept.html","popDept","",0,0,"","",{},"","")}else{if(cInd=="budget_name"){g_main.openPopup("popBudgetList.html","popBudgetList","",0,0,"","",{singleSelect:true},"","")}else{if(cInd=="product_name"){g_main.openPopup("popProductList.html","popProductList","",0,0,"","",{product_code:""},"","")}else{if(cInd=="costcenter_code_lv1_name"){$.costCode="costcenter_code_lv1";$.costName="costcenter_code_lv1_name";g_main.openPopup("popCostCenter.html","popCostCenter","코스트 센터",330,500,"","",{type:1},"","")}else{if(cInd=="costcenter_code_lv2_name"){$.costCode="costcenter_code_lv2";$.costName="costcenter_code_lv2_name";g_main.openPopup("popCostCenter.html","popCostCenter","코스트 센터",330,500,"","",{type:2},"","")}else{if(cInd=="costcenter_code_lv3_name"){$.costCode="costcenter_code_lv3";$.costName="costcenter_code_lv3_name";g_main.openPopup("popCostCenter.html","popCostCenter","코스트 센터",330,500,"","",{type:3},"","")}}}}}}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdMappingTable"){if(cInd=="chk"){searchList("Q_DETAIL","")}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtDept"){if(value&&value=="13"){searchList("Q","")}}};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panMappingTable"){if(btnId=="btnAdd"){$.grdMappingTable.addRow();setMappingCntTxt()}else{if(btnId=="btnSave"){if(!mappingTableSaveChk()){return}confirmBoxShow("저장 하시겠습니까?",function(){if(g_main.msgShare==true){saveMappingTable("")}})}else{if(btnId=="btnDelete"){var checkedRow=$.grdMappingTable.getCheckedRows("chk");if(checkedRow.length<1){MessageBoxShow("삭제할 내역이 없습니다.");return}var isModify=false;for(var i=0;i<checkedRow.length;i++){if(checkedRow[i].rowType=="U"){isModify=true;break}}if(isModify){confirmBoxShow("삭제 하시겠습니까?",function(){if(g_main.msgShare==true){deleteMappingTable("D")}})}else{for(var i=0;i<checkedRow.length;i++){$.grdMappingTable.deleteRow(checkedRow[i].id)}setMappingCntTxt()}}else{if(btnId=="btnAllDelete"){if(!$.grdMappingTable.getRowCount()){MessageBoxShow("삭제할 내역이 없습니다.");return}confirmBoxShow("전체 내역을 삭제 하시겠습니까?",function(){if(g_main.msgShare==true){deleteMappingTable("D_ALL")}})}else{if(btnId=="btnExcelDown"){$.grdMappingTable.excelDown("예산매핑테이블")}}}}}}else{if(panelId=="panInputAuth"){if(btnId=="btnAdd"){if(!addAuthEmployeeChk()){return}$.popCallId=panelId;g_main.openPopup("popEmp.html","popEmp","",0,0,"","",{emp_name:""},"","")}else{if(btnId=="btnDelete"){var checkedRow=$.grdInputAuth.getCheckedRows("chk");if(!checkedRow.length){MessageBoxShow("삭제할 내역이 없습니다.");return}confirmBoxShow("삭제 하시겠습니까?",function(){if(g_main.msgShare==true){saveAuthTable("D_PLAN")}})}}}else{if(panelId=="panApprovalAuth"){if(btnId=="btnAdd"){if(!addAuthEmployeeChk()){return}$.popCallId=panelId;g_main.openPopup("popEmp.html","popEmp","",0,0,"","",{emp_name:""},"","")}else{if(btnId=="btnDelete"){var checkedRow=$.grdApprovalAuth.getCheckedRows("chk");if(!checkedRow.length){MessageBoxShow("삭제할 내역이 없습니다.");return}confirmBoxShow("삭제 하시겠습니까?",function(){if(g_main.msgShare==true){saveAuthTable("D_APPR")}})}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popPaste"){var dt=popResult.paste;var msg="";var iCount="1";var lv1Str="";var lv2Str="";var lv3Str="";var deptNameStr="";var productNameStr="";var budgetNameStr="";var seq="";var excelData={};var suffix="||";for(var i=0;i<dt.length;i++){if(i==dt.length-1){suffix=""}lv1Str+=dt[i].costcenter_code_lv1_name.trim()+suffix;lv2Str+=dt[i].costcenter_code_lv2_name.trim()+suffix;lv3Str+=dt[i].costcenter_code_lv3_name.trim()+suffix;deptNameStr+=dt[i].dept_name.trim()+suffix;productNameStr+=dt[i].product_name.trim()+suffix;budgetNameStr+=dt[i].budget_name.trim()+suffix;seq+=iCount+suffix;iCount++}excelData.lv1Str=lv1Str;excelData.lv2Str=lv2Str;excelData.lv3Str=lv3Str;excelData.deptNameStr=deptNameStr;excelData.productNameStr=productNameStr;excelData.budgetNameStr=budgetNameStr;excelData.seq=seq;excelRowDataChk("Q_CHK",excelData)}else{if(id=="popDept"){$.grdMappingTable.setValue($.rowId,"dept_code",popResult.dept_code);$.grdMappingTable.setValue($.rowId,"dept_name",popResult.dept_name);setMappingCntTxt()}else{if(id=="popBudgetList"){$.grdMappingTable.setValue($.rowId,"budget_code",popResult[0].budget_code);$.grdMappingTable.setValue($.rowId,"budget_name",popResult[0].budget_name);$.grdMappingTable.setValue($.rowId,"ucoa_code",popResult[0].ucoa_code);setMappingCntTxt()}else{if(id=="popEmp"){if($.popCallId=="panInputAuth"){var dt=$.grdInputAuth.getAllRows();for(var i=0;i<dt.length;i++){if(dt[i].employee_id==popResult.employee_id){MessageBoxShow("동일한 담당자는 입력이 불가합니다.");return}}$.grdInputAuth.addRow({employee_id:popResult.employee_id,emp_name:popResult.emp_name,dept_code:popResult.dept_code,dept_name:popResult.dept_name});saveAuthTable("N_PLAN")}else{var dt=$.grdApprovalAuth.getAllRows();for(var i=0;i<dt.length;i++){if(dt[i].employee_id==popResult.employee_id){MessageBoxShow("동일한 담당자는 입력이 불가합니다.");return}}$.grdApprovalAuth.addRow({employee_id:popResult.employee_id,emp_name:popResult.emp_name,dept_code:popResult.dept_code,dept_name:popResult.dept_name});saveAuthTable("N_APPR")}}else{if(id=="popProductList"){$.grdMappingTable.setValue($.rowId,"product_code",popResult.product_code);$.grdMappingTable.setValue($.rowId,"product_name",popResult.product_name);setMappingCntTxt()}else{if(id=="popCostCenter"){$.grdMappingTable.setValue($.rowId,$.costCode,popResult.sub_code);$.grdMappingTable.setValue($.rowId,$.costName,popResult.code_name);setMappingCntTxt()}}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>