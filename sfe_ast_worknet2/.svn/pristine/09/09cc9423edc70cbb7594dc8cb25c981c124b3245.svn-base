<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panelEx1=null;$.panBasicInfo=null;$.panEmp=null;$.panTab=null;$.tabMain=null;$.panTab1=null;$.panTab2=null;$.panTab3=null;$.panTab4=null;$.lblteam_title=null;$.grdMemberList=null;$.grdPage1=null;$.grdPage3=null;$.grdPage4=null;$.lblperiod=null;$.cmbbase_year=null;$.cmbbase_half=null;$.lblwork_title=null;$.txtactionlearning_title=null;$.txtdept_code=null;$.txtboard_id=null;$.labelEx1=null;$.txtsponsor=null;$.btnSave=null;$.btnClose=null;$.memooutput=null;function fnQRY_P_crmActionLearningMemberList_Q(workType){var json=createJSON_Q1(workType);callQuery(["req",json],"Q1",$)}function createJSON_Q1(workType){var json=createExecuteParamInfo("P_crmActionLearningMemberList_Q",[workType,$.cmbbase_year.getValue(),$.cmbbase_half.getValue(),$.txtboard_id.getValue()]);return json}function fnQRY_P_crmActionLearningDocu_Q(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmActionLearningDocu_Q",[workType,$.cmbbase_year.getValue(),$.cmbbase_half.getValue(),$.txtboard_id.getValue()]);return json}function fnSET_P_crmActionLearningDocu_S(workType){if(!validateControls([$.txtactionlearning_title,$.txtsponsor])){return false}var json=createJSON_S(workType);callQuery(["req",json],"S",$)}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmActionLearningDocu_S",[workType,$.cmbbase_year.getValue(),$.cmbbase_half.getValue(),$.txtboard_id.getValue(),$.txtactionlearning_title.getValue(),$.txtsponsor.getValue(),$.grdPage1.getValue(0,"description"),$.grdPage1.getValue(1,"description"),$.grdPage1.getValue(2,"description"),$.memooutput.getValue(),$.grdPage3.getValue(0,"shorterm_result")||"",$.grdPage3.getValue(0,"longterm_result")||"",$.grdPage3.getValue(1,"shorterm_result")||"",$.grdPage3.getValue(1,"longterm_result")||"",$.grdPage3.getValue(2,"shorterm_result")||"",$.grdPage3.getValue(2,"longterm_result")||"",g_main.session.obj.EmpCode]);return json}function fnSET_P_crmActionLearningScheDule_S(workType){if($.grdPage4.getRowCount()<0){return}var json=createJSON_S1(workType);callQuery(["req",json],"S1",$)}function createJSON_S1(workType){var rows=[];for(var i=0;i<$.grdPage4.getRowCount();i++){rows.push([workType,$.cmbbase_year.getValue(),$.cmbbase_half.getValue(),$.txtboard_id.getValue(),$.grdPage4.getValue(i,"Sequence"),$.grdPage4.getValue(i,"contents")||"",$.grdPage4.getValue(i,"data_source")||"",$.grdPage4.getValue(i,"method")||"",$.grdPage4.getValue(i,"work_date")||"",$.grdPage4.getValue(i,"person")||"",g_main.session.obj.EmpCode])}json=createExecuteParamInfo("P_crmActionLearningScheDule_S",rows);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,900,660);$.panMain.setText("");$.panMain.setBottomLine(true);$.panelEx1=new FingerPanel(host,"panelEx1",0,0,900,55);$.panelEx1.setText("");$.panelEx1.setBottomLine();$.panBasicInfo=new FingerPanel(host,"panBasicInfo",0,60,650,155);$.panBasicInfo.setText("기본정보");$.panBasicInfo.setBottomLine(true);$.panEmp=new FingerPanel(host,"panEmp",655,60,245,155);$.panEmp.setText("");$.panEmp.setBottomLine(true);$.panTab=new FingerPanel(host,"panTab",0,220,900,385);$.panTab.setText("");$.panTab.setBottomLine(true);$.tabMain=new FingerTab(host,"tabMain",0,0,900,385);$.panTab1=new FingerPanel(host,"panTab1",0,0,900,360);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,900,360);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.panTab3=new FingerPanel(host,"panTab3",0,0,900,360);$.panTab3.setText("");$.panTab3.setBottomLine(true);$.panTab4=new FingerPanel(host,"panTab4",0,0,900,305);$.panTab4.setText("학습계획");$.panTab4.setBottomLine(true);$.lblteam_title=new FingerLabel(host,"lblteam_title",215,15,470,20);$.lblteam_title.setText("의 Action Learning 과제 기술서");$.grdMemberList=new FingerDataGrid(host,"grdMemberList",0,0,245,155);$.grdPage1=new FingerDataGrid(host,"grdPage1",0,0,900,350);$.grdPage3=new FingerDataGrid(host,"grdPage3",0,0,900,350);$.grdPage4=new FingerDataGrid(host,"grdPage4",0,0,900,305);$.lblperiod=new FingerLabel(host,"lblperiod",0,15,100,20);$.lblperiod.setText("기간");$.cmbbase_year=new FingerComboBox(host,"cmbbase_year",105,15,140,20);$.cmbbase_half=new FingerComboBox(host,"cmbbase_half",250,15,140,20);$.lblwork_title=new FingerLabel(host,"lblwork_title",0,45,100,20);$.lblwork_title.setText("과제명칭");$.txtactionlearning_title=new FingerEdit(host,"txtactionlearning_title",105,45,415,20);$.txtdept_code=new FingerEdit(host,"txtdept_code",525,45,45,20);$.txtboard_id=new FingerEdit(host,"txtboard_id",575,45,50,20);$.labelEx1=new FingerLabel(host,"labelEx1",0,75,100,20);$.labelEx1.setText("과제스폰서");$.txtsponsor=new FingerEdit(host,"txtsponsor",105,75,290,20);$.btnSave=new FingerButton(host,"btnSave",755,620,80,20);$.btnSave.setText("저장");$.btnClose=new FingerButton(host,"btnClose",820,620,80,20);$.btnClose.setText("닫기");$.memooutput=new FingerMemoEdit(host,"memooutput",0,0,895,350);$.txtdept_code.setVisible(false);$.txtboard_id.setVisible(false);$.cmbbase_year.setEmptyRow(true);$.txtactionlearning_title.setAllowBlank(false,"과제명칭");$.txtsponsor.setAllowBlank(false,"과제스폰서");$.panTab4.addButtons(["btnDelete","btnAdd"]);$.panelEx1.setBorder(true);$.grdMemberList.setColumns([new FingerDataGridColumn("emp_code",70,"left","string","사원코드",{hidden:true}),new FingerDataGridColumn("emp_name",230,"left","string","팀원")]);$.grdMemberList.init({nonExcel:true,isFilter:false});$.grdPage1.setColumns([new FingerDataGridColumn("work_title_code",70,"left","string","코드",{hidden:true}),new FingerDataGridColumn("work_title",150,"center","multi_line_edit"," "),new FingerDataGridColumn("description",730,"left","multi_line_edit","내용")]);$.grdPage1.init({nonExcel:true,isFilter:false,scroll:"xy",rowHeight:90});$.grdPage1.setEditable(true);$.grdPage3.setColumns([new FingerDataGridColumn("work_title2",150,"center","string"," "),new FingerDataGridColumn("work_title_code2",70,"center","string","코드",{hidden:true}),new FingerDataGridColumn("shorterm_result",365,"left","multi_line_edit","단기"),new FingerDataGridColumn("longterm_result",365,"left","multi_line_edit","중장기")]);$.grdPage3.init({nonExcel:true,isFilter:false,scroll:"xy",rowHeight:90});$.grdPage3.setEditable(true);$.grdPage4.setColumns([new FingerDataGridColumn("Sequence",70,"center","string","Num."),new FingerDataGridColumn("contents",330,"left","multi_line_edit","내용(What)"),new FingerDataGridColumn("data_source",120,"left","multi_line_edit","자료원(Where)"),new FingerDataGridColumn("method",120,"left","multi_line_edit","방법(How)"),new FingerDataGridColumn("work_date",120,"left","string","일정(When)"),new FingerDataGridColumn("person",120,"left","string","담당(Who)")]);$.grdPage4.init({nonExcel:true,isFilter:false,scroll:"xy",rowHeight:70});$.grdPage4.setEditable(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panelEx1);$.panMain.add($.panBasicInfo);$.panMain.add($.panEmp);$.panMain.add($.panTab);$.panMain.add($.panTab1);$.panMain.add($.panTab2);$.panMain.add($.panTab3);$.panMain.add($.panTab4);$.panMain.add($.btnSave);$.panMain.add($.btnClose);$.panelEx1.add($.lblteam_title);$.panBasicInfo.add($.lblperiod);$.panBasicInfo.add($.cmbbase_year);$.panBasicInfo.add($.cmbbase_half);$.panBasicInfo.add($.lblwork_title);$.panBasicInfo.add($.txtactionlearning_title);$.panBasicInfo.add($.txtdept_code);$.panBasicInfo.add($.txtboard_id);$.panBasicInfo.add($.labelEx1);$.panBasicInfo.add($.txtsponsor);$.panEmp.add($.grdMemberList);$.panTab.add($.tabMain);$.panTab1.add($.grdPage1);$.panTab2.add($.memooutput);$.panTab3.add($.grdPage3);$.panTab4.add($.grdPage4);$.tabMain.addTab([{text:"과제선정배경(As-is)",body:$.panTab1,width:150},{text:"도출해야 할 구체적 결과물(Tangible Output Image)",body:$.panTab2,width:280},{text:"과제해결 후 이상적 모습(To-be)",body:$.panTab3,width:180},{text:"학습계획",body:$.panTab4,width:80}]);var ds=bizComponentData2($,"Q1","S_999");$.cmbbase_year.setColumn("base_yyyy","name");setComboBind([$.cmbbase_year],ds);var ds1=bizComponentData2($,"Q2","L_CRM0070");$.cmbbase_half.setColumn("sub_code","code_name");setComboBind([$.cmbbase_half],ds1);if($.p_argument){$.lblteam_title.setText($.p_argument.dept_name+" 의 Action Learning 과제 기술서");$.lblteam_title.setAlign("center");$.txtboard_id.setValue($.p_argument.board_id);$.cmbbase_year.setValue("2017");$.cmbbase_half.setValue("1");fnQRY_P_crmActionLearningMemberList_Q("Q");fnQRY_P_crmActionLearningDocu_Q("Q");if($.p_argument.Mode!="View"){$.txtactionlearning_title.setReadOnly(true);$.txtsponsor.setReadOnly(true);$.grdPage1.setEditable(false);$.memooutput.setReadOnly(true);$.grdPage3.setEditable(false);$.grdPage4.setEditable(false);$.panTab4.disableButton(["btnDelete","btnAdd"]);$.cmbbase_year.setReadOnly(false);$.cmbbase_half.setReadOnly(false)}}};$.callback=function(type,ds){if(type=="Q"){if(ds!=null){$.txtactionlearning_title.setValue(ds.resultList[0][0].actionlearning_title);$.txtsponsor.setValue(ds.resultList[0][0].sponsor);setDataGrid([$.grdPage1],ds.resultList[1],true);$.memooutput.setValue(ds.resultList[2][0].tangible_output);setDataGrid([$.grdPage3],ds.resultList[3],true);setDataGrid([$.grdPage4],ds.resultList[4],true);$.grdPage1.selectRow(0);$.grdPage3.selectRow(0);$.grdPage4.selectRow(0)}}else{if(type=="Q1"){setDataGrid([$.grdMemberList],ds);$.grdMemberList.selectRow(0)}else{if(type=="S"||type=="S1"){fnQRY_P_crmActionLearningDocu_Q("Q")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSave"){confirmBoxShow("변경 사항을 저장 하시겠습니까?",function(){if(g_main.msgShare==true){fnSET_P_crmActionLearningDocu_S("S");fnSET_P_crmActionLearningScheDule_S("S")}})}else{if(id=="btnClose"){g_popupStack.close()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbbase_year"){if($.cmbbase_year.getValue()==""){return}else{fnQRY_P_crmActionLearningDocu_Q("Q")}}else{if(id=="cmbbase_half"){if($.cmbbase_half.getValue()==""){return}else{fnQRY_P_crmActionLearningDocu_Q("Q")}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panTab4"){if(btnId=="btnAdd"){$.grdPage4.addRow({Sequence:0});for(var i=0;i<$.grdPage4.getRowCount();i++){$.grdPage4.setValue(i,"Sequence",i+1)}}else{if(btnId=="btnDelete"){if($.grdPage4.getRowCount()<0){return}var rId=$.grdPage4.getSelectedRowIdx();var rowS=$.grdPage4.getRowStatus(rId);if(rowS=="N"){$.grdPage4.deleteRow(rId);$.grdPage4.selectRow(0)}else{confirmBoxShow("정말 삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdPage4.deleteRow(rId);$.grdPage4.selectRow(0);for(var i=0;i<$.grdPage4.getRowCount();i++){$.grdPage4.setValue(i,"Sequence",i+1)}}})}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>