<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panInfo=null;$.panContact=null;$.panCard=null;$.panBottom=null;$.lblCPDocNo=null;$.lblStartDate=null;$.lblReportDate=null;$.lblEmp=null;$.lblStatus=null;$.lblAppEmp=null;$.lblLabel1=null;$.txtCPDocNo=null;$.dteStartDate=null;$.dteReportDate=null;$.cmbEmp=null;$.cmbStatus=null;$.txtAppEmp=null;$.grdContact=null;$.grdCard=null;$.imgPicture1=null;$.imgPicture2=null;$.imgPicture3=null;$.imgPicture4=null;$.memDesc=null;$.lblDesc=null;$.btnConfirm=null;$.btnCancel=null;$.btnReject=null;$.btnCPConfirm=null;$.memCPDescr=null;$.grdEsero=null;$.btnAppReq=null;$.varCPId="";$.varWFDocId="";$.varCPCode="";$.varAppEmp="";$.varDeptCode="";$.varSupportTotal=0;$.varAPPAMTTotal=0;$.varBillType="Card";function createJSON_S(workType){var contRow=$.grdContact.getAllRows();var cardRow=$.grdCard.getAllRows();var eseroRow=$.grdEsero.getAllRows();if($.varBillType=="Card"){for(var i in cardRow){$.varAPPAMTTotal+=Number(cardRow[i].APPAMT)}}else{if($.varBillType=="Esero"){for(var i in eseroRow){$.varAPPAMTTotal+=Number(eseroRow[i].appamt)}}}var pic1Yn=$.imgPicture1.getValue()?"Y":"N";var pic2Yn=$.imgPicture2.getValue()?"Y":"N";var pic3Yn=$.imgPicture3.getValue()?"Y":"N";var pic4Yn=$.imgPicture4.getValue()?"Y":"N";var compId="",contId="",special="",suppAmt="",APPRNO="",APPDAT="",CARDNO="",APPAMT="",VENKNM="",VENADD="",VENGRP="",BIZNAME="",PRODUCT="",PRODUCT1="",pic1URL="",pic2URL="",pic3URL="",pic4URL="";var today=getToday("");var year=today.substr(0,4);var month=today.substr(4,2);var url=year+"/"+month+"/";if(workType!="D"){var imgRs=$.imgGroup.uploadBase64();if(imgRs){var imgURL=imgRs.resultList[0]}var imgIdx=0;if(pic1Yn=="Y"&&$.imgPicture1.isDataUrL){pic1URL=imgURL[imgIdx].file_url;imgIdx++}else{if(pic1Yn=="Y"){pic1URL=$.varPic1Url||""}}if(pic2Yn=="Y"&&$.imgPicture2.isDataUrL){pic2URL=imgURL[imgIdx].file_url;imgIdx++}else{if(pic2Yn=="Y"){pic2URL=$.varPic2Url||""}}if(pic3Yn=="Y"&&$.imgPicture3.isDataUrL){pic3URL=imgURL[imgIdx].file_url;imgIdx++}else{if(pic3Yn=="Y"){pic3URL=$.varPic3Url||""}}if(pic4Yn=="Y"&&$.imgPicture4.isDataUrL){pic4URL=imgURL[imgIdx].file_url;imgIdx++}else{if(pic4Yn=="Y"){pic4URL=$.varPic4Url||""}}}log(pic1URL);if($.varBillType=="Card"){if(cardRow.length<=0){MessageBoxShow("법인카드내역이 등록되지 않았습니다.");return}for(var i in cardRow){APPRNO+=(APPRNO?"|":"")+cardRow[i].APPRNO||" ";APPDAT+=(APPDAT?"|":"")+cardRow[i].APPDAT||" ";CARDNO+=(CARDNO?"|":"")+cardRow[i].CARDNO||" ";APPAMT+=(APPAMT?"|":"")+cardRow[i].APPAMT||" ";VENKNM+=(VENKNM?"|":"")+cardRow[i].VENKNM||" ";VENADD+=(VENADD?"|":"")+cardRow[i].VENADD||" ";VENGRP+=(VENGRP?"|":"")+cardRow[i].VENGRP||" "}}else{if($.varBillType=="Esero"){if(eseroRow.length<=0){MessageBoxShow("전자세금계산서내역이 등록되지 않았습니다.");return}for(var i in eseroRow){APPRNO+=(APPRNO?"|":"")+cardRow[i].apprno||" ";APPDAT+=(APPDAT?"|":"")+cardRow[i].appdat||" ";APPAMT+=(APPAMT?"|":"")+cardRow[i].appamt||" ";BIZNAME+=(APPAMT?"|":"")+cardRow[i].bizname||" ";PRODUCT+=(APPAMT?"|":"")+cardRow[i].product||" ";PRODUCT1+=(APPAMT?"|":"")+cardRow[i].product1||" "}}}if(contRow.length<=0){MessageBoxShow("고객정보가 등록되지 않았습니다.");return}for(var i in contRow){compId+=(compId?"|":"")+contRow[i].company_id||" ";contId+=(contId?"|":"")+contRow[i].contact_id||" ";special+=(special?"|":"")+contRow[i].speciality||" ";suppAmt+=(suppAmt?"|":"")+contRow[i].support_amt||" "}var json=createExecuteParamInfo("P_crmCPExternalAct_S",[workType,$.varCPId,$.txtCPDocNo.getValue()||"",$.cmbEmp.getValue()||"",$.dteReportDate.getValue()||"",$.varDeptCode,$.dteStartDate.getValue()||"",Number($.varAPPAMTTotal),$.memDesc.getValue()||"",pic1Yn,pic2Yn,pic3Yn,pic4Yn,pic1URL,pic2URL,pic3URL,pic4URL,$.varCPCode,$.varWFDocId,"#UserID#",compId,contId,special,suppAmt,APPRNO,APPDAT,CARDNO,APPAMT,VENKNM,VENADD,VENGRP,BIZNAME,PRODUCT,PRODUCT1,$.varBillType]);log(json);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.varCPId,"","#UserID#"]);return json}function saveExternalAct(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$);if(ds){if(ds.errorCode.substr(0,1)=="D"){MessaeBoxShow("참가자는 1일 2회, 매월 5회를 초과할 수 없습니다. ["+ds.errorCode+"]");return}if(workType=="N"){log(ds);var rStr=ds.returnStr.split("|");$.varCPId=rStr[1];$.txtCPDocNo.setValue(rStr[0])}if(workType=="D"){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}}}function saveExtraFunction(workType){var json=createJSON_S2(workType);if(json){var ds=callExecuteSync(["req",json],workType,$);if(ds){if(ds.errorCode=="MSG0004"){$.cmbStatus.setValue("05")}}}}function chkExpense(){var contRow=$.grdContact.getAllRows();var cardRow=$.grdCard.getAllRows();var supAmt=0,cardAmt=0;for(var i in contRow){supAmt+=Number(contRow[i].support_amt)}for(var i in cardRow){cardAmt+=Number(cardRow[i].APPAMT)}if(supAmt==cardAmt){return true}else{return false}}function akrMember(){var akrMember=false;var contRow=$.grdContact.getAllRows();for(var i in contRow){if(contRow[i].contact_id.substr(0,2)=="ka"){}akrMember=true;break}return akrMember}function setEnable(bo){if(bo){$.panInfo.enableButton(["btnSave"]);$.panContact.enableButton(["btnAdd","btnDelete"])}else{$.panInfo.disableButton(["btnSave"]);$.panContact.disableButton(["btnAdd","btnDelete"])}$.memDesc.setReadOnly(!bo)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,800);$.panMain.setText("");$.panMain.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,0,1200,680);$.panInfo.setText("대외활동(CP)");$.panInfo.setBottomLine(true);$.panContact=new FingerPanel(host,"panContact",0,75,600,295);$.panContact.setText("참석자 명단");$.panContact.setBottomLine(true);$.panCard=new FingerPanel(host,"panCard",0,380,600,250);$.panCard.setText("법인카드내역");$.panCard.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,690,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.lblCPDocNo=new FingerLabel(host,"lblCPDocNo",0,10,100,20);$.lblCPDocNo.setText("문서번호");$.lblStartDate=new FingerLabel(host,"lblStartDate",300,10,100,20);$.lblStartDate.setText("진행일시");$.lblReportDate=new FingerLabel(host,"lblReportDate",600,10,100,20);$.lblReportDate.setText("보고일자");$.lblEmp=new FingerLabel(host,"lblEmp",0,40,100,20);$.lblEmp.setText("담당자");$.lblStatus=new FingerLabel(host,"lblStatus",300,40,100,20);$.lblStatus.setText("승인상태");$.lblAppEmp=new FingerLabel(host,"lblAppEmp",600,40,100,20);$.lblAppEmp.setText("승인자");$.lblLabel1=new FingerLabel(host,"lblLabel1",845,90,100,20);$.lblLabel1.setText("영수증 내역서");$.txtCPDocNo=new FingerEdit(host,"txtCPDocNo",105,10,140,20);$.dteStartDate=new FingerDateEdit(host,"dteStartDate",405,10,140,20);$.dteReportDate=new FingerDateEdit(host,"dteReportDate",705,10,140,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",105,40,140,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",405,40,140,20);$.txtAppEmp=new FingerEdit(host,"txtAppEmp",705,40,140,20);$.grdContact=new FingerDataGrid(host,"grdContact",0,0,600,250);$.grdCard=new FingerDataGrid(host,"grdCard",0,0,600,205);$.imgPicture1=new FingerImage(host,"imgPicture1",615,120,280,170);$.imgPicture2=new FingerImage(host,"imgPicture2",905,120,280,170);$.imgPicture3=new FingerImage(host,"imgPicture3",615,300,280,170);$.imgPicture4=new FingerImage(host,"imgPicture4",905,300,280,170);$.memDesc=new FingerMemoEdit(host,"memDesc",615,505,565,115);$.lblDesc=new FingerLabel(host,"lblDesc",605,480,70,20);$.lblDesc.setText("진행내용");$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnReject=new FingerButton(host,"btnReject",125,5,120,40);$.btnReject.setText("반려");$.btnCPConfirm=new FingerButton(host,"btnCPConfirm",125,60,120,40);$.btnCPConfirm.setText("CP승인요청");$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",255,5,930,90);$.grdEsero=new FingerDataGrid(host,"grdEsero",0,0,600,205);$.btnAppReq=new FingerButton(host,"btnAppReq",825,-40,140,30);$.btnAppReq.setText("소, 팀장 승인요청");$.panInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panContact.addButtons(["btnDelete","btnAdd"]);$.panCard.addButtons(["btnDelete","btnAdd"]);$.grdContact.setColumns([new FingerDataGridColumn("seq",60,"left","int","순번",{readonly:true}),new FingerDataGridColumn("company_id",99,"left","string","소속기관아이디",{hidden:true}),new FingerDataGridColumn("company_name",150,"left","string","소속기관/병원",{readonly:true}),new FingerDataGridColumn("speciality_code",99,"left","string","진료과목코드",{hidden:true}),new FingerDataGridColumn("speciality",150,"left","string","부서/진료과목",{readonly:true}),new FingerDataGridColumn("contact_id",99,"left","string","고객아이디",{hidden:true}),new FingerDataGridColumn("contact_name",100,"left","string","고객명",{readonly:true}),new FingerDataGridColumn("support_amt",120,"right","string","지원금액",{format:"int"})]);$.grdContact.init();$.grdContact.setEditable(true);$.grdContact.setBorder(false);$.grdCard.setColumns([new FingerDataGridColumn("APPRNO",99,"left","string","승인번호",{hidden:true}),new FingerDataGridColumn("APPDAT",110,"left","string","승인시간"),new FingerDataGridColumn("CARDNO",130,"left","string","카드정보"),new FingerDataGridColumn("EMPNO",80,"left","string","소유자",{readonly:true}),new FingerDataGridColumn("APPAMT",90,"right","string","승인금액",{format:"int"}),new FingerDataGridColumn("VENKNM",120,"left","checkBox","가맹점"),new FingerDataGridColumn("VENADD",150,"left","checkBox","가맹점 주소"),new FingerDataGridColumn("VENGRP",100,"left","checkBox","업태")]);$.grdCard.init({scroll:"xy"});$.grdCard.setBorder(false);$.grdEsero.setColumns([new FingerDataGridColumn("appdat",120,"left","string","발행일자"),new FingerDataGridColumn("bizname",99,"left","string","상호",{hidden:true}),new FingerDataGridColumn("appamt",120,"right","string","공급가액",{format:"int"}),new FingerDataGridColumn("product",99,"left","string","품목",{hidden:true}),new FingerDataGridColumn("product1",99,"left","string","품목1",{hidden:true}),new FingerDataGridColumn("apprno",99,"left","string","승인번호",{hidden:true})]);$.grdEsero.init({scroll:"xy"});$.grdEsero.setBorder(false);$.grdEsero.setVisible(false);$.dteStartDate.setAllowBlank(false,"진행일시");$.dteReportDate.setAllowBlank(false,"보고일자");$.cmbEmp.setAllowBlank(false,"담당자");$.memDesc.setAllowBlank(false,"진행내용");$.dteReportDate.setValue(getToday(""));$.btnAppReq.setVisible(false);$.txtCPDocNo.setReadOnly(true);$.dteStartDate.setEnable(false);$.dteReportDate.setEnable(false);$.cmbEmp.setEnable(false);$.cmbStatus.setEnable(false);$.txtAppEmp.setReadOnly(true);$.panInfo.disableButton(["btnDelete"]);$.varDeptCode=g_main.session.obj.DeptCode;$.imgGroup=new FingerImageGroup([$.imgPicture1,$.imgPicture2,$.imgPicture3,$.imgPicture4],"CPImages");$.imgPicture1.setMode("N");$.imgPicture2.setMode("N");$.imgPicture3.setMode("N");$.imgPicture4.setMode("N");$.imgPicture1.setZooming(true);$.imgPicture2.setZooming(true);$.imgPicture3.setZooming(true);$.imgPicture4.setZooming(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panInfo);$.panMain.add($.panBottom);$.panInfo.add($.panContact);$.panInfo.add($.panCard);$.panInfo.add($.lblCPDocNo);$.panInfo.add($.lblStartDate);$.panInfo.add($.lblReportDate);$.panInfo.add($.lblEmp);$.panInfo.add($.lblStatus);$.panInfo.add($.lblAppEmp);$.panInfo.add($.lblLabel1);$.panInfo.add($.txtCPDocNo);$.panInfo.add($.dteStartDate);$.panInfo.add($.dteReportDate);$.panInfo.add($.cmbEmp);$.panInfo.add($.cmbStatus);$.panInfo.add($.txtAppEmp);$.panInfo.add($.imgPicture1);$.panInfo.add($.imgPicture2);$.panInfo.add($.imgPicture3);$.panInfo.add($.imgPicture4);$.panInfo.add($.memDesc);$.panInfo.add($.lblDesc);$.panInfo.add($.btnAppReq);$.panContact.add($.grdContact);$.panCard.add($.grdCard);$.panCard.add($.grdEsero);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnReject);$.panBottom.add($.btnCPConfirm);$.panBottom.add($.memCPDescr);relocateChildIndexInPanel([$.panInfo]);$.cmbEmp.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbEmp.setColumn("employee_id","emp_name");var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0111");setComboBind([$.cmbEmp,$.cmbStatus],ds);var ds2=bizComponentData2($,"Q1","L_CRM0219");$.grdCard.setColumnDropDownList("EMPNO",ds2.resultList[0],{key:"employee_id",name:"emp_name"});$.cmbEmp.setValue(g_main.session.obj.UserID);$.cmbStatus.setValue("10");$.panBottom.setVisible(false);if($.p_argument){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnReject.setVisible(false);$.btnCPConfirm.setVisible(false);var rs=$.p_argument[0][0];$.varCPId=rs.cp_id;$.varWFDocId=rs.wf_doc_id;$.varCPCode=rs.cp_code;$.varDeptCode=rs.cp_dept_code;$.varAppEmp=rs.approval_id;$.txtCPDocNo.setValue(rs.cp_id);$.dteStartDate.setValue(rs.cp_start_date);$.dteReportDate.setValue(rs.report_date);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbStatus.setValue(rs.cp_status);$.txtAppEmp.setValue(rs.approval_name);$.memDesc.setValue(rs.cp_desc);$.memCPDescr.setValue(rs.cp_descr);setDataGrid([$.grdContact],$.p_argument[1],true);setDataGrid([$.grdCard],$.p_argument[2],true);if(rs.save_yn=="Y"){setEnable(true);$.panInfo.enableButton(["btnSave","btnDelete"])}else{setEnable(false);$.panInfo.disableButton(["btnSave","btnDelete"])}if(rs.pic1_url){$.varPic1Url=rs.pic1_url;$.imgPicture1.setValue(getServerFileUrl("CPImages/"+rs.pic1_url))}if(rs.pic2_url){$.varPic2Url=rs.pic2_url;$.imgPicture2.setValue(getServerFileUrl("CPImages/"+rs.pic2_url))}if(rs.pic3_url){$.varPic3Url=rs.pic3_url;$.imgPicture3.setValue(getServerFileUrl("CPImages/"+rs.pic3_url))}if(rs.pic4_url){$.varPic4Url=rs.pic4_url;$.imgPicture4.setValue(getServerFileUrl("CPImages/"+rs.pic4_url))}if($.cmbStatus.getValue()=="05"){if(g_main.session.obj.DutyCode!="09"&&$.cmbEmp.getValue()!=g_main.session.obj.EmpCode){$.btnConfirm.setVisible(true);$.btnCPConfirm.setVisible(true)}}else{if($.cmbStatus.getValue()=="10"){if(g_main.session.obj.DeptCode==g_main.session.obj.CPDeptCode){$.btnConfirm.setVisible(true);$.btnReject.setVisible(true)}}else{if($.cmbStatus.getValue()=="90"){if(g_main.session.obj.DutyCode!="09"&&$.varAppEmp!=g_main.session.obj.UserID){if($.varWFDocId==""){$.btnCancel.setVisible(true)}}if(g_main.session.obj.UserID=="ka041184"){if($.varWFDocId==""){$.btnCancel.setVisible(true)}}if(g_main.session.obj.UserID==$.cmbEmp.getValue()&&$.varWFDocId==""&&$.varCPId!=""){$.btnAppReq.setVisible(true)}}}}}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnAppReq"){confirmBoxShow("해당 디테일링건에 대해 승인요청 하시겠습니까?",function(){if(g_main.msgShare==true){saveExtraFunction("ApprReq")}})}else{if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memCPDescr.getValue(),approval_id:g_main.session.obj.UserID};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCPConfirm"){var share={save_mode:"CPCONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnReject"){var share={save_mode:"REJECT",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){$.panInfo.clear();$.grdContact.setData("");$.grdCard.setData("");$.grdEsero.setData("");$.cmbEmp.setValue(g_main.session.obj.UserID);$.cmbStatus.setValue("10");$.dteReportDate.setValue(getToday(""))}else{if(btnId=="btnSave"){if(!validateControls([$.memDesc])){return}if(!$.imgPicture1.getValue()&&!$.imgPicture2.getValue()&&!$.imgPicture3.getValue()&&!$.imgPicture4.getValue()){MessageBoxShow("최소한 하나의 영수증 사진이<br>등록되어야 합니다.");return}if(!chkExpense()){MessageBoxShow("영수증 합계 금액과 지원금액의 총합이 일치하지 않습니다.");return}if(!akrMember()){MessageBoxShow("적어도 한명 이상의 자사 직원이 등록되어야 합니다.");return}if($.varBillType=="Card"){var aRow=$.grdCard.getAllRows();if(aRow.length>1){for(var i in aRow){for(var j in aRow){j++;if(aRow[i].APPDAT.substr(0,8)!=aRow[j].APPDAT.substr(0,8)){MessageBoxShow("법인카드의 승인일자는 동일해야합니다.");return}}}}}saveExternalAct($.varCPId==""?"N":"U");if(g_main.session.obj.UserID==$.cmbEmp.getValue()&&$.varWFDocId==""&&$.varCPId!=""){$.btnAppReq.setVisible(true)}}else{if(btnId=="btnDelete"){if($.varCPId==""){return}confirmBoxShow("["+$.txtCPDocNo.getValue()+"] 대외활동(CP)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveExternalAct("D")}})}}}}else{if(panelId=="panContact"){if(btnId=="btnAdd"){$.popUpCallId="contact_btnAdd";var param={contact_name:"",check_yn:"Y"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){$.grdContact.deleteCurrentRow();var contRow=$.grdContact.getAllRows();for(var i in contRow){contRow[i].seq=Number(i)+1}$.grdContact.selectRow(0)}}}else{if(panelId=="panCard"){if(btnId=="btnAdd"){$.popUpCallId="card_btnAdd";var param={};g_main.openPopup("popCardApprovalSub.html","popCardApprovalSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){if($.varBillType=="Card"){$.grdCard.deleteCurrentRow()}else{$.grdEsero.deleteCurrentRow()}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="contact_btnAdd"){var popRows=popResult.popRows;if($.grdContact.getRowCount()>0){var aRow=$.grdContact.getAllRows();for(var i in aRow){for(var j in popRows){if(aRow[i].contact_id==popRows[j].contact_id){MessageBoxShow("이미 추가된 참석자가 있습니다.");return}}}}for(var i in popRows){$.grdContact.addRow({seq:$.grdContact.getRowCount()>0?$.grdContact.getValue($.grdContact.getRowCount()-1,"seq")+1:1,contact_id:popRows[i].contact_id,contact_name:popRows[i].contact_name,company_id:popRows[i].company_id,company_name:popRows[i].company_name,speciality:popRows[i].speciality,support_amt:0})}}}else{if(id=="popCPBefore"){if($.popUpCallId=="btnLoad"){var rs=popResult.rs;$.varCPBeforeId=rs.cp_id;$.varCPDeptCode=rs.cp_dept_code;$.cmbTeamLeader.setValue(rs.team_leader);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbPM.setValue(rs.cp_emp_pm);$.cmbGift.setValue(rs.gift_buy);$.cmbProduct.setValue(rs.product_code);$.dteStart.setValue(rs.cp_start_date);$.dteEnd.setValue(rs.cp_end_date);$.cmbTheme.setValue(rs.report_theme);$.chkStayModify.setValue(rs.area_modify_yn);$.chkDateModify.setValue(rs.date_modify_yn);$.rdoLect.setValue(rs.lect_yn);$.rdoAcademy.setValue(rs.academy_yn);$.speSupportTotal.setValue(rs.support_total);$.memPlace.setValue(rs.cp_place);$.dteReportDate.setValue(rs.report_date);if($.varCPBeforeId!=""){searchContact()}}}else{if(id=="popCardApprovalSub"){if($.popUpCallId=="card_btnAdd"){var rs=popResult;if($.varBillType=="Card"){for(var i in rs){$.grdCard.addRow({APPRNO:rs[i].APPRNO,APPDAT:rs[i].APPDAT,APPAMT:rs[i].APPAMT,VENKNM:rs[i].VENKNM,CARDNO:rs[i].CARDNO,VENADD:rs[i].VENADD,VENGRP:rs[i].VENGRP,EMPNO:rs[i].EMPNUM})}$.dteStartDate.setValue("20"+$.grdCard.getValue(0,"APPDAT").substr(0,2)+$.grdCard.getValue(0,"APPDAT").substr(3,2)+$.grdCard.getValue(0,"APPDAT").substr(6,2))}else{if($.varBillType=="Esero"){for(var i in rs){$.grdEsero.addRow({apprno:rs[i].APPRNO,appdat:rs[i].APPDAT,appamt:rs[i].APPAMT,bizname:rs[i].BIZNAME,product:rs[i].PRODUCT,product1:rs[i].PRODUCT1})}$.dteStartDate.setValue($.grdEsero.getValue(0,"appdat"))}}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>