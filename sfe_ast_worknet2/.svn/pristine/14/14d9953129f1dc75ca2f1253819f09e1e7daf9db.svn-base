<script>function Main(){var $=this;$.host=null;$.panTop=null;$.panList=null;$.panMain=null;$.grdList=null;$.lblPeriod=null;$.dtdStartDate=null;$.dtdEndDate=null;$.lblTilde3=null;$.btnSearch=null;$.lblCardCodeList=null;$.cboCardCodeList=null;$.panMiddle=null;$.lblSecurity=null;$.lblBond=null;$.lblLoan=null;$.lblShipmentSum=null;$.lblRemainLoan=null;$.btnApprove=null;$.btnReject=null;$.panList2=null;$.grdList2=null;$.speLoan=null;$.speSecurity=null;$.speBond=null;$.speShipmentSum=null;$.speRemainLoan=null;$.txtComment=null;$.lblComment=null;$.varType="";function createJson_Q(workType){var json=createExecuteParamInfo("P_sapWebOrderCredit_Q",[workType,1,100,$.dtdStartDate.getValue()||"",$.dtdEndDate.getValue()||"","0"]);return json}function createJson_Q1(workType){var json=createExecuteParamInfo("P_sapWebOrderCredit_Q1",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"CardCd"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"InsertDt"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"Status")]);return json}function createJson_S(workType){var json="";var rows=[];for(var i=0;i<$.grdList2.getRowCount();i++){rows.push([workType,$.grdList2.getValue(i,"DocNum"),$.txtComment.getValue(),"#UserID#"])}json=createExecuteParamInfo("P_sapWebOrderCredit_S",rows);return json}function searchOrderList(workType){var json=createJson_Q(workType);callQuery(["req",json],workType,$)}function searchOrderDetailList(workType){var json=createJson_Q1(workType);callQuery(["req",json],workType,$)}function UpdateOrderStatus(workType){var json=createJson_S(workType);callQuery(["req",json],workType,$)}$.init=function(host,args){$.panTop=new FingerPanel(host,"panTop",0,0,1200,60);$.panTop.setText("");$.panTop.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,60,1200,300);$.panList.setText("주문집계");$.panList.setBottomLine(true);$.panMain=new FingerPanel(host,"panMain",0,0,1200,1100);$.panMain.setText("");$.panMain.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,250);$.lblPeriod=new FingerLabel(host,"lblPeriod",10,20,50,20);$.lblPeriod.setText("기간");$.dtdStartDate=new FingerDateEdit(host,"dtdStartDate",70,20,120,20);$.dtdEndDate=new FingerDateEdit(host,"dtdEndDate",210,20,120,20);$.lblTilde3=new FingerLabel(host,"lblTilde3",190,20,20,20);$.lblTilde3.setText("~");$.btnSearch=new FingerButton(host,"btnSearch",1060,10,100,40);$.btnSearch.setText("조회");$.lblCardCodeList=new FingerLabel(host,"lblCardCodeList",400,20,100,20);$.lblCardCodeList.setText("도매상 목록");$.cboCardCodeList=new FingerComboBox(host,"cboCardCodeList",510,20,160,20);$.panMiddle=new FingerPanel(host,"panMiddle",0,365,1200,85);$.panMiddle.setText("");$.panMiddle.setBottomLine(true);$.lblSecurity=new FingerLabel(host,"lblSecurity",10,20,50,20);$.lblSecurity.setText("담보");$.lblBond=new FingerLabel(host,"lblBond",200,20,70,20);$.lblBond.setText("채권");$.lblLoan=new FingerLabel(host,"lblLoan",425,20,70,20);$.lblLoan.setText("여신");$.lblShipmentSum=new FingerLabel(host,"lblShipmentSum",650,20,70,20);$.lblShipmentSum.setText("출하합계");$.lblRemainLoan=new FingerLabel(host,"lblRemainLoan",875,20,110,20);$.lblRemainLoan.setText("여신-출하합계");$.btnApprove=new FingerButton(host,"btnApprove",940,50,120,20);$.btnApprove.setText("여신승인");$.btnReject=new FingerButton(host,"btnReject",1050,50,100,20);$.btnReject.setText("보류");$.panList2=new FingerPanel(host,"panList2",0,455,1200,400);$.panList2.setText("주문 상세내역");$.panList2.setBottomLine(true);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,350);$.speLoan=new FingerSpinEdit(host,"speLoan",500,20,140,20);$.speSecurity=new FingerSpinEdit(host,"speSecurity",70,20,140,20);$.speBond=new FingerSpinEdit(host,"speBond",280,20,140,20);$.speShipmentSum=new FingerSpinEdit(host,"speShipmentSum",730,20,140,20);$.speRemainLoan=new FingerSpinEdit(host,"speRemainLoan",990,20,140,20);$.txtComment=new FingerEdit(host,"txtComment",70,50,570,20);$.lblComment=new FingerLabel(host,"lblComment",10,50,50,20);$.lblComment.setText("메모");$.panTop.setBorder(true);$.panMiddle.setBorder(true);var today=getToday("");var firstDate=today.substr(0,6)+"01";$.dtdStartDate.setValue(firstDate);$.dtdEndDate.setValue(today);$.speSecurity.setReadOnly(true);$.speLoan.setReadOnly(true);$.speBond.setReadOnly(true);$.speShipmentSum.setReadOnly(true);$.speRemainLoan.setReadOnly(true);$.grdList.setColumns([new FingerDataGridColumn("Count",80,"center","string","집계건수",{readonly:true}),new FingerDataGridColumn("CardNm",200,"left","string","거래처",{readonly:true}),new FingerDataGridColumn("CardCd",100,"center","string","거래처코드",{readonly:true,hidden:true}),new FingerDataGridColumn("Quantity",130,"right","int","전체 주문수량",{format:"int",readonly:true}),new FingerDataGridColumn("Price",130,"right","int","주문금액",{format:"int",readonly:true}),new FingerDataGridColumn("InsertDt",110,"center","date","등록일",{readonly:true}),new FingerDataGridColumn("Status",100,"center","string","상태",{readonly:true,hidden:true}),new FingerDataGridColumn("ApproveYN",100,"center","string","주문상태",{readonly:true}),new FingerDataGridColumn("Approve1Dt",150,"center","date","여신승인일",{readonly:true}),new FingerDataGridColumn("Approver1",100,"center","string","여신승인자",{readonly:true})]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setEditable(false);$.grdList.setBorder(false);$.grdList2.setColumns([new FingerDataGridColumn("DocNum",80,"left","string","주문번호",{readonly:true,rowSpan:true,verticalMiddle:true}),new FingerDataGridColumn("ShipNm",160,"left","string","납품처",{readonly:true,rowSpan:true,verticalMiddle:true}),new FingerDataGridColumn("ItemName",100,"center","string","제품명",{readonly:true}),new FingerDataGridColumn("ItemUnit",100,"center","string","규격",{readonly:true}),new FingerDataGridColumn("Price",80,"center","int","단가",{format:"int",readonly:true}),new FingerDataGridColumn("Quantity",80,"center","int","주문수량",{format:"int",readonly:true}),new FingerDataGridColumn("PreDCrate",80,"right","string","사전할인율",{readonly:true}),new FingerDataGridColumn("TotalPrice",110,"right","int","금액",{format:"int",readonly:true}),new FingerDataGridColumn("OutQuantity",80,"right","int","출하수량",{format:"int",readonly:true}),new FingerDataGridColumn("OutPrice",110,"right","int","금액",{format:"int",readonly:true}),new FingerDataGridColumn("SumInOne",100,"right","int","당월누계",{format:"int",readonly:true}),new FingerDataGridColumn("SumInThree",100,"right","int","3개월 평균",{format:"int",readonly:true}),new FingerDataGridColumn("Reason",100,"center","string","사유",{readonly:true,hidden:true})]);$.grdList2.init({panel:$.panList2,scroll:"xy"});$.grdList2.setEditable(false);$.grdList2.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panTop.add($.lblPeriod);$.panTop.add($.dtdStartDate);$.panTop.add($.dtdEndDate);$.panTop.add($.lblTilde3);$.panTop.add($.lblCardCodeList);$.panTop.add($.cboCardCodeList);$.panTop.add($.btnSearch);$.panList.add($.grdList);$.panMain.add($.panList);$.panMain.add($.panTop);$.panMain.add($.panMiddle);$.panMain.add($.panList2);$.panMiddle.add($.lblSecurity);$.panMiddle.add($.lblBond);$.panMiddle.add($.lblLoan);$.panMiddle.add($.lblShipmentSum);$.panMiddle.add($.lblRemainLoan);$.panMiddle.add($.btnApprove);$.panMiddle.add($.btnReject);$.panMiddle.add($.speLoan);$.panMiddle.add($.speSecurity);$.panMiddle.add($.speBond);$.panMiddle.add($.speShipmentSum);$.panMiddle.add($.speRemainLoan);$.panMiddle.add($.txtComment);$.panMiddle.add($.lblComment);$.panList2.add($.grdList2);var ds1=bizComponentData2($,"Q1","L_CRM0219");$.grdList.setColumnDropDownList("Approver1",ds1.resultList[0],{key:"employee_id",name:"emp_name"})};$.callback=function(type,ds){if(type=="Q"){convertJavaDateToJs(ds.resultList,"yyyymmddhhmmss");setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}else{if(type=="Q1"){setDataGrid([$.grdList2],ds);$.grdList2.selectRow(0);$.speSecurity.setValue(ds.resultList[1][0].Credit);$.speBond.setValue(ds.resultList[1][0].Balance);$.speLoan.setValue(ds.resultList[1][0].Limit);$.speShipmentSum.setValue($.grdList.getValue($.grdList.getSelectedRowIdx(),"Price"));$.speRemainLoan.setValue(ds.resultList[1][0].Limit-$.grdList.getValue($.grdList.getSelectedRowIdx(),"Price"));$.txtComment.setValue($.grdList2.getValue($.grdList2.getSelectedRowIdx(),"Reason"))}else{if(type=="U"||type=="U1"){searchOrderList("Q")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchOrderList("Q")}else{if(id=="btnApprove"){confirmBoxShow("여신승인 처리 하시겠습니까?",function(){if(g_main.msgShare==true){UpdateOrderStatus("U")}else{return}})}else{if(id=="btnReject"){confirmBoxShow("해당 주문에 대해 보류처리 하시겠습니까?",function(){if(g_main.msgShare==true){UpdateOrderStatus("U1")}else{return}})}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){searchOrderDetailList("Q1")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>