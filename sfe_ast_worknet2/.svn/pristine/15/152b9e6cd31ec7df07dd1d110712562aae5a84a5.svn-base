<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.panFile=null;$.grdFile=null;$.lbl1=null;$.lbl2=null;$.lbl3=null;$.lbl4=null;$.lbl5=null;$.lbl6=null;$.lbl7=null;$.lbl8=null;$.lbl9=null;$.lbl10=null;$.lbl11=null;$.lbl12=null;$.lbl13=null;$.lbl14=null;$.lbl15=null;$.lbl16=null;$.cmbEmp=null;$.cmbStatus=null;$.txtCpDocNo=null;$.dteStart=null;$.dteEnd=null;$.meRePur=null;$.txtReSub=null;$.meReCont=null;$.meRePlan=null;$.txtAgen=null;$.dteApp=null;$.meChoice=null;$.txtcp_id=null;$.txtbefore_cp_id=null;$.panBottom=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.memcp_descr=null;$.txtDays=null;$.txtResponse=null;$.txtEachGive=null;$.txtTotEx=null;$.txtTotBud=null;$.btnViewBfCP=null;$.bConfirm=false;$.bSave=false;$.varBfcpcode="";function saveList(workType){if(!validateControls([$.meRePur,$.meRePlan,$.meChoice,$.meReCont,$.dteStart,$.dteEnd,$.txtReSub,$.txtAgen])){return false}if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()==""){MessageBoxShow("첨부서류 유형 5가지 모두 필수 항목입니다.");return}else{var check1="";var check2="";var check3="";var check4="";var check5="";for(var i=0;i<=$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="009"){check1="009"}if($.grdFile.getValue(i,"file_type")=="010"){check2="010"}if($.grdFile.getValue(i,"file_type")=="011"){check3="011"}if($.grdFile.getValue(i,"file_type")=="012"){check4="012"}if($.grdFile.getValue(i,"file_type")=="013"){check5="013"}if(check1=="009"&&check2=="010"&&check3=="011"&&check4=="012"&&check5=="013"){break}}if(check1!="009"||check2!="010"||check3!="011"||check4!="012"||check5!="013"){MessageBoxShow("첨부서류 유형 5가지 모두 필수 항목입니다.");return}}}var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if($.grdFile.getSelectedRowIdx()!=-1){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}var bResult=false;var json=createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname);var ds=callExecuteSync(["req",json],workType,$,false);if(ds!=null){if(workType=="N"){if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txtcp_id.setValue(id[0]);$.txtCpDocNo.setValue(id[1])}}}}if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"){bResult=true}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.");bResult=true;newClick()}else{if(ds.errorCode=="P_crmCPMaster_S_001"){MessageBoxShow("승인요청일 상태만 수정,삭제가 가능합니다.")}else{MessageBoxShow(ds.errorCode)}}}}return bResult}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.varBfcpcode]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.txtbefore_cp_id.getValue()])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.txtbefore_cp_id.getValue(),"#UserID#"])}return json}function createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname){var json=createExecuteParamInfo("P_crmCPResearch_S",[workType,$.txtcp_id.getValue()||"",$.txtCpDocNo.getValue()||"",$.cmbEmp.getValue(),g_main.session.obj.DeptCode,"","","","",$.dteStart.getValue(),$.dteEnd.getValue(),$.txtDays.getValue(),Number($.txtResponse.getValue()),Number($.txtEachGive.getValue()),Number($.txtTotEx.getValue()),$.txtReSub.getValue(),$.meReCont.getValue(),$.meChoice.getValue(),$.meRePlan.getValue(),Number($.txtTotBud.getValue()),$.txtAgen.getValue(),$.dteApp.getValue(),$.txtbefore_cp_id.getValue()||"","CP27",$.meRePur.getValue(),g_main.session.obj.EmpCode,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname]);return json}function deleteClick(){if(!$.txtcp_id.getValue()){MessageBoxShow("사전 데이터가 없습니다");return}confirmBoxShow("["+$.txtCpDocNo.getValue()+"] 시장조사(사후)정보를 삭제 하시겠습니까?",function(){if(g_main.msgShare==true){if(saveList("D")){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}})}function newClick(){$.panList.clear();$.grdFile.clear();$.panList.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panBottom.setVisible(false);fnEnableSet(true);$.cmbEmp.setValue(g_main.session.obj.EmpCode);$.cmbStatus.setValue("10");$.dteApp.setValue(getToday(""));$.dteApp.setReadOnly(false)}function fnEnableSet(bo){$.grdFile.setEditable(bo);$.dteStart.setReadOnly(!bo);$.dteEnd.setReadOnly(!bo);$.txtDays.setReadOnly(!bo);$.txtResponse.setReadOnly(!bo);$.txtEachGive.setReadOnly(!bo);$.txtTotEx.setReadOnly(!bo);$.txtReSub.setReadOnly(!bo);$.meReCont.setReadOnly(!bo);$.meRePlan.setReadOnly(!bo);$.txtTotBud.setReadOnly(!bo);$.txtAgen.setReadOnly(!bo);$.dteApp.setReadOnly(!bo);$.meChoice.setReadOnly(!bo);$.meRePur.setReadOnly(!bo)}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,775);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,1200,430);$.panList.setText("시장조사(사후)");$.panList.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,440,1200,210);$.panFile.setText("첨부자료");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,165);$.lbl1=new FingerLabel(host,"lbl1",0,10,100,20);$.lbl1.setText("문서번호");$.lbl2=new FingerLabel(host,"lbl2",0,40,100,20);$.lbl2.setText("조사기간");$.lbl3=new FingerLabel(host,"lbl3",0,100,100,20);$.lbl3.setText("조사목적");$.lbl4=new FingerLabel(host,"lbl4",0,160,100,20);$.lbl4.setText("시장조사 주제");$.lbl5=new FingerLabel(host,"lbl5",0,220,100,20);$.lbl5.setText("시장조사 내용");$.lbl6=new FingerLabel(host,"lbl6",15,300,85,20);$.lbl6.setText("시장조사결과 활용방안");$.lbl7=new FingerLabel(host,"lbl7",250,40,20,20);$.lbl7.setText("~");$.lbl8=new FingerLabel(host,"lbl8",380,10,100,20);$.lbl8.setText("담당자");$.lbl9=new FingerLabel(host,"lbl9",475,40,40,20);$.lbl9.setText("일간");$.lbl10=new FingerLabel(host,"lbl10",695,70,100,20);$.lbl10.setText("응답자수");$.lbl11=new FingerLabel(host,"lbl11",695,100,100,20);$.lbl11.setText("1인 답례비");$.lbl12=new FingerLabel(host,"lbl12",695,130,100,20);$.lbl12.setText("총비용");$.lbl13=new FingerLabel(host,"lbl13",695,160,100,20);$.lbl13.setText("대행사");$.lbl14=new FingerLabel(host,"lbl14",685,215,110,20);$.lbl14.setText("대행사 선정사유");$.lbl15=new FingerLabel(host,"lbl15",670,280,125,20);$.lbl15.setText("대행사 진행 총예산");$.lbl16=new FingerLabel(host,"lbl16",695,340,100,20);$.lbl16.setText("승인요청일");$.cmbEmp=new FingerComboBox(host,"cmbEmp",485,10,140,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",1030,15,140,20);$.txtCpDocNo=new FingerEdit(host,"txtCpDocNo",105,10,140,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,40,140,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",275,40,140,20);$.meRePur=new FingerMemoEdit(host,"meRePur",105,70,515,80);$.txtReSub=new FingerEdit(host,"txtReSub",105,160,520,20);$.meReCont=new FingerMemoEdit(host,"meReCont",105,190,515,80);$.meRePlan=new FingerMemoEdit(host,"meRePlan",105,280,515,80);$.txtAgen=new FingerEdit(host,"txtAgen",800,160,370,20);$.dteApp=new FingerDateEdit(host,"dteApp",800,340,140,20);$.meChoice=new FingerMemoEdit(host,"meChoice",800,190,365,80);$.txtcp_id=new FingerEdit(host,"txtcp_id",105,10,140,20);$.txtbefore_cp_id=new FingerEdit(host,"txtbefore_cp_id",485,-37.5,140,20);$.panBottom=new FingerPanel(host,"panBottom",0,665,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",1105,5,105,95);$.btnMemoSave.setText("메모저장");$.memcp_descr=new FingerMemoEdit(host,"memcp_descr",135,670,950,90);$.txtDays=new FingerSpinEdit(host,"txtDays",420,40,50,20);$.txtResponse=new FingerSpinEdit(host,"txtResponse",800,70,140,20);$.txtEachGive=new FingerSpinEdit(host,"txtEachGive",800,100,140,20);$.txtTotEx=new FingerSpinEdit(host,"txtTotEx",800,130,140,20);$.txtTotBud=new FingerSpinEdit(host,"txtTotBud",800,280,140,20);$.btnViewBfCP=new FingerButton(host,"btnViewBfCP",800,10,130,50);$.btnViewBfCP.setText("사전CP보기");$.panList.addButtons(["btnLoad","btnDelete","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.txtcp_id.setReadOnly(true);$.txtCpDocNo.setVisible(false);$.txtbefore_cp_id.setVisible(false);$.cmbEmp.setEnable(false);$.cmbStatus.setEnable(false);$.cmbEmp.setAllowBlank(false,"담당자");$.cmbStatus.setAllowBlank(false,"상태");$.dteStart.setAllowBlank(false,"시작일");$.dteEnd.setAllowBlank(false,"종료일");$.txtDays.setAllowBlank(false,"기간");$.meRePur.setAllowBlank(false,"조사목적");$.txtReSub.setAllowBlank(false,"시장조사주제");$.meReCont.setAllowBlank(false,"시장조사내용");$.meRePlan.setAllowBlank(false,"시장조사 활용방안");$.txtResponse.setAllowBlank(false,"응답자 수");$.txtEachGive.setAllowBlank(false,"1인 답례비");$.txtAgen.setAllowBlank(false,"대행사");$.meChoice.setAllowBlank(false,"대행사 선정사유");$.txtTotBud.setAllowBlank(false,"대행사 진행 총예산");$.dteApp.setAllowBlank(false,"승인요청일");$.grdFile.setColumns([new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.memcp_descr);$.panList.add($.lbl1);$.panList.add($.lbl2);$.panList.add($.lbl3);$.panList.add($.lbl4);$.panList.add($.lbl5);$.panList.add($.lbl6);$.panList.add($.lbl7);$.panList.add($.lbl8);$.panList.add($.lbl9);$.panList.add($.lbl10);$.panList.add($.lbl11);$.panList.add($.lbl12);$.panList.add($.lbl13);$.panList.add($.lbl14);$.panList.add($.lbl15);$.panList.add($.lbl16);$.panList.add($.cmbStatus);$.panList.add($.cmbEmp);$.panList.add($.txtCpDocNo);$.panList.add($.dteStart);$.panList.add($.dteEnd);$.panList.add($.meRePur);$.panList.add($.txtReSub);$.panList.add($.meReCont);$.panList.add($.meRePlan);$.panList.add($.txtAgen);$.panList.add($.dteApp);$.panList.add($.meChoice);$.panList.add($.txtcp_id);$.panList.add($.txtbefore_cp_id);$.panList.add($.txtDays);$.panList.add($.txtResponse);$.panList.add($.txtEachGive);$.panList.add($.txtTotEx);$.panList.add($.txtTotBud);$.panList.add($.btnViewBfCP);$.panFile.add($.grdFile);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0111");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbStatus.setColumn("sub_code","code_name");setComboBind([$.cmbEmp,$.cmbStatus],ds);$.cmbEmp.setValue(g_main.session.obj.EmpCode);$.cmbStatus.setValue("10");var subQuery=" AND extra_field1 LIKE '%CP27%'";var ds1=bizComponentData2($,"Q4","L_CRM0110",subQuery);$.grdFile.setColumnDropDownList("file_type",ds1.resultList[0],null,true);if($.p_argument){$.cmbStatus.setValue($.p_argument[0][0].cp_status);$.memcp_descr.setValue($.p_argument[0][0].cp_descr);$.bConfirm=$.p_argument[0][0].Confirm;if(!$.bConfirm){$.panBottom.setVisible(false)}else{$.panBottom.setVisible(true)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.txtcp_id.setValue($.p_argument[0][0].cp_id);$.cmbEmp.setValue($.p_argument[0][0].cp_emp_id);$.cmbStatus.setValue($.p_argument[0][0].cp_status);$.txtCpDocNo.setValue($.p_argument[0][0].cp_doc_no);$.dteStart.setValue($.p_argument[0][0].research_start_date);$.dteEnd.setValue($.p_argument[0][0].research_end_date);$.txtDays.setValue($.p_argument[0][0].research_days);$.meRePur.setValue($.p_argument[0][0].research_purpose);$.txtReSub.setValue($.p_argument[0][0].research_subject);$.meReCont.setValue($.p_argument[0][0].research_content);$.meRePlan.setValue($.p_argument[0][0].research_use_plan);$.txtResponse.setValue($.p_argument[0][0].respondent_cnt);$.txtEachGive.setValue($.p_argument[0][0].each_give_amt);$.txtTotEx.setValue($.p_argument[0][0].tot_expense_amt);$.txtAgen.setValue($.p_argument[0][0].agency);$.txtTotBud.setValue($.p_argument[0][0].tot_progress_budget_amt);$.dteApp.setValue($.p_argument[0][0].app_date.trim());$.meChoice.setValue($.p_argument[0][0].agency_choice_cause);$.txtbefore_cp_id.setValue($.p_argument[0][0].before_cp_id);if($.p_argument[1].length>0){setDataGrid([$.grdFile],$.p_argument[1],true)}if($.cmbStatus.getValue()=="10"){$.btnConfirm.setEnable(true);if(!$.bSave){$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"]);$.btnCancel.setEnable(false)}}else{if($.cmbStatus.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}}}else{newClick();$.panBottom.setVisible(false);$.memcp_descr.setVisible(false)}};$.callback=function(type,ds){if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="BUCall";param[0][0].Confirm=false;param[0][0].cp_descr=param.cp_desc;param[0][0].cp_status="90";param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnViewBfCP"){if($.txtbefore_cp_id.getValue()!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.txtbefore_cp_id.getValue()+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";$.varBfcpcode=ds.resultList[0][0].cp_type;searchCPInfo("FORM")}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStart"||id=="dteEnd"){if($.dteStart.getValue()==null||$.dteEnd.getValue()==null){return}if($.dteStart.getValue()>$.dteEnd.getValue()){MessageBoxShow("조사 종료일이 조사 시작일이 보다 빠를수 없습니다.");$.dteEnd.setValue($.dteStart.getValue());$.txtDays.setValue("1");return}var endDay=$.dteEnd.getValue();var tsDays=getCalcDate(endDay,1);var diff=tsDays-$.dteStart.getValue();var stDate=new Date($.dteStart.getValue().substr(0,4),($.dteStart.getValue().substr(4,2)-1),$.dteStart.getValue().substr(6,2));var endDate=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=endDate.getTime()-stDate.getTime();var btDay=btMs/(1000*60*60*24);$.txtDays.setValue(btDay)}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="txtResponse"||id=="txtEachGive"){if($.txtResponse.getValue()==null||$.txtEachGive.getValue()==null){return}$.txtTotEx.setValue($.txtResponse.getValue()*$.txtEachGive.getValue())}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnSave"){if($.txtbefore_cp_id.getValue()==""){MessageBoxShow("사전 데이터가 없습니다.");return}var workType=$.txtcp_id.getValue()==""?"N":"U";if(saveList(workType)){$.dteApp.setReadOnly(true)}}else{if(btnId=="btnNew"){newClick()}else{if(btnId=="btnDelete"){deleteClick()}else{if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={};g_main.openPopup("popCPResearch.html","popCPResearch","시장조사(팝업)",900,640,"","",param,"","")}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList);for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}}}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPResearch"){if($.popUpCallId=="btnLoad"){$.txtbefore_cp_id.setValue(popResult[0][0].cp_id);$.dteStart.setValue(popResult[0][0].research_start_date);$.dteEnd.setValue(popResult[0][0].research_end_date);$.meRePur.setValue(popResult[0][0].research_purpose);$.txtReSub.setValue(popResult[0][0].research_subject);$.meReCont.setValue(popResult[0][0].research_content);$.meRePlan.setValue(popResult[0][0].research_use_plan);$.txtAgen.setValue(popResult[0][0].agency);$.dteApp.setValue(popResult[0][0].app_date);$.meChoice.setValue(popResult[0][0].agency_choice_cause);$.txtDays.setValue(popResult[0][0].research_days);$.txtResponse.setValue(popResult[0][0].respondent_cnt);$.txtEachGive.setValue(popResult[0][0].each_give_amt);$.txtTotEx.setValue(popResult[0][0].tot_expense_amt);$.txtTotBud.setValue(popResult[0][0].tot_progress_budget_amt);setDataGrid([$.grdFile],popResult[1],true)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>