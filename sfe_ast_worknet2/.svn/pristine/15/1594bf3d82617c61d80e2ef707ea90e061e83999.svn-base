<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.lblDept=null;$.lblEmp=null;$.lblType=null;$.lblProduct=null;$.lblProductName=null;$.lblProductQty=null;$.lblImage=null;$.lblDescr=null;$.lblLabel1=null;$.txtDept=null;$.txtEmp=null;$.rdoType=null;$.cmbProduct=null;$.txtProductName=null;$.speProductQty=null;$.img1=null;$.img2=null;$.img3=null;$.memDescr=null;$.htmlMemo=null;$.grdFile=null;$.grdDoc=null;$.lblSympDate=null;$.lblBidAttendee=null;$.txtBidAttendee=null;$.lblBudgetAmt=null;$.speBudgetAmt=null;$.lblBidReqYN=null;$.rdoBidReqYN=null;$.lblTargetDept=null;$.txtTargetDept=null;$.lblTargetAttendee=null;$.speTargetAttendee=null;$.lblDay1Schedule=null;$.lblDay2Schedule=null;$.memoDay1Schedule=null;$.memoDay2Schedule=null;$.lblSympType=null;$.lblSympPlace=null;$.txtSympPlace=null;$.lblPlaceDevidedYN=null;$.rdoPlaceDevidedYN=null;$.lblTakePhotoYN=null;$.rdoTakePhotoYN=null;$.comSympType=null;$.lblAttendeeNum=null;$.dteSympStartDate=null;$.dteSympEndDate=null;$.lblWave=null;$.lblPlaceSet=null;$.txtPlaceSet=null;$.varWFDocId="";$.varBusinessId="";$.varWFType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFPromoItemReq"]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmWFPromoItemReq_S_B64",[workType,$.varWfDocId,1,$.cmbProduct.getValue(),$.txtProductName.getValue()||0,$.speProductQty.getValue()||0,0,$.img1.getValue()!=""?$.img1.getUploadParam().image_base64:"",$.img2.getValue()!=""?$.img2.getUploadParam().image_base64:"",$.img3.getValue()!=""?$.img3.getUploadParam().image_base64:"",$.memDescr.getValue(),g_main.session.obj.DeptCode,g_main.session.obj.UserID,$.rdoType.getValue(),$.dteSympStartDate.getValue(),$.dteSympEndDate.getValue(),$.txtBidAttendee.getValue(),$.rdoBidReqYN.getValue(),$.speBudgetAmt.getValue(),$.txtTargetDept.getValue(),$.speTargetAttendee.getValue(),$.comSympType.getValue(),$.txtSympPlace.getValue(),$.txtPlaceSet.getValue(),$.rdoTakePhotoYN.getValue(),$.rdoPlaceDevidedYN.getValue(),$.memoDay1Schedule.getValue(),$.memoDay2Schedule.getValue()]);return json}function searchWFDocument(){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function savePromoItem(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"N",$);if(ds){return true}}return false}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}function SetItemVisible(bo){$.lblSympDate.setVisible(bo);$.lblWave.setVisible(bo);$.dteSympStartDate.setVisible(bo);$.dteSympStartDate.setAllowBlank(!bo);$.dteSympEndDate.setVisible(bo);$.dteSympEndDate.setAllowBlank(!bo);$.lblBidAttendee.setVisible(bo);$.txtBidAttendee.setVisible(bo);$.txtBidAttendee.setAllowBlank(!bo);$.lblBudgetAmt.setVisible(bo);$.speBudgetAmt.setVisible(bo);$.speBudgetAmt.setAllowBlank(!bo);$.lblBidReqYN.setVisible(bo);$.rdoBidReqYN.setVisible(bo);$.rdoBidReqYN.setAllowBlank(!bo);$.lblTargetDept.setVisible(bo);$.txtTargetDept.setVisible(bo);$.txtTargetDept.setAllowBlank(!bo);$.lblTargetAttendee.setVisible(bo);$.speTargetAttendee.setVisible(bo);$.speTargetAttendee.setAllowBlank(!bo);$.lblAttendeeNum.setVisible(bo);$.lblDay1Schedule.setVisible(bo);$.memoDay1Schedule.setVisible(bo);$.memoDay1Schedule.setAllowBlank(!bo);$.lblDay2Schedule.setVisible(bo);$.memoDay2Schedule.setVisible(bo);$.memoDay2Schedule.setAllowBlank(!bo);$.lblSympPlace.setVisible(bo);$.txtSympPlace.setVisible(bo);$.txtSympPlace.setAllowBlank(!bo);$.lblPlaceDevidedYN.setVisible(bo);$.rdoPlaceDevidedYN.setVisible(bo);$.rdoPlaceDevidedYN.setAllowBlank(!bo);$.lblTakePhotoYN.setVisible(bo);$.rdoTakePhotoYN.setVisible(bo);$.rdoTakePhotoYN.setAllowBlank(!bo);$.lblSympType.setVisible(bo);$.comSympType.setVisible(bo);$.comSympType.setAllowBlank(!bo);$.lblPlaceSet.setVisible(bo);$.txtPlaceSet.setVisible(bo);$.txtPlaceSet.setAllowBlank(!bo)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1260);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine();$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,510);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,585,1200,375);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,975,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,975,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,300);$.lblDept=new FingerLabel(host,"lblDept",0,10,100,20);$.lblDept.setText("소속부서");$.lblEmp=new FingerLabel(host,"lblEmp",375,10,100,20);$.lblEmp.setText("신청자");$.lblType=new FingerLabel(host,"lblType",0,60,100,20);$.lblType.setText("신청구분");$.lblProduct=new FingerLabel(host,"lblProduct",0,110,100,20);$.lblProduct.setText("판촉품목");$.lblProductName=new FingerLabel(host,"lblProductName",0,140,100,20);$.lblProductName.setText("판촉물 품명");$.lblProductQty=new FingerLabel(host,"lblProductQty",330,140,70,20);$.lblProductQty.setText("수량");$.lblImage=new FingerLabel(host,"lblImage",0,220,100,20);$.lblImage.setText("판촉물 이미지");$.lblDescr=new FingerLabel(host,"lblDescr",0,350,100,20);$.lblDescr.setText("설명");$.lblLabel1=new FingerLabel(host,"lblLabel1",485,140,20,20);$.lblLabel1.setText("개");$.txtDept=new FingerEdit(host,"txtDept",105,10,245,20);$.txtEmp=new FingerEdit(host,"txtEmp",480,10,125,20);$.rdoType=new FingerRadioBox(host,"rdoType",105,45,430,50);$.cmbProduct=new FingerComboBox(host,"cmbProduct",105,110,150,20);$.txtProductName=new FingerEdit(host,"txtProductName",105,140,245,20);$.speProductQty=new FingerSpinEdit(host,"speProductQty",405,140,80,20);$.img1=new FingerImage(host,"img1",105,170,130,105);$.img2=new FingerImage(host,"img2",243,170,130,105);$.img3=new FingerImage(host,"img3",380,170,130,105);$.memDescr=new FingerMemoEdit(host,"memDescr",105,280,400,160);$.htmlMemo=new FingerHTMLView(host,"htmlMemo",935,5,260,220);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,230);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,230);$.lblSympDate=new FingerLabel(host,"lblSympDate",520,110,100,20);$.lblSympDate.setText("심포지엄 날짜");$.lblBidAttendee=new FingerLabel(host,"lblBidAttendee",520,430,100,20);$.lblBidAttendee.setText("비딩 참석자");$.txtBidAttendee=new FingerEdit(host,"txtBidAttendee",620,430,180,20);$.lblBudgetAmt=new FingerLabel(host,"lblBudgetAmt",520,140,100,20);$.lblBudgetAmt.setText("배정예산");$.speBudgetAmt=new FingerSpinEdit(host,"speBudgetAmt",620,140,140,20);$.lblBidReqYN=new FingerLabel(host,"lblBidReqYN",860,430,110,20);$.lblBidReqYN.setText("비딩 PT요청");$.rdoBidReqYN=new FingerRadioBox(host,"rdoBidReqYN",970,430,140,20);$.lblTargetDept=new FingerLabel(host,"lblTargetDept",520,170,100,20);$.lblTargetDept.setText("대상 과");$.txtTargetDept=new FingerEdit(host,"txtTargetDept",620,170,270,20);$.lblTargetAttendee=new FingerLabel(host,"lblTargetAttendee",900,170,70,20);$.lblTargetAttendee.setText("예상 인원");$.speTargetAttendee=new FingerSpinEdit(host,"speTargetAttendee",970,170,70,20);$.lblDay1Schedule=new FingerLabel(host,"lblDay1Schedule",520,310,100,20);$.lblDay1Schedule.setText("1일차 일정");$.lblDay2Schedule=new FingerLabel(host,"lblDay2Schedule",520,380,100,20);$.lblDay2Schedule.setText("2일차 일정");$.memoDay1Schedule=new FingerMemoEdit(host,"memoDay1Schedule",620,290,440,60);$.memoDay2Schedule=new FingerMemoEdit(host,"memoDay2Schedule",620,360,440,60);$.lblSympType=new FingerLabel(host,"lblSympType",520,80,100,20);$.lblSympType.setText("심포지엄 형태");$.lblSympPlace=new FingerLabel(host,"lblSympPlace",520,200,100,20);$.lblSympPlace.setText("장소");$.txtSympPlace=new FingerEdit(host,"txtSympPlace",620,200,445,20);$.lblPlaceDevidedYN=new FingerLabel(host,"lblPlaceDevidedYN",850,260,115,20);$.lblPlaceDevidedYN.setText("강연장/연회장 분리");$.rdoPlaceDevidedYN=new FingerRadioBox(host,"rdoPlaceDevidedYN",970,260,140,20);$.lblTakePhotoYN=new FingerLabel(host,"lblTakePhotoYN",520,260,100,20);$.lblTakePhotoYN.setText("강연 촬영");$.rdoTakePhotoYN=new FingerRadioBox(host,"rdoTakePhotoYN",620,260,140,20);$.comSympType=new FingerComboBox(host,"comSympType",620,80,180,20);$.lblAttendeeNum=new FingerLabel(host,"lblAttendeeNum",1020,170,40,20);$.lblAttendeeNum.setText("명");$.dteSympStartDate=new FingerDateEdit(host,"dteSympStartDate",620,110,120,20);$.dteSympEndDate=new FingerDateEdit(host,"dteSympEndDate",760,110,120,20);$.lblWave=new FingerLabel(host,"lblWave",740,110,15,20);$.lblWave.setText("~");$.lblPlaceSet=new FingerLabel(host,"lblPlaceSet",520,230,100,20);$.lblPlaceSet.setText("강연장 형태");$.txtPlaceSet=new FingerEdit(host,"txtPlaceSet",620,230,445,20);$.panTitle.setBorder(true);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.txtTitle.setAllowBlank(false,"문서제목");$.txtDept.setAllowBlank(false,"소속부서");$.txtEmp.setAllowBlank(false,"신청자");$.cmbProduct.setAllowBlank(false,"판촉품목");$.txtProductName.setAllowBlank(false,"판촉물 품명");$.speProductQty.setAllowBlank(false,"수량");$.memDescr.setAllowBlank(false,"설명");$.cmbProduct.setEmptyRow(true,"");$.htmlMemo.setVisible(false);$.txtDept.setReadOnly(true);$.txtEmp.setReadOnly(true);$.imgGroup=new FingerImageGroup([$.img1,$.img2,$.img3]);$.img1.setMode("N");$.img2.setMode("N");$.img3.setMode("N");$.img1.setZooming(true);$.img2.setZooming(true);$.img3.setZooming(true);$.rdoType.addButtons([{sub_code:"Promo",code_name:"판촉물"},{sub_code:"Print",code_name:"인쇄물"},{sub_code:"Seminar",code_name:"자사제품설명회"},{sub_code:"Symposium",code_name:"심포지엄"},{sub_code:"IT",code_name:"IT"},{sub_code:"CRO",code_name:"CRO"},{sub_code:"Edu",code_name:"교육,연수"},{sub_code:"Etc",code_name:"기타"}]);$.rdoBidReqYN.addButtons([{sub_code:"Yes",code_name:"예"},{sub_code:"No",code_name:"아니오"}]);$.rdoPlaceDevidedYN.addButtons([{sub_code:"Yes",code_name:"예"},{sub_code:"No",code_name:"아니오"}]);$.rdoTakePhotoYN.addButtons([{sub_code:"Yes",code_name:"예"},{sub_code:"No",code_name:"아니오"}]);$.rdoType.setValue("Promo");SetItemVisible(false);$.rdoBidReqYN.setValue("Yes");$.rdoPlaceDevidedYN.setValue("Yes");$.rdoTakePhotoYN.setValue("Yes");$.txtDept.setValue(g_main.session.obj.DeptName);$.txtEmp.setValue(g_main.session.obj.UserName);$.speProductQty.setValue(0);$.speBudgetAmt.setValue(0);$.speTargetAttendee.setValue(0);$.htmlMemo.setBorder(true);$.htmlMemo.setStyleClass("information");$.htmlMemo.setHTML("<div style='text-align: center;'>< 자사제품설명회 기념?답례품 구입 기준 ></div><br><br>- 5만원 이내 (부가세 포함).<br><br>- 골프용품/식?음료 불가.<br><br>- 합리적 수준의 할인은 인정되나,<br>&nbsp;&nbsp;실제 구입가격이 '적정시장가격'에 비추어<br>&nbsp;&nbsp;합리성을 인정할 수 있어야 함.<br><br>- 시중에 판매되지 않는 제품은 업체에서 구입한<br>&nbsp;&nbsp;가격을 기준으로 하나,<br>&nbsp;&nbsp;해당 금액의 합리성 입증 절차 필요.<br><br>- CP팀장 협의결재.");$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.lblDept);$.panWFMain.add($.lblEmp);$.panWFMain.add($.lblType);$.panWFMain.add($.lblProduct);$.panWFMain.add($.lblProductName);$.panWFMain.add($.lblProductQty);$.panWFMain.add($.lblImage);$.panWFMain.add($.lblDescr);$.panWFMain.add($.lblLabel1);$.panWFMain.add($.txtDept);$.panWFMain.add($.txtEmp);$.panWFMain.add($.rdoType);$.panWFMain.add($.cmbProduct);$.panWFMain.add($.txtProductName);$.panWFMain.add($.speProductQty);$.panWFMain.add($.img1);$.panWFMain.add($.img2);$.panWFMain.add($.img3);$.panWFMain.add($.memDescr);$.panWFMain.add($.htmlMemo);$.panWFMain.add($.speBudgetAmt);$.panWFMain.add($.lblBudgetAmt);$.panWFMain.add($.txtBidAttendee);$.panWFMain.add($.lblBidAttendee);$.panWFMain.add($.lblSympDate);$.panWFMain.add($.lblBidReqYN);$.panWFMain.add($.rdoBidReqYN);$.panWFMain.add($.lblTargetDept);$.panWFMain.add($.txtTargetDept);$.panWFMain.add($.lblTargetAttendee);$.panWFMain.add($.speTargetAttendee);$.panWFMain.add($.lblDay1Schedule);$.panWFMain.add($.lblDay2Schedule);$.panWFMain.add($.memoDay1Schedule);$.panWFMain.add($.memoDay2Schedule);$.panWFMain.add($.lblSympType);$.panWFMain.add($.lblSympPlace);$.panWFMain.add($.txtSympPlace);$.panWFMain.add($.lblPlaceDevidedYN);$.panWFMain.add($.rdoPlaceDevidedYN);$.panWFMain.add($.lblTakePhotoYN);$.panWFMain.add($.rdoTakePhotoYN);$.panWFMain.add($.comSympType);$.panWFMain.add($.lblAttendeeNum);$.panWFMain.add($.dteSympStartDate);$.panWFMain.add($.dteSympEndDate);$.panWFMain.add($.lblWave);$.panWFMain.add($.txtPlaceSet);$.panWFMain.add($.lblPlaceSet);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);var ds=bizComponentData2($,"Q1","L_CRM0224|L_CRM0303");setComboBind([$.cmbProduct,$.comSympType],ds);searchWFDocument()};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue(result.business_title)}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var md=args[6][0];if(md){if(md.item_image1){$.img1.setValue(md.item_image1)}else{if(md.item_image2){$.img2.setValue(md.item_image2)}else{if(md.item_image3){$.img3.setValue(md.item_image3)}}}$.cmbProduct.setValue(md.product_code);$.txtProductName.setValue(md.item_name);$.speProductQty.setValue(md.item_qty);$.memDescr.setValue(md.descr);$.dteSympStartDate.setValue(md.symp_start_date);$.dteSympEndDate.setValue(md.symp_end_date);$.txtBidAttendee.setValue(md.symp_bid_attendee);$.rdoBidReqYN.setValue(md.symp_bid_req_yn);$.speBudgetAmt.setValue(md.symp_budget_amt);$.txtTargetDept.setValue(md.symp_target_dept);$.speTargetAttendee.setValue(md.symp_target_attendee);$.comSympType.setValue(md.symp_type);$.txtSympPlace.setValue(md.symp_place);$.rdoTakePhotoYN.setValue(md.symp_photo_yn);$.rdoPlaceDevidedYN.setValue(md.symp_place_devide_yn);$.memoDay1Schedule.setValue(md.symp_day1_schedule);$.memoDay2Schedule.setValue(md.symp_day2_schedule);$.txtPlaceSet.setValue(md.symp_place_set)}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!validateControls([$.txtTitle,$.txtDept,$.txtEmp,$.cmbProduct,$.txtProductName])){return}if(!$.varWfDocId){saveWFDocument("","N")}if(savePromoItem("N")){var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFPromoItemReq",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{removeWFDocument($.varWfDocId)}}else{if(id=="btnTmpSave"){if(saveWFDocument("","N")){if(savePromoItem("N")){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}else{if(id=="btnDocAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(id=="btnDocDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}else{if(id=="btnFileAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(id=="btnFileDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWFDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){if(savePromoItem("N")){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}else{if(id=="popWFGoAboardSub"){if($.popUpCallId=="bteSubject"){$.varSubWfDocId=popResult.wf_doc_id;$.bteSubject.setValue(popResult.subject)}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){if(id=="rdoType"){if(value=="Promo"){$.lblProduct.setText("판촉 품목");$.lblProductName.setText("판촉물 품명");$.lblImage.setText("판촉물 이미지");SetItemVisible(false);$.htmlMemo.setVisible(false)}else{if(value=="Print"){$.lblProduct.setText("인쇄 품목");$.lblProductName.setText("인쇄물 품명");$.lblImage.setText("인쇄물 이미지");SetItemVisible(false);$.htmlMemo.setVisible(false)}else{if(value=="Seminar"){$.lblProduct.setText("품목");$.lblProductName.setText("품명");$.lblImage.setText("이미지");SetItemVisible(false);$.htmlMemo.setVisible(true)}else{if(value=="Symposium"){$.lblProduct.setText("품목");$.lblProductName.setText("품명");$.lblImage.setText("이미지");SetItemVisible(true);$.htmlMemo.setVisible(false)}else{if(value=="IT"){$.lblProduct.setText("품목");$.lblProductName.setText("품명");$.lblImage.setText("이미지");SetItemVisible(false);$.htmlMemo.setVisible(false)}else{if(value=="CRO"){$.lblProduct.setText("품목");$.lblProductName.setText("품명");$.lblImage.setText("이미지");SetItemVisible(false);$.htmlMemo.setVisible(false)}else{if(value=="Etc"){$.lblProduct.setText("품목");$.lblProductName.setText("품명");$.lblImage.setText("이미지");SetItemVisible(false);$.htmlMemo.setVisible(false)}}}}}}}}};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>