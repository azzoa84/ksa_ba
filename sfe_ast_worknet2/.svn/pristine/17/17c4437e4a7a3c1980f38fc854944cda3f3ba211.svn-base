<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panSearch=null;$.panTree=null;$.panList=null;$.lblName=null;$.txtName=null;$.btnSearch=null;$.treDept=null;$.grdEmp=null;$.btnConfirm=null;$.btnCancel=null;$.chkAll=null;$.chkPay=null;$.varDeptId="";$.varFirstId="";$.varExceptYn="N";$.varSearchAll=false;$.varSearchDeptCode="";$.varEmpGroupCode="#EMP_LIST#";$.varDeptGroupCode="#DEPT_LIST#";function createJSON_Q(workType){var json=createExecuteParamInfo("P_GetComboData",[workType,$.varDeptGroupCode,"","",$.txtName.getText()]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_GetComboData",[workType,$.varEmpGroupCode,"","",$.varDeptId||"","",$.varRetire?$.txtName.getText():""]);return json}function searchDeptTree(){$.varFirstId="";$.varDeptId="";$.varRetire=false;var ds=commCodeData2($,"Q_TREE",$.varDeptGroupCode,$.txtName.getText(),$.varSearchDeptCode);if($.varSearchAll&&!ds.resultList[0].length){$.treDept.clearAll();$.grdEmp.setData("");$.varRetire=true;searchEmpList();return}if(ds&&ds.resultList[0].length==1){$.varFirstId=ds.resultList[0][0].id}if($.varExceptYn=="Y"){ds.resultList[0].push({parent_id:"ROOT",id:"EXCEPT",name:"기타",ico_id:"1",order_seq:9999})}$.treDept.clearAll();$.treDept.load(ds.resultList[0],"id","parent_id","name","ico_id","order_seq");$.grdEmp.setData("")}function searchEmpList(){var json=createJSON_Q2("Q");callQuery(["req",json],"Q",$)}function dataSelect(){var rId=$.grdEmp.getSelectedRowIdx();if(rId==null){return}var share={employee_id:$.grdEmp.getValue(rId,"employee_id")||"",emp_name:$.grdEmp.getValue(rId,"emp_name")||"",position_name:$.grdEmp.getValue(rId,"position_name")||"",dept_code:$.grdEmp.getValue(rId,"dept_code")||"",dept_name:$.grdEmp.getValue(rId,"dept_name")||"",email_address:$.grdEmp.getValue(rId,"email_address")||"",enter_date:unmask($.grdEmp.getValue(rId,"enter_date"))||"",retire_date:unmask($.grdEmp.getValue(rId,"retire_date"))||"",site_code:$.grdEmp.getValue(rId,"site_code")||"",emp_state:$.grdEmp.getValue(rId,"emp_state")||"",DflAccount:$.grdEmp.getValue(rId,"DflAccount")||"",bank_account:$.grdEmp.getValue(rId,"bank_account")||"",account:$.grdEmp.getValue(rId,"account")||"",acct_name:$.grdEmp.getValue(rId,"acct_name")||"",bank:$.grdEmp.getValue(rId,"bankcode")||"",calc_start_date:$.grdEmp.getValue(rId,"calc_start_date")||"",nation_code:$.grdEmp.getValue(rId,"nation_code")||"",bank_depositor:$.grdEmp.getValue(rId,"bank_depositor")||"",bank_name:$.grdEmp.getValue(rId,"bank_name")||"",last_calc_date:$.grdEmp.getValue(rId,"last_calc_date")||"",pension_change_amt:$.grdEmp.getValue(rId,"pension_change_amt")||"",midway_income_tax_amt:$.grdEmp.getValue(rId,"midway_income_tax_amt")||"",midway_local_tax_amt:$.grdEmp.getValue(rId,"midway_local_tax_amt")||"",bank_depositer:$.grdEmp.getValue(rId,"bank_depositer")||""};g_popupStack.setData(share);g_popupStack.close()}function change_checkbox_chkAll(value){if(value=="Y"){$.varEmpGroupCode="#EMP_ALL_LIST#";$.varSearchAll=true;$.chkAll.setVisible(true)}else{$.varEmpGroupCode="#EMP_LIST#";$.varSearchAll=false}}function change_checkbox_chkPay(value){if(value=="Y"){$.varEmpGroupCode="#EMP_Pay_LIST#";$.varSearchAll=true;$.chkPay.setVisible(true)}else{$.varEmpGroupCode="#EMP_LIST#";$.varSearchAll=false}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,750,450);$.panMain.setText("");$.panMain.setBottomLine(true);$.panSearch=new FingerPanel(host,"panSearch",0,0,750,50);$.panSearch.setText("");$.panSearch.setBottomLine(true);$.panTree=new FingerPanel(host,"panTree",0,55,260,350);$.panTree.setText("");$.panTree.setBottomLine(false);$.panList=new FingerPanel(host,"panList",265,55,485,350);$.panList.setText("");$.panList.setBottomLine(false);$.lblName=new FingerLabel(host,"lblName",0,15,80,20);$.lblName.setText("부서/성명");$.txtName=new FingerEdit(host,"txtName",85,15,150,20);$.btnSearch=new FingerButton(host,"btnSearch",670,15,80,20);$.btnSearch.setText("검색");$.treDept=new FingerTree(host,"treDept",0,0,260,350);$.grdEmp=new FingerDataGrid(host,"grdEmp",0,0,485,350);$.btnConfirm=new FingerButton(host,"btnConfirm",610,415,80,20);$.btnConfirm.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",680,415,80,20);$.btnCancel.setText("취소");$.chkAll=new FingerCheckBox(host,"chkAll",245,15,105,20);$.chkAll.setText("퇴직자 포함");$.chkPay=new FingerCheckBox(host,"chkPay",245,15,155,20);$.chkPay.setText("중간/퇴직급여 대상자");$.panSearch.setBorder(true);$.panTree.setBorder(true);$.panList.setBorder(false);$.chkAll.setEnable(false);$.chkPay.setEnable(false);$.chkAll.setVisible(false);$.chkPay.setVisible(false);$.grdEmp.colIdx=$.grdEmp.setColumns([new FingerDataGridColumn("employee_id",90,"left","ro","사번"),new FingerDataGridColumn("emp_name",100,"left","ro","사원명"),new FingerDataGridColumn("dept_name",110,"left","ro","부서명"),new FingerDataGridColumn("position_name",88,"left","ro","직위"),new FingerDataGridColumn("emp_state_name",80,"left","ro","재직구분"),new FingerDataGridColumn("enter_date",90,"left","ro","입사일",{format:"s_ymd",hidden:true}),new FingerDataGridColumn("retire_date",90,"left","ro","퇴사일",{format:"s_ymd",hidden:true}),new FingerDataGridColumn("bankcode",90,"left","ro","은행코드",{hidden:true}),new FingerDataGridColumn("bank_name",90,"left","ro","은행명",{hidden:true}),new FingerDataGridColumn("bank_account",90,"left","ro","계좌번호",{hidden:true}),new FingerDataGridColumn("bank_depositer",90,"left","ro","예금자",{hidden:true}),new FingerDataGridColumn("dept_code",0,"left","ro","부서코드",{hidden:true}),new FingerDataGridColumn("email_address",0,"left","ro","이메일주소",{hidden:true}),new FingerDataGridColumn("site_code",0,"left","ro","사업장코드",{hidden:true}),new FingerDataGridColumn("emp_state",0,"left","ro","사원재직여부",{hidden:true}),new FingerDataGridColumn("DflAccount",0,"left","ro","계좌번호",{hidden:true}),new FingerDataGridColumn("acct_name",0,"left","ro","입금자",{hidden:true}),new FingerDataGridColumn("account",0,"left","ro","계좌번호1",{hidden:true}),new FingerDataGridColumn("nation_code",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("last_calc_date",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("pension_change_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("midway_income_tax_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("midway_local_tax_amt",0,"left","ro","",{hidden:true}),new FingerDataGridColumn("calc_start_date",0,"left","ro","",{hidden:true})]);$.grdEmp.init({scroll:"xy"});$.grdEmp.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panSearch);$.panMain.add($.panTree);$.panMain.add($.panList);$.panMain.add($.btnCancel);$.panMain.add($.btnConfirm);$.panSearch.add($.lblName);$.panSearch.add($.txtName);$.panSearch.add($.btnSearch);$.panSearch.add($.chkAll);$.panSearch.add($.chkPay);$.panTree.add($.treDept);$.panList.add($.grdEmp);if($.p_argument&&$.p_argument!=""){$.txtName.setText($.p_argument.emp_name);if($.p_argument.exceptYn){$.varExceptYn="Y"}if($.p_argument.searchAll){$.chkAll.setValue($.p_argument.searchAll);change_checkbox_chkAll($.p_argument.searchAll)}if($.p_argument.dept_code){$.varSearchDeptCode=$.p_argument.dept_code}if($.p_argument.searchPay){$.grdEmp.setColumnHidden("enter_date",false);$.grdEmp.setColumnHidden("retire_date",false);$.grdEmp.setColumnHidden("bankcode",false);$.grdEmp.setColumnHidden("bank_name",false);$.grdEmp.setColumnHidden("bank_account",false);$.grdEmp.setColumnHidden("bank_depositer",false);$.grdEmp.setColumnHidden("position_name",true);$.chkPay.setValue($.p_argument.searchPay);change_checkbox_chkPay($.p_argument.searchPay)}}searchDeptTree()};$.callback=function(type,ds){if(type=="Q"){if($.varExceptYn=="Y"&&$.varDeptId=="EXCEPT"){ds.resultList[0].push({employee_id:"ka999999",emp_name:"기타",email_address:"",office_tel:"",mobile_phone:"",position_code:"",position_name:"",dept_code:"EXCEPT",dept_name:"기타",enter_date:"",retire_date:"",site_code:"1",emp_state:"",DflAccount:"",bank_account:"",bank:"",account:"",acct_name:""})}setDataGrid([$.grdEmp],ds)}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchDeptTree()}else{if(id=="btnConfirm"){dataSelect()}else{if(id=="btnCancel"){g_popupStack.close()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){if(id=="chkAll"){change_checkbox_chkAll(value)}else{if(id=="chkPay"){change_checkbox_chkPay(value)}}};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){if(id=="grdEmp"){dataSelect()}};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtName"&&value=="13"){searchDeptTree()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){if(id=="treDept"){$.grdEmp.setData("");$.varDeptId=value.id;searchEmpList()}};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){if(id=="treDept"){$.treDept.openNode("ROOT");if($.varFirstId){$.treDept.setFocusNode($.varFirstId)}}};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>