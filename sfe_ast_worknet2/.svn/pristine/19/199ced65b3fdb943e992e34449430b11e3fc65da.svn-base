<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.panFile=null;$.panBottom=null;$.grdFile=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.memcp_descr=null;$.btnReSave=null;$.btnOpenCancel=null;$.chkRe=null;$.panProduct=null;$.grdProduct=null;$.lbl_cp_doc_no=null;$.txt_cp_doc_no=null;$.lbl_emp_id=null;$.cmb_emp=null;$.lbl_emp_pm=null;$.cmb_emp_pm=null;$.lbl_status=null;$.cmb_status=null;$.lbl_product_code=null;$.cmb_product_code=null;$.lbl_app_date=null;$.dte_app_date=null;$.lbl_support_target=null;$.txt_support_target=null;$.lbl_support_amt=null;$.txt_support_amt=null;$.lbl_support_date=null;$.dte_support_date=null;$.lbl_txt=null;$.lbl_txt2=null;$.lbl_cp_purpose=null;$.me_cp_purpose=null;$.txt_cp_id=null;$.txt_cp_code=null;$.txt_wf_doc_id=null;function saveList(workType){if(!validateControls([$.cmb_emp,$.cmb_status,$.cmb_product_code,$.dte_app_date,$.txt_support_target,$.txt_support_amt,$.dte_support_date,$.me_cp_purpose])){return false}if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()==""){MessageBoxShow("요양기관등의 의약품지원요청공문, RINGI 승인서는 필수 첨부파일입니다.");return}else{var check1="";var check2="";for(var i=0;i<=$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="024"){check1="024"}if($.grdFile.getValue(i,"file_type")=="056"){check2="056"}if(check1=="024"&&check2=="056"){break}}if(check1!="024"||check2!="056"){MessageBoxShow("요양기관등의 의약품지원요청공문, RINGI 승인서는 필수 첨부파일입니다.");return}}}var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";var strproduct="";var strproductboxqty="";var strproducteachqty="";var strproductecahamt="";var strproducttotalamt="";if($.grdFile.getSelectedRowIdx()!=-1){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}if($.grdProduct.getSelectedRowIdx()!=-1){for(var j=0;j<$.grdProduct.getRowCount();j++){if(j>0){strproduct+="|";strproductboxqty+="|";strproducteachqty+="|";strproductecahamt+="|";strproducttotalamt+="|"}strproduct+=$.grdProduct.getValue(j,"product");strproductboxqty+=$.grdProduct.getValue(j,"product_amt");strproducteachqty+=$.grdProduct.getValue(j,"product_each");strproductecahamt+=$.grdProduct.getValue(j,"product_price");strproducttotalamt+=$.grdProduct.getValue(j,"product_pricesum")}}var bResult=false;var json=createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname,strproduct,strproductboxqty,strproducteachqty,strproductecahamt,strproducttotalamt);var ds=callExecuteSync(["req",json],workType,$,false);if(ds!=null){if(workType=="N"){if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txt_cp_id.setValue(id[0]);$.txt_cp_doc_no.setValue(id[1])}}}}if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"){bResult=true}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.");bResult=true;newClick()}else{if(ds.errorCode=="P_crmCPMaster_S_001"){MessageBoxShow("승인요청일 상태만 수정,삭제가 가능합니다.")}else{MessageBoxShow(ds.errorCode)}}}}return bResult}function createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname,strproduct,strproductboxqty,strproducteachqty,strproductecahamt,strproducttotalamt){var json=createExecuteParamInfo("P_crmCPSupportApp_S1",[workType,$.txt_cp_id.getValue()||"",$.txt_cp_doc_no.getValue()||"",$.cmb_emp.getValue(),g_main.session.obj.DeptCode,$.cmb_emp_pm.getValue(),$.cmb_product_code.getValue(),$.txt_support_target.getValue(),$.txt_support_amt.getValue(),$.dte_support_date.getValue(),$.me_cp_purpose.getValue(),$.dte_app_date.getValue(),"CP11","",g_main.session.obj.EmpCode,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname,strproduct,strproductboxqty,strproducteachqty,strproductecahamt,strproducttotalamt]);return json}function deleteClick(){if($.txt_cp_doc_no.getValue()==""){MessageBoxShow("사전 데이터가 없습니다.");return}confirmBoxShow("["+$.txt_cp_doc_no.getValue()+"] 자선목적 의약품지원(사전)정보를 삭제 하시겠습니까?",function(){if(g_main.msgShare==true){if(saveList("D")){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}})}function newClick(){$.panList.clear();$.grdFile.clear();$.grdProduct.clear();$.panList.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panProduct.enableButton(["btnDelete","btnAdd"]);$.panBottom.setVisible(false);$.dte_app_date.setValue(getToday(""));$.dte_support_date.setValue(getCalcDate(getToday(""),15));var endDay=$.dte_support_date.getValue();var tsDays=endDay;var diff=tsDays-$.dte_support_date.getValue();var dt1=new Date(getToday("").substr(0,4),(getToday("").substr(4,2)-1),getToday("").substr(6,2));var dt2=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);$.lbl_txt2.setText("현재 개최일로부터 "+btDay+" 일 전입니다.");$.cmb_emp.setValue(g_main.session.obj.EmpCode);$.cmb_status.setValue("10");$.dte_app_date.setValue(getToday(""));fnEnableSet(true)}function fnEnableSet(bo){$.grdFile.setEditable(bo);$.grdProduct.setEditable(bo);$.cmb_product_code.setEnable(bo);$.cmb_emp_pm.setEnable(bo);$.txt_support_target.setReadOnly(!bo);$.dte_support_date.setReadOnly(!bo);$.me_cp_purpose.setReadOnly(!bo)}function assign(workType){var json=createJson_S1(workType);callQuery(["req",json],workType,$)}function createJson_S1(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txt_cp_id.getValue(),$.chkRe.getValue(),g_main.session.obj.EmpCode]);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,915);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,1200,350);$.panList.setText("자선목적 의약품지원 신청");$.panList.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,585,1200,210);$.panFile.setText("첨부파일");$.panFile.setBottomLine(false);$.panBottom=new FingerPanel(host,"panBottom",0,805,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,165);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",1005,5,90,95);$.btnMemoSave.setText("메모저장");$.memcp_descr=new FingerMemoEdit(host,"memcp_descr",135,810,855,90);$.btnReSave=new FingerButton(host,"btnReSave",1090,5,120,20);$.btnReSave.setText("신고상태저장");$.btnOpenCancel=new FingerButton(host,"btnOpenCancel",1090,75,120,20);$.btnOpenCancel.setText("개최취소");$.chkRe=new FingerCheckBox(host,"chkRe",1090,40,120,20);$.chkRe.setText("협회신고");$.panProduct=new FingerPanel(host,"panProduct",0,365,1200,210);$.panProduct.setText("지원품목");$.panProduct.setBottomLine(true);$.grdProduct=new FingerDataGrid(host,"grdProduct",0,0,1200,165);$.lbl_cp_doc_no=new FingerLabel(host,"lbl_cp_doc_no",0,10,100,20);$.lbl_cp_doc_no.setText("CP번호");$.txt_cp_doc_no=new FingerEdit(host,"txt_cp_doc_no",250,10,30,20);$.lbl_emp_id=new FingerLabel(host,"lbl_emp_id",295,10,100,20);$.lbl_emp_id.setText("담당자");$.cmb_emp=new FingerComboBox(host,"cmb_emp",400,10,140,20);$.lbl_emp_pm=new FingerLabel(host,"lbl_emp_pm",590,10,100,20);$.lbl_emp_pm.setText("PM");$.cmb_emp_pm=new FingerComboBox(host,"cmb_emp_pm",695,10,140,20);$.lbl_status=new FingerLabel(host,"lbl_status",885,10,100,20);$.lbl_status.setText("승인상태");$.cmb_status=new FingerComboBox(host,"cmb_status",990,10,140,20);$.lbl_product_code=new FingerLabel(host,"lbl_product_code",0,40,100,20);$.lbl_product_code.setText("대표품목");$.cmb_product_code=new FingerComboBox(host,"cmb_product_code",105,40,140,20);$.lbl_app_date=new FingerLabel(host,"lbl_app_date",885,40,100,20);$.lbl_app_date.setText("승인요청일");$.dte_app_date=new FingerDateEdit(host,"dte_app_date",990,40,140,20);$.lbl_support_target=new FingerLabel(host,"lbl_support_target",0,70,100,20);$.lbl_support_target.setText("지원대상");$.txt_support_target=new FingerEdit(host,"txt_support_target",105,70,465,20);$.lbl_support_amt=new FingerLabel(host,"lbl_support_amt",0,100,100,20);$.lbl_support_amt.setText("지원금액");$.txt_support_amt=new FingerSpinEdit(host,"txt_support_amt",105,100,140,20);$.lbl_support_date=new FingerLabel(host,"lbl_support_date",0,130,100,20);$.lbl_support_date.setText("지원일");$.dte_support_date=new FingerDateEdit(host,"dte_support_date",105,130,140,20);$.lbl_txt=new FingerLabel(host,"lbl_txt",0,160,410,20);$.lbl_txt.setText("* 의약품 지원 13일전까지 신청서를 제출하여 주시기 바랍니다.");$.lbl_txt2=new FingerLabel(host,"lbl_txt2",5,185,260,20);$.lbl_txt2.setText("                                                                                     ");$.lbl_cp_purpose=new FingerLabel(host,"lbl_cp_purpose",0,235,100,20);$.lbl_cp_purpose.setText("지원목적");$.me_cp_purpose=new FingerMemoEdit(host,"me_cp_purpose",105,210,800,70);$.txt_cp_id=new FingerEdit(host,"txt_cp_id",105,10,140,20);$.txt_cp_code=new FingerEdit(host,"txt_cp_code",0,0,140,20);$.txt_wf_doc_id=new FingerEdit(host,"txt_wf_doc_id",0,0,140,20);$.panList.addButtons(["btnDelete","btnSave","btnNew"]);$.panProduct.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.cmb_product_code.setEmptyRow(true);$.cmb_emp_pm.setEmptyRow(true);$.cmb_product_code.setAllowBlank(false,"대표품목");$.txt_support_target.setAllowBlank(false,"지원대상");$.dte_support_date.setAllowBlank(false,"지 원 일");$.me_cp_purpose.setAllowBlank(false,"지원목적");$.txt_cp_id.setReadOnly(true);$.cmb_emp.setReadOnly(true);$.cmb_status.setReadOnly(true);$.txt_support_amt.setReadOnly(true);$.dte_app_date.setEnable(false);$.txt_cp_doc_no.setVisible(false);$.txt_cp_code.setVisible(false);$.txt_wf_doc_id.setVisible(false);$.grdProduct.setColumns([new FingerDataGridColumn("product",268,"left","string","품목"),new FingerDataGridColumn("product_amt",228,"right","string","지원수량(box)",{format:"int"}),new FingerDataGridColumn("product_each",228,"right","string","지원수량(낱개)",{format:"int"}),new FingerDataGridColumn("product_price",228,"right","string","보험약가",{format:"int"}),new FingerDataGridColumn("product_pricesum",231,"right","string","총지원금액",{format:"int"}),new FingerDataGridColumn("local_fname",440,"left","string","파일명",{hidden:true})]);$.grdProduct.init({panel:$.panProduct,scroll:"xy",isFilter:false,nonExcel:true});$.grdProduct.setEditable(true);$.grdProduct.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_type",300,"left","date","자료유형"),new FingerDataGridColumn("seq",99,"left","string","연번",{hidden:true}),new FingerDataGridColumn("server_path",99,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",99,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",880,"left","string","파일명",{readonly:true,readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({panel:$.panFile,scroll:"xy",isFilter:false,nonExcel:true});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.panProduct);$.panMain.add($.memcp_descr);$.panList.add($.lbl_cp_doc_no);$.panList.add($.txt_cp_doc_no);$.panList.add($.lbl_emp_id);$.panList.add($.cmb_emp);$.panList.add($.lbl_emp_pm);$.panList.add($.cmb_emp_pm);$.panList.add($.lbl_status);$.panList.add($.cmb_status);$.panList.add($.lbl_product_code);$.panList.add($.cmb_product_code);$.panList.add($.lbl_app_date);$.panList.add($.dte_app_date);$.panList.add($.lbl_support_target);$.panList.add($.txt_support_target);$.panList.add($.lbl_support_amt);$.panList.add($.txt_support_amt);$.panList.add($.lbl_support_date);$.panList.add($.dte_support_date);$.panList.add($.lbl_txt);$.panList.add($.lbl_txt2);$.panList.add($.lbl_cp_purpose);$.panList.add($.me_cp_purpose);$.panList.add($.txt_cp_id);$.panList.add($.txt_cp_code);$.panList.add($.txt_wf_doc_id);$.panFile.add($.grdFile);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnReSave);$.panBottom.add($.btnOpenCancel);$.panBottom.add($.chkRe);$.panProduct.add($.grdProduct);var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0111|L_CRM192|L_CRM0131");$.cmb_emp.setColumn("employee_id","emp_name");$.cmb_status.setColumn("sub_code","code_name");$.cmb_emp_pm.setColumn("employee_id","emp_name");$.cmb_product_code.setColumn("product_code","product_name");setComboBind([$.cmb_emp,$.cmb_status,$.cmb_emp_pm,$.cmb_product_code],ds);var subQuery=" AND extra_field1 LIKE '%CP11%'";var ds1=bizComponentData2($,"Q4","L_CRM0110",subQuery);$.grdFile.setColumnDropDownList("file_type",ds1.resultList[0],null,true);var ds2=bizComponentData2($,"Q1","L_CRM0040");$.grdProduct.setColumnDropDownList("product",ds2.resultList[0],{key:"product_code",name:"product_name"});if($.p_argument){$.cmb_status.setValue($.p_argument[0][0].cp_status);$.memcp_descr.setValue($.p_argument[0][0].cp_descr);$.bConfirm=$.p_argument[0][0].Confirm;if(!$.bConfirm){$.panBottom.setVisible(false);$.memcp_descr.setReadOnly(true)}else{$.panBottom.setVisible(true);$.memcp_descr.setReadOnly(false)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.txt_cp_doc_no.setValue($.p_argument[0][0].cp_doc_no);$.cmb_emp.setValue($.p_argument[0][0].cp_emp_id);$.cmb_emp_pm.setValue($.p_argument[0][0].cp_emp_pm);$.cmb_status.setValue($.p_argument[0][0].cp_status);$.cmb_product_code.setValue($.p_argument[0][0].product_code);$.dte_app_date.setValue($.p_argument[0][0].app_date);$.txt_support_target.setValue($.p_argument[0][0].cp_support_target);$.txt_support_amt.setValue($.p_argument[0][0].support_amt);$.dte_support_date.setValue($.p_argument[0][0].cp_support_date);$.me_cp_purpose.setValue($.p_argument[0][0].cp_purpose);$.txt_cp_id.setValue($.p_argument[0][0].cp_id);$.txt_cp_code.setValue($.p_argument[0][0].cp_code);$.txt_wf_doc_id.setValue($.p_argument[0][0].wf_doc_id);if($.p_argument[1].length>0){setDataGrid([$.grdFile],$.p_argument[1],true)}if($.p_argument[2].length>0){setDataGrid([$.grdProduct],$.p_argument[2],true)}if($.cmb_status.getValue()=="10"){$.btnConfirm.setEnable(true);if(!$.bSave){$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}}else{if($.cmb_status.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"]);$.panProduct.disableButton(["btnAdd","btnDelete"])}}}else{newClick();$.panBottom.setVisible(false);$.memcp_descr.setVisible(false)}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnReSave"){assign("REPORT")}else{if(id=="btnOpenCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){assign("CANCEL");g_popupStack.close()}else{return}})}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dte_support_date"){var endDay=$.dte_support_date.getValue();var tsDays=endDay;var diff=tsDays-$.dte_support_date.getValue();var dt1=new Date(getToday("").substr(0,4),(getToday("").substr(4,2)-1),getToday("").substr(6,2));var dt2=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);$.lbl_txt2.setText("현재 개최일로부터 "+btDay+" 일 전입니다.")}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdProduct"){if(cInd=="product_each"||"product_price"){var a=$.grdProduct.getValue(rId,"product_each");var b=$.grdProduct.getValue(rId,"product_price");$.grdProduct.setValue(rId,"product_pricesum",(a*b));var totalAmt=0;for(var i=0;i<$.grdProduct.getRowCount();i++){totalAmt+=$.grdProduct.getValue(i,"product_pricesum")}$.txt_support_amt.setValue(totalAmt)}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panProduct"){if(btnId=="btnAdd"){$.grdProduct.addRow({product:"",product_amt:0,product_each:0,product_price:0,product_pricesum:0},$.grdProduct.getRowCount())}else{if(btnId=="btnDelete"){var rId=$.grdProduct.getSelectedRowIdx();$.grdProduct.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList);for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}}}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}else{if(panelId=="panList"){if(btnId=="btnSave"){var endDay=$.dte_support_date.getValue();var tsDays=getCalcDate(endDay,1);var diff=tsDays-$.dte_support_date.getValue();var dt1=new Date(getToday("").substr(0,4),(getToday("").substr(4,2)-1),getToday("").substr(6,2));var dt2=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);if(btDay<13){MessageBoxShow("지원개시일로부터 13일 이전까지만 신청가능합니다.");return}else{var workType=$.txt_cp_id.getValue()==""?"N":"U";saveList(workType)}}else{if(btnId=="btnDelete"){deleteClick()}else{if(btnId=="btnNew"){newClick()}}}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>