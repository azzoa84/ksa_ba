<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.panList=null;$.lblShipToCd=null;$.bteShipToCd=null;$.grdList=null;$.btnSearch=null;$.panBottom=null;$.grdSalesList=null;$.lblProduct=null;$.bteProduct=null;$.btnWebOrder=null;$.btnNew=null;$.chkDataYN=null;$.lblSoldToCd=null;$.bteSoldToCd=null;$.chkFocusYN=null;$.varFocusYN="%";function searchClick(){if($.chkDataYN.getValue()=="Y"){var json=createJSON_Q("Q1");callQuery(["req",json],"Q1",$)}else{var json=createJSON_Q("Q");callQuery(["req",json],"Q1",$)}}function newClick(){$.panTop.clear()}function searchSales(){var json=createJSON_Q2("Q");callQuery(["req",json],"Q2",$)}function saveData(){confirmBoxShow("내역을 저장하시겠습니까?",function(){if(g_main.msgShare==true){var json=createJson_S("S");callQuery(["req",json],"S",$)}})}function updateWebOrder(){confirmBoxShow("웹수주 가격을 전송하시겠습니까?",function(){if(g_main.msgShare==true){var json=createJSON_Q3("Q");callQuery(["req",json],"Q",$)}})}function createJSON_Q(workType){if(workType=="Q"||workType=="Q1"){var json=createExecuteParamInfo("P_sapMonitoring_Q",[workType,$.bteSoldToCd.getValue()||"",$.bteShipToCd.getValue()||"",$.bteProduct.getValue()||"",$.varFocusYN])}return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("SAP.dbo.P_sapSalesDtl_Q1",[workType,"D4",$.grdList.getValue($.grdList.getSelectedRowIdx(),"cardname"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"soldtonm"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"product_code"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"u_sdt")||"20991231",$.grdList.getValue($.grdList.getSelectedRowIdx(),"u_edt")||"20991231","%"]);return json}function createJSON_Q3(workType){var json=createExecuteParamInfo("SAP.dbo.P_SapWebOrderNewLight",[workType]);return json}function createJson_S(workType){var json="";var rows=[];for(var i=0;i<$.grdList.getRowCount();i++){rows.push([workType,$.grdList.getValue(i,"code"),$.grdList.getValue(i,"cardname"),$.grdList.getValue(i,"soldtonm"),$.grdList.getValue(i,"product_code"),$.grdList.getValue(i,"u_sdt"),$.grdList.getValue(i,"expected_sales1"),$.grdList.getValue(i,"expected_sales2"),$.grdList.getValue(i,"sum_expected_sales"),$.grdList.getValue(i,"descr"),$.grdList.getValue(i,"descr2"),$.grdList.getValue(i,"mid_date"),$.grdList.getValue(i,"mid_rate"),$.grdList.getValue(i,"focus_yn")||"N",$.grdList.getValue(i,"hold_yn")||"N","#UserID#"])}json=createExecuteParamInfo("P_sapMonitoring_S",rows);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,870);$.panMain.setText("");$.panMain.setBottomLine();$.panTop=new FingerPanel(host,"panTop",0,0,1200,50);$.panTop.setText("");$.panTop.setBottomLine();$.panList=new FingerPanel(host,"panList",0,60,1200,400);$.panList.setText("입찰내역");$.panList.setBottomLine(true);$.lblShipToCd=new FingerLabel(host,"lblShipToCd",240,15,50,20);$.lblShipToCd.setText("납품처");$.bteShipToCd=new FingerButtonEdit(host,"bteShipToCd",290,15,190,20);$.bteShipToCd.setText("");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,350);$.btnSearch=new FingerButton(host,"btnSearch",980,15,100,20);$.btnSearch.setText("조회");$.panBottom=new FingerPanel(host,"panBottom",0,465,1200,400);$.panBottom.setText("세부출하내역");$.panBottom.setBottomLine(true);$.grdSalesList=new FingerDataGrid(host,"grdSalesList",0,0,1200,330);$.lblProduct=new FingerLabel(host,"lblProduct",490,15,50,20);$.lblProduct.setText("품목");$.bteProduct=new FingerButtonEdit(host,"bteProduct",540,15,140,20);$.bteProduct.setText("");$.btnWebOrder=new FingerButton(host,"btnWebOrder",1070,15,130,20);$.btnWebOrder.setText("웹수주가격갱신");$.btnNew=new FingerButton(host,"btnNew",890,15,100,20);$.btnNew.setText("신규");$.chkDataYN=new FingerCheckBox(host,"chkDataYN",695,15,100,20);$.chkDataYN.setText("모니터링 여부");$.lblSoldToCd=new FingerLabel(host,"lblSoldToCd",20,15,50,20);$.lblSoldToCd.setText("도매상");$.bteSoldToCd=new FingerButtonEdit(host,"bteSoldToCd",70,15,160,20);$.bteSoldToCd.setText("");$.chkFocusYN=new FingerCheckBox(host,"chkFocusYN",805,15,70,20);$.chkFocusYN.setText("관리대상");$.panTop.setBorder(true);$.panList.addButtons(["btnSave"]);$.grdList.setColumns([new FingerDataGridColumn("code",150,"left","string","가격코드",{hidden:true}),new FingerDataGridColumn("cardname",110,"left","string","도매상명",{readonly:true}),new FingerDataGridColumn("soldtonm",150,"left","string","납품처명",{readonly:true}),new FingerDataGridColumn("product_code",150,"left","string","품목",{readonly:true}),new FingerDataGridColumn("u_dcrt",90,"right","int","도매할인(%)",{readonly:true}),new FingerDataGridColumn("u_cmdcrt",90,"right","int","수금할인(%)",{readonly:true}),new FingerDataGridColumn("u_sdt",90,"center","date","시작일",{format:"ymd"}),new FingerDataGridColumn("u_edt",90,"center","date","종료일",{hidden:true}),new FingerDataGridColumn("expected_sales1",70,"right","int","수량1",{format:"int"}),new FingerDataGridColumn("expected_sales2",70,"right","int","수량2",{format:"int"}),new FingerDataGridColumn("sum_expected_sales",80,"right","int","총 수량",{format:"int",readonly:true}),new FingerDataGridColumn("accumulated_sales",85,"right","int","누적출하량",{format:"int",readonly:true}),new FingerDataGridColumn("progress_rate",85,"right","int","진척율(%)",{readonly:true}),new FingerDataGridColumn("mid_date",90,"center","date","중간일",{format:"ymd"}),new FingerDataGridColumn("mid_rate",70,"right","int","중간진척도",{format:"int"}),new FingerDataGridColumn("focus_yn",60,"center","checkbox","관리",{sort:null}),new FingerDataGridColumn("hold_yn",60,"center","string","Hold"),new FingerDataGridColumn("descr",180,"left","string","비고"),new FingerDataGridColumn("descr2",180,"left","string","비고2"),new FingerDataGridColumn("monitoring_yn",50,"left","string","모니터링  여부",{hidden:true}),new FingerDataGridColumn("update_date",100,"center","string","최종 수정일")]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setEditable(true);$.grdList.setBorder(false);$.grdSalesList.setColumns([new FingerDataGridColumn("DocDate",90,"center","date","세부출하일자",{format:"ymd"}),new FingerDataGridColumn("BatchNum",80,"center","string","Lot번호"),new FingerDataGridColumn("ExpDate",90,"center","date","유효일자",{format:"ymd"}),new FingerDataGridColumn("Quantity",70,"right","int","수량",{format:"int"}),new FingerDataGridColumn("JBPrice",105,"right","int","동경보고단가",{format:"int"}),new FingerDataGridColumn("U_JPrice",105,"right","int","동경보고가",{format:"int"}),new FingerDataGridColumn("U_JVAPrice",120,"right","int","동경보고가(VAT)",{format:"int"}),new FingerDataGridColumn("WBPrice",105,"right","int","도매출하단가",{format:"int"}),new FingerDataGridColumn("Price",105,"right","int","도매출하가",{format:"int"}),new FingerDataGridColumn("U_WVAPrice",120,"right","int","도매출하가(VAT)",{format:"int"}),new FingerDataGridColumn("U_RVAPrice",105,"right","int","실출하가",{format:"int"}),new FingerDataGridColumn("Comments",350,"left","string","비고")]);$.grdSalesList.init({panel:$.panBottom,scroll:"xy"});$.grdSalesList.setEditable(false);$.grdSalesList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panList);$.panMain.add($.panBottom);$.panTop.add($.lblShipToCd);$.panTop.add($.bteShipToCd);$.panTop.add($.btnSearch);$.panTop.add($.lblProduct);$.panTop.add($.bteProduct);$.panTop.add($.btnWebOrder);$.panTop.add($.btnNew);$.panTop.add($.chkDataYN);$.panTop.add($.lblSoldToCd);$.panTop.add($.bteSoldToCd);$.panTop.add($.chkFocusYN);$.panList.add($.grdList);$.panBottom.add($.grdSalesList);var ds=bizComponentData2($,"Q1","L_CRM0203|P_SAP0011|PU_ItemCode");$.grdList.setColumnDropDownList("cardname",ds.resultList[0],{key:"CardCode",name:"CardName"});$.grdList.setColumnDropDownList("soldtonm",ds.resultList[1],{key:"U_ShipToCd",name:"U_ShipToName"});$.grdList.setColumnDropDownList("product_code",ds.resultList[2],{key:"ItemCode",name:"ItemName"});var ds2=bizComponentData2($,"Q2","P_SAP0010");$.grdList.setColumnDropDownList("hold_yn",ds2.resultList[0]);if(g_main.session.getValue("EmpCode")!="ka080065"&&g_main.session.getValue("EmpCode")!="ka100136"&&g_main.session.getValue("EmpCode")!="ka961016"){$.panList.disableButton(["btnSave"])}};$.callback=function(type,ds){if(type=="Q1"){setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}else{if(type=="Q2"){convertJavaDateToJs(ds.resultList,"yyyymmddhhmmss");$.grdSalesList.setData("");setDataGrid([$.grdSalesList],ds);$.grdSalesList.selectRow(0)}else{if(type=="S"){searchClick()}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSearch"){if($.chkDataYN.getValue()=="N"){$.varFocusYN="%";searchClick()}else{if($.chkDataYN.getValue()=="Y"){if($.chkFocusYN.getValue()=="Y"){$.varFocusYN="Y"}else{$.varFocusYN="%"}searchClick()}}}if(id=="btnNew"){newClick()}if(id=="btnWebOrder"){updateWebOrder()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){log("123");$.popUpCallId=id;if(id=="bteShipToCd"){var param={ShipToNm:$.bteShipToCd.getText()};g_main.openPopup("popShipToCd.html","popShipToCd","납품처 리스트",500,525,"","",param,"","")}else{if(id=="bteProduct"){var param={product_name:$.bteProduct.getText(),product_code:""};g_main.openPopup("popProduct.html","popProduct","품목 리스트",500,525,"","",param,"","")}else{if(id=="bteSoldToCd"){var param={SoldToNm:$.bteSoldToCd.getText()};g_main.openPopup("popSoldToCd.html","popSoldToCd","도매상 리스트",500,525,"","",param,"","")}}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){if($.grdList.getValue($.grdList.getSelectedRowIdx(),"monitoring_yn")=="N"){$.grdSalesList.setData("");return}else{searchSales()}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="expected_sales1"||cInd=="expected_sales2"){$.grdList.setValue(rId,"sum_expected_sales",(Number($.grdList.getValue(rId,"expected_sales1"))+Number($.grdList.getValue(rId,"expected_sales2"))))}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnSave"){$.grdList.editStop();saveData()}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popShipToCd"){if($.popUpCallId=="bteShipToCd"){if(popResult.CardCode){$.bteShipToCd.setValue(popResult.CardCode);$.bteShipToCd.setText(popResult.CardName)}}}else{if(id=="popProduct"){if($.popUpCallId=="bteProduct"){if(popResult.product_code){$.bteProduct.setValue(popResult.product_code);$.bteProduct.setText(popResult.product_name)}}}else{if(id=="popSoldToCd"){if($.popUpCallId=="bteSoldToCd"){if(popResult.CardCode){$.bteSoldToCd.setValue(popResult.CardCode);$.bteSoldToCd.setText(popResult.CardName)}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>