<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.panBottom=null;$.btnPreview=null;$.btnPrint=null;$.lbljob_yyyymm_to=null;$.ymdjob_yyyymm_to=null;$.lblWave=null;$.ymdjob_yyyymm_fr=null;$.lblsite_code=null;$.cbosite_code=null;$.lblearner_name=null;$.txtearner_code=null;$.txtearner_name=null;$.txtsocial_no=null;function fnPrint(workType){if($.ymdjob_yyyymm_fr.getValue().substring(0,4)!=$.ymdjob_yyyymm_to.getValue().substring(0,4)){MessageBoxShow("귀속년도를 동일하게 설정해주세요.");return}var ds=fnQRY_P_HRA4400_Q("REPORT");log(ds);if(ds!=null){if(ds.resultList[0].length==0){MessageBoxShow("데이터가 존재하지 않습니다.");return}var title=[{yyyy:$.ymdjob_yyyymm_to.getValue().substring(0,4),site_code:$.cbosite_code.getText(),turm_s:$.ymdjob_yyyymm_fr.getValue().substring(4,6),turm_e:$.ymdjob_yyyymm_to.getValue().substring(4,6),search_time:ds.resultList[0][0].search_date,count:ds.resultList[0].length}];if(workType=="PREVIEW"){if(ds&&ds.errorCode=="MSG0001"){var params={report:"report_HRA4400",isPrint:false};params.data={title:title,Info:ds.resultList[0],Info1:ds.resultList[1]};for(var i=0;i<=10;i++){if(params.data.Info.length<10){params.data.Info.push({})}}g_printBrowser.callPrint(params)}}else{if(workType=="PRINT"){if(ds&&ds.errorCode=="MSG0001"&&ds.resultList.length!=0){var params={report:"report_HRA4400",isPrint:true};params.data={title:title,Info:ds.resultList[0],Info1:ds.resultList[1]};for(var i=0;i<=10;i++){if(params.data.Info.length<10){params.data.Info.push({})}}g_printBrowser.callPrint(params)}}}}}function fnQRY_P_HRA4400_Q(workType){var json=createJSON_Q(workType);var ds=callExecuteSync(["req",json],workType);if(workType=="REPORT"){if(ds!=null){if(!ds.errorCode.substring(0,1)=="P"&&!ds.errorCode.substring(0,1)=="E"&&ds.resultList.length>=2){if(ds.resultList.length==0){MessageBoxShow("데이터가 존재하지 않습니다.");return false}}}}return ds}function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRA4400_Q",[workType,$.ymdjob_yyyymm_fr.getValue(),$.ymdjob_yyyymm_to.getValue(),$.cbosite_code.getValue(),$.txtearner_code.getValue()]);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,700);$.panMain.setText("");$.panMain.setBottomLine();$.panTop=new FingerPanel(host,"panTop",350,240,500,140);$.panTop.setText("");$.panTop.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",350,380,500,55);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.btnPreview=new FingerButton(host,"btnPreview",125,15,100,20);$.btnPreview.setText("미리보기");$.btnPrint=new FingerButton(host,"btnPrint",215,15,100,20);$.btnPrint.setText("출력");$.lbljob_yyyymm_to=new FingerLabel(host,"lbljob_yyyymm_to",40,25,100,20);$.lbljob_yyyymm_to.setText("지급년월");$.ymdjob_yyyymm_to=new FingerDateEdit(host,"ymdjob_yyyymm_to",310,25,140,20);$.lblWave=new FingerLabel(host,"lblWave",285,25,20,20);$.lblWave.setText("~");$.ymdjob_yyyymm_fr=new FingerDateEdit(host,"ymdjob_yyyymm_fr",145,25,140,20);$.lblsite_code=new FingerLabel(host,"lblsite_code",40,55,100,20);$.lblsite_code.setText("사업장");$.cbosite_code=new FingerComboBox(host,"cbosite_code",145,55,310,20);$.lblearner_name=new FingerLabel(host,"lblearner_name",40,90,100,20);$.lblearner_name.setText("소득자");$.txtearner_code=new FingerEdit(host,"txtearner_code",145,90,100,20);$.txtearner_name=new FingerButtonEdit(host,"txtearner_name",250,90,195,20);$.txtearner_name.setText("");$.txtsocial_no=new FingerEdit(host,"txtsocial_no",310,115,140,20);$.panTop.setBorder(true);$.panBottom.setBorder(true);$.panMain.setBorder(true);$.txtsocial_no.setVisible(false);$.btnPreview.setVisible(false);$.ymdjob_yyyymm_to.setDateFormat("yyyymm");$.ymdjob_yyyymm_fr.setDateFormat("yyyymm");$.ymdjob_yyyymm_fr.setValue(getToday(""));$.ymdjob_yyyymm_to.setValue(getToday(""));$.ymdjob_yyyymm_to.setAllowBlank(false,"시작일");$.ymdjob_yyyymm_fr.setAllowBlank(false,"종료일");$.cbosite_code.setAllowBlank(false,"사업장코드");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panBottom);$.panTop.add($.lbljob_yyyymm_to);$.panTop.add($.ymdjob_yyyymm_to);$.panTop.add($.lblWave);$.panTop.add($.ymdjob_yyyymm_fr);$.panTop.add($.lblsite_code);$.panTop.add($.cbosite_code);$.panTop.add($.lblearner_name);$.panTop.add($.txtearner_code);$.panTop.add($.txtearner_name);$.panTop.add($.txtsocial_no);$.panBottom.add($.btnPreview);$.panBottom.add($.btnPrint);$.cbosite_code.setColumn("site_code","site_name");var ds=bizComponentData2($,"Q1","L_ORG001");setComboBind([$.cbosite_code],ds);$.cbosite_code.setValue(g_main.session.obj.SiteCode)};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPreview"){fnPrint("PREVIEW")}else{if(id=="btnPrint"){fnPrint("PRINT")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){if(id=="txtearner_name"){$.popUpCallId=id;var param={earner_code:$.txtearner_code.getValue()||"",earner_name:$.txtearner_name.getValue()||""};g_main.openPopup("popHRA036.html","popHRA036","소득자정보",400,585,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if($.popUpCallId=="txtearner_name"){if(popResult!=null){$.txtearner_code.setValue(popResult.earner_code);$.txtearner_name.setText(popResult.earner_name);$.txtsocial_no.setValue(popResult.social_no)}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>