<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.lblDate=null;$.dteDate=null;$.lblDeptCode=null;$.cmbDeptCode=null;$.lblTeamCode=null;$.cmbTeamCode=null;$.lblProductCode=null;$.cmbProductCode=null;$.btnSearch=null;$.panDetail=null;$.htmlCallKSA=null;$.lblEmployee=null;$.cmbEmployee=null;$.radioId="AMT";$.loadingIdx=0;$.expireDate="";$.selectDate="";$.isDebug=true;function initData(){relocateChildIndexInPanel([$.panTop]);var ds="";var yyyymm=getToday().substr(0,6);if(!$.isDebug){ds=bizComponentData2($,"Q2","L_CRM0122");if(ds&&ds.resultList){ds.resultList[0].unshift({sub_code:"S030",code_name:"SR영업소"})}setComboBind([$.cmbDeptCode],ds);ds=bizComponentData2($,"Q1","L_CRM0202");setComboBind([$.cmbProductCode],ds);$.dteDate.setValue(yyyymm)}else{ds={errorCode:"",returnStr:"",errorMsg:"",resultList:[[{sub_code:"S030",code_name:"SR영업소"},{sub_code:"S400",code_name:"비뇨기1영업부"},{sub_code:"S500",code_name:"비뇨기2영업부"},{sub_code:"S300",code_name:"개업의영업부"},{sub_code:"T300",code_name:"SI영업부"},{sub_code:"T100",code_name:"면역영업부"}]]};setComboBind([$.cmbDeptCode],ds);ds={errorCode:"",returnStr:"",errorMsg:"",resultList:[[{product_code:"P01",product_name:"라우간"},{product_code:"P02",product_name:"올데카"},{product_code:"P04",product_name:"하루날"},{product_code:"P05",product_name:"베라실"},{product_code:"P06",product_name:"페르디핀"},{product_code:"P07",product_name:"나제아주사"},{product_code:"P08",product_name:"나제아OD"},{product_code:"P11",product_name:"프로그랍-TX"},{product_code:"P12",product_name:"프로그랍-AI"},{product_code:"P13",product_name:"프로토픽"},{product_code:"P15",product_name:"마이카민"},{product_code:"P16",product_name:"베시케어"},{product_code:"P17",product_name:"아드바그랍"},{product_code:"P18",product_name:"이리보"},{product_code:"P19",product_name:"라파뮨"},{product_code:"P20",product_name:"엑스탄디"},{product_code:"P21",product_name:"베타미가"},{product_code:"P22",product_name:"슈글렛"}],[{sub_code:"AMT",code_name:"금액"},{sub_code:"QTY",code_name:"수량"}]]};setComboBind([$.cmbProductCode],ds);$.dteDate.setValue(yyyymm)}}function createJson_Q(workType){var json="";if(!$.isDebug){json=createExecuteParamInfo("P_crmDSMCallKSA_Q",[workType,$.dteDate.getValue(),$.cmbDeptCode.getValue()||"",$.cmbTeamCode.getValue()||"",$.cmbEmployee.getValue()||"",$.cmbProductCode.getValue()||"","#UserID#"])}else{json=createExecuteParamInfo("P_crmDSMCallKSA_Q",[workType,"201807","S400","S410","",$.cmbProductCode.getValue()||"","#UserID#"])}return json}function searchInitData(workType){var json=createJson_Q(workType);var ds=callQuerySync(["req",json],workType);if(ds&&ds.errorCode=="MSG0001"){$.dteDate.setValue(ds.resultList[0][0].yyyymm)}}function searchList(workType){var json=createJson_Q(workType);callQueryLoading(["req",json],workType,$)}function callKSASearch(){searchList("Q_KSA");searchList("Q_RECENT")}function closeLoading(){$.loadingIdx++;if($.loadingIdx==2){$.loadingIdx=0;hideToast();var height=$.dsmCallKSA.getHeight()+70;$.htmlCallKSA.setProperty(0,0,1200,height);$.panDetail.setSize(1200,height+65,false);$.panMain.setSize(1200,height+120,true)}}function openNewTab(params,viewId){g_main.openModelWithBusiness(viewId,params,false,false)}function setTreeTableDepth1(obj,common){if(obj.depth1){return common.treetable(obj,common)+obj.p_name1}else{return""}}function setTreeTableDepth2(obj,common){if(obj.depth2){return common.treetable(obj,common)+obj.p_name1}else{if(obj.key_id=="1"){return"합계"}else{if(obj.sort_seq=="10"){return obj.p_name1}else{return""}}}}function setTreeTableDepth3(obj,common){if(obj.depth3){return common.treetable(obj,common)+obj.company_name}else{return""}}function setDataGridMR(data){var dt=[];var dataObj={};var empIndex="",companyIndex="";if(data&&data.length){for(var i=0;i<data.length;i++){var rowData=data[i];empIndex="";companyIndex="";if(!rowData.parent_id){dataObj=rowData;dataObj.depth1=rowData.key_id;dataObj.data=[]}else{if(rowData.parent_id=="ALL"){rowData.depth2=rowData.key_id;if(rowData.key_id){rowData.data=[]}dataObj.data.push(rowData)}else{if(rowData.parent_id.indexOf("ka")>-1){rowData.depth3=rowData.key_id;if(rowData.key_id){rowData.data=[];empIndex=getArrayRowNum(dataObj.data,"key_id",rowData.parent_id);dataObj.data[empIndex].data.push(rowData)}}else{empIndex=getArrayRowNum(dataObj.data,"key_id",rowData.p_parent_id);companyIndex=getArrayRowNum(dataObj.data[empIndex].data,"key_id",rowData.parent_id);rowData.inst_name=rowData.p_name1;dataObj.data[empIndex].data[companyIndex].data.push(rowData)}}}}dt.push(dataObj)}setDataGrid([$.grdMR],dt,true);$.grdMR.openNode("all");for(var i=0;i<$.grdMR.getRowCount();i++){var rowData=$.grdMR.getValue(i);var rowObj=Object.keys(rowData);var colorObj="";if(rowData.$level==1){$.grdMR.addSpan(rowData.id,"depth1",1,1,null,"tree-depth1");$.grdMR.addSpan(rowData.id,"depth2",1,1,null,"tree-depth1");$.grdMR.addSpan(rowData.id,"depth3",1,1,null,"tree-depth1");$.grdMR.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth1");colorObj={background:"#e9cbf5 !important"}}else{if(rowData.$level==2&&rowData.key_id){$.grdMR.addSpan(rowData.id,"depth2",1,1,null,"tree-depth2");$.grdMR.addSpan(rowData.id,"depth3",1,1,null,"tree-depth2");$.grdMR.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth2");colorObj={background:"#cbdff5 !important"}}else{if(rowData.$level==3&&rowData.key_id){$.grdMR.addSpan(rowData.id,"depth3",1,1,null,"tree-depth3");$.grdMR.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth3");colorObj={background:"#d0f5cb !important"}}}}for(var j=0;j<rowObj.length;j++){$.grdMR.setCellStyle(i,rowObj[j],colorObj)}}$.grdMR.selectRow(0);$.grdMR.clearSelect()}function setDataGridCompany(data){var dt=[];var dataObj={};var empIndex="",companyIndex="";if(data&&data.length){for(var i=0;i<data.length;i++){var rowData=data[i];empIndex="";companyIndex="";if(!rowData.parent_id){dataObj=rowData;dataObj.depth1=rowData.key_id;dataObj.data=[]}else{if(rowData.parent_id=="ALL"){rowData.depth2=rowData.key_id;if(rowData.key_id){rowData.data=[]}dataObj.data.push(rowData)}else{rowData.data=[];companyIndex=getArrayRowNum(dataObj.data,"key_id",rowData.parent_id);dataObj.data[companyIndex].data.push(rowData)}}}dt.push(dataObj)}setDataGrid([$.grdCompany],dt,true);$.grdCompany.openNode("all");for(var i=0;i<$.grdCompany.getRowCount();i++){var rowData=$.grdCompany.getValue(i);var rowObj=Object.keys(rowData);var colorObj="";if(rowData.$level==1){$.grdCompany.addSpan(rowData.id,"depth1",1,1,null,"tree-depth1");$.grdCompany.addSpan(rowData.id,"depth2",1,1,null,"tree-depth1");$.grdCompany.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth1");colorObj={background:"#e9cbf5 !important"}}else{if(rowData.$level==2&&rowData.key_id){$.grdCompany.addSpan(rowData.id,"depth2",1,1,null,"tree-depth2");$.grdCompany.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth2");colorObj={background:"#cbdff5 !important"}}}for(var j=0;j<rowObj.length;j++){$.grdCompany.setCellStyle(i,rowObj[j],colorObj)}}$.grdCompany.selectRow(0);$.grdCompany.clearSelect()}function setDataGridProduct(data){var dt=[];var dataObj={};var companyIndex="",productIndex="";if(data&&data.length){for(var i=0;i<data.length;i++){var rowData=data[i];productIndex="";companyIndex="";if(!rowData.parent_id){dataObj=rowData;dataObj.depth1=rowData.key_id;dataObj.data=[]}else{if(rowData.parent_id=="ALL"){rowData.depth2=rowData.key_id;if(rowData.key_id){rowData.data=[]}dataObj.data.push(rowData)}else{if(rowData.parent_id.indexOf("P")>-1&&rowData.parent_id.length==3){rowData.depth3=rowData.key_id;if(rowData.key_id){rowData.data=[];productIndex=getArrayRowNum(dataObj.data,"key_id",rowData.parent_id);dataObj.data[productIndex].data.push(rowData)}}else{productIndex=getArrayRowNum(dataObj.data,"key_id",rowData.p_parent_id);companyIndex=getArrayRowNum(dataObj.data[productIndex].data,"key_id",rowData.parent_id);dataObj.data[productIndex].data[companyIndex].data.push(rowData)}}}}dt.push(dataObj)}setDataGrid([$.grdProduct],dt,true);$.grdProduct.openNode("all");for(var i=0;i<$.grdProduct.getRowCount();i++){var rowData=$.grdProduct.getValue(i);var rowObj=Object.keys(rowData);var colorObj="";if(rowData.$level==1){$.grdProduct.addSpan(rowData.id,"depth1",1,1,null,"tree-depth1");$.grdProduct.addSpan(rowData.id,"depth2",1,1,null,"tree-depth1");$.grdProduct.addSpan(rowData.id,"depth3",1,1,null,"tree-depth1");$.grdProduct.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth1");colorObj={background:"#e9cbf5 !important"}}else{if(rowData.$level==2&&rowData.key_id){$.grdProduct.addSpan(rowData.id,"depth2",1,1,null,"tree-depth2");$.grdProduct.addSpan(rowData.id,"depth3",1,1,null,"tree-depth2");$.grdProduct.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth2");colorObj={background:"#cbdff5 !important"}}else{if(rowData.$level==3&&rowData.key_id){$.grdProduct.addSpan(rowData.id,"depth3",1,1,null,"tree-depth3");$.grdProduct.addSpan(rowData.id,"inst_name",1,1,null,"tree-depth3");colorObj={background:"#d0f5cb !important"}}}}for(var j=0;j<rowObj.length;j++){$.grdProduct.setCellStyle(i,rowObj[j],colorObj)}}$.grdProduct.selectRow(0);$.grdProduct.clearSelect()}function getArrayRowNum(data,column,key){for(var i=0;i<data.length;i++){if(data[i][column]==key){return i}}}function setGridLRChart(obj,common,value,col,colIdx){var perWidth=value||0;var backGorundColor="";var fontColor="";if(col.id=="kcm_cnt"){perWidth=value/($.maxKcmCnt/105);backGorundColor="#4F9BE2";fontColor="#4F9BE2"}else{if(col.id=="non_target_cnt"){perWidth=value/($.maxTargetTotCnt/105);backGorundColor="#f5f2ab";fontColor:"#928d0b"}else{if(col.id=="zero_cnt"){perWidth=value/($.maxExcTotCnt/105);backGorundColor="#f5e3df";fontColor="#c57361"}}}if(!value){log(col.id);log(perWidth)}var str="<div style='width: 150px; height: 26px; padding: 3px 0 3px 0; display: flex;'> 				   <div style='width: "+perWidth+"px; height: 26px; line-height: 25px; background: "+backGorundColor+"; flex: 1;'> 				   </div> 				   <div style='width: "+(140-perWidth)+"px; height: 26px; line-height: 25px; flex: inherit; text-align: left; margin-left: 5px; font-size: 11px; color: "+fontColor+";'>"+value+"</div> 			   </div>";return str}function setGridRLChart(obj,common,value,col,colIdx){var perWidth=value||0;var backGorundColor="";var fontColor="";if(col.id=="target_cnt"){perWidth=value/($.maxTargetTotCnt/105);backGorundColor="#2EC8CA";fontColor="#4F9BE2"}else{if(col.id=="exc_cnt"){perWidth=value/($.maxExcTotCnt/105);backGorundColor="#FFB880";fontColor="#a56736"}}var str="<div style='width: 150px; height: 26px; padding: 3px 0 3px 0; display: flex;'> 				   <div style='width: "+(130-perWidth)+"px; height: 26px; line-height: 25px; flex: inherit; text-align: right; font-size: 11px; color: "+fontColor+";'>"+value+"</div> 				   <div style='width: "+perWidth+"px; height: 26px;  margin-left: 5px; line-height: 25px; background: "+backGorundColor+"; flex: 1;'> 				   </div> 			   </div>";return str}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,2305);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,55);$.panTop.setText("");$.panTop.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",0,15,100,20);$.lblDate.setText("년월");$.dteDate=new FingerDateEdit(host,"dteDate",105,15,115,20);$.lblDeptCode=new FingerLabel(host,"lblDeptCode",195,15,100,20);$.lblDeptCode.setText("부서");$.cmbDeptCode=new FingerComboBox(host,"cmbDeptCode",300,15,140,20);$.lblTeamCode=new FingerLabel(host,"lblTeamCode",425,15,100,20);$.lblTeamCode.setText("영업소");$.cmbTeamCode=new FingerComboBox(host,"cmbTeamCode",530,15,140,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",640,15,100,20);$.lblProductCode.setText("품목");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",745,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panDetail=new FingerPanel(host,"panDetail",0,65,1200,2230);$.panDetail.setText("");$.panDetail.setBottomLine(true);$.htmlCallKSA=new FingerHTMLView(host,"htmlCallKSA",0,0,1200,2225);$.lblEmployee=new FingerLabel(host,"lblEmployee",870,15,100,20);$.lblEmployee.setText("담당자");$.cmbEmployee=new FingerComboBox(host,"cmbEmployee",975,15,120,20);$.panTop.setBorder(true);$.dteDate.setDateFormat("yyyymm");$.cmbDeptCode.setEmptyRow(true);$.cmbTeamCode.setEmptyRow(true);$.cmbEmployee.setEmptyRow(true);$.cmbProductCode.setEmptyRow(true);$.cmbTeamCode.setColumn("dept_code","dept_name");$.cmbProductCode.setColumn("product_code","product_name");$.cmbEmployee.setColumn("employee_id","emp_name");$.dteDate.setAllowBlank(false,"년월");$.cmbDeptCode.setAllowBlank(false,"부서");$.dsmCallKSA=new CustomDSMCallKSA($,$.htmlCallKSA,{onCallLinkClick:function(){}});$.dsmCallKSA.load();$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panDetail);$.panTop.add($.lblDate);$.panTop.add($.dteDate);$.panTop.add($.lblDeptCode);$.panTop.add($.cmbDeptCode);$.panTop.add($.lblTeamCode);$.panTop.add($.cmbTeamCode);$.panTop.add($.lblProductCode);$.panTop.add($.cmbProductCode);$.panTop.add($.btnSearch);$.panTop.add($.lblEmployee);$.panTop.add($.cmbEmployee);$.panDetail.add($.htmlCallKSA);initData()};$.callback=function(type,ds){if(type=="Q_KSA"){$.dsmCallKSA.setTitleLabel($.cmbTeamCode.getValue());if($.cmbTeamCode.getValue()){$.dsmCallKSA.setVisible("teamKSABox","")}else{$.dsmCallKSA.setVisible("teamKSABox","none")}if($.cmbTeamCode.getValue()){$.dsmCallKSA.chart.ksaPieChart(ds.resultList[0],"10","ALL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[1],"20","DETAIL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[2],"30","JASA");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[3],"40","SYMP")}$.dsmCallKSA.chart.ksaPieChart(ds.resultList[4],"50","ALL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[5],"60","DETAIL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[6],"70","JASA");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[7],"80","SYMP");$.dsmCallKSA.chart.mrCallActivityBox(ds.resultList[8]);$.dsmCallKSA.chart.mrCallActivityPieChart(ds.resultList[8],"100","ALL");$.dsmCallKSA.chart.mrCallActivityBatChart(ds.resultList[9],"110");closeLoading()}else{if(type=="Q_RECENT"){$.dsmCallKSA.chart.ksaRecentChart(ds.resultList[0],"90","ALL");closeLoading()}else{if(type=="Q_DETAIL"){closeLoading()}}}};$.update=function(args){if(args){try{var params=args;$.dteDate.setValue(params.yyyymm);$.cmbDeptCode.setValue(params.deptCode||"");$.cmbTeamCode.setValue(params.teamCode||"");if(!$.panTop.validateControls()){return}drawToast("#LOADING#");callKSASearch()}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!$.isDebug){if(!$.panTop.validateControls()){return}$.dsmCallKSA.setTitleLabel($.cmbTeamCode.getValue(),$.cmbEmployee.getValue("emp_name"));drawToast("#LOADING#");callKSASearch()}else{$.dsmCallKSA.setTitleLabel($.cmbTeamCode.getValue(),$.cmbEmployee.getValue("emp_name"));if($.cmbTeamCode.getValue()){$.dsmCallKSA.setVisible("teamKSABox","")}else{$.dsmCallKSA.setVisible("teamKSABox","none")}var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{call_kind:"10",call_kind_name:"정보수집전달",call_cnt:216},{call_kind:"20",call_kind_name:"Detail",call_cnt:117},{call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:20},{call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:29},{call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:9}],[{call_kind:"201",call_kind_name:"구두",call_cnt:76},{call_kind:"202",call_kind_name:"브로셔",call_cnt:38},{call_kind:"203",call_kind_name:"PT",call_cnt:0},{call_kind:"204",call_kind_name:"기타",call_cnt:2}],[{call_kind:"301",call_kind_name:"초청",call_cnt:15},{call_kind:"302",call_kind_name:"참석",call_cnt:0},{call_kind:"303",call_kind_name:"F/U",call_cnt:3}],[{call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:29},{call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:9}],[{call_kind:"10",call_kind_name:"정보수집전달",call_cnt:191},{call_kind:"20",call_kind_name:"Detail",call_cnt:149},{call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:26},{call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:17},{call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:5}],[{call_kind:"201",call_kind_name:"구두",call_cnt:91},{call_kind:"202",call_kind_name:"브로셔",call_cnt:50},{call_kind:"203",call_kind_name:"PT",call_cnt:2},{call_kind:"204",call_kind_name:"기타",call_cnt:5}],[{call_kind:"301",call_kind_name:"초청",call_cnt:16},{call_kind:"302",call_kind_name:"참석",call_cnt:4},{call_kind:"303",call_kind_name:"F/U",call_cnt:5}],[{call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:17},{call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:5}],[{code:"ka031173",name:"정상현",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:1},{code:"ka031173",name:"정상현",call_kind:"20",call_kind_name:"Detail",call_cnt:1},{code:"ka031173",name:"정상현",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:419},{code:"ka080064",name:"전병호",call_kind:"20",call_kind_name:"Detail",call_cnt:41},{code:"ka080064",name:"전병호",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:2},{code:"ka080064",name:"전병호",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:14},{code:"ka080064",name:"전병호",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:7},{code:"ka100130",name:"정진문",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:173},{code:"ka100130",name:"정진문",call_kind:"20",call_kind_name:"Detail",call_cnt:278},{code:"ka100130",name:"정진문",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:40},{code:"ka100130",name:"정진문",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:0},{code:"ka100130",name:"정진문",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:317},{code:"ka130256",name:"이형준",call_kind:"20",call_kind_name:"Detail",call_cnt:2},{code:"ka130256",name:"이형준",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:3},{code:"ka130256",name:"이형준",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka130262",name:"김성탁",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:240},{code:"ka130262",name:"김성탁",call_kind:"20",call_kind_name:"Detail",call_cnt:84},{code:"ka130262",name:"김성탁",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:30},{code:"ka130262",name:"김성탁",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:91},{code:"ka130262",name:"김성탁",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:35},{code:"ka140304",name:"민경남",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:155},{code:"ka140304",name:"민경남",call_kind:"20",call_kind_name:"Detail",call_cnt:257},{code:"ka140304",name:"민경남",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:23},{code:"ka140304",name:"민경남",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:57},{code:"ka140304",name:"민경남",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:7},{code:"ka140320",name:"정호윤",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:212},{code:"ka140320",name:"정호윤",call_kind:"20",call_kind_name:"Detail",call_cnt:159},{code:"ka140320",name:"정호윤",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:47},{code:"ka140320",name:"정호윤",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:41},{code:"ka140320",name:"정호윤",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:15}],[{code:"ka031173",name:"정상현",call_kind:"201",call_kind_name:"구두",call_cnt:1},{code:"ka031173",name:"정상현",call_kind:"202",call_kind_name:"브로셔",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"203",call_kind_name:"PT",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"204",call_kind_name:"기타",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"301",call_kind_name:"초청",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"302",call_kind_name:"참석",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"303",call_kind_name:"F/U",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:0},{code:"ka031173",name:"정상현",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"201",call_kind_name:"구두",call_cnt:21},{code:"ka080064",name:"전병호",call_kind:"202",call_kind_name:"브로셔",call_cnt:20},{code:"ka080064",name:"전병호",call_kind:"203",call_kind_name:"PT",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"204",call_kind_name:"기타",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"301",call_kind_name:"초청",call_cnt:2},{code:"ka080064",name:"전병호",call_kind:"302",call_kind_name:"참석",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"303",call_kind_name:"F/U",call_cnt:0},{code:"ka080064",name:"전병호",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:14},{code:"ka080064",name:"전병호",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:7},{code:"ka100130",name:"정진문",call_kind:"201",call_kind_name:"구두",call_cnt:154},{code:"ka100130",name:"정진문",call_kind:"202",call_kind_name:"브로셔",call_cnt:123},{code:"ka100130",name:"정진문",call_kind:"203",call_kind_name:"PT",call_cnt:1},{code:"ka100130",name:"정진문",call_kind:"204",call_kind_name:"기타",call_cnt:0},{code:"ka100130",name:"정진문",call_kind:"301",call_kind_name:"초청",call_cnt:36},{code:"ka100130",name:"정진문",call_kind:"302",call_kind_name:"참석",call_cnt:0},{code:"ka100130",name:"정진문",call_kind:"303",call_kind_name:"F/U",call_cnt:4},{code:"ka100130",name:"정진문",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:0},{code:"ka100130",name:"정진문",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"201",call_kind_name:"구두",call_cnt:2},{code:"ka130256",name:"이형준",call_kind:"202",call_kind_name:"브로셔",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"203",call_kind_name:"PT",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"204",call_kind_name:"기타",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"301",call_kind_name:"초청",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"302",call_kind_name:"참석",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"303",call_kind_name:"F/U",call_cnt:0},{code:"ka130256",name:"이형준",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:3},{code:"ka130256",name:"이형준",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{code:"ka130262",name:"김성탁",call_kind:"201",call_kind_name:"구두",call_cnt:31},{code:"ka130262",name:"김성탁",call_kind:"202",call_kind_name:"브로셔",call_cnt:36},{code:"ka130262",name:"김성탁",call_kind:"203",call_kind_name:"PT",call_cnt:2},{code:"ka130262",name:"김성탁",call_kind:"204",call_kind_name:"기타",call_cnt:15},{code:"ka130262",name:"김성탁",call_kind:"301",call_kind_name:"초청",call_cnt:19},{code:"ka130262",name:"김성탁",call_kind:"302",call_kind_name:"참석",call_cnt:3},{code:"ka130262",name:"김성탁",call_kind:"303",call_kind_name:"F/U",call_cnt:8},{code:"ka130262",name:"김성탁",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:91},{code:"ka130262",name:"김성탁",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:35},{code:"ka140304",name:"민경남",call_kind:"201",call_kind_name:"구두",call_cnt:193},{code:"ka140304",name:"민경남",call_kind:"202",call_kind_name:"브로셔",call_cnt:61},{code:"ka140304",name:"민경남",call_kind:"203",call_kind_name:"PT",call_cnt:0},{code:"ka140304",name:"민경남",call_kind:"204",call_kind_name:"기타",call_cnt:3},{code:"ka140304",name:"민경남",call_kind:"301",call_kind_name:"초청",call_cnt:19},{code:"ka140304",name:"민경남",call_kind:"302",call_kind_name:"참석",call_cnt:2},{code:"ka140304",name:"민경남",call_kind:"303",call_kind_name:"F/U",call_cnt:2},{code:"ka140304",name:"민경남",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:57},{code:"ka140304",name:"민경남",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:7},{code:"ka140320",name:"정호윤",call_kind:"201",call_kind_name:"구두",call_cnt:130},{code:"ka140320",name:"정호윤",call_kind:"202",call_kind_name:"브로셔",call_cnt:27},{code:"ka140320",name:"정호윤",call_kind:"203",call_kind_name:"PT",call_cnt:0},{code:"ka140320",name:"정호윤",call_kind:"204",call_kind_name:"기타",call_cnt:2},{code:"ka140320",name:"정호윤",call_kind:"301",call_kind_name:"초청",call_cnt:35},{code:"ka140320",name:"정호윤",call_kind:"302",call_kind_name:"참석",call_cnt:1},{code:"ka140320",name:"정호윤",call_kind:"303",call_kind_name:"F/U",call_cnt:11},{code:"ka140320",name:"정호윤",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:41},{code:"ka140320",name:"정호윤",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:15}]]};if($.cmbTeamCode.getValue()){$.dsmCallKSA.chart.ksaPieChart(ds.resultList[0],"10","ALL","");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[1],"20","DETAIL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[2],"30","JASA");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[3],"40","SYMP")}$.dsmCallKSA.chart.ksaPieChart(ds.resultList[4],"50","ALL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[5],"60","DETAIL");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[6],"70","JASA");$.dsmCallKSA.chart.ksaBarChart(ds.resultList[7],"80","SYMP");$.dsmCallKSA.chart.mrCallActivityBox(ds.resultList[8]);$.dsmCallKSA.chart.mrCallActivityPieChart(ds.resultList[8],"100","ALL");$.dsmCallKSA.chart.mrCallActivityBatChart(ds.resultList[9],"110");var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{yyyymm:"201708",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:4},{yyyymm:"201709",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:1},{yyyymm:"201710",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:16},{yyyymm:"201711",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:12},{yyyymm:"201712",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:5},{yyyymm:"201801",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:25},{yyyymm:"201802",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:12},{yyyymm:"201803",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:9},{yyyymm:"201804",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:19},{yyyymm:"201805",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:843},{yyyymm:"201806",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:1957},{yyyymm:"201807",call_kind:"10",call_kind_name:"정보수집전달",call_cnt:1979},{yyyymm:"201708",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201709",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201710",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201711",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201712",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201801",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201802",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201803",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201804",call_kind:"20",call_kind_name:"Detail",call_cnt:0},{yyyymm:"201805",call_kind:"20",call_kind_name:"Detail",call_cnt:632},{yyyymm:"201806",call_kind:"20",call_kind_name:"Detail",call_cnt:1322},{yyyymm:"201807",call_kind:"20",call_kind_name:"Detail",call_cnt:1793},{yyyymm:"201708",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201709",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201710",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201711",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201712",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201801",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201802",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201803",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201804",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:0},{yyyymm:"201805",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:100},{yyyymm:"201806",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:309},{yyyymm:"201807",call_kind:"30",call_kind_name:"자사제품설명회",call_cnt:241},{yyyymm:"201708",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:27},{yyyymm:"201709",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:32},{yyyymm:"201710",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:63},{yyyymm:"201711",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:45},{yyyymm:"201712",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:13},{yyyymm:"201801",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:40},{yyyymm:"201802",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:57},{yyyymm:"201803",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:46},{yyyymm:"201804",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:34},{yyyymm:"201805",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:93},{yyyymm:"201806",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:210},{yyyymm:"201807",call_kind:"40",call_kind_name:"심포지엄(초청)",call_cnt:91},{yyyymm:"201708",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:2},{yyyymm:"201709",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:1},{yyyymm:"201710",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{yyyymm:"201711",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:1},{yyyymm:"201712",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:1},{yyyymm:"201801",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{yyyymm:"201802",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:10},{yyyymm:"201803",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:0},{yyyymm:"201804",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:3},{yyyymm:"201805",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:12},{yyyymm:"201806",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:54},{yyyymm:"201807",call_kind:"50",call_kind_name:"심포지엄(F/U)",call_cnt:80}]]};$.dsmCallKSA.chart.ksaRecentChart(ds.resultList[0],"90","ALL");var height=$.dsmCallKSA.getHeight()+70;$.htmlCallKSA.setProperty(0,0,1200,height);$.panDetail.setSize(1200,height+65,false);$.panMain.setSize(1200,height+120,true)}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDeptCode"){if($.isDebug){return}if(!value){$.cmbTeamCode.clear();return}if(value=="S030"){var ds={resultList:[[{dept_code:"S030",dept_name:"SR영업소"}]]};$.cmbTeamCode.clear();setComboBind([$.cmbTeamCode],ds);$.cmbTeamCode.setValue("S030");return}var strQuery=" and parent_dept_code = '"+value+"'";var ds=bizComponentData2($,"Q4","L_CRM0120",strQuery,"","");$.cmbTeamCode.clear();setComboBind([$.cmbTeamCode],ds)}else{if(id=="cmbTeamCode"){var strQuery=" and dept_code = '"+value+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmployee.clear();setComboBind([$.cmbEmployee],ds)}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panMR"){if(!$.grdMR.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelData=[];$.grdMRExcel.clear();for(var i=0;i<$.excelMRData.length;i++){var rowData=$.excelMRData[i];var dt=rowData;dt.dept_name_excel="";dt.emp_name_excel="";dt.company_name_excel="";dt.product_name_excel=rowData.product_name;if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"&&rowData.key_id){dt.emp_name_excel=rowData.p_name}if(rowData.parent_id.indexOf("ka")>-1&&rowData.key_id){dt.company_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelData.push(dt)}setDataGrid([$.grdMRExcel],excelData,true);$.grdMRExcel.excelDownCustom("최근 6개월 소화실적 추이(MR 기준)")}else{if(panelId=="panCompany"){if(!$.grdCompany.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelCompanyData=[];$.grdCompanyExcel.clear();for(var i=0;i<$.excelCompanyData.length;i++){var rowData=$.excelCompanyData[i];var dt=rowData;dt.dept_name_excel="";dt.company_name_excel="";dt.product_name_excel=rowData.product_name;if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"&&rowData.key_id){dt.company_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelCompanyData.push(dt)}setDataGrid([$.grdCompanyExcel],excelCompanyData,true);$.grdCompanyExcel.excelDownCustom("최근 6개월 소화실적 추이(거래처 기준)")}else{if(panelId=="panProduct"){if(!$.grdProduct.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelProductData=[];$.grdProductExcel.clear();for(var i=0;i<$.excelProductData.length;i++){var rowData=$.excelProductData[i];var dt=rowData;dt.dept_name_excel="";dt.product_name_excel="";dt.company_name_excel=rowData.product_name||"";if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"){dt.product_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelProductData.push(dt)}setDataGrid([$.grdProductExcel],excelProductData,true);$.grdProductExcel.excelDownCustom("최근 6개월 소화실적 추이(품목 기준)")}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>