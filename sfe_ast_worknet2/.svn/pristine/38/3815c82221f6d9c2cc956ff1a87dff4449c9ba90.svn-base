<script>function Main(){var $=this;$.host=null;$.panQuery=null;$.panBudget=null;$.btnSearch=null;$.lblDateQ=null;$.lblDeptNameQ=null;$.panMain=null;$.lblOfficeQ=null;$.lblEmployeeQ=null;$.panCall=null;$.panContact=null;$.panCoding=null;$.panProfit=null;$.gridCoding=null;$.cbxPeriod=null;$.profitBackground=null;$.profitTitle=null;$.profitSubBackground=null;$.profitGoalLbl=null;$.profitLbl=null;$.profitBeforeLbl=null;$.profitGoalLine=null;$.profitLine=null;$.profitMain=null;$.budgetMain=null;$.contactMain=null;$.callMain=null;$.codingMain=null;$.codingMainLine=null;$.contactChart=null;$.budgetChart=null;$.budgetBackground=null;$.budgetTitle=null;$.budgetSubBackground=null;$.budgetLine=null;$.budgetLbl1=null;$.budgetLbl2=null;$.budgetCircle1=null;$.budgetCircle2=null;$.budgetCircleLbl1=null;$.budgetCircleLbl2=null;$.contactBackground=null;$.contactTitle=null;$.contactSubBackground=null;$.contactLblS=null;$.contactLblK=null;$.contactLblA=null;$.contactLblG=null;$.contactLblTot=null;$.contactLine1=null;$.contactLine2=null;$.contactLine3=null;$.contactBackground1=null;$.contactSubBackground1=null;$.contactTitle1=null;$.contactLbl1=null;$.contactLbl2=null;$.contactLbl3=null;$.contactLbl4=null;$.contactLbl5=null;$.contactLine5=null;$.contactLine6=null;$.callChart=null;$.callBackground=null;$.callSubBackground=null;$.callTitle=null;$.callLbl1=null;$.callLbl2=null;$.callLbl3=null;$.callLbl4=null;$.callLbl5=null;$.callLbl6=null;$.callLbl7=null;$.callLbl8=null;$.callLine1=null;$.callLine2=null;$.profitGoalRateTmp=null;$.profitGoalRate=null;$.profitGoalTitle=null;$.profitGoalValue=null;$.profitValue=null;$.profitBeforeValue=null;$.profitGoalVal=null;$.budgetValue1=null;$.budgetValue2=null;$.budgetCircleValue1=null;$.budgetCircleValue2=null;$.contactValS=null;$.contactValK=null;$.contactValA=null;$.contactValG=null;$.contactValTot=null;$.contactVal1=null;$.contactVal2=null;$.contactVal3=null;$.callVal1=null;$.callVal2=null;$.callVal3=null;$.callVal4=null;$.profitMainBox=null;$.profitMainTitle=null;$.budgetMainBox=null;$.budgetMainTitle=null;$.contactMainBox=null;$.contactMainTitle=null;$.callMainBox=null;$.codingMainBox=null;$.callMainTitle=null;$.codingMainTitle=null;$.profitGoalRateDeptTmp=null;$.profitGoalRateDept=null;$.profitGoalDeptTitle=null;$.profitGoalDeptValue=null;$.profitGoalBf=null;$.profitGoalDeptBf=null;$.profitGrowthBf=null;$.profitGrowthDeptBf=null;$.htmlGoalIcon=null;$.htmlGoalDeptIcon=null;$.htmlGoalType=null;$.htmlGoalDeptType=null;$.htmlGrowthType=null;$.htmlGrowthDeptType=null;$.cbxDeptNameQ=null;$.cbxEmployeeQ=null;$.cbxOfficeQ=null;$.contactLine4=null;$.lblProfitUnit=null;$.lblBudgetUnit=null;$.lblProductQ=null;$.cbxProductQ=null;$.callBackground1=null;$.callSubBackground1=null;$.callTitle1=null;$.callLblA=null;$.callLblS=null;$.callLblK=null;$.callLblG=null;$.callLblTotal=null;$.callValS=null;$.callValK=null;$.callValA=null;$.callValG=null;$.callValTotal=null;$.callLine3=null;$.callLine4=null;$.callLine5=null;$.callLine6=null;$.profitMainLink=null;$.profitHalfGoalValue=null;$.budgetMainLink=null;$.contactMainLink=null;$.callMainLink=null;$.profitGrowthChart=null;$.profitGrowthDeptChart=null;$.profitGoalRank=null;$.profitGrowthRank=null;$.profitAllGoalLbl=null;$.profitChart=null;$.profitAmt=null;$.profitCount=null;$.lblProfitDispYm=null;$.profitTarDiffLbl=null;$.profitTarDiffLblValue=null;$.callLblN=null;$.callLine7=null;$.callValN=null;$.contactValN=null;$.contactLblN=null;$.contactLine7=null;var p02Idx=0;var p04Idx=0;var p05Idx=0;var p06Idx=0;var p07Idx=0;var p11Idx=0;var p12Idx=0;var p13Idx=0;var p15Idx=0;var p16Idx=0;var p17Idx=0;var p20Idx=0;var p21Idx=0;var p08Idx=0;var enable="true";var btnType="amt";var loadingIdx=0;function initSetTitle(){$.profitMainTitle.setValue("실적");$.profitTitle.setValue("반기목표대비 누적 실적 현황");$.profitGoalLbl.setValue("목표");$.profitAllGoalLbl.setValue("(전체)");$.profitLbl.setValue("실적");$.profitTarDiffLbl.setValue("(목표대비Gap)");$.profitBeforeLbl.setValue("전년동기");$.profitAmt.setValue("금액");$.profitCount.setValue("수량");$.budgetMainTitle.setValue("예산");$.budgetTitle.setValue("예산사용 횟수");$.budgetLbl1.setValue("MR");$.budgetLbl2.setValue("영업부 평균");$.contactMainTitle.setValue("고객현황");$.contactTitle.setValue("등급별 현황");$.contactTitle1.setValue("고객 현황");$.contactLblS.setValue("L");$.contactLblK.setValue("U");$.contactLblA.setValue("T");$.contactLblG.setValue("A");$.contactLblN.setValue("N");$.contactLblTot.setValue("Total");$.contactLbl1.setValue("영업부");$.contactLbl2.setValue("고객 수");$.contactLbl3.setValue("LUTA 고객 비율");$.contactLbl4.setValue("영업부");$.contactLbl5.setValue("LUTA 고객 비율");$.callMainTitle.setValue("Call 현황");$.callTitle.setValue("반기 Call 현황");$.callLbl1.setValue("LUTA 고객");$.callLbl2.setValue("Call 수");$.callLbl3.setValue("LUTA");$.callLbl4.setValue("Call 비율");$.callLbl5.setValue("영업부 평균");$.callLbl6.setValue("LUTA Call 비율");$.callLbl7.setValue("영업부 평균");$.callLbl8.setValue("Call 실행률");$.callLblS.setValue("L");$.callLblK.setValue("U");$.callLblA.setValue("T");$.callLblG.setValue("A");$.callLblN.setValue("N");$.callLblTotal.setValue("Total");$.callTitle1.setValue("Zero call Customer");$.codingMainTitle.setValue("Coding 등록 현황")}function initSetStyle(){setArraySpaceBox([$.profitMainBox,$.budgetMainBox,$.contactMainBox,$.callMainBox,$.codingMainBox]);setArraySpaceTitle([$.profitMainTitle,$.budgetMainTitle,$.contactMainTitle,$.callMainTitle,$.codingMainTitle]);setArrayBorder([$.profitMain,$.budgetMain,$.contactMain,$.callMain,$.codingMain]);setArrayNotice([$.profitSubBackground,$.budgetSubBackground,$.contactSubBackground,$.contactSubBackground1,$.callSubBackground,$.callSubBackground1],"subBackground");setArrayNotice([$.profitBackground,$.budgetBackground,$.contactBackground,$.contactBackground1,$.callBackground,$.callBackground1],"background");setArrayNotice([$.profitTitle,$.budgetTitle,$.contactTitle,$.contactTitle1,$.callTitle,$.callTitle1],"title");setArrayLabelStyle([$.profitGoalLbl,$.profitLbl,$.profitBeforeLbl],17,"");setArrayLabelStyle([$.profitAllGoalLbl],15,"");setArrayLabelStyle([$.contactLblS,$.contactLblK,$.contactLblA,$.contactLblG,$.contactLblN,$.contactLbl1,$.contactLbl2,$.contactLbl3,$.contactLbl4,$.contactLbl5,$.callLbl1,$.callLbl2,$.callLbl3,$.callLbl4,$.callLbl5,$.callLbl6,$.callLbl7,$.callLbl8,$.callLblS,$.callLblA,$.callLblK,$.callLblG,$.callLblN,$.callLblTotal],18,"");setArrayLabelStyle([$.contactLbl1,$.contactLbl2,$.contactLbl3,$.contactLbl4,$.contactLbl5,$.callLbl1,$.callLbl2,$.callLbl3,$.callLbl4,$.callLbl5,$.callLbl6,$.callLbl7,$.callLbl8],14,"");setArrayLabelStyle([$.budgetLbl1],16,"DA1E48");setArrayLabelStyle([$.budgetLbl2],16,"");setArrayLabelStyle([$.contactLblTot],20,"DA1E48","","bold");setArrayLabelStyle([$.callLblTotal],16,"DA1E48","","bold");setArrayRadio([$.profitAmt,$.profitCount]);setArrayClickUrl([$.profitAmt],"amt");setArrayClickUrl([$.profitCount],"count");setArrayRadioColor([$.profitAmt],"#DA1E48","#FFFFFF");setArrayRadioColor([$.profitCount],"#FFFFFF","#333333");var clickLinkPortal=function(obj){var params={webid:obj.webid,parent_dept_code:$.cbxDeptNameQ.getValue()||"",dept_code:$.cbxOfficeQ.getValue()||"",employee_id:$.cbxEmployeeQ.getValue()||"",product_code:$.cbxProductQ.getValue()||""};g_main.openModelWithBusiness(obj.webid,params,true,false)};setArrayHTMLBackgroundImage([{obj:$.profitMainLink,webid:"crmPotalSales"},{obj:$.budgetMainLink,webid:"crmBudgetPortal"},{obj:$.callMainLink,webid:"crmCustomerCallPortal"},{obj:$.contactMainLink,webid:"crmCustomerCallPortal"},],"icon_link.png",22,22,clickLinkPortal)}function initLayout(){initSetTitle();initSetStyle()}function chartLayout(){initCharts($.profitGrowthChart,"column",150,215);initCharts($.profitGrowthDeptChart,"column",150,215);init3DCharts($.contactChart,"column",180,330);initAreaCharts($.budgetChart,"bar",575,175);initCharts($.callChart,"column",245,390);initCharts($.profitChart,"column",325,215)}function profitLayout(){initCharts($.profitGrowthChart,"column",150,215);initCharts($.profitGrowthDeptChart,"column",150,215);initCharts($.profitChart,"column",325,215)}function initAreaCharts(id,type,width,height){id.init({chart:{width:width,height:height,type:type},title:{text:null},xAxis:{categories:[""],title:{text:null},labels:{enabled:false}},yAxis:{min:0,title:{text:null}},lang:{thousandsSep:","},tooltip:{formatter:function(){if(this.point.y1){return'<span style="color:'+this.point.color+'">\u25CF</span> '+this.point.title+": <b>"+addComma(this.point.y)+"</b><b>("+((Number(this.point.y)/Number(this.point.y1))*100).toFixed(0)+"%)"}else{return'<span style="color:'+this.point.color+'">\u25CF</span> '+this.point.title+": <b>"+addComma(this.point.y)+"</b>"}}},plotOptions:{series:{stacking:"normal",grouping:false,shadow:false,borderWidth:0}},series:[]})}function addComma(num){var len,point,str;num=num+"";point=num.length%3;len=num.length;str=num.substring(0,point);while(point<len){if(str!=""){str+=","}str+=num.substring(point,point+3);point+=3}return str}function init3DCharts(id,type,width,height){id.init({chart:{width:width,height:height,type:type,options3d:{enabled:true,alpha:10,beta:25,depth:70}},title:{text:null},xAxis:{allowDecimals:false,labels:{enabled:false}},yAxis:{title:{text:null},labels:{enabled:true}},tooltip:{formatter:function(){return'<span style="color:'+this.point.color+'">\u25CF</span> '+this.point.title+": <b>"+addComma(this.point.y)+"</b>"}},plotOptions:{area:{pointStart:1940,marker:{enabled:false,symbol:"circle",radius:2,states:{hover:{enabled:true}}}}},series:[]})}function initCharts(id,type,width,height){id.init({chart:{width:width,height:height,type:type},title:{text:null},xAxis:{categories:[""],label:{enabled:false}},yAxis:{min:0,title:{text:null},labels:{formatter:function(){return this.value}}},credits:{enabled:false},series:[],tooltip:{formatter:function(){return'<span style="color:'+this.point.color+'">\u25CF</span> '+this.point.title+": <b>"+addComma(this.point.y)+"</b>"}},plotOptions:{bar:{dataLabels:{enabled:true}}},})}function initStackCharts(id,type,width,height){id.init({chart:{width:width,height:height,type:type},title:{text:null},xAxis:{categories:null,label:{enabled:true}},yAxis:[{min:0,title:{text:null}}],credits:{enabled:false},series:[],tooltip:{shared:true},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:true,color:(Highcharts.theme&&Highcharts.theme.dataLabelsColor)||"white"}}}})}function createJSON_Q(workType){var json=createExecuteParamInfo("p_crmMainDashboard_Q",[workType,"#UserID#",$.cbxPeriod.getValue(),$.cbxDeptNameQ.getValue(),$.cbxOfficeQ.getValue(),$.cbxEmployeeQ.getValue(),$.cbxProductQ.getValue(),btnType]);return json}function initConditions(){var today=getToday("");$.varRowId="";$.varDeptCode="";$.cbxDeptNameQ.setValue("")}function initAuthentication(){var objInfo=g_main.session.obj;if(objInfo.SystemDeveloper=="Y"){return}var parentDeptCode=objInfo.DeptCode.substring(0,2)+"00";if(objInfo.DeptLeaderYN=="Y"){$.cbxDeptNameQ.setValue(parentDeptCode);$.cbxOfficeQ.setValue(objInfo.DeptCode)}else{if(objInfo.DeptLeaderYN=="N"){$.cbxDeptNameQ.setValue(parentDeptCode);$.cbxOfficeQ.setValue(objInfo.DeptCode);$.cbxEmployeeQ.setValue(objInfo.EmpCode)}}}function setSearchCssTitle(){$.htmlGoalDeptType.setValue(getTextDeptName()+" 평균");$.profitGoalDeptTitle.setValue("달성률");$.profitGoalTitle.setValue("달성률");$.budgetCircleLbl1.setValue("정책지원 디테일링");$.budgetCircleLbl2.setValue("AM 디테일링")}function searchLayout(){setSearchCssTitle();setArrayProfitTitle([$.htmlGoalType,$.htmlGoalDeptType,$.htmlGrowthType,$.htmlGrowthDeptType]);setArrayProfitInnerTitle([$.profitGoalDeptTitle,$.profitGoalTitle]);setArrayHTMLImage([$.profitGoalRateTmp],170,170);setArrayHTMLImage([$.profitGoalRateDeptTmp],135,135);setArrayLabelStyle([$.profitGoalValue],24,"d93816","right");setArrayLabelStyle([$.profitHalfGoalValue,$.profitTarDiffLblValue],20,"595959","right");setArrayLabelStyle([$.profitValue],24,"395ed7","right");setArrayLabelStyle([$.profitBeforeValue],24,"595959","right");setArrayLabelStyle([$.profitGoalBf,$.profitGoalDeptBf,$.profitGrowthBf,$.profitGrowthDeptBf],15);setArrayLabelStyle([$.budgetCircleLbl1,$.budgetCircleLbl2,$.budgetCircleLbl2],13);setArrayBudgetCircle([$.budgetCircle1],"44d3c3");setArrayBudgetCircle([$.budgetCircle2],"AF94F3");setArrayLabelStyle([$.budgetValue1],35,"DA1E48","center","bold");setArrayLabelStyle([$.budgetValue2],35,"595959","center","bold");setArrayLabelStyle([$.budgetCircleValue1,$.budgetCircleValue2],30,"FFFFFF","center","bold");setArrayLabelStyle([$.contactValS,$.contactValK,$.contactValA,$.contactValG,$.contactValN,$.contactVal1,$.contactVal2,$.contactVal3,$.callValA,$.callValS,$.callValK,$.callValG,$.callValN],15,"595959","center","bold");setArrayLabelStyle([$.callValTotal],15,"DA1E48","center","bold");setArrayLabelStyle([$.contactValTot],20,"DA1E48","center","bold");setArrayLabelStyle([$.callVal1,$.callVal2,$.callVal3,$.callVal4],18,"595959","center","bold");var imgUrlGoal=g_scriptPath+"/images/icon_goal.png";$.htmlGoalIcon.setHTML("<img style='width:25px; height:25px;' src='"+imgUrlGoal+"' />");$.htmlGoalDeptIcon.setHTML("<img style='width: 25px; height: 25px;' src='"+imgUrlGoal+"' />")}function clearData(){p02Idx=0;p04Idx=0;p05Idx=0;p06Idx=0;p07Idx=0;p11Idx=0;p12Idx=0;p13Idx=0;p15Idx=0;p16Idx=0;p17Idx=0;p20Idx=0;p21Idx=0;p08Idx=0;$.profitGoalValue.setValue("");$.profitHalfGoalValue.setValue("");$.profitValue.setValue("");$.profitBeforeValue.setValue("");$.profitGoalVal.setValue("");$.profitGoalDeptValue.setValue("");$.profitGoalRank.setValue("");$.profitGrowthRank.setValue("");$.budgetValue1.setValue("");$.budgetValue2.setValue("");$.budgetCircleValue1.setValue("");$.budgetCircleValue2.setValue("");$.contactValA.setValue("");$.contactValG.setValue("");$.contactValK.setValue("");$.contactValS.setValue("");$.contactValTot.setValue("");$.contactVal1.setValue("");$.contactVal2.setValue("");$.contactVal3.setValue("");$.callVal1.setValue("");$.callVal2.setValue("");$.callVal3.setValue("");$.callVal4.setValue("");setClearRank([$.profitGoalRank,$.profitGrowthRank])}function searchList(){enable="false";clearData();drawToast("#LOADING#");doSearchProfit();doSearchBudget();doSearchContact();doSearchCall();doSearchCoding()}function doSearchRadioProfit(){if($.cbxDeptNameQ.getValue()==""){MessageBoxShow("본부/영업부를 선택하세요.");return}profitLayout();var deptQ=$.cbxDeptNameQ.getValue();var officeQ=$.cbxOfficeQ.getValue();var employeeQ=$.cbxEmployeeQ.getValue();if(employeeQ!=""){$.htmlGoalType.setValue("담당자");$.htmlGrowthType.setValue("담당자")}else{if(officeQ!=""){$.htmlGoalType.setValue("영업소");$.htmlGrowthType.setValue("영업소")}else{$.htmlGoalType.setValue(getTextTeamName());$.htmlGrowthType.setValue("영업부")}}if(btnType=="amt"){$.lblProfitUnit.setVisible(true)}else{if(btnType=="count"){$.lblProfitUnit.setVisible(false)}}var json=createJSON_Q("Q_PROFIT");callQuery(["req",json],"Q_PROFIT_RADIO",$)}function doSearchProfit(){var deptQ=$.cbxDeptNameQ.getValue();var officeQ=$.cbxOfficeQ.getValue();var employeeQ=$.cbxEmployeeQ.getValue();if(employeeQ!=""){$.htmlGoalType.setValue("담당자");$.htmlGrowthType.setValue("담당자")}else{if(officeQ!=""){$.htmlGoalType.setValue("영업소");$.htmlGrowthType.setValue("영업소")}else{$.htmlGoalType.setValue(getTextTeamName())}}var json=createJSON_Q("Q_PROFIT");callQueryLoading(["req",json],"Q_PROFIT",$)}function doSearchBudget(){var json=createJSON_Q("Q_BUDGET");callQueryLoading(["req",json],"Q_BUDGET",$)}function doSearchContact(){var json=createJSON_Q("Q_CONTACT");callQueryLoading(["req",json],"Q_CONTACT",$)}function doSearchCall(){var json=createJSON_Q("Q_CALL");callQueryLoading(["req",json],"Q_CALL",$)}function doSearchCoding(){var json=createJSON_Q("Q_CODING");callQueryLoading(["req",json],"Q_CODING",$)}function closeLoading(){if(loadingIdx==5){loadingIdx=0;hideToast();enable="true"}}function fnSetData(ds){if(ds.resultList.length>0){fnSetColumns(ds.resultList[0]);if(ds.resultList.length>0){fnSetDatas(ds.resultList[0])}}}function fnSetColumns(rs){$.gridCoding.clear();$.gridCoding.removeColumns();for(var i=0;i<rs.length;i++){if(rs[i].P02!=""&&rs[i].P02!=null){p02Idx++}if(rs[i].P04!=""&&rs[i].P04!=null){p04Idx++}if(rs[i].P05!=""&&rs[i].P05!=null){p05Idx++}if(rs[i].P06!=""&&rs[i].P06!=null){p06Idx++}if(rs[i].P07!=""&&rs[i].P07!=null){p07Idx++}if(rs[i].P11!=""&&rs[i].P11!=null){p11Idx++}if(rs[i].P12!=""&&rs[i].P12!=null){p12Idx++}if(rs[i].P13!=""&&rs[i].P13!=null){p13Idx++}if(rs[i].P15!=""&&rs[i].P15!=null){p15Idx++}if(rs[i].P16!=""&&rs[i].P16!=null){p16Idx++}if(rs[i].P17!=""&&rs[i].P17!=null){p17Idx++}if(rs[i].P20!=""&&rs[i].P20!=null){p20Idx++}if(rs[i].P21!=""&&rs[i].P21!=null){p21Idx++}if(rs[i].P08!=""&&rs[i].P08!=null){p08Idx++}}var cols=[];cols.push(new FingerDataGridColumn("company_name",250,"left","int","거래처"));if(p07Idx!=0){cols.push(new FingerDataGridColumn("P07_in",50,"center","int",[{text:"나제아주사",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P07_out",50,"center","int",["","원외"]))}if(p08Idx!=0){cols.push(new FingerDataGridColumn("P08_in",50,"center","int",[{text:"나제아정",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P08_out",50,"center","int",["","원외"]))}if(p05Idx!=0){cols.push(new FingerDataGridColumn("P05_in",50,"center","int",[{text:"베라실",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P05_out",50,"center","int",["","원외"]))}if(p06Idx!=0){cols.push(new FingerDataGridColumn("P06_in",50,"center","int",[{text:"페르디핀",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P06_out",50,"center","int",["","원외"]))}if(p02Idx!=0){cols.push(new FingerDataGridColumn("P02_in",50,"center","int",[{text:"올데카",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P02_out",50,"center","int",["","원외"]))}if(p04Idx!=0){cols.push(new FingerDataGridColumn("P04_in",50,"center","int",[{text:"하루날",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P04_out",50,"center","int",["","원외"]))}if(p11Idx!=0){cols.push(new FingerDataGridColumn("P11_in",50,"center","int",[{text:"프로그랍TX",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P11_out",50,"center","int",["","원외"]))}if(p12Idx!=0){cols.push(new FingerDataGridColumn("P12_in",50,"center","int",[{text:"프로그랍AI",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P12_out",50,"center","int",["","원외"]))}if(p17Idx!=0){cols.push(new FingerDataGridColumn("P17_in",50,"center","int",[{text:"아드바그랍",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P17_out",50,"center","int",["","원외"]))}if(p13Idx!=0){cols.push(new FingerDataGridColumn("P13_in",50,"center","int",[{text:"프로토픽",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P13_out",50,"center","int",["","원외"]))}if(p15Idx!=0){cols.push(new FingerDataGridColumn("P15_in",50,"center","int",[{text:"마이카민",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P15_out",50,"center","int",["","원외"]))}if(p16Idx!=0){cols.push(new FingerDataGridColumn("P16_in",50,"center","int",[{text:"베시케어",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P16_out",50,"center","int",["","원외"]))}if(p20Idx!=0){cols.push(new FingerDataGridColumn("P20_in",50,"center","int",[{text:"엑스탄디",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P20_out",50,"center","int",["","원외"]))}if(p21Idx!=0){cols.push(new FingerDataGridColumn("P21_in",50,"center","int",[{text:"베타미가",colspan:2},"원내"]));cols.push(new FingerDataGridColumn("P21_out",50,"center","int",["","원외"]))}$.gridCoding.resetColumns(cols)}function fnSetDatas(rs){for(var i=0;i<rs.length;i++){$.gridCoding.addRow({});$.gridCoding.setValue(i,"company_name",rs[i].company_name);if(p02Idx!=0){var inData="";var outData="";if(rs[i].P02.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P02.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P02_in",inData);$.gridCoding.setValue(i,"P02_out",outData)}if(p04Idx!=0){var inData="";var outData="";if(rs[i].P04.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P04.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P04_in",inData);$.gridCoding.setValue(i,"P04_out",outData)}if(p05Idx!=0){var inData="";var outData="";if(rs[i].P05.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P05.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P05_in",inData);$.gridCoding.setValue(i,"P05_out",outData)}if(p06Idx!=0){var inData="";var outData="";if(rs[i].P06.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P06.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P06_in",inData);$.gridCoding.setValue(i,"P06_out",outData)}if(p07Idx!=0){var inData="";var outData="";if(rs[i].P07.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P07.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P07_in",inData);$.gridCoding.setValue(i,"P07_out",outData)}if(p11Idx!=0){var inData="";var outData="";if(rs[i].P11.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P11.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P11_in",inData);$.gridCoding.setValue(i,"P11_out",outData)}if(p12Idx!=0){var inData="";var outData="";if(rs[i].P12.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P12.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P12_in",inData);$.gridCoding.setValue(i,"P12_out",outData)}if(p17Idx!=0){var inData="";var outData="";if(rs[i].P17.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P17.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P17_in",inData);$.gridCoding.setValue(i,"P17_out",outData)}if(p13Idx!=0){var inData="";var outData="";if(rs[i].P13.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P13.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P13_in",inData);$.gridCoding.setValue(i,"P13_out",outData)}if(p15Idx!=0){var inData="";var outData="";if(rs[i].P15.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P15.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P15_in",inData);$.gridCoding.setValue(i,"P15_out",outData)}if(p16Idx!=0){var inData="";var outData="";if(rs[i].P16.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P16.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P16_in",inData);$.gridCoding.setValue(i,"P16_out",outData)}if(p20Idx!=0){var inData="";var outData="";if(rs[i].P20.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P20.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P20_in",inData);$.gridCoding.setValue(i,"P20_out",outData)}if(p21Idx!=0){var inData="";var outData="";if(rs[i].P21.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P21.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P21_in",inData);$.gridCoding.setValue(i,"P21_out",outData)}if(p08Idx!=0){var inData="";var outData="";if(rs[i].P08.indexOf("001")!="-1"){inData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}if(rs[i].P08.indexOf("002")!="-1"){outData="<img src='./fingerPlatform/images/check.png' style='width:15px'>"}$.gridCoding.setValue(i,"P08_in",inData);$.gridCoding.setValue(i,"P08_out",outData)}}}function cssFontInit(fontSize,fontColor){return[{styleAttr:"font-weight",value:"600"},{styleAttr:"color",value:"#"+fontColor},{styleAttr:"text-align",value:"center"},{styleAttr:"font-size",value:fontSize+"px"}]}function cssLabelStyle(fontSize,fontColor){return[{styleAttr:"font-weight",value:"200"},{styleAttr:"vertical-align",value:"middel"},{styleAttr:"text-align",value:"center"},{styleAttr:"font-size",value:fontSize+"px"},{styleAttr:"color",value:"#"+fontColor},]}$.dashboard_radio_click=function(id,value){if(id=="amt"){setArrayRadioColor([$.profitAmt],"#DA1E48","#FFFFFF");setArrayRadioColor([$.profitCount],"#FFFFFF","#333333")}else{if(id=="count"){setArrayRadioColor([$.profitAmt],"#FFFFFF","#333333");setArrayRadioColor([$.profitCount],"#DA1E48","#FFFFFF")}}btnType=id;searchLayout();doSearchRadioProfit()};function getTextDeptName(){if($.cbxOfficeQ.getValue()){return"영업부"}else{return"전체"}}function getTextTeamName(){if($.cbxOfficeQ.getValue()){return"영업소"}else{return"영업부"}}$.init=function(host,args){$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,50);$.panQuery.setText("");$.panQuery.setBottomLine(false);$.panBudget=new FingerPanel(host,"panBudget",605,435,595,460);$.panBudget.setText("");$.panBudget.setBottomLine(true);$.btnSearch=new FingerButton(host,"btnSearch",1120,10,80,20);$.btnSearch.setText("조회");$.lblDateQ=new FingerLabel(host,"lblDateQ",5,10,60,20);$.lblDateQ.setText("기간");$.lblDeptNameQ=new FingerLabel(host,"lblDeptNameQ",205,10,90,20);$.lblDeptNameQ.setText("본부/영업부");$.panMain=new FingerPanel(host,"panMain",0,5,1200,1340);$.panMain.setText("");$.panMain.setBottomLine(false);$.lblOfficeQ=new FingerLabel(host,"lblOfficeQ",450,10,60,20);$.lblOfficeQ.setText("영업소");$.lblEmployeeQ=new FingerLabel(host,"lblEmployeeQ",665,10,60,20);$.lblEmployeeQ.setText("MR");$.panCall=new FingerPanel(host,"panCall",0,435,595,460);$.panCall.setText("");$.panCall.setBottomLine(true);$.panContact=new FingerPanel(host,"panContact",0,905,595,420);$.panContact.setText("");$.panContact.setBottomLine(true);$.panCoding=new FingerPanel(host,"panCoding",605,905,595,420);$.panCoding.setText("");$.panCoding.setBottomLine(true);$.panProfit=new FingerPanel(host,"panProfit",0,65,1200,360);$.panProfit.setText("");$.panProfit.setBottomLine(true);$.gridCoding=new FingerDataGrid(host,"gridCoding",1,43,593,375);$.cbxPeriod=new FingerComboBox(host,"cbxPeriod",70,10,120,20);$.profitBackground=new FingerHTMLView(host,"profitBackground",30,90,340,215);$.profitTitle=new FingerHTMLView(host,"profitTitle",92,75,210,25);$.profitSubBackground=new FingerHTMLView(host,"profitSubBackground",45,110,310,185);$.profitGoalLbl=new FingerHTMLView(host,"profitGoalLbl",60,120,35,25);$.profitLbl=new FingerHTMLView(host,"profitLbl",60,180,35,25);$.profitBeforeLbl=new FingerHTMLView(host,"profitBeforeLbl",50,255,85,25);$.profitGoalLine=new FingerLine(host,"profitGoalLine",60,170,280,1);$.profitLine=new FingerLine(host,"profitLine",60,230,280,1);$.profitMain=new FingerHTMLView(host,"profitMain",0,0,1200,360);$.budgetMain=new FingerHTMLView(host,"budgetMain",0,0,595,460);$.contactMain=new FingerHTMLView(host,"contactMain",0,0,595,420);$.callMain=new FingerHTMLView(host,"callMain",0,0,595,460);$.codingMain=new FingerHTMLView(host,"codingMain",0,0,595,420);$.codingMainLine=new FingerLine(host,"codingMainLine",0,50,596,1);$.contactChart=new FingerBarChart(host,"contactChart",10,70,180,340);$.budgetChart=new FingerBarChart(host,"budgetChart",10,80,575,175);$.budgetBackground=new FingerHTMLView(host,"budgetBackground",30,275,265,140);$.budgetTitle=new FingerHTMLView(host,"budgetTitle",100,260,130,25);$.budgetSubBackground=new FingerHTMLView(host,"budgetSubBackground",45,295,235,105);$.budgetLine=new FingerLine(host,"budgetLine",160,310,1,76);$.budgetLbl1=new FingerHTMLView(host,"budgetLbl1",55,310,100,25);$.budgetLbl2=new FingerHTMLView(host,"budgetLbl2",165,310,110,25);$.budgetCircle1=new FingerHTMLView(host,"budgetCircle1",330,280,110,100);$.budgetCircle2=new FingerHTMLView(host,"budgetCircle2",465,280,110,100);$.budgetCircleLbl1=new FingerHTMLView(host,"budgetCircleLbl1",330,390,110,20);$.budgetCircleLbl2=new FingerHTMLView(host,"budgetCircleLbl2",465,390,110,20);$.contactBackground=new FingerHTMLView(host,"contactBackground",210,95,370,115);$.contactTitle=new FingerHTMLView(host,"contactTitle",330,80,120,25);$.contactSubBackground=new FingerHTMLView(host,"contactSubBackground",220,115,350,85);$.contactLblS=new FingerHTMLView(host,"contactLblS",225,130,40,25);$.contactLblK=new FingerHTMLView(host,"contactLblK",275,130,45,25);$.contactLblA=new FingerHTMLView(host,"contactLblA",330,130,45,25);$.contactLblG=new FingerHTMLView(host,"contactLblG",385,130,40,25);$.contactLblTot=new FingerHTMLView(host,"contactLblTot",485,130,80,25);$.contactLine1=new FingerLine(host,"contactLine1",270,135,1,51);$.contactLine2=new FingerLine(host,"contactLine2",326,135,1,51);$.contactLine3=new FingerLine(host,"contactLine3",379,135,1,51);$.contactBackground1=new FingerHTMLView(host,"contactBackground1",230,245,320,110);$.contactSubBackground1=new FingerHTMLView(host,"contactSubBackground1",240,265,300,80);$.contactTitle1=new FingerHTMLView(host,"contactTitle1",330,230,120,25);$.contactLbl1=new FingerHTMLView(host,"contactLbl1",250,270,80,20);$.contactLbl2=new FingerHTMLView(host,"contactLbl2",255,290,70,20);$.contactLbl3=new FingerHTMLView(host,"contactLbl3",333,280,110,20);$.contactLbl4=new FingerHTMLView(host,"contactLbl4",445,270,90,20);$.contactLbl5=new FingerHTMLView(host,"contactLbl5",432,290,115,20);$.contactLine5=new FingerLine(host,"contactLine5",335,275,1,61);$.contactLine6=new FingerLine(host,"contactLine6",440,275,1,61);$.callChart=new FingerBarChart(host,"callChart",10,70,245,390);$.callBackground=new FingerHTMLView(host,"callBackground",295,75,265,210);$.callSubBackground=new FingerHTMLView(host,"callSubBackground",310,100,235,175);$.callTitle=new FingerHTMLView(host,"callTitle",365,60,130,25);$.callLbl1=new FingerHTMLView(host,"callLbl1",325,110,85,20);$.callLbl2=new FingerHTMLView(host,"callLbl2",325,130,85,20);$.callLbl3=new FingerHTMLView(host,"callLbl3",440,110,85,20);$.callLbl4=new FingerHTMLView(host,"callLbl4",440,130,85,20);$.callLbl5=new FingerHTMLView(host,"callLbl5",440,195,85,20);$.callLbl6=new FingerHTMLView(host,"callLbl6",425,215,110,30);$.callLbl7=new FingerHTMLView(host,"callLbl7",325,195,85,20);$.callLbl8=new FingerHTMLView(host,"callLbl8",325,215,85,20);$.callLine1=new FingerLine(host,"callLine1",330,185,195,1);$.callLine2=new FingerLine(host,"callLine2",425,110,1,161);$.profitGoalRateTmp=new FingerHTMLView(host,"profitGoalRateTmp",405,100,175,175);$.profitGoalRate=new FingerHTMLView(host,"profitGoalRate",405,100,175,175);$.profitGoalTitle=new FingerHTMLView(host,"profitGoalTitle",430,160,125,45);$.profitGoalValue=new FingerHTMLView(host,"profitGoalValue",130,115,205,30);$.profitValue=new FingerHTMLView(host,"profitValue",130,175,205,30);$.profitBeforeValue=new FingerHTMLView(host,"profitBeforeValue",130,250,205,30);$.profitGoalVal=new FingerHTMLView(host,"profitGoalVal",450,200,90,45);$.budgetValue1=new FingerHTMLView(host,"budgetValue1",55,340,100,45);$.budgetValue2=new FingerHTMLView(host,"budgetValue2",165,340,110,45);$.budgetCircleValue1=new FingerHTMLView(host,"budgetCircleValue1",330,315,110,40);$.budgetCircleValue2=new FingerHTMLView(host,"budgetCircleValue2",465,315,110,40);$.contactValS=new FingerHTMLView(host,"contactValS",225,165,40,25);$.contactValK=new FingerHTMLView(host,"contactValK",275,165,45,25);$.contactValA=new FingerHTMLView(host,"contactValA",330,165,45,25);$.contactValG=new FingerHTMLView(host,"contactValG",385,165,40,25);$.contactValTot=new FingerHTMLView(host,"contactValTot",485,160,80,30);$.contactVal1=new FingerHTMLView(host,"contactVal1",260,315,60,20);$.contactVal2=new FingerHTMLView(host,"contactVal2",333,315,110,20);$.contactVal3=new FingerHTMLView(host,"contactVal3",460,315,65,20);$.callVal1=new FingerHTMLView(host,"callVal1",325,155,85,25);$.callVal2=new FingerHTMLView(host,"callVal2",440,155,90,25);$.callVal3=new FingerHTMLView(host,"callVal3",440,240,90,25);$.callVal4=new FingerHTMLView(host,"callVal4",325,240,90,25);$.profitMainBox=new FingerHTMLView(host,"profitMainBox",1,0,1198,39);$.profitMainTitle=new FingerHTMLView(host,"profitMainTitle",15,10,50,25);$.budgetMainBox=new FingerHTMLView(host,"budgetMainBox",1,0,593,39);$.budgetMainTitle=new FingerHTMLView(host,"budgetMainTitle",15,7,55,25);$.contactMainBox=new FingerHTMLView(host,"contactMainBox",1,0,593,39);$.contactMainTitle=new FingerHTMLView(host,"contactMainTitle",15,7,105,25);$.callMainBox=new FingerHTMLView(host,"callMainBox",1,0,593,39);$.codingMainBox=new FingerHTMLView(host,"codingMainBox",1,0,593,39);$.callMainTitle=new FingerHTMLView(host,"callMainTitle",15,7,110,25);$.codingMainTitle=new FingerHTMLView(host,"codingMainTitle",15,7,170,30);$.profitGoalRateDeptTmp=new FingerHTMLView(host,"profitGoalRateDeptTmp",625,135,145,140);$.profitGoalRateDept=new FingerHTMLView(host,"profitGoalRateDept",625,135,145,140);$.profitGoalDeptTitle=new FingerHTMLView(host,"profitGoalDeptTitle",645,180,95,35);$.profitGoalDeptValue=new FingerHTMLView(host,"profitGoalDeptValue",655,222,85,40);$.profitGoalBf=new FingerHTMLView(host,"profitGoalBf",395,305,188,25);$.profitGoalDeptBf=new FingerHTMLView(host,"profitGoalDeptBf",600,305,188,25);$.profitGrowthBf=new FingerHTMLView(host,"profitGrowthBf",810,305,188,25);$.profitGrowthDeptBf=new FingerHTMLView(host,"profitGrowthDeptBf",985,305,188,25);$.htmlGoalIcon=new FingerHTMLView(host,"htmlGoalIcon",485,135,25,30);$.htmlGoalDeptIcon=new FingerHTMLView(host,"htmlGoalDeptIcon",687,155,25,30);$.htmlGoalType=new FingerHTMLView(host,"htmlGoalType",425,280,128,25);$.htmlGoalDeptType=new FingerHTMLView(host,"htmlGoalDeptType",628,280,128,25);$.htmlGrowthType=new FingerHTMLView(host,"htmlGrowthType",840,255,128,25);$.htmlGrowthDeptType=new FingerHTMLView(host,"htmlGrowthDeptType",1018,255,128,25);$.cbxDeptNameQ=new FingerComboBox(host,"cbxDeptNameQ",300,10,140,20);$.cbxEmployeeQ=new FingerComboBox(host,"cbxEmployeeQ",730,10,140,20);$.cbxOfficeQ=new FingerComboBox(host,"cbxOfficeQ",515,10,140,20);$.contactLine4=new FingerLine(host,"contactLine4",430,135,1,51);$.lblProfitUnit=new FingerLabel(host,"lblProfitUnit",280,305,90,20);$.lblProfitUnit.setText("(단위:천원)");$.lblBudgetUnit=new FingerLabel(host,"lblBudgetUnit",500,60,85,15);$.lblBudgetUnit.setText("(단위:천원)");$.lblProductQ=new FingerLabel(host,"lblProductQ",890,10,50,20);$.lblProductQ.setText("품목");$.cbxProductQ=new FingerComboBox(host,"cbxProductQ",945,10,140,20);$.callBackground1=new FingerHTMLView(host,"callBackground1",265,320,320,95);$.callSubBackground1=new FingerHTMLView(host,"callSubBackground1",285,340,285,60);$.callTitle1=new FingerHTMLView(host,"callTitle1",345,300,165,25);$.callLblA=new FingerHTMLView(host,"callLblA",380,345,35,25);$.callLblS=new FingerHTMLView(host,"callLblS",290,345,35,25);$.callLblK=new FingerHTMLView(host,"callLblK",335,345,35,25);$.callLblG=new FingerHTMLView(host,"callLblG",425,345,35,25);$.callLblTotal=new FingerHTMLView(host,"callLblTotal",515,345,50,25);$.callValS=new FingerHTMLView(host,"callValS",290,375,35,25);$.callValK=new FingerHTMLView(host,"callValK",335,375,35,25);$.callValA=new FingerHTMLView(host,"callValA",380,375,35,25);$.callValG=new FingerHTMLView(host,"callValG",425,375,35,25);$.callValTotal=new FingerHTMLView(host,"callValTotal",515,375,50,25);$.callLine3=new FingerLine(host,"callLine3",330,350,1,36);$.callLine4=new FingerLine(host,"callLine4",375,350,1,36);$.callLine5=new FingerLine(host,"callLine5",420,350,1,36);$.callLine6=new FingerLine(host,"callLine6",465,350,1,36);$.profitMainLink=new FingerHTMLView(host,"profitMainLink",55,10,30,30);$.profitHalfGoalValue=new FingerHTMLView(host,"profitHalfGoalValue",150,145,190,25);$.budgetMainLink=new FingerHTMLView(host,"budgetMainLink",55,10,30,30);$.contactMainLink=new FingerHTMLView(host,"contactMainLink",90,10,35,30);$.callMainLink=new FingerHTMLView(host,"callMainLink",90,10,35,30);$.profitGrowthChart=new FingerBarChart(host,"profitGrowthChart",825,110,150,215);$.profitGrowthDeptChart=new FingerBarChart(host,"profitGrowthDeptChart",1000,110,150,215);$.profitGoalRank=new FingerHTMLView(host,"profitGoalRank",530,65,140,25);$.profitGrowthRank=new FingerHTMLView(host,"profitGrowthRank",915,65,140,25);$.profitAllGoalLbl=new FingerHTMLView(host,"profitAllGoalLbl",50,145,55,20);$.profitChart=new FingerBarChart(host,"profitChart",825,110,325,215);$.profitAmt=new FingerHTMLView(host,"profitAmt",1100,10,45,20);$.profitCount=new FingerHTMLView(host,"profitCount",1145,10,45,20);$.lblProfitDispYm=new FingerLabel(host,"lblProfitDispYm",0,305,200,20);$.lblProfitDispYm.setText("");$.profitTarDiffLbl=new FingerHTMLView(host,"profitTarDiffLbl",60,205,130,20);$.profitTarDiffLblValue=new FingerHTMLView(host,"profitTarDiffLblValue",200,205,140,25);$.callLblN=new FingerHTMLView(host,"callLblN",470,345,35,25);$.callLine7=new FingerLine(host,"callLine7",510,350,1,36);$.callValN=new FingerHTMLView(host,"callValN",470,375,35,25);$.contactValN=new FingerHTMLView(host,"contactValN",435,165,40,25);$.contactLblN=new FingerHTMLView(host,"contactLblN",435,130,40,25);$.contactLine7=new FingerLine(host,"contactLine7",480,135,1,51);$.cbxDeptNameQ.setAllowBlank(false,"본부/영업부");$.cbxPeriod.setAllowBlank(false,"기간");$.cbxProductQ.setColumn("product_code","product_name");$.cbxDeptNameQ.setEmptyRow(true);$.cbxOfficeQ.setEmptyRow(true);$.cbxEmployeeQ.setEmptyRow(true);$.cbxProductQ.setEmptyRow(true);$.cbxOfficeQ.setColumn("dept_code","dept_name");$.cbxEmployeeQ.setColumn("employee_id","emp_name");$.cbxPeriod.setColumn("CodeValue","CodeText");$.panQuery.setBorder(true);$.fixedGridColumns=[new FingerDataGridColumn("",250,"left","string","거래처")];$.gridCoding.colIdx=$.gridCoding.setColumns($.fixedGridColumns);$.gridCoding.init({scroll:"xy"});$.gridCoding.setBorder(true);$.host=host;$.args=args};$.start=function(){$.panQuery.add($.btnSearch);$.panQuery.add($.lblDateQ);$.panQuery.add($.lblDeptNameQ);$.panQuery.add($.lblOfficeQ);$.panQuery.add($.lblEmployeeQ);$.panQuery.add($.cbxPeriod);$.panQuery.add($.cbxDeptNameQ);$.panQuery.add($.cbxEmployeeQ);$.panQuery.add($.cbxOfficeQ);$.panQuery.add($.lblProductQ);$.panQuery.add($.cbxProductQ);$.panBudget.add($.budgetMain);$.panBudget.add($.budgetChart);$.panBudget.add($.budgetBackground);$.panBudget.add($.budgetTitle);$.panBudget.add($.budgetSubBackground);$.panBudget.add($.budgetLine);$.panBudget.add($.budgetLbl1);$.panBudget.add($.budgetLbl2);$.panBudget.add($.budgetCircle1);$.panBudget.add($.budgetCircle2);$.panBudget.add($.budgetCircleLbl1);$.panBudget.add($.budgetCircleLbl2);$.panBudget.add($.budgetValue2);$.panBudget.add($.budgetValue1);$.panBudget.add($.budgetCircleValue1);$.panBudget.add($.budgetCircleValue2);$.panBudget.add($.budgetMainBox);$.panBudget.add($.budgetMainTitle);$.panBudget.add($.lblBudgetUnit);$.panBudget.add($.budgetMainLink);$.panMain.add($.panQuery);$.panMain.add($.panBudget);$.panMain.add($.panCall);$.panMain.add($.panContact);$.panMain.add($.panCoding);$.panMain.add($.panProfit);$.panCall.add($.callMain);$.panCall.add($.callChart);$.panCall.add($.callBackground);$.panCall.add($.callSubBackground);$.panCall.add($.callTitle);$.panCall.add($.callLbl1);$.panCall.add($.callLbl2);$.panCall.add($.callLbl3);$.panCall.add($.callLbl4);$.panCall.add($.callLbl6);$.panCall.add($.callLbl7);$.panCall.add($.callLbl8);$.panCall.add($.callLine1);$.panCall.add($.callLine2);$.panCall.add($.callLbl5);$.panCall.add($.callVal1);$.panCall.add($.callVal2);$.panCall.add($.callVal3);$.panCall.add($.callVal4);$.panCall.add($.callMainBox);$.panCall.add($.callMainTitle);$.panCall.add($.callBackground1);$.panCall.add($.callSubBackground1);$.panCall.add($.callTitle1);$.panCall.add($.callLblA);$.panCall.add($.callLblS);$.panCall.add($.callLblK);$.panCall.add($.callLblG);$.panCall.add($.callLblTotal);$.panCall.add($.callValS);$.panCall.add($.callValK);$.panCall.add($.callValA);$.panCall.add($.callValG);$.panCall.add($.callValTotal);$.panCall.add($.callLine3);$.panCall.add($.callLine4);$.panCall.add($.callLine5);$.panCall.add($.callLine6);$.panCall.add($.callMainLink);$.panCall.add($.callLblN);$.panCall.add($.callLine7);$.panCall.add($.callValN);$.panContact.add($.contactMain);$.panContact.add($.contactChart);$.panContact.add($.contactBackground);$.panContact.add($.contactTitle);$.panContact.add($.contactSubBackground);$.panContact.add($.contactLblA);$.panContact.add($.contactLblG);$.panContact.add($.contactLblK);$.panContact.add($.contactLblS);$.panContact.add($.contactLblTot);$.panContact.add($.contactLine1);$.panContact.add($.contactLine2);$.panContact.add($.contactLine3);$.panContact.add($.contactBackground1);$.panContact.add($.contactSubBackground1);$.panContact.add($.contactTitle1);$.panContact.add($.contactLbl1);$.panContact.add($.contactLbl2);$.panContact.add($.contactLbl3);$.panContact.add($.contactLbl4);$.panContact.add($.contactLbl5);$.panContact.add($.contactLine5);$.panContact.add($.contactLine6);$.panContact.add($.contactValS);$.panContact.add($.contactValK);$.panContact.add($.contactValA);$.panContact.add($.contactValG);$.panContact.add($.contactValTot);$.panContact.add($.contactVal1);$.panContact.add($.contactVal2);$.panContact.add($.contactVal3);$.panContact.add($.contactMainBox);$.panContact.add($.contactMainTitle);$.panContact.add($.contactLine4);$.panContact.add($.contactMainLink);$.panContact.add($.contactValN);$.panContact.add($.contactLblN);$.panContact.add($.contactLine7);$.panCoding.add($.gridCoding);$.panCoding.add($.codingMain);$.panCoding.add($.codingMainLine);$.panCoding.add($.codingMainBox);$.panCoding.add($.codingMainTitle);$.panProfit.add($.profitBackground);$.panProfit.add($.profitTitle);$.panProfit.add($.profitSubBackground);$.panProfit.add($.profitGoalLbl);$.panProfit.add($.profitLbl);$.panProfit.add($.profitBeforeLbl);$.panProfit.add($.profitGoalLine);$.panProfit.add($.profitLine);$.panProfit.add($.profitMain);$.panProfit.add($.profitGoalRateTmp);$.panProfit.add($.profitGoalRate);$.panProfit.add($.profitGoalTitle);$.panProfit.add($.profitGoalValue);$.panProfit.add($.profitValue);$.panProfit.add($.profitBeforeValue);$.panProfit.add($.profitGoalVal);$.panProfit.add($.profitMainBox);$.panProfit.add($.profitMainTitle);$.panProfit.add($.profitGoalRateDeptTmp);$.panProfit.add($.profitGoalRateDept);$.panProfit.add($.profitGoalDeptTitle);$.panProfit.add($.profitGoalDeptValue);$.panProfit.add($.profitGoalBf);$.panProfit.add($.profitGoalDeptBf);$.panProfit.add($.profitGrowthBf);$.panProfit.add($.profitGrowthDeptBf);$.panProfit.add($.htmlGoalIcon);$.panProfit.add($.htmlGoalDeptIcon);$.panProfit.add($.htmlGoalType);$.panProfit.add($.htmlGoalDeptType);$.panProfit.add($.htmlGrowthType);$.panProfit.add($.htmlGrowthDeptType);$.panProfit.add($.lblProfitUnit);$.panProfit.add($.profitMainLink);$.panProfit.add($.profitHalfGoalValue);$.panProfit.add($.profitGrowthDeptChart);$.panProfit.add($.profitGrowthChart);$.panProfit.add($.profitGoalRank);$.panProfit.add($.profitGrowthRank);$.panProfit.add($.profitAllGoalLbl);$.panProfit.add($.profitChart);$.panProfit.add($.profitAmt);$.panProfit.add($.profitCount);$.panProfit.add($.lblProfitDispYm);$.panProfit.add($.profitTarDiffLbl);$.panProfit.add($.profitTarDiffLblValue);initConditions();initLayout();var ds=commCodeData2($,"CM981|CM982");setComboBind([$.cmbResultQ,null],ds);ds=bizComponentData2($,"Q1","S_9998");setComboBind([$.cbxPeriod],ds);ds=bizComponentData2($,"Q2","L_CRM0122");if(ds&&ds.resultList){ds.resultList[0].unshift({sub_code:"S030",code_name:"SR영업소"})}setComboBind([$.cbxDeptNameQ],ds);ds=bizComponentData2($,"Q1","L_CRM0202");setComboBind([$.cbxProductQ],ds);initAuthentication()};$.callback=function(type,ds){if(type=="Q_PROFIT_RADIO"){if(ds!=null&&ds.resultList.length>0){if(ds.resultList[0]&&ds.resultList[0].length>0){$.profitGoalValue.setValue(ds.resultList[0][0].tar);$.profitHalfGoalValue.setValue("("+ds.resultList[0][0].half_tar+")");$.profitValue.setValue(ds.resultList[0][0].res);$.profitTarDiffLblValue.setValue("("+ds.resultList[0][0].res_tar+")");$.profitBeforeValue.setValue(ds.resultList[0][0].pre_res);$.profitGoalVal.setValue(ds.resultList[0][0].goal_rate?ds.resultList[0][0].goal_rate+"%":"0%");$.profitGoalDeptValue.setValue(ds.resultList[0][0].goal_dept_rate+"%");var chart=$.profitChart.getChart();var deptQ=$.cbxDeptNameQ.getValue();var officeQ=$.cbxOfficeQ.getValue();var employeeQ=$.cbxEmployeeQ.getValue();var target="";if(employeeQ!=""){target="담당자";setArrayNoticeRank([$.profitGoalRank,$.profitGrowthRank]);$.profitGoalRank.setHTML(ds.resultList[0][0].goal_rank?"영업부 상위 "+ds.resultList[0][0].goal_rank+"%":"");$.profitGrowthRank.setHTML(ds.resultList[0][0].growth_rank?"영업부 상위 "+ds.resultList[0][0].growth_rank+"%":"")}else{if(officeQ!=""){target="영업소"}else{target="영업부"}}chart.addSeries({name:[target+" 성장률"],data:[{y:Number(ds.resultList[0][0].growth_rate),color:"#cbec47",title:target+" 성장률"}],color:"#cbec47",dataLabels:{enabled:true,format:Number(ds.resultList[0][0].growth_rate)+"%",style:{fontSize:"15px",fontWeight:"bold",color:"red"}}});chart.addSeries({name:[getTextDeptName()+" 평균 성장률"],data:[{y:Number(ds.resultList[0][0].growth_dept_rate),color:"#44d3c3",title:getTextDeptName()+" 평균 성장률"}],color:"#44d3c3",dataLabels:{enabled:true,format:Number(ds.resultList[0][0].growth_dept_rate)+"%",style:{fontSize:"15px",fontWeight:"bold"}}});var ih=[ds.resultList[0][0].goal_rate,ds.resultList[0][0].goal_dept_rate];setArrayLabelStyle([$.profitGoalDeptValue],21,"5D5D5D","center");setArrayLabelStyle([$.profitGoalVal],30,"5D5D5D","center");jQuery.each(ih,function(i,item){var itemFloor=Math.floor(item/10);var ihNum=0;var interValSetting=setInterval(function(){changeImage()},100);function changeImage(){ihNum++;var imgNum=ihNum;if(ihNum<itemFloor){}else{if(imgNum>=10){if(i==1){setArrayLabelStyle([$.profitGoalDeptValue],21,"DA1E48","center")}else{setArrayLabelStyle([$.profitGoalVal],30,"DA1E48","center")}imgNum=10}clearInterval(interValSetting)}var imgUrl=g_scriptPath+"/images/progress_"+imgNum+".png";if(i==1){$.profitGoalRateDept.setHTML("<img style='width: 135px; height: 135px;' src='"+imgUrl+"' />")}else{$.profitGoalRate.setHTML("<img style='width: 170px; height: 170px;' src='"+imgUrl+"' />")}}})}}}if(type=="Q_PROFIT"){if(ds!=null&&ds.resultList.length>0){if(ds.resultList[0]&&ds.resultList[0].length>0){if(ds.resultList[1]){var half_fr_ym=ds.resultList[1][0]["half_fr_ym"];var half_to_ym=ds.resultList[1][0]["half_to_ym"];var dispYmtxt="(기준: "+half_fr_ym.substr(2,2)+"년 "+half_fr_ym.substr(4,2)+"월 ~ "+half_to_ym.substr(2,2)+"년 "+half_to_ym.substr(4,2)+"월)";$.lblProfitDispYm.setText(dispYmtxt)}$.profitGoalValue.setValue(ds.resultList[0][0].tar);$.profitHalfGoalValue.setValue("("+ds.resultList[0][0].half_tar+")");$.profitValue.setValue(ds.resultList[0][0].res);$.profitTarDiffLblValue.setValue("("+ds.resultList[0][0].res_tar+")");$.profitBeforeValue.setValue(ds.resultList[0][0].pre_res);$.profitGoalVal.setValue(ds.resultList[0][0].goal_rate?ds.resultList[0][0].goal_rate+"%":"0%");$.profitGoalDeptValue.setValue(ds.resultList[0][0].goal_dept_rate+"%");var chart=$.profitChart.getChart();var deptQ=$.cbxDeptNameQ.getValue();var officeQ=$.cbxOfficeQ.getValue();var employeeQ=$.cbxEmployeeQ.getValue();var target="";if(employeeQ!=""){target="담당자";setArrayNoticeRank([$.profitGoalRank,$.profitGrowthRank]);$.profitGoalRank.setHTML(ds.resultList[0][0].goal_rank?"영업부 상위 "+ds.resultList[0][0].goal_rank+"%":"");$.profitGrowthRank.setHTML(ds.resultList[0][0].growth_rank?"영업부 상위 "+ds.resultList[0][0].growth_rank+"%":"")}else{if(officeQ!=""){target="영업소"}else{target="영업부"}}chart.addSeries({name:[target+" 성장률"],data:[{y:Number(ds.resultList[0][0].growth_rate),color:"#cbec47",title:target+" 성장률"}],color:"#cbec47",dataLabels:{enabled:true,format:Number(ds.resultList[0][0].growth_rate)+"%",style:{fontSize:"15px",fontWeight:"bold",color:"red"}}});chart.addSeries({name:[getTextDeptName()+" 평균 성장률"],data:[{y:Number(ds.resultList[0][0].growth_dept_rate),color:"#44d3c3",title:getTextDeptName()+" 평균 성장률"}],color:"#44d3c3",dataLabels:{enabled:true,format:Number(ds.resultList[0][0].growth_dept_rate)+"%",style:{fontSize:"15px",fontWeight:"bold"}}});var ih=[ds.resultList[0][0].goal_rate,ds.resultList[0][0].goal_dept_rate];setArrayLabelStyle([$.profitGoalDeptValue],21,"5D5D5D","center");setArrayLabelStyle([$.profitGoalVal],30,"5D5D5D","center");jQuery.each(ih,function(i,item){var itemFloor=Math.floor(item/10);var ihNum=0;var interValSetting=setInterval(function(){changeImage()},100);function changeImage(){ihNum++;var imgNum=ihNum;if(ihNum<itemFloor){}else{if(imgNum>=10){if(i==1){setArrayLabelStyle([$.profitGoalDeptValue],21,"DA1E48","center")}else{setArrayLabelStyle([$.profitGoalVal],30,"DA1E48","center")}imgNum=10}clearInterval(interValSetting)}var imgUrl=g_scriptPath+"/images/progress_"+imgNum+".png";if(i==1){$.profitGoalRateDept.setHTML("<img style='width: 135px; height: 135px;' src='"+imgUrl+"' />")}else{$.profitGoalRate.setHTML("<img style='width: 170px; height: 170px;' src='"+imgUrl+"' />")}}})}}loadingIdx++;closeLoading()}if(type=="Q_BUDGET"){if(ds!=null&&ds.resultList.length>0){var chartB=$.budgetChart.getChart();chartB.addSeries({name:"AM 계획금액",color:"#D8F175",stack:0,data:[{y:Number(ds.resultList[0][0].plan_amt),color:"#D8F175",title:"AM 계획금액"},{y:Number(ds.resultList[0][0].md_amt),color:"#69DAAF",title:"정책지원 사용금액"}]});var plan_ratio=(Number(ds.resultList[0][0].crm_use_amt)/Number(ds.resultList[0][0].plan_amt)*100).toFixed(0);if(plan_ratio=="NaN"){plan_ratio=0}if(plan_ratio=="Infinity"){plan_ratio=100}chartB.addSeries({name:"AM 사용금액",color:"#C3AFF6",stack:1,zIndex:1,pointPadding:0.3,data:[{y:Number(ds.resultList[0][0].crm_use_amt),y1:Number(ds.resultList[0][0].plan_amt),color:"#C3AFF6",title:"AM 사용금액"}],dataLabels:{enabled:true,format:plan_ratio+"%",style:{fontSize:"15px",fontWeight:"bold",color:"red"}}});chartB.addSeries({name:"정책지원 사용금액",color:"#69DAAF",stack:1,data:[],pointPadding:0.4,pointPlacement:-0.2});$.budgetCircleValue1.setValue(ds.resultList[0][0].md_detail);$.budgetCircleValue2.setValue(ds.resultList[0][0].crm_detail);$.budgetValue1.setValue(addComma(ds.resultList[0][0].mr_cnt));$.budgetValue2.setValue(addComma(ds.resultList[0][0].mr_dept_cnt))}$.budgetLbl2.setValue(getTextDeptName()+" 평균");loadingIdx++;closeLoading()}if(type=="Q_CONTACT"){if(ds!=null&&ds.resultList.length>0){var chartC=$.contactChart.getChart();$.contactValS.setValue(ds.resultList[0][0].contact_cnt||0);$.contactValK.setValue(ds.resultList[0][1].contact_cnt||0);$.contactValA.setValue(ds.resultList[0][2].contact_cnt||0);$.contactValG.setValue(ds.resultList[0][3].contact_cnt||0);$.contactValN.setValue(ds.resultList[0][4].contact_cnt||0);$.contactValTot.setValue(ds.resultList[0][5].contact_cnt||0);chartC.addSeries({name:["KCM 고객수"],data:[{x:"199",y:Number(ds.resultList[0][5].chart_contact_cnt),color:"#cbec47",title:"KCM 고객수"}],color:"#cbec47"});if(ds.resultList[1]&&ds.resultList[1].length>0){$.contactVal1.setValue(ds.resultList[1][0].dept_cnt);$.contactVal2.setValue(ds.resultList[1][0].sk_rate+"%");$.contactVal3.setValue(ds.resultList[1][0].sk_dept_rate+"%");chartC.addSeries({name:[getTextDeptName()+" 평균 고객수"],data:[{x:"200",y:Number(ds.resultList[1][0].dept_chart_cnt),color:"#44d3c3",title:getTextDeptName()+" 평균 고객수"}],color:"#44d3c3"})}}$.contactLbl1.setValue(getTextDeptName());$.contactLbl4.setValue(getTextDeptName());loadingIdx++;closeLoading()}if(type=="Q_CALL"){if(ds!=null&&ds.resultList.length>0){var chartD=$.callChart.getChart();var call_ratio=(Number(ds.resultList[0][0].exc_call)/Number(ds.resultList[0][0].res_call)*100).toFixed(0);if(call_ratio=="NaN"){call_ratio=0}chartD.addSeries({name:["반기목표 Call"],data:[{y:Number(ds.resultList[0][0].res_call),color:"#cbec47",title:"반기목표 Call"}],color:"#cbec47"});chartD.addSeries({name:["반기실행 Call"],data:[{y:Number(ds.resultList[0][0].exc_call),color:"#44d3c3",title:"반기실행 Call"}],color:"#44d3c3",dataLabels:{enabled:true,format:call_ratio+"%",style:{fontSize:"15px",fontWeight:"bold",color:"red"}}})}$.callVal1.setValue(ds.resultList[0][0].sk_cnt?addComma(ds.resultList[0][0].sk_cnt):"0");$.callVal2.setValue(ds.resultList[0][0].sk_rate?ds.resultList[0][0].sk_rate+"%":"0%");$.callVal3.setValue(ds.resultList[0][0].sk_dept_rate+"%");$.callVal4.setValue(ds.resultList[0][0].sk_dept_exc_rate+"%");$.callValS.setValue(ds.resultList[1][0].contact_cnt||0);$.callValK.setValue(ds.resultList[1][1].contact_cnt||0);$.callValA.setValue(ds.resultList[1][2].contact_cnt||0);$.callValG.setValue(ds.resultList[1][3].contact_cnt||0);$.callValN.setValue(ds.resultList[1][4].contact_cnt||0);$.callValTotal.setValue(ds.resultList[1][5].contact_cnt||0);$.callLbl5.setValue(getTextDeptName()+" 평균");$.callLbl7.setValue(getTextDeptName()+" 평균");loadingIdx++;closeLoading()}if(type=="Q_CODING"){if(ds!=null){fnSetData(ds)}loadingIdx++;closeLoading()}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(enable!="true"){return}searchLayout();chartLayout();if($.cbxDeptNameQ.getValue()==""){MessageBoxShow("본부/영업부를 선택하세요.");return}searchList()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteDeptNameQ"){var param=[];param.dept_code=$.varDeptCode;param.dept_name=$.bteDeptNameQ.getText();g_main.openPopup("popDept.html","popDept","부서 조회",305,495,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cbxDeptNameQ"){if(value=="S030"){var ds={resultList:[[{dept_code:"S030",dept_name:"SR영업소"}]]};$.cbxOfficeQ.clear();setComboBind([$.cbxOfficeQ],ds);$.cbxOfficeQ.setValue("S030");return}var strQuery=" and parent_dept_code = '"+$.cbxDeptNameQ.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0120",strQuery,"","");$.cbxOfficeQ.clear();setComboBind([$.cbxOfficeQ],ds)}if(id=="cbxOfficeQ"){var strQuery=" and dept_code = '"+$.cbxOfficeQ.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cbxEmployeeQ.clear();setComboBind([$.cbxEmployeeQ],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtCondition")&&value=="13"){searchList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnExcel"){var json=createJSON_Q("ED1");excelDownload(["req",json],"result_list.xlsx");return}}};$.fingerpopup_close=function(id){if(g_main.popShare!=null){var popResult=g_main.popShare;if(id=="popDept"){if($.popUpCallId=="bteDeptNameQ"){$.varDeptCode=popResult[0];$.bteDeptNameQ.setValue(popResult[1])}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>