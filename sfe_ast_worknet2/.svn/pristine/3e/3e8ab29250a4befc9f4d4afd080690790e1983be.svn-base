<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panFile=null;$.panDoc=null;$.panQuery=null;$.panList=null;$.panDetail=null;$.lblDate=null;$.lblDeptEmp=null;$.lblType=null;$.lblStatus=null;$.dteStart=null;$.dteEnd=null;$.cmbDept=null;$.cmbEmp=null;$.cmbRequestType=null;$.cmbStatus=null;$.chkMe=null;$.btnSearch=null;$.lblWave=null;$.grdList=null;$.tabDetail=null;$.panRequestForm=null;$.panProcForm=null;$.panConfirmForm=null;$.panTransForm=null;$.panApplyForm=null;$.btnViewWFDoc=null;$.btnSave=null;$.btnProc=null;$.btnProcConf=null;$.btnProcCancel=null;$.btnNew=null;$.btnNotConf=null;$.btnReqConf=null;$.btnConfCancel=null;$.panBtn=null;$.btnTranReq=null;$.btnTranConf=null;$.btnResultConf=null;$.btnProcFin=null;$.btnDel=null;$.btnApply=null;$.lblReqForm1=null;$.lblReqForm2=null;$.cmbReqForm1=null;$.txtReqForm1=null;$.wbeReqForm1=null;$.lblProcForm1=null;$.lblProcForm2=null;$.lblProcForm3=null;$.lblProcForm4=null;$.lblProcForm5=null;$.lblProcForm6=null;$.cmbProcForm1=null;$.dteProcForm1=null;$.txtProcForm1=null;$.txtProcForm2=null;$.memProcForm1=null;$.memProcForm2=null;$.btnProcForm1=null;$.panProcFormTop=null;$.lblConfirmForm1=null;$.cmbConfirmForm1=null;$.cmbConfirmForm2=null;$.memConfirmForm1=null;$.lblTransForm1=null;$.lblTransForm2=null;$.dteTransForm1=null;$.cmbTransForm1=null;$.cmbTransForm2=null;$.memTransForm1=null;$.lblApplyForm1=null;$.dteApplyForm1=null;$.memApplyForm1=null;$.chkConf=null;$.grdFile=null;$.grdDoc=null;$.varRequestId="";$.varWorkType="";$.varReason="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmSystemRequest_Q",[workType,$.dteStart.getValue()||"",$.dteEnd.getValue()||"",$.varRequestId||"",$.cmbRequestType.getValue()||"",$.cmbStatus.getValue()||"",$.cmbDept.getValue()||"",$.cmbEmp.getValue()||"","#UserID#"]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmSystemRequest_S",[workType,$.varRequestId||"",$.cmbReqForm1.getValue()||"","",$.cmbProcForm1.getValue()||"",$.dteProcForm1.getValue()||"",$.cmbConfirmForm2.getValue()||"",$.wbeReqForm1.getHTML()||"",$.wbeReqForm1.getHTML()||"",$.txtReqForm1.getValue()||"",$.txtProcForm1.getValue()||"",$.txtProcForm2.getValue()||"",$.memProcForm1.getValue()||"",$.memProcForm2.getValue()||"",$.memConfirmForm1.getValue()||"",$.dteTransForm1.getValue()||"",$.cmbTransForm1.getValue()||"",$.cmbTransForm2.getValue()||"",$.memTransForm1.getValue()||"",$.dteApplyForm1.getValue()||"",$.memApplyForm1.getValue()||"","#DeptCode#",$.varReason||"","N","","","","","",$.chkConf.getValue()||"N","","N","","","","","#UserID#"]);return json}function searchRequest(wt){var workType=wt||"";if(workType==""){if($.chkMe.getValue()=="Y"){workType="APPROVAL"}else{if(g_main.session.obj.SystemDeveloper=="Y"){workType="SYSTEM"}else{workType="Q"}}}var json=createJSON_Q(workType);callQuery(["req",json],(workType=="CONTENT"?"CONTENT":"Q"),$)}function saveRequest(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"N",$);if(workType=="N"){$.varRequestId=ds.returnStr}else{if(workType=="D"||workType=="CANCEL"||workType=="NOTCONF"){$.varRequestId=""}}clearControls();searchRequest()}}function clearControls(){$.panRequestForm.clear();$.panProcForm.clear();$.panProcFormTop.clear();$.panConfirmForm.clear();$.panTransForm.clear();$.panApplyForm.clear();$.wbeReqForm1.setValue("")}function controlsVisible(bool){$.btnViewWFDoc.setVisible(bool);$.btnSave.setVisible(bool);$.btnProc.setVisible(bool);$.btnProcConf.setVisible(bool);$.btnProcCancel.setVisible(bool);$.btnNew.setVisible(bool);$.btnNotConf.setVisible(bool);$.btnReqConf.setVisible(bool);$.btnConfCancel.setVisible(bool);$.btnTranReq.setVisible(bool);$.btnTranConf.setVisible(bool);$.btnResultConf.setVisible(bool);$.btnProcFin.setVisible(bool);$.btnDel.setVisible(bool);$.btnApply.setVisible(bool);if(bool){$.panFile.enableButton(["btnAdd","btnDelete"]);$.panDoc.enableButton(["btnAdd","btnDelete"])}else{$.panFile.disableButton(["btnAdd","btnDelete"]);$.panDoc.disableButton(["btnAdd","btnDelete"])}$.btnProcForm1.setEnable(bool);$.cmbReqForm1.setEnable(bool);$.txtReqForm1.setReadOnly(!bool);$.cmbProcForm1.setEnable(bool);$.dteProcForm1.setEnable(bool);$.cmbConfirmForm1.setEnable(bool);$.cmbConfirmForm2.setEnable(bool);$.dteTransForm1.setEnable(bool);$.cmbTransForm1.setEnable(bool);$.cmbTransForm2.setEnable(bool);$.dteApplyForm1.setEnable(bool);$.memProcForm2.setReadOnly(!bool);$.memConfirmForm1.setReadOnly(!bool);$.memTransForm1.setReadOnly(!bool);$.memApplyForm1.setReadOnly(!bool);$.chkConf.setVisible(bool);$.cmbReqForm1.setAllowBlank(false,"요청구분");$.txtReqForm1.setAllowBlank(false,"협의자/부서");$.cmbProcForm1.setAllowBlank(false,"처리자");$.dteProcForm1.setAllowBlank(false,"처리예정일");$.txtProcForm1.setAllowBlank(false,"이전소스파일명");$.txtProcForm2.setAllowBlank(false,"변경소스파일명");$.dteTransForm1.setAllowBlank(false,"이관일");$.cmbTransForm1.setAllowBlank(false,"이관자 부서");$.cmbTransForm2.setAllowBlank(false,"이관자");$.dteApplyForm1.setAllowBlank(false,"최종반영일")}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1120);$.panMain.setText("");$.panMain.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",690,555,510,255);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",690,820,510,255);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,80);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,90,1200,450);$.panList.setText("요청 내역");$.panList.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",0,555,680,530);$.panDetail.setText("요청 및 처리 내용");$.panDetail.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",0,10,100,20);$.lblDate.setText("요청기간");$.lblDeptEmp=new FingerLabel(host,"lblDeptEmp",405,10,100,20);$.lblDeptEmp.setText("요청부서/사원");$.lblType=new FingerLabel(host,"lblType",0,40,100,20);$.lblType.setText("요청구분");$.lblStatus=new FingerLabel(host,"lblStatus",405,40,100,20);$.lblStatus.setText("처리상태");$.dteStart=new FingerDateEdit(host,"dteStart",105,10,120,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",250,10,120,20);$.cmbDept=new FingerComboBox(host,"cmbDept",510,10,140,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",655,10,100,20);$.cmbRequestType=new FingerComboBox(host,"cmbRequestType",105,40,265,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",510,40,245,20);$.chkMe=new FingerCheckBox(host,"chkMe",800,25,140,20);$.chkMe.setText("본인 결재대상 조회");$.btnSearch=new FingerButton(host,"btnSearch",1120,45,80,20);$.btnSearch.setText("조회");$.lblWave=new FingerLabel(host,"lblWave",225,10,20,20);$.lblWave.setText("~");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,405);$.tabDetail=new FingerTab(host,"tabDetail",0,0,680,485);$.panRequestForm=new FingerPanel(host,"panRequestForm",0,0,820,553);$.panRequestForm.setText("");$.panRequestForm.setBottomLine(true);$.panProcForm=new FingerPanel(host,"panProcForm",0,0,820,553);$.panProcForm.setText("");$.panProcForm.setBottomLine(true);$.panConfirmForm=new FingerPanel(host,"panConfirmForm",0,0,820,553);$.panConfirmForm.setText("");$.panConfirmForm.setBottomLine(true);$.panTransForm=new FingerPanel(host,"panTransForm",0,0,820,553);$.panTransForm.setText("");$.panTransForm.setBottomLine(true);$.panApplyForm=new FingerPanel(host,"panApplyForm",0,0,820,553);$.panApplyForm.setText("");$.panApplyForm.setBottomLine(true);$.btnViewWFDoc=new FingerButton(host,"btnViewWFDoc",550,-37.5,130,20);$.btnViewWFDoc.setText("결재문서 보기");$.btnSave=new FingerButton(host,"btnSave",290,-37.5,120,20);$.btnSave.setText("저장");$.btnProc=new FingerButton(host,"btnProc",290,-37.5,120,20);$.btnProc.setText("처리");$.btnProcConf=new FingerButton(host,"btnProcConf",290,-37.5,120,20);$.btnProcConf.setText("처리승인");$.btnProcCancel=new FingerButton(host,"btnProcCancel",395,-37.5,100,20);$.btnProcCancel.setText("처리취소");$.btnNew=new FingerButton(host,"btnNew",205,-37.5,100,20);$.btnNew.setText("신규요청");$.btnNotConf=new FingerButton(host,"btnNotConf",480,-37.5,80,20);$.btnNotConf.setText("반려");$.btnReqConf=new FingerButton(host,"btnReqConf",290,-37.5,120,20);$.btnReqConf.setText("요청승인");$.btnConfCancel=new FingerButton(host,"btnConfCancel",290,-37.5,120,20);$.btnConfCancel.setText("승인취소");$.panBtn=new FingerPanel(host,"panBtn",0,0,1200,55);$.panBtn.setText("");$.panBtn.setBottomLine(true);$.btnTranReq=new FingerButton(host,"btnTranReq",290,-37.5,120,20);$.btnTranReq.setText("이관승인요청");$.btnTranConf=new FingerButton(host,"btnTranConf",290,-37.5,120,20);$.btnTranConf.setText("이관승인");$.btnResultConf=new FingerButton(host,"btnResultConf",290,-37.5,120,20);$.btnResultConf.setText("결과확인");$.btnProcFin=new FingerButton(host,"btnProcFin",290,-37.5,120,20);$.btnProcFin.setText("처리완료");$.btnDel=new FingerButton(host,"btnDel",290,-37.5,120,20);$.btnDel.setText("요청취소");$.btnApply=new FingerButton(host,"btnApply",290,-37.5,120,20);$.btnApply.setText("최종반영");$.lblReqForm1=new FingerLabel(host,"lblReqForm1",0,20,100,20);$.lblReqForm1.setText("요청구분");$.lblReqForm2=new FingerLabel(host,"lblReqForm2",0,55,100,20);$.lblReqForm2.setText("협의자/부서");$.cmbReqForm1=new FingerComboBox(host,"cmbReqForm1",105,20,240,20);$.txtReqForm1=new FingerEdit(host,"txtReqForm1",105,55,240,20);$.wbeReqForm1=new FingerWebEditor(host,"wbeReqForm1",0,95,680,320);$.lblProcForm1=new FingerLabel(host,"lblProcForm1",10,15,100,20);$.lblProcForm1.setText("처리자");$.lblProcForm2=new FingerLabel(host,"lblProcForm2",10,45,100,20);$.lblProcForm2.setText("처리예정일");$.lblProcForm3=new FingerLabel(host,"lblProcForm3",0,105,110,20);$.lblProcForm3.setText("이전소스 파일명");$.lblProcForm4=new FingerLabel(host,"lblProcForm4",0,135,110,20);$.lblProcForm4.setText("변경소스 파일명");$.lblProcForm5=new FingerLabel(host,"lblProcForm5",10,165,100,20);$.lblProcForm5.setText("프로시저변경");$.lblProcForm6=new FingerLabel(host,"lblProcForm6",10,300,100,20);$.lblProcForm6.setText("기타");$.cmbProcForm1=new FingerComboBox(host,"cmbProcForm1",115,15,160,20);$.dteProcForm1=new FingerDateEdit(host,"dteProcForm1",115,45,165,20);$.txtProcForm1=new FingerEdit(host,"txtProcForm1",115,105,250,20);$.txtProcForm2=new FingerEdit(host,"txtProcForm2",115,135,250,20);$.memProcForm1=new FingerMemoEdit(host,"memProcForm1",115,165,540,120);$.memProcForm2=new FingerMemoEdit(host,"memProcForm2",115,300,540,120);$.btnProcForm1=new FingerButton(host,"btnProcForm1",600,30,80,20);$.btnProcForm1.setText("변경");$.panProcFormTop=new FingerPanel(host,"panProcFormTop",0,0,680,85);$.panProcFormTop.setText("");$.panProcFormTop.setBottomLine(true);$.lblConfirmForm1=new FingerLabel(host,"lblConfirmForm1",0,30,100,20);$.lblConfirmForm1.setText("결과확인자");$.cmbConfirmForm1=new FingerComboBox(host,"cmbConfirmForm1",105,30,140,20);$.cmbConfirmForm2=new FingerComboBox(host,"cmbConfirmForm2",250,30,100,20);$.memConfirmForm1=new FingerMemoEdit(host,"memConfirmForm1",0,80,675,360);$.lblTransForm1=new FingerLabel(host,"lblTransForm1",0,10,100,20);$.lblTransForm1.setText("이관일");$.lblTransForm2=new FingerLabel(host,"lblTransForm2",0,40,100,20);$.lblTransForm2.setText("이관자");$.dteTransForm1=new FingerDateEdit(host,"dteTransForm1",105,10,140,20);$.cmbTransForm1=new FingerComboBox(host,"cmbTransForm1",105,40,140,20);$.cmbTransForm2=new FingerComboBox(host,"cmbTransForm2",250,40,100,20);$.memTransForm1=new FingerMemoEdit(host,"memTransForm1",0,80,675,360);$.lblApplyForm1=new FingerLabel(host,"lblApplyForm1",0,30,100,20);$.lblApplyForm1.setText("최종반영일");$.dteApplyForm1=new FingerDateEdit(host,"dteApplyForm1",105,30,140,20);$.memApplyForm1=new FingerMemoEdit(host,"memApplyForm1",0,80,675,360);$.chkConf=new FingerCheckBox(host,"chkConf",315,30,140,20);$.chkConf.setText("부서장 승인");$.grdFile=new FingerDataGrid(host,"grdFile",0,0,510,205);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,510,205);$.panQuery.setBorder(true);$.panProcFormTop.setBorder(true);$.panDetail.setBorder(false);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.dteStart.setValue("20140401");$.dteEnd.setValue("29991231");$.cmbRequestType.setEmptyRow(true,"");$.cmbStatus.setEmptyRow(true,"");$.cmbDept.setEmptyRow(true,"");$.cmbEmp.setEmptyRow(true,"");$.cmbEmp.setEnable(false);$.cmbReqForm1.setEmptyRow(true,"");$.cmbConfirmForm1.setEmptyRow(true,"");$.cmbConfirmForm2.setEmptyRow(true,"");$.cmbTransForm1.setEmptyRow(true,"");$.cmbTransForm2.setEmptyRow(true,"");$.cmbReqForm1.setAllowBlank(false,"요청구분");$.txtReqForm1.setAllowBlank(false,"협의자/부서");$.cmbProcForm1.setAllowBlank(false,"처리자");$.txtProcForm1.setAllowBlank(false,"이전소스파일명");$.txtProcForm2.setAllowBlank(false,"변경소스파일명");$.dteTransForm1.setAllowBlank(false,"이관일");$.cmbTransForm1.setAllowBlank(false,"이관자 부서");$.cmbTransForm2.setAllowBlank(false,"이관자");$.dteApplyForm1.setAllowBlank(false,"최종반영일");controlsVisible(false);$.btnNew.setVisible(true);colMap=$.grdList.setColumns([new FingerDataGridColumn("request_id",99,"left","string","업무협조아이디"),new FingerDataGridColumn("req_content2",150,"left","string","요청내용"),new FingerDataGridColumn("dept_code",99,"left","string","부서코드"),new FingerDataGridColumn("dept_name",100,"left","string","요청부서"),new FingerDataGridColumn("req_user",99,"left","string","요청사원"),new FingerDataGridColumn("req_user_name",90,"left","string","요청자"),new FingerDataGridColumn("req_time",99,"left","string","요청일",{format:"s_ymd"}),new FingerDataGridColumn("cooperate_dept",99,"left","string","협의자/부서"),new FingerDataGridColumn("req_proc_status",99,"left","string","처리상태코드"),new FingerDataGridColumn("req_proc_status_name",90,"left","string","처리상태"),new FingerDataGridColumn("req_conf_user1",99,"left","string","요청승인자1"),new FingerDataGridColumn("req_conf_user_name1",90,"left","string","요청승인1"),new FingerDataGridColumn("req_conf_time1",99,"left","string","요청승인일시1",{format:"s_ymd"}),new FingerDataGridColumn("req_conf_user2",99,"left","string","요청승인자2"),new FingerDataGridColumn("req_conf_user_name2",90,"left","string","요청승인2"),new FingerDataGridColumn("req_conf_time2",99,"left","string","요청승인일시2",{format:"s_ymd"}),new FingerDataGridColumn("proc_user",99,"left","string","처리담당자"),new FingerDataGridColumn("proc_user_name",90,"left","string","처리"),new FingerDataGridColumn("proc_date",100,"left","string","처리예정일"),new FingerDataGridColumn("proc_time",99,"left","string","처리일시"),new FingerDataGridColumn("proc_conf_user1",99,"left","string","처리승인자1"),new FingerDataGridColumn("proc_conf_user_name1",90,"left","string","처리승인1"),new FingerDataGridColumn("proc_time1",99,"left","string","처리승인일시1"),new FingerDataGridColumn("proc_conf_user2",99,"left","string","처리승인자2"),new FingerDataGridColumn("proc_conf_user_name2",90,"left","string","처리승인2"),new FingerDataGridColumn("proc_time2",99,"left","string","처리승인일시2"),new FingerDataGridColumn("proc_conf_user3",99,"left","string","처리승인자3"),new FingerDataGridColumn("proc_conf_user_name3",90,"left","string","처리승인3"),new FingerDataGridColumn("proc_time3",99,"left","string","처리승인일시3"),new FingerDataGridColumn("proc_fin_user",99,"left","string","처리완료자"),new FingerDataGridColumn("proc_fin_user_name",90,"left","string","처리완료"),new FingerDataGridColumn("proc_fin_time",99,"left","string","처리완료일시"),new FingerDataGridColumn("result_conf_user",99,"left","string","처리결과확인자"),new FingerDataGridColumn("result_conf_user_name",90,"left","string","결과확인"),new FingerDataGridColumn("result_conf_time",99,"left","string","처리결과확인일시"),new FingerDataGridColumn("tran_conf_user1",99,"left","string","이관승인자1"),new FingerDataGridColumn("tran_conf_user_name1",90,"left","string","이관승인1"),new FingerDataGridColumn("tran_conf_time1",99,"left","string","이관승인일시1"),new FingerDataGridColumn("tran_conf_user2",99,"left","string","이관승인자2"),new FingerDataGridColumn("tran_conf_user_name2",90,"left","string","이관승인2"),new FingerDataGridColumn("tran_conf_time2",99,"left","string","이관승인일시2"),new FingerDataGridColumn("apply_user",99,"left","string","이관처리자"),new FingerDataGridColumn("apply_user_name",90,"left","string","이관처리"),new FingerDataGridColumn("apply_time",99,"left","string","이관처리일시"),new FingerDataGridColumn("return_conf_user",99,"left","string","반려자"),new FingerDataGridColumn("return_conf_user_name",90,"left","string","반려/취소"),new FingerDataGridColumn("return_conf_time",99,"left","string","반려시간"),new FingerDataGridColumn("reason",99,"left","string","반려/취소 사유"),new FingerDataGridColumn("req_wf_doc_id",99,"left","string","결재문서"),new FingerDataGridColumn("request_type",99,"left","string","요청구분코드"),new FingerDataGridColumn("request_type_name",90,"left","string","요청구분")]);$.grdList.init({panel:$.panList,scroll:"xy",leftSplit:6,isFilter:false});$.grdList.setColumnHidden(["request_id","request_type","dept_code","req_user","req_time","cooperate_dept","req_proc_status","req_conf_user1","req_conf_time1","req_conf_user2","req_conf_time2","proc_user","proc_time","proc_conf_user1","proc_time1","proc_conf_user2","proc_time2","proc_conf_user3","proc_time3","proc_fin_user","proc_fin_time","proc_fin_time","result_conf_user","result_conf_time","tran_conf_user1","tran_conf_time1","tran_conf_user2","tran_conf_time2","apply_user","return_conf_user","apply_time","return_conf_user","return_conf_time","reason","req_wf_doc_id","request_type"],true);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",340,"left","string","파일명"),new FingerDataGridColumn("file_size",150,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panList);$.panMain.add($.panDetail);$.panMain.add($.panBtn);$.panMain.add($.panQuery);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.panQuery.add($.lblDate);$.panQuery.add($.lblDeptEmp);$.panQuery.add($.lblType);$.panQuery.add($.lblStatus);$.panQuery.add($.dteStart);$.panQuery.add($.dteEnd);$.panQuery.add($.cmbDept);$.panQuery.add($.cmbEmp);$.panQuery.add($.cmbRequestType);$.panQuery.add($.cmbStatus);$.panQuery.add($.chkMe);$.panQuery.add($.btnSearch);$.panQuery.add($.lblWave);$.panList.add($.grdList);$.panDetail.add($.tabDetail);$.panDetail.add($.btnViewWFDoc);$.panDetail.add($.btnSave);$.panDetail.add($.btnProc);$.panDetail.add($.btnProcConf);$.panDetail.add($.btnProcCancel);$.panDetail.add($.btnNew);$.panDetail.add($.btnNotConf);$.panDetail.add($.btnReqConf);$.panDetail.add($.btnConfCancel);$.panDetail.add($.btnTranReq);$.panDetail.add($.btnTranConf);$.panDetail.add($.btnResultConf);$.panDetail.add($.btnProcFin);$.panDetail.add($.btnDel);$.panDetail.add($.btnApply);$.panRequestForm.add($.lblReqForm1);$.panRequestForm.add($.lblReqForm2);$.panRequestForm.add($.cmbReqForm1);$.panRequestForm.add($.txtReqForm1);$.panRequestForm.add($.wbeReqForm1);$.panProcForm.add($.memProcForm2);$.panProcForm.add($.memProcForm1);$.panProcForm.add($.txtProcForm2);$.panProcForm.add($.txtProcForm1);$.panProcForm.add($.lblProcForm6);$.panProcForm.add($.lblProcForm5);$.panProcForm.add($.lblProcForm4);$.panProcForm.add($.lblProcForm3);$.panProcForm.add($.panProcFormTop);$.panConfirmForm.add($.lblConfirmForm1);$.panConfirmForm.add($.cmbConfirmForm1);$.panConfirmForm.add($.cmbConfirmForm2);$.panConfirmForm.add($.memConfirmForm1);$.panTransForm.add($.lblTransForm1);$.panTransForm.add($.lblTransForm2);$.panTransForm.add($.dteTransForm1);$.panTransForm.add($.cmbTransForm1);$.panTransForm.add($.cmbTransForm2);$.panTransForm.add($.memTransForm1);$.panApplyForm.add($.lblApplyForm1);$.panApplyForm.add($.dteApplyForm1);$.panApplyForm.add($.memApplyForm1);$.panProcFormTop.add($.lblProcForm1);$.panProcFormTop.add($.lblProcForm2);$.panProcFormTop.add($.cmbProcForm1);$.panProcFormTop.add($.dteProcForm1);$.panProcFormTop.add($.btnProcForm1);$.panProcFormTop.add($.chkConf);$.tabDetail.addTab([{text:"업무요청내용",body:$.panRequestForm},{text:"업무처리내용",body:$.panProcForm},{text:"확인요청내용",body:$.panConfirmForm},{text:"이관계획내용",body:$.panTransForm},{text:"최종반영내용",body:$.panApplyForm}]);$.cmbDept.setColumn("dept_code","dept_name");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbProcForm1.setColumn("employee_id","emp_name");$.cmbConfirmForm1.setColumn("dept_code","dept_name");$.cmbTransForm1.setColumn("dept_code","dept_name");$.cmbConfirmForm2.setColumn("employee_id","emp_name");$.cmbTransForm2.setColumn("employee_id","emp_name");var ds=bizComponentData2($,"Q1","L_CRM0102");setComboBind([$.cmbRequestType],ds);setComboBind([$.cmbReqForm1],ds);var ds=bizComponentData2($,"Q1","L_CRM0103");setComboBind([$.cmbStatus],ds);var ds=commCodeData2($,"Q","#DEPT_LIST#");setComboBind([$.cmbDept],ds)};$.callback=function(type,ds){if(type=="Q"){convertJavaDateToJs(ds.resultList);setDataGrid([$.grdList],ds);if(ds.resultList[0].length<=0){return}if($.varRequestId!=""){if($.grdList.getGridRowIndex("request_id",$.varRequestId)=="-1"){return}$.grdList.selectRow($.grdList.getGridRowIndex("request_id",$.varRequestId))}else{$.grdList.selectRow(0)}}else{if(type=="CONTENT"){var result=ds.resultList[0][0];result=convertRtfToHtml(result);result.procedure_chg_content=convertHtmlToPlain(result.procedure_chg_content);result.proc_content=convertHtmlToPlain(result.proc_content);result.confrim_req_content=convertHtmlToPlain(result.confrim_req_content);result.tran_plan_content=convertHtmlToPlain(result.tran_plan_content);result.apply_content=convertHtmlToPlain(result.apply_content);$.wbeReqForm1.setValue(result.req_content);$.memProcForm1.setValue(result.procedure_chg_content);$.memProcForm2.setValue(result.proc_content);$.memConfirmForm1.setValue(result.confrim_req_content);$.memTransForm1.setValue(result.tran_plan_content);$.memApplyForm1.setValue(result.apply_content);$.cmbReqForm1.setValue(result.request_type);$.txtReqForm1.setValue(result.cooperate_dept);$.cmbProcForm1.setValue(result.proc_user);$.dteProcForm1.setValue(result.proc_date);$.txtProcForm1.setValue(result.source_bfr);$.txtProcForm2.setValue(result.source_aft);$.cmbConfirmForm1.setValue(result.result_conf_dept);$.varConfrimForm1=result.result_conf_dept;$.cmbConfirmForm2.setValue(result.result_conf_user);$.dteTransForm1.setValue(result.tran_date);$.cmbTransForm1.setValue(result.apply_dept);$.varTransForm1=result.apply_dept;$.cmbTransForm2.setValue(result.apply_user);$.dteApplyForm1.setValue(result.apply_date)}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){clearControls();controlsVisible(false);$.varRequestId="";searchRequest()}else{if(id=="btnNew"){clearControls();controlsVisible(false);$.varWorkType="N";$.cmbReqForm1.setEnable(true);$.txtReqForm1.setReadOnly(false);$.wbeReqForm1.setReadOnly(false);$.btnNew.setVisible(true);$.btnSave.setVisible(true);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panDoc.enableButton(["btnAdd","btnDelete"]);$.cmbReqForm1.setAllowBlank(false,"요청구분");$.txtReqForm1.setAllowBlank(false,"협의자/부서");$.tabDetail.showTabPage(0)}else{if(id=="btnSave"){if(!validateControls([$.txtReqForm1,$.cmbReqForm1])){return}saveRequest($.varWorkType);$.chkMe.setValue("N");$.cmbStatus.setValue(g_main.session.obj.SystemDeveloper=="Y"?"00":"");searchRequest()}else{if(id=="btnProc"){confirmBoxShow("처리 하시겠습니까?",function(){if(g_main.msgShare==true){if(!validateControls([$.dteProcForm1,$.cmbProcForm1])){return}saveRequest("PROC")}})}else{if(id=="btnProcConf"){confirmBoxShow("처리승인 하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("PROCCONF")}})}else{if(id=="btnProcCancel"){$.popUpCallId="btnProcCancel";var param={};g_main.openPopup("popWFReason.html","popWFReason","사유",350,230,"","",param,"","")}else{if(id=="btnNotConf"){$.popUpCallId="btnNotConf";var param={};g_main.openPopup("popWFReason.html","popWFReason","사유",350,230,"","",param,"","")}else{if(id=="ReqConf"){confirmBoxShow("승인하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("REQCONF")}})}else{if(id=="btnConfCancel"){confirmBoxShow("승인을 취소하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("CONFCANCEL")}})}else{if(id=="btnTranReq"){if($.cmbProcForm1.getValue()==$.cmbTransForm2.getValue()){MessageBoxShow("처리자와 이관자를 다르게 선택해 주세요.");return}confirmBoxShow("이관승인을 요청하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("REQTRAN")}})}else{if(id=="btnTranConf"){confirmBoxShow("이관승인을 요청하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("TRANCONF")}})}else{if(id=="btnResultConf"){confirmBoxShow("결과를 확인하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("RESULTCONF")}})}else{if(id=="btnProcFin"){confirmBoxShow("처리완료 하시겠습니까?",function(){if(g_main.msgShare==true){if($.txtProcForm1.getValue()==""||$.txtProcForm2.getValue()==""){MessageBoxShow("소스정보를 입력해 주시기 바랍니다.");$.tabDetail.showTabPage(1);return}var rId=$.grdList.getGridRowIndex("request_id",$.varRequestId);if($.grdList.getValue(rId,"request_type")=="60"){$.cmbConfirmForm1.setAllowBlank(true,"결과확인 부서");$.cmbConfirmForm2.setAllowBlank(true,"결과확인자")}else{$.cmbConfirmForm1.setAllowBlank(false,"결과확인 부서");$.cmbConfirmForm2.setAllowBlank(false,"결과확인자")}if(!validateControls([$.cmbConfirmForm1,$.cmbConfirmForm2])){$.tabDetail.showTabPage(2);return}saveRequest("FINCONF")}})}else{if(id=="btnDel"){confirmBoxShow("선택한 업무협조요청을 취소 하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("D")}})}else{if(id=="btnApply"){confirmBoxShow("최종 반영하시겠습니까?",function(){if(g_main.msgShare==true){if(!validateControls([$.dteApplyForm1])){$.tabDetail.showTabPage(4);return}saveRequest("APPLY")}})}}}}}}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbStatus"){if(value=="00"){$.chkMe.setValue("N");$.chkMe.setEnable(false)}else{$.chkMe.setEnable(true)}}else{if(id=="cmbDept"){$.cmbEmp.clear();if(value==""){$.cmbEmp.setEnable(false);return}$.cmbEmp.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbEmp],ds)}else{if(id=="cmbConfirmForm1"){$.cmbConfirmForm2.clear();if(value==""){$.cmbConfirmForm2.setEnable(false);return}$.cmbConfirmForm2.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbConfirmForm2],ds)}else{if(id=="cmbTransForm1"){$.cmbTransForm2.clear();if(value==""){$.cmbTransForm2.setEnable(false);return}$.cmbTransForm2.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbTransForm2],ds)}}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id="grdList"){if($.grdList.getRowCount()<=0){return}clearControls();$.varWorkType="U";$.varRequestId=$.grdList.getValue(rId,"request_id");searchRequest("CONTENT");controlsVisible(false);var status=$.grdList.getValue(rId,"req_proc_status");var user=g_main.session.obj.UserID;var dept=g_main.session.obj.DetpCode;var systmeYn=g_main.session.obj.SystemDeveloper;if(status=="10"){if($.grdList.getValue(rId,"dept_code")=="A120"){$.btnNew.setVisible(true);$.btnProc.setVisible(true);$.dteProcForm1.setEnable(true);$.memProcForm2.setReadOnly(false)}else{if($.grdList.getValue(rId,"req_user")==user&&$.grdList.getValue(rId,"req_conf_time1")==""){$.btnNew.setVisible(true);$.btnSave.setVisible(true);$.btnDel.setVisible(true);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panDoc.enableButton(["btnAdd","btnDelete"]);$.cmbReqForm1.setEnable(true);$.txtReqForm1.setReadOnly(false);$.tabDetail.showTabPage(0)}else{if($.grdList.getValue(rId,"req_conf_user1")==user&&$.grdList.getValue(rId,"req_conf_time1")==""){$.btnNew.setVisible(true);$.btnReqConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(0)}else{if($.grdList.getValue(rId,"req_conf_user2")==user&&$.grdList.getValue(rId,"req_conf_time1")!=""&&$.grdList.getValue(rId,"req_conf_time2")==""){$.btnNew.setVisible(true);$.btnReqConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(0)}else{if($.grdList.getValue(rId,"req_conf_time1")!=""&&$.grdList.getValue(rId,"req_conf_time2")!=""&&systmeYn=="Y"){$.btnNew.setVisible(true);$.btnProc.setVisible(true);$.btnNotConf.setVisible(true);$.panFile.enableButton(["btnAdd","btnDelete"]);$.dteProcForm1.setEnable(true);$.cmbReqForm1.setEnable(true);$.memProcForm2.setReadOnly(false);if(user=="ka961015"){$.cmbProcForm1.setValue(user)}$.tabDetail.showTabPage(1)}else{$.btnNew.setVisible(true);$.tabDetail.showTabPage(0)}}}}}}else{if(status=="20"){if($.grdList.getValue(rId,"proc_conf_user1")==user&&$.grdList.getValue(rId,"proc_conf_time1")==""){$.btnNew.setVisible(true);$.btnProcConf.setVisible(true);$.btnNotConf.setVisible(true);$.memProcForm2.setReadOnly(false);$.chkConf.setVisible(true);$.tabDetail.showTabPage(1)}else{if($.grdList.getValue(rId,"proc_conf_user1")==user&&$.grdList.getVlaue(rId,"proc_conf_time1")!=""){$.btnNew.setVisible(true);$.btnConfCancel.setVisible(true)}else{if($.grdList.getValue(rId,"proc_conf_user2")==user&&$.grdList.getValue(rId,"proc_conf_time2")==""){$.btnNew.setVisible(true);$.btnProcConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(0)}else{if($.grdList.getValue(rId,"proc_conf_user3")==user&&$.grdList.getValue(rId,"proc_conf_time3")==""){$.btnNew.setVisible(true);$.btnProcConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(0)}else{if(systmeYn=="Y"&&$.grdList.getValue(rId,"proc_conf_time1")!=""&&$.grdList.getValue(rId,"proc_conf_user2")==""){$.btnNew.setVisible(true);$.btnProcFin.setVisible(true);$.btnNotConf.setVisible(true);$.memProcForm2.setReadOnly(false);$.cmbConfirmForm1.setEnable(true);$.cmbConfirmForm2.setEnable(true);$.memConfirmForm1.setReadOnly(false);$.memConfirmForm1.setValue("결과확인 바랍니다.");$.tabDetail.showTabPage(2)}else{if(systmeYn=="Y"&&$.grdList.getValue(rId,"proc_conf_time1")!=""&&($.grdList.getValue(rId,"proc_conf_user2")==""||$.grdList.getValue(rId,"proc_conf_time2")!="")&&($.grdList.getValue(rId,"proc_conf_user3")==""||$.grdList.getValue(rId,"proc_conf_time3")!="")){$.btnNew.setVisible(true);$.btnProcFin.setVisible(true);$.btnProcCancel.setVisible(true);$.memProcForm2.setReadOnly(false);$.cmbConfirmForm1.setEnable(true);$.cmbConfirmForm2.setEnable(true);$.memConfirmForm1.setReadOnly(false);$.memConfirmForm1.setValue("결과확인 바랍니다.");$.tabDetail.showTabPage(2)}else{$.btnNew.setVisible(true);$.tabDetail.showTabPage(2)}}}}}}}else{if(status=="30"){if($.grdList.getValue(rId,"result_conf_user")==user){$.btnNew.setVisible(true);$.btnResultConf.setVisible(true)}else{$.btnNew.setVisible(true)}$.tabDetail.showTabPage(2)}else{if(status=="40"){if($.grdList.getValue(rId,"proc_user")==user&&$.grdList.getValue(rId,"tran_conf_user1")==""){$.btnNew.setVisible(true);$.btnTranReq.setVisible(true);$.dteTransForm1.setEnable(true);$.cmbTransForm1.setEnable(true);$.cmbTransForm2.setEnable(true);$.memTransForm1.setReadOnly(false);$.memTransForm1.setValue("이관하도록 하겠습니다.");$.cmbTransForm1.setValue(dept);$.tabDetail.showTabPage(3)}else{if($.grdList.getValue(rId,"tran_conf_user1")==user&&$.grdList.getValue(rId,"tran_conf_time1")==""){$.btnNew.setVisible(true);$.btnTranConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(3)}else{if($.grdList.getValue(rId,"tran_conf_user2")==user&&$.grdList.getValue(rId,"tran_conf_time2")==""&&$.grdList.getValue(rId,"tran_conf_time1")!=""){$.btnNew.setVisible(true);$.btnTranConf.setVisible(true);$.btnNotConf.setVisible(true);$.tabDetail.showTabPage(3)}else{if(($.grdList.getValue(rId,"apply_user")==user||$.grdList.getValue(rId,"proc_user")==user)&&$.grdList.getValue(rId,"tran_conf_time1")!=""&&$.grdList.getValue(rId,"tran_conf_user2")==""){$.btnNew.setVisible(true);$.btnApply.setVisible(true);$.dteApplyForm1.setEnable(true);$.memApplyForm1.setReadOnly(false);$.memApplyForm1.setValue("최종 반영하였습니다.");$.tabDetail.showTabPage(4)}else{if($.grdList.getValue(rId,"apply_user")==user&&$.grdList.getValue(rId,"tran_conf_time1")!=""&&$.grdList.getValue(rId,"tran_conf_user2")!=""&&$.grdList.getValue(rId,"tran_conf_time2")!=""){$.btnNew.setVisible(true);$.btnApply.setVisible(true);$.dteApplyForm1.setEnable(true);$.memApplyForm1.setReadOnly(false);$.memApplyForm1.setValue("최종 반영하였습니다.");$.tabDetail.showTabPage(4)}else{$.btnNew.setVisible(true);$.tabDetail.showTabPage(3)}}}}}}else{if(status=="80"){$.btnNew.setVisible(true);$.tabDetail.showTabPage(0)}else{if($.grdList.getValue(rId,"req_wf_doc_id")!=null&&$.grdList.getValue(rId,"req_wf_doc_id")!=""){$.btnViewWFDoc.setVisible(true)}else{$.btnViewWFDoc.setVisible(false)}$.btnNew.setVisible(true);$.tabDetail.showTabPage(0)}}}}}if(systmeYn=="Y"){$.btnProcCancel.setVisible(true)}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popWFReason"){if($.popUpCallId=="btnProcCancel"){if(popResult.reason){$.varReason=popResult.reason;confirmBoxShow("해당 건을 취소하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("CANCEL")}})}}else{if($.popUpCallId=="btnNotConf"){if(popResult.reason){$.varReason=popResult.reason;confirmBoxShow("반려하시겠습니까?",function(){if(g_main.msgShare==true){saveRequest("NOTCONF")}})}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){if(id=="tabDetail"){switch(tabid){case"1":var ds=commCodeData2($,"Q","#EMP_LIST#","","","","a.dept_code = ''D130'' and a.employee_id <> (SELECT dept_leader FROM crmDepartment WHERE dept_code = ''D130'')");setComboBind([$.cmbProcForm1],ds);break;case"2":var ds=commCodeData2($,"Q","#DEPT_LIST#");setComboBind([$.cmbConfirmForm1],ds);if($.varConfirmForm1!=""){var ds=commCodeData2($,"Q","#EMP_LIST#",$.varConfirmForm1);setComboBind([$.cmbConfirmForm2],ds)}break;case"3":var ds=commCodeData2($,"Q","#DEPT_LIST#");setComboBind([$.cmbTransForm1],ds);if($.varTransForm1!=""){var ds=commCodeData2($,"Q","#EMP_LIST#",$.varTransForm1);setComboBind([$.cmbTransForm2],ds)}break}}};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){}};</script>