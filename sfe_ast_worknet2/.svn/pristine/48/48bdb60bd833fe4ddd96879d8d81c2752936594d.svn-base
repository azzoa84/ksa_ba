<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMaster=null;$.grdMaster=null;$.panInfo=null;$.panDetail=null;$.grdDetail=null;$.lbl_ymdyyyy=null;$.dte_ymdyyyy=null;$.lbl_apply_date=null;$.dte_apply_start_date=null;$.lbl_Ex1=null;$.dte_apply_end_date=null;$.lbl_memo=null;$.txt_memo=null;$.initRow=false;$.dteEnbaleChk=false;$.stryyyy="";$.deleteRows=[];function createJson_Q(workType){var json=createExecuteParamInfo("HR..P_HRB6300_Q",[workType,$.dte_ymdyyyy.getValue()||""]);return json}function createJson_S(workType){var json=createExecuteParamInfo("HR..P_HRB6300_S",[workType,$.dte_ymdyyyy.getValue(),$.dte_apply_start_date.getValue(),$.dte_apply_end_date.getValue(),$.txt_memo.getValue()||"","#UserID#","#HostInfo#"]);return json}function createJson_S1(workType){var json;var gRow=$.grdDetail.getChangedRows();if($.deleteRows.length>0){for(var i in $.deleteRows){gRow.push($.deleteRows[i])}}if(gRow.length<1){return false}var rows=[];for(var i in gRow){workType=gRow[i].rowType;rows.push([workType,$.dte_ymdyyyy.getValue(),Number(gRow[i].pay_amt_fr)||0,Number(gRow[i].pay_amt_to)||0,Number(gRow[i].tax_rate)||0,Number(gRow[i].cumulative_tax_ded_amt)||0,"#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRB6300_S1",rows);return json}function searchHRB6300(workType){var json=createJson_Q(workType);callQuery(["req",json],workType,$)}function saveHRB6300_S(workType){if(!$.panInfo.validateControls()){return}var json=createJson_S(workType);callExecute(["req",json],workType,$)}function saveHRB6300_S1(workType){if(!$.panInfo.validateControls()){return}var json=createJson_S1(workType);if(json){callExecute(["req",json],workType,$)}else{MessageBoxShow($.msg);$.initRow=true;saveButton(false);searchHRB6300("MASTER")}}function newClick(){$.grdDetail.clear();$.panInfo.clear();$.dte_ymdyyyy.setEnable(true);$.dteEnbaleChk=true;$.dte_ymdyyyy.setFocus();$.deleteRows=[]}function saveClick(){var strStatus="";if($.dteEnbaleChk){strStatus="N"}else{strStatus="U"}saveHRB6300_S(strStatus)}function saveButton(bo){if(bo){$.panInfo.enableButton(["btnSave"])}else{$.panInfo.disableButton(["btnSave"])}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,645);$.panMain.setText("");$.panMain.setBottomLine(true);$.panMaster=new FingerPanel(host,"panMaster",0,0,350,635);$.panMaster.setText("기준년도별 종합소득세율");$.panMaster.setBottomLine(true);$.grdMaster=new FingerDataGrid(host,"grdMaster",0,0,350,590);$.panInfo=new FingerPanel(host,"panInfo",360,0,840,155);$.panInfo.setText("종합 소득세율 기본 정보");$.panInfo.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",360,165,840,470);$.panDetail.setText("종합소득세율 정보");$.panDetail.setBottomLine(true);$.grdDetail=new FingerDataGrid(host,"grdDetail",0,0,840,425);$.lbl_ymdyyyy=new FingerLabel(host,"lbl_ymdyyyy",0,10,100,20);$.lbl_ymdyyyy.setText("기준년도");$.dte_ymdyyyy=new FingerDateEdit(host,"dte_ymdyyyy",105,10,140,20);$.lbl_apply_date=new FingerLabel(host,"lbl_apply_date",0,40,100,20);$.lbl_apply_date.setText("적용기간");$.dte_apply_start_date=new FingerDateEdit(host,"dte_apply_start_date",105,40,140,20);$.lbl_Ex1=new FingerLabel(host,"lbl_Ex1",245,40,20,20);$.lbl_Ex1.setText("~");$.dte_apply_end_date=new FingerDateEdit(host,"dte_apply_end_date",270,40,140,20);$.lbl_memo=new FingerLabel(host,"lbl_memo",0,70,100,20);$.lbl_memo.setText("메모");$.txt_memo=new FingerEdit(host,"txt_memo",105,70,715,20);$.panInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panDetail.addButtons(["btnDelete","btnAdd"]);$.dte_ymdyyyy.setDateFormat("yyyy");$.dte_ymdyyyy.setAllowBlank(false,"기준년도");$.dte_apply_start_date.setAllowBlank(false,"적용기간 시작일");$.dte_apply_end_date.setAllowBlank(false,"적용기간 종료일");$.grdMaster.colIdx=$.grdMaster.setColumns([new FingerDataGridColumn("yyyy",83,"left","string","기준년도"),new FingerDataGridColumn("apply_start_date",125,"left","string","적용시작일",{format:"s_ymd"}),new FingerDataGridColumn("apply_end_date",125,"left","string","적용종료일",{format:"s_ymd"}),new FingerDataGridColumn("memo",0,"left","string","메모",{hidden:true})]);$.grdMaster.init();$.grdMaster.setEditable(false);$.grdMaster.setBorder(false);$.grdDetail.colIdx=$.grdDetail.setColumns([new FingerDataGridColumn("pay_amt_fr",220,"right","int",[{text:"과세표준하한(초과)",css:"col_chk"}],{format:"int"}),new FingerDataGridColumn("pay_amt_to",220,"right","int",[{text:"과세표준상한(이하)",css:"col_chk"}],{format:"int"}),new FingerDataGridColumn("tax_rate",163,"right","int","과세율(%)",{format:"number"}),new FingerDataGridColumn("cumulative_tax_ded_amt",220,"right","int","누진공제액",{format:"int"})]);$.grdDetail.init({eventCellReadOnly:true});$.grdDetail.setEditable(true);$.grdDetail.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMaster);$.panMain.add($.panInfo);$.panMain.add($.panDetail);$.panMaster.add($.grdMaster);$.panInfo.add($.lbl_ymdyyyy);$.panInfo.add($.dte_ymdyyyy);$.panInfo.add($.lbl_apply_date);$.panInfo.add($.dte_apply_start_date);$.panInfo.add($.lbl_Ex1);$.panInfo.add($.dte_apply_end_date);$.panInfo.add($.lbl_memo);$.panInfo.add($.txt_memo);$.panDetail.add($.grdDetail);relocateChildIndexInPanel([$.panInfo]);saveButton(false);searchHRB6300("MASTER")};$.callback=function(type,ds){if(type=="MASTER"){setDataGrid([$.grdMaster],ds);if($.grdMaster.getRowCount()<1){newClick()}else{var rIndex=0;if($.initRow){rIndex=$.grdMaster.getGridRowIndex("yyyy",$.stryyyy)}$.grdMaster.selectRow(rIndex)}$.deleteRows=[];$.initRow=false}else{if(type=="DETAIL"){setDataGrid([$.grdDetail],ds);$.grdDetail.selectRow(0);$.dte_ymdyyyy.setEnable(false);$.dteEnbaleChk=false;var grdRow=$.grdDetail.getAllRows();for(var i in grdRow){grdRow[i].pay_amt_fr_readonly=true;grdRow[i].pay_amt_to_readonly=true}}else{if(type=="N"||type=="U"||type=="D"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0004"){$.msg="정상적으로 수정되었습니다.";$.stryyyy=$.dte_ymdyyyy.getValue();saveHRB6300_S1("")}else{if(ds.errorCode=="MSG0002"){$.msg="정상적으로 등록되었습니다.";$.stryyyy=$.dte_ymdyyyy.getValue();saveHRB6300_S1("")}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제되었습니다.");searchHRB6300("MASTER")}}}}}}else{if(type==""){if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}}MessageBoxShow($.msg);$.initRow=true;saveButton(false);searchHRB6300("MASTER")}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){saveButton(true)};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdMaster"){$.deleteRows=[];$.dte_ymdyyyy.setValue($.grdMaster.getValue(rId,"yyyy"));$.dte_apply_start_date.setValue(getFormatDate($.grdMaster.getValue(rId,"apply_start_date"),"yyyyMMdd"));$.dte_apply_end_date.setValue(getFormatDate($.grdMaster.getValue(rId,"apply_end_date"),"yyyyMMdd"));$.txt_memo.setValue($.grdMaster.getValue(rId,"memo"));saveButton(false);searchHRB6300("DETAIL")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdDetail"){saveButton(true);if(cInd=="tax_rate"){if(Number(nValue)<0||Number(nValue)>100){MessageBoxShow("숫자가 유효한 범위를 벗어났습니다.</br>(0 <= Value <= 100)");$.grdDetail.setValue(rId,cInd,oValue);return}}var inputData=nValue.toString();if(inputData.trim()==""||isNaN(inputData)){$.grdDetail.setValue(rId,cInd,oValue)}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){saveButton(true)};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnSave"){confirmBoxShow("저장하시겠습니까?",function(){if(g_main.msgShare==true){saveClick()}})}else{if(btnId=="btnNew"){newClick()}else{if(btnId=="btnDelete"){confirmBoxShow("["+$.dte_ymdyyyy.getValue()+"] 정보를 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveHRB6300_S("D")}})}}}}else{if(panelId=="panDetail"){if(btnId=="btnAdd"){$.grdDetail.addRow({pay_amt_fr:0,pay_amt_to:0,tax_rate:0,cumulative_tax_ded_amt:0});saveButton(true)}else{if(btnId=="btnDelete"){var rId=$.grdDetail.getSelectedRowIdx();if(!rId){return}if($.grdDetail.getRowStatus(rId)!="N"){confirmBoxShow("정말 삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdDetail.getItem(rId).rowType="D";$.deleteRows.push($.grdDetail.getValue(rId));$.grdDetail.deleteCurrentRow();saveButton(true)}})}else{$.grdDetail.deleteCurrentRow()}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popProductList"){if($.popUpCallId=="grdList"){$.grdList.setValue($.varRowIdx,"product_name",popResult.product_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>