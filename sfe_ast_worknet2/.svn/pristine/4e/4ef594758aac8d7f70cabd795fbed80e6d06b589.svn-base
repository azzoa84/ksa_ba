<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panFile=null;$.grdFile=null;$.btnConfirm=null;$.btnCancel=null;$.memcp_descr=null;$.btnMemoSave=null;$.panContact=null;$.grdContact=null;$.btnAdd=null;$.btnDel=null;$.lblcp_id=null;$.txtcp_id=null;$.lblcp_emp_id=null;$.cmbcp_emp_id=null;$.lblemployee_pm=null;$.cmbemployee_pm=null;$.cmbStatus=null;$.lblcp_lect_title=null;$.txtcp_lect_title=null;$.lblcp_lect_date=null;$.dtecp_lect_date=null;$.lblcp_place=null;$.txtcp_place=null;$.lblcp_lect_target=null;$.memcp_lect_target=null;$.lbllect_type=null;$.cmblect_type=null;$.lblcp_total=null;$.specp_total=null;$.lblcp_lect_cnt=null;$.txtcp_lect_cnt=null;$.lblTxt1=null;$.lblcp_lect_company=null;$.txtcp_lect_company=null;$.lblapp_date=null;$.dteapp_date=null;$.txtbefore_cp_id=null;$.txtcp_code=null;$.txtwf_doc_id=null;$.txtcp_doc_no=null;$.panBottom=null;$.btnMAConfirm=null;$.btnMACancel=null;$.lbletc_descr=null;$.memoetc_descr=null;$.lblMatch=null;$.bteMatch=null;$.btnMatch=null;$.btnView=null;$.lblcp_lect_target2=null;$.btnViewBfCP=null;$.bAllReport=false;$.bMyReport=false;$.bConfirm=false;$.bSave=false;$.errorCode;$.cp_code="";function createJson_Q(workType){var json=createExecuteParamInfo("P_crmCPSeminarStayAfter_Q",[workType,$.bteMatch.getValue(),""]);return json}function createJson_Q1(workType){var json=createExecuteParamInfo("P_crmCPSeminarAfter_Q",[workType,$.bteMatch.getValue(),""]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.cp_code]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.txtbefore_cp_id.getValue()])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.txtbefore_cp_id.getValue(),"#UserID#"])}return json}function createJson_S1(workType){var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if(workType=="N"||workType=="U"||workType=="NT"||workType=="UT"){if($.grdFile.getSelectedRowIdx()&&$.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}}var json=createExecuteParamInfo("P_crmCPLecture_S",[workType,$.txtcp_id.getValue()||"",$.txtcp_doc_no.getValue()||"","#DeptCode#",$.cmbcp_emp_id.getValue(),$.cmbemployee_pm.getValue(),"","","","",$.txtcp_lect_title.getValue(),$.dtecp_lect_date.getValue(),$.txtcp_place.getValue(),$.memcp_lect_target.getValue(),$.memoetc_descr.getValue(),$.txtcp_lect_company.getValue(),$.cmblect_type.getValue(),$.txtcp_lect_cnt.getValue(),Number($.specp_total.getValue()),$.bteMatch.getValue(),$.dteapp_date.getValue(),"CP05",$.txtwf_doc_id.getValue()||"",$.dteapp_date.getValue(),"#UserID#",strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname,$.txtbefore_cp_id.getValue()||""]);return json}function createJson_S2(workType){var rows=[];for(var i=0;i<$.grdContact.getRowCount();i++){rows.push([workType,$.txtcp_id.getValue(),$.grdContact.getValue(i,"contact_id"),$.grdContact.getValue(i,"company_id"),$.grdContact.getValue(i,"cp_emp_id"),getFormatDate($.grdContact.getValue(i,"cp_lect_date"),"yyyyMMdd").substring(0,8),$.grdContact.getValue(i,"cp_lect_subject1"),Number($.grdContact.getValue(i,"cp_lect_amt")),$.grdContact.getValue(i,"cp_HH_fr"),$.grdContact.getValue(i,"cp_MM_fr"),$.grdContact.getValue(i,"cp_HH_to"),$.grdContact.getValue(i,"cp_MM_to"),$.grdContact.getValue(i,"cp_HH"),$.grdContact.getValue(i,"cp_MM"),$.grdContact.getValue(i,"agenda"),$.grdContact.getValue(i,"cp_desc"),$.grdContact.getValue(i,"cp_desc2"),$.grdContact.getValue(i,"cp_lect_subject2"),$.grdContact.getValue(i,"cp_choice_desc"),Number($.grdContact.getValue(i,"contact_cnt")),Number($.grdContact.getValue(i,"contact_cnt2"))||0,($.grdContact.getValue(i,"cp_picture1")||$.grdContact.getValue(i,"cp_picture1")!=""?$.grdContact.getValue(i,"cp_picture1").split(",")[1]:""),($.grdContact.getValue(i,"cp_picture2")||$.grdContact.getValue(i,"cp_picture2")!=""?$.grdContact.getValue(i,"cp_picture2").split(",")[1]:""),($.grdContact.getValue(i,"cp_picture3")||$.grdContact.getValue(i,"cp_picture3")!=""?$.grdContact.getValue(i,"cp_picture3").split(",")[1]:""),$.grdContact.getValue(i,"trans_yn"),$.grdContact.getValue(i,"stay_yn"),$.grdContact.getValue(i,"meal_yn"),Number($.grdContact.getValue(i,"trans_amt")),Number($.grdContact.getValue(i,"stay_amt")),Number($.grdContact.getValue(i,"meal_amt")),$.grdContact.getValue(i,"lect_bank_account")])}var json=createExecuteParamInfo("P_crmCPLecturer_S_B64",rows);return json}function saveCPLecture(workType){if(workType!="D"){if(!validateControls([$.cmblect_type,$.txtcp_lect_company,$.memcp_lect_target,$.txtcp_lect_title,$.txtcp_lect_title,$.txtcp_lect_cnt])){return}}else{if($.txtcp_doc_no.getValue()==""){MessageBoxShow("삭제시 CP문서 번호는 필수 항목입니다.");return}}if(workType=="N"||workType=="U"){if(!$.grdContact.getSelectedRowIdx()){MessageBoxShow("강연자가 없습니다.");return}if($.grdFile.getRowCount()<1){MessageBoxShow("강연역 계약서, Agenda, 개인정보 동의서는 필수 첨부 파일입니다.");return}else{var check1="";var check2="";var check3="";if($.cmblect_type.getValue()=="50"){for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="014"){check1="014"}else{if($.grdFile.getValue(i,"file_type")=="007"){check2="007"}else{if($.grdFile.getValue(i,"file_type")=="036"){check3="036"}}}if(check1=="014"&&check2=="007"&&check3=="036"){break}}if(check1!="014"||check2!="007"||check3!="036"){MessageBoxShow("강연역 계약서, Agenda, 개인정보 동의서는 필수 첨부 파일입니다.");return}}else{if($.cmblect_type.getValue()=="60"){for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="007"){check2="007"}else{if($.grdFile.getValue(i,"file_type")=="036"){check3="036"}}if(check2=="007"&&check3=="036"){break}}if(check2!="007"||check3!="036"){MessageBoxShow("강연역 계약서, 개인정보 동의서는 필수 첨부 파일입니다.");return}}}}}var json=createJson_S1(workType);callExecute(["req",json],"LECTURE",$)}function saveCPLecturer(workType){var json=createJson_S2(workType);$.workType=workType;callExecute(["req",json],"LECTURER",$)}function newClick(){$.panQuery.clear();$.grdContact.clear();$.grdFile.clear();$.memcp_descr.setValue("");$.memcp_descr.setReadOnly(true);$.panQuery.enableButton(["btnLoad","btnDelete","btnTemp","btnSave","btnNew"]);$.panFile.enableButton(["btnDelete","btnAdd"]);$.panBottom.setVisible(false);fnEnableSet(true);$.txtcp_id.setValue("");$.txtbefore_cp_id.setValue("");$.cmbStatus.setValue("10");$.panBottom.setVisible(false);$.panQuery.disableButton(["btnDelete"]);$.btnAdd.setText("추가");$.cmbcp_emp_id.setValue(g_main.session.obj.EmpCode);$.cmbemployee_pm.setValue("");$.dteapp_date.setValue(getToday(""));$.cmbemployee_pm.setFocus();var subQuery=" and sub_code in('50','60','70','80','90','95')";var ds3=bizComponentData2($,"Q4","L_CRM0144",subQuery);$.cmblect_type.setColumn("sub_code","code_name");setComboBind([$.cmblect_type],ds3);$.cmblect_type.setValue("50");$.txtcp_lect_title.setMaxLength(50);$.txtcp_lect_title.setPlaceholder("50자 이내로 입력하시기 바랍니다.")}function saveClick(){if(!$.txtbefore_cp_id.getValue()){MessageBoxShow("사전 데이터가 없습니다.");return}saveCPLecture($.txtcp_id.getValue()==""?"N":"U")}function deleteClick(){if($.txtcp_id.getValue()==""){return}confirmBoxShow("["+$.txtcp_doc_no.getValue()+"] 강연을 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCPLecture("D")}})}function tmpSave(){if($.txtbefore_cp_id.getValue()==""){MessageBoxShow("사전 데이터가 없습니다.");return}saveCPLecture($.txtcp_id.getValue()==""?"NT":"UT")}function fnEnableSet(bo){if(bo){$.panQuery.enableButton(["btnDelete","btnSave","btnTemp"]);$.panFile.enableButton(["btnAdd","btnDelete"])}else{$.panQuery.disableButton(["btnDelete","btnSave","btnTemp"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.grdFile.setEditable(bo);if(!bo){$.btnAdd.setText("상세보기")}$.btnDel.setEnable(bo);$.cmbemployee_pm.setEnable(bo);$.txtcp_lect_title.setReadOnly(!bo);$.dtecp_lect_date.setEnable(bo);$.txtcp_place.setReadOnly(!bo);$.memcp_lect_target.setReadOnly(!bo);$.cmblect_type.setEnable(bo);$.txtcp_lect_company.setReadOnly(!bo);$.txtcp_lect_cnt.setReadOnly(!bo);$.memoetc_descr.setReadOnly(!bo)}function fnTotalamtSet(){var cp_lect_amt=0;if($.grdContact.getRowCount()>0){for(var i=0;i<$.grdContact.getRowCount();i++){cp_lect_amt+=Number($.grdContact.getValue(i,"cp_lect_amt"))}}$.specp_total.setValue(cp_lect_amt)}function getObjectDate(objDate){var year=parseInt(objDate.year)+1900;var month=parseInt(objDate.month)+1;var date=objDate.date;if(parseInt(month)<10){month="0"+month}if(parseInt(date)<10){date="0"+date}return year+""+month+""+date}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}function searchCPSeminarStayAfter(workType){var json=createJson_Q(workType);callExecute(["req",json],"LIST1",$)}function searchCPSeminarAfter(workType){var json=createJson_Q1(workType);callExecute(["req",json],"LIST2",$)}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1020);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,335);$.panQuery.setText("강연(사후)");$.panQuery.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,605,1200,280);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,235);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.memcp_descr=new FingerMemoEdit(host,"memcp_descr",125,915,845,90);$.btnMemoSave=new FingerButton(host,"btnMemoSave",995,5,90,95);$.btnMemoSave.setText("메모저장");$.panContact=new FingerPanel(host,"panContact",0,345,1200,250);$.panContact.setText("강연자");$.panContact.setBottomLine(true);$.grdContact=new FingerDataGrid(host,"grdContact",0,0,1200,205);$.btnAdd=new FingerButton(host,"btnAdd",1040,-40,95,30);$.btnAdd.setText("추가");$.btnDel=new FingerButton(host,"btnDel",1120,-40,95,30);$.btnDel.setText("삭제");$.lblcp_id=new FingerLabel(host,"lblcp_id",0,10,100,20);$.lblcp_id.setText("문서번호");$.txtcp_id=new FingerEdit(host,"txtcp_id",105,10,140,20);$.lblcp_emp_id=new FingerLabel(host,"lblcp_emp_id",380,10,100,20);$.lblcp_emp_id.setText("담당자");$.cmbcp_emp_id=new FingerComboBox(host,"cmbcp_emp_id",485,10,140,20);$.lblemployee_pm=new FingerLabel(host,"lblemployee_pm",705,10,100,20);$.lblemployee_pm.setText("P   M");$.cmbemployee_pm=new FingerComboBox(host,"cmbemployee_pm",810,10,140,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",1000,10,140,20);$.lblcp_lect_title=new FingerLabel(host,"lblcp_lect_title",0,40,100,20);$.lblcp_lect_title.setText("강연행사명");$.txtcp_lect_title=new FingerEdit(host,"txtcp_lect_title",105,40,845,20);$.lblcp_lect_date=new FingerLabel(host,"lblcp_lect_date",0,70,100,20);$.lblcp_lect_date.setText("강연일");$.dtecp_lect_date=new FingerDateEdit(host,"dtecp_lect_date",105,70,140,20);$.lblcp_place=new FingerLabel(host,"lblcp_place",380,70,100,20);$.lblcp_place.setText("강연장소");$.txtcp_place=new FingerEdit(host,"txtcp_place",485,70,465,20);$.lblcp_lect_target=new FingerLabel(host,"lblcp_lect_target",0,110,100,20);$.lblcp_lect_target.setText("강연주제");$.memcp_lect_target=new FingerMemoEdit(host,"memcp_lect_target",105,100,840,60);$.lbllect_type=new FingerLabel(host,"lbllect_type",0,220,100,20);$.lbllect_type.setText("강연유형");$.cmblect_type=new FingerComboBox(host,"cmblect_type",105,220,250,20);$.lblcp_total=new FingerLabel(host,"lblcp_total",385,220,100,20);$.lblcp_total.setText("지급총액");$.specp_total=new FingerSpinEdit(host,"specp_total",490,220,140,20);$.lblcp_lect_cnt=new FingerLabel(host,"lblcp_lect_cnt",0,250,100,20);$.lblcp_lect_cnt.setText("강연자수");$.txtcp_lect_cnt=new FingerEdit(host,"txtcp_lect_cnt",105,250,140,20);$.lblTxt1=new FingerLabel(host,"lblTxt1",245,250,25,20);$.lblTxt1.setText("명");$.lblcp_lect_company=new FingerLabel(host,"lblcp_lect_company",385,250,100,20);$.lblcp_lect_company.setText("기관(수)");$.txtcp_lect_company=new FingerEdit(host,"txtcp_lect_company",490,250,140,20);$.lblapp_date=new FingerLabel(host,"lblapp_date",700,250,100,20);$.lblapp_date.setText("승인요청일");$.dteapp_date=new FingerDateEdit(host,"dteapp_date",805,250,145,20);$.txtbefore_cp_id=new FingerEdit(host,"txtbefore_cp_id",1000,60,140,20);$.txtcp_code=new FingerEdit(host,"txtcp_code",1000,90,140,20);$.txtwf_doc_id=new FingerEdit(host,"txtwf_doc_id",1000,120,140,20);$.txtcp_doc_no=new FingerEdit(host,"txtcp_doc_no",1000,150,140,20);$.panBottom=new FingerPanel(host,"panBottom",0,910,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1080,5,120,40);$.btnMAConfirm.setText("MA 승인");$.btnMACancel=new FingerButton(host,"btnMACancel",1080,60,120,40);$.btnMACancel.setText("MA 승인취소");$.lbletc_descr=new FingerLabel(host,"lbletc_descr",0,180,100,20);$.lbletc_descr.setText("기타사항");$.memoetc_descr=new FingerMemoEdit(host,"memoetc_descr",105,170,840,40);$.lblMatch=new FingerLabel(host,"lblMatch",665,220,135,20);$.lblMatch.setText("관련 자사제품설명회");$.bteMatch=new FingerButtonEdit(host,"bteMatch",805,220,145,20);$.bteMatch.setText("");$.btnMatch=new FingerButton(host,"btnMatch",1025,220,80,20);$.btnMatch.setText("연결");$.btnView=new FingerButton(host,"btnView",960,220,80,20);$.btnView.setText("보기");$.lblcp_lect_target2=new FingerLabel(host,"lblcp_lect_target2",0,130,100,20);$.lblcp_lect_target2.setText("(250자 이내)");$.btnViewBfCP=new FingerButton(host,"btnViewBfCP",1000,40,120,20);$.btnViewBfCP.setText("사전CP보기");$.panQuery.addButtons(["btnLoad","btnDelete","btnTemp","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.txtcp_id.setReadOnly(true);$.cmbcp_emp_id.setEnable(false);$.cmbcp_emp_id.setAllowBlank(false,"담당자");$.cmbemployee_pm.setEmptyRow(true);$.cmbStatus.setEnable(false);$.txtcp_lect_title.setAllowBlank(false,"강연행사명");$.dtecp_lect_date.setAllowBlank(false,"강연일");$.txtcp_place.setAllowBlank(false,"강연장소");$.memcp_lect_target.setAllowBlank(false,"강연목적");$.cmblect_type.setAllowBlank(false,"강연유형");$.specp_total.setReadOnly(true);$.cmblect_type.setEmptyRow(true);$.txtcp_lect_cnt.setAllowBlank(false,"강연자수");$.txtcp_lect_company.setAllowBlank(false,"기관(수)");$.dteapp_date.setEnable(false);$.dteapp_date.setAllowBlank(false,"승인요청일");$.txtbefore_cp_id.setVisible(false);$.txtcp_code.setVisible(false);$.txtwf_doc_id.setVisible(false);$.txtcp_doc_no.setVisible(false);$.btnAdd.setClass("btn_new");$.memcp_descr.setReadOnly(true);$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);$.btnMatch.setVisible(false);$.bteMatch.setEnable(false);$.grdContact.setColumns([new FingerDataGridColumn("contact_name",100,"left","string","강연자"),new FingerDataGridColumn("company_name",200,"left","string","소속"),new FingerDataGridColumn("cp_lect_date",100,"left","string","강연일",{format:"ymd"}),new FingerDataGridColumn("time",130,"center","string","강연시간"),new FingerDataGridColumn("cp_lect_subject2",500,"left","string","강연주제"),new FingerDataGridColumn("cp_lect_amt",100,"right","int","강연료",{format:"int"}),new FingerDataGridColumn("contact_id",280,"left","string","강연자아이디",{hidden:true}),new FingerDataGridColumn("company_id",280,"left","string","소속아이디",{hidden:true}),new FingerDataGridColumn("cp_emp_id",280,"left","string","보고자",{hidden:true}),new FingerDataGridColumn("cp_lect_subject1",280,"left","string","강의제목",{hidden:true}),new FingerDataGridColumn("cp_HH_fr",280,"left","string","시작시",{hidden:true}),new FingerDataGridColumn("cp_MM_fr",280,"left","string","시작분",{hidden:true}),new FingerDataGridColumn("cp_HH_to",280,"left","string","종료시",{hidden:true}),new FingerDataGridColumn("cp_MM_to",280,"left","string","종료분",{hidden:true}),new FingerDataGridColumn("cp_HH",280,"left","string","강의시간",{hidden:true}),new FingerDataGridColumn("cp_MM",280,"left","string","강의분",{hidden:true}),new FingerDataGridColumn("agenda",280,"left","string","Agenda",{hidden:true}),new FingerDataGridColumn("cp_desc",280,"left","string","강연내용 요약",{hidden:true}),new FingerDataGridColumn("cp_desc2",280,"left","string","Q&A 및 free Discussion 내용",{hidden:true}),new FingerDataGridColumn("cp_choice_desc",280,"left","string","선정사유",{hidden:true}),new FingerDataGridColumn("contact_cnt",280,"left","string","계획참여인원수",{hidden:true}),new FingerDataGridColumn("contact_cnt2",280,"left","string","실참여인원수",{hidden:true}),new FingerDataGridColumn("cp_picture1",280,"left","string","사진1",{hidden:true}),new FingerDataGridColumn("cp_picture2",280,"left","string","사진2",{hidden:true}),new FingerDataGridColumn("cp_picture3",280,"left","string","사진3",{hidden:true}),new FingerDataGridColumn("trans_amt",280,"left","string","교통여비",{hidden:true}),new FingerDataGridColumn("stay_amt",280,"left","string","숙박비",{hidden:true}),new FingerDataGridColumn("meal_amt",280,"left","string","식음료비",{hidden:true}),new FingerDataGridColumn("lect_bank_account",280,"left","string","계좌번호",{hidden:true}),new FingerDataGridColumn("trans_yn",280,"left","checkbox","교통비여부",{hidden:true}),new FingerDataGridColumn("stay_yn",280,"left","checkbox","숙박비여부",{hidden:true}),new FingerDataGridColumn("meal_yn",280,"left","checkbox","식음료비여부",{hidden:true})]);$.grdContact.init({isFilter:false});$.grdContact.setEditable(false);$.grdContact.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",300,"left","string","자료유형"),new FingerDataGridColumn("local_fname",900,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",800,"left","string","사이즈",{hidden:true})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panFile);$.panMain.add($.panContact);$.panMain.add($.panBottom);$.panMain.add($.memcp_descr);$.panQuery.add($.lblcp_id);$.panQuery.add($.txtcp_id);$.panQuery.add($.lblcp_emp_id);$.panQuery.add($.cmbcp_emp_id);$.panQuery.add($.lblemployee_pm);$.panQuery.add($.cmbemployee_pm);$.panQuery.add($.cmbStatus);$.panQuery.add($.lblcp_lect_title);$.panQuery.add($.txtcp_lect_title);$.panQuery.add($.lblcp_lect_date);$.panQuery.add($.dtecp_lect_date);$.panQuery.add($.lblcp_place);$.panQuery.add($.txtcp_place);$.panQuery.add($.lblcp_lect_target);$.panQuery.add($.memcp_lect_target);$.panQuery.add($.lbllect_type);$.panQuery.add($.cmblect_type);$.panQuery.add($.lblcp_total);$.panQuery.add($.specp_total);$.panQuery.add($.lblcp_lect_cnt);$.panQuery.add($.txtcp_lect_cnt);$.panQuery.add($.lblTxt1);$.panQuery.add($.lblcp_lect_company);$.panQuery.add($.txtcp_lect_company);$.panQuery.add($.lblapp_date);$.panQuery.add($.dteapp_date);$.panQuery.add($.txtbefore_cp_id);$.panQuery.add($.txtcp_code);$.panQuery.add($.txtwf_doc_id);$.panQuery.add($.txtcp_doc_no);$.panQuery.add($.lbletc_descr);$.panQuery.add($.memoetc_descr);$.panQuery.add($.lblMatch);$.panQuery.add($.bteMatch);$.panQuery.add($.btnMatch);$.panQuery.add($.btnView);$.panQuery.add($.lblcp_lect_target2);$.panQuery.add($.btnViewBfCP);$.panFile.add($.grdFile);$.panContact.add($.grdContact);$.panContact.add($.btnAdd);$.panContact.add($.btnDel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMAConfirm);$.panBottom.add($.btnMACancel);relocateChildIndexInPanel([$.panQuery]);var ds=bizComponentData2($,"Q1","L_CRM192|L_CRM0111|L_CRM0052");$.cmbemployee_pm.setColumn("employee_id","emp_name");$.cmbcp_emp_id.setColumn("employee_id","emp_name");setComboBind([$.cmbemployee_pm,$.cmbStatus,$.cmbcp_emp_id],ds);var subQuery=" and sub_code in('007','014','034','040','036','039')";var ds1=bizComponentData2($,"Q4","L_CRM0110",subQuery);$.grdFile.setColumnDropDownList("file_type",ds1.resultList[0],null,true);var subQuery1=" and sub_code in('50','60','70','80','90','95')";var ds3=bizComponentData2($,"Q4","L_CRM0144",subQuery1);$.cmblect_type.setColumn("sub_code","code_name");setComboBind([$.cmblect_type],ds3);if($.p_argument){$.cmbStatus.setValue($.p_argument[0][0].cp_status);$.memcp_descr.setValue($.p_argument[0][0].cp_descr);$.bAllReport=$.p_argument[0][0].AllReport;$.bMyReport=$.p_argument[0][0].MyReport;$.bConfirm=$.p_argument[0][0].Confirm;if(!$.bConfirm){$.panBottom.setVisible(false)}else{$.panBottom.setVisible(true);$.memcp_descr.setReadOnly(false)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false)}$.dteapp_date.setEnable(false);$.txtcp_id.setValue($.p_argument[0][0].cp_id);$.cmbcp_emp_id.setValue($.p_argument[0][0].cp_emp_id);$.cmbemployee_pm.setValue($.p_argument[0][0].cp_emp_pm);$.txtcp_lect_title.setValue($.p_argument[0][0].cp_lect_title);$.dtecp_lect_date.setValue($.p_argument[0][0].cp_lect_date);$.txtcp_place.setValue($.p_argument[0][0].cp_place);$.memcp_lect_target.setValue($.p_argument[0][0].cp_lect_target);$.cmblect_type.setValue($.p_argument[0][0].cp_lect_type);$.specp_total.setValue($.p_argument[0][0].cp_total);$.txtcp_lect_cnt.setValue($.p_argument[0][0].cp_lect_cnt);$.txtcp_lect_company.setValue($.p_argument[0][0].cp_lect_company);$.dteapp_date.setValue($.p_argument[0][0].app_date);$.txtcp_code.setValue($.p_argument[0][0].cp_code);$.txtwf_doc_id.setValue($.p_argument[0][0].wf_doc_id);$.txtcp_doc_no.setValue($.p_argument[0][0].cp_doc_no);$.txtbefore_cp_id.setValue($.p_argument[0][0].before_cp_id);$.memoetc_descr.setValue($.p_argument[0][0].cp_etc_descr);$.bteMatch.setText($.p_argument[0][0].relate_seminar);$.bteMatch.setValue($.p_argument[0][0].relate_seminar);for(var i=0;i<$.p_argument[1].length;i++){$.p_argument[1][i].cp_lect_date=extFormat($.p_argument[1][i].cp_lect_date,"yyyyMMdd");$.p_argument[1][i].cp_picture1=$.p_argument[1][i].cp_picture1==""?"":convertByteArrayToImageSource($.p_argument[1][i].cp_picture1);$.p_argument[1][i].cp_picture2=$.p_argument[1][i].cp_picture2==""?"":convertByteArrayToImageSource($.p_argument[1][i].cp_picture2);$.p_argument[1][i].cp_picture3=$.p_argument[1][i].cp_picture3==""?"":convertByteArrayToImageSource($.p_argument[1][i].cp_picture3)}setDataGrid([$.grdContact],$.p_argument[1],true);$.grdContact.selectRow(0);setDataGrid([$.grdFile],$.p_argument[2],true);$.grdFile.selectRow(0);if($.cmbStatus.getValue()=="10"){$.btnConfirm.setEnable(true);if(!$.bSave){$.panQuery.disableButton(["btnDelete"])}}else{if($.cmbStatus.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panQuery.disableButton(["btnTemp"]);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnLimitFree.setVisible(false);$.btnMemoSave.setVisible(false);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}}else{newClick();$.panBottom.setVisible(false);$.memcp_descr.setVisible(false)}};$.callback=function(type,ds){if(type=="LECTURE"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txtcp_id.setValue(id[0]);$.txtcp_doc_no.setValue(id[1])}}$.resultMsg="정상적으로 저장되었습니다.";saveCPLecturer("D")}else{if(ds.errorCode=="MSG0004"){$.resultMsg="정상적으로 수정되었습니다.";saveCPLecturer("D")}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제되었습니다.");newClick();if($.p_argument){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}else{if(ds.errorCode=="MSG0030"){MessageBoxShow("수정된 레코드가 없습니다.")}}}}}}}else{if(type=="LECTURER"){if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}}if($.workType=="D"){saveCPLecturer("N")}else{MessageBoxShow($.resultMsg)}}}else{if(type=="LIST1"){if(ds){ds.resultList[0][0].CallType="BUCall";ds.resultList[0][0].Confirm=false;ds.resultList[0][0].cp_status="90";ds.resultList[0][0].cp_descr="";ds.resultList[0][0].save_yn="N";g_main.openPopup("crmCPSeminarStayAf.html","crmCPSeminarStayAf","자사제품설명회 숙박(사후)",1200,1250,"","",ds.resultList,"","")}}else{if(type=="LIST2"){if(ds){ds.resultList[0][0].CallType="BUCall";ds.resultList[0][0].Confirm=false;ds.resultList[0][0].cp_status="90";ds.resultList[0][0].cp_descr="";ds.resultList[0][0].save_yn="N";g_main.openPopup("crmCPSeminarAfter.html","crmCPSeminarAfter","자사제품설명회 (사후)",1200,1350,"","",ds.resultList,"","")}}else{if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="BUCall";param[0][0].Confirm=false;param[0][0].cp_descr=param.cp_desc;param[0][0].cp_status="90";param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnAdd"){$.popUpCallId=id;var rows=[];if($.grdContact.getRowCount()>0){rows=copyArray($.grdContact.getAllRows())}var param={save_mode:$.btnAdd.getText()=="상세보기"?"N":"Y",lect_type:$.cmblect_type.getValue(),lect_date:$.dtecp_lect_date.getValue(),cp_code:"CP05",source:rows};g_main.openPopup("crmCPLecture_Sub.html","crmCPLecture_Sub","강연상세내역등록",1200,990,"","",param,"","")}else{if(id=="btnView"){if($.bteMatch.getValue()!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.bteMatch.getValue()+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";if(ds.resultList[0][0].cp_type=="CP02"){searchCPSeminarAfter("Q")}else{if(ds.resultList[0][0].cp_type=="CP22"){searchCPSeminarStayAfter("Q")}}}}else{if(id=="btnDel"){if(!$.grdContact.getSelectedRowIdx()){return}confirmBoxShow("삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdContact.deleteRow($.grdContact.getSelectedRowIdx());$.grdContact.selectRow(0);fnTotalamtSet()}})}else{if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMAConfirm"){var share={save_mode:"MACONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMACancel"){var share={save_mode:"MACANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnViewBfCP"){if($.txtbefore_cp_id.getValue()!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.txtbefore_cp_id.getValue()+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";$.cp_code=ds.resultList[0][0].cp_type;searchCPInfo("FORM")}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panQuery"){if(btnId=="btnNew"){newClick()}else{if(btnId=="btnSave"){saveClick()}else{if(btnId=="btnDelete"){deleteClick()}else{if(btnId=="btnTemp"){tmpSave()}else{if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={};g_main.openPopup("popCPLectureBf.html","popCPLectureBf","","","","","",param,"","")}}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){fileList[i].file_type="";fileList[i].seq=seq+i;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);$.grdFile.selectRow(0)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="crmCPLecture_Sub"){if($.popUpCallId=="btnAdd"){if(popResult.confirm_yn=="Y"){setDataGrid([$.grdContact],popResult.source,true);$.grdContact.selectRow(0);fnTotalamtSet()}}}else{if(id=="popCPLectureBf"){if($.popUpCallId=="btnLoad"){for(var i=0;i<popResult.rs.length;i++){if(i==0){$.txtcp_id.setValue(popResult.rs[0][0].cp_id);$.cmbcp_emp_id.setValue(popResult.rs[0][0].cp_emp_id);$.cmbemployee_pm.setValue(popResult.rs[0][0].cp_emp_pm);$.dtecp_lect_date.setValue(popResult.rs[0][0].cp_lect_date);$.txtcp_lect_title.setValue(popResult.rs[0][0].cp_lect_title);$.txtcp_place.setValue(popResult.rs[0][0].cp_place);$.memcp_lect_target.setValue(popResult.rs[0][0].cp_lect_target);$.cmblect_type.setValue(popResult.rs[0][0].cp_lect_type);$.specp_total.setValue(Number(popResult.rs[0][0].cp_total));$.txtcp_lect_cnt.setValue(popResult.rs[0][0].cp_lect_cnt);$.txtcp_lect_company.setValue(popResult.rs[0][0].cp_lect_company);$.dteapp_date.setValue(popResult.rs[0][0].app_date);$.txtcp_code.setValue(popResult.rs[0][0].cp_code);$.txtwf_doc_id.setValue(popResult.rs[0][0].wf_doc_id);$.memoetc_descr.setValue(popResult.rs[0][0].cp_etc_descr);$.bteMatch.setText(popResult.rs[0][0].relate_seminar);$.bteMatch.setValue(popResult.rs[0][0].relate_seminar)}else{if(i==1){setDataGrid([$.grdContact],popResult.rs[1],true);$.grdContact.selectRow(0);for(var j=0;j<popResult.rs[1].length;j++){$.grdContact.setValue(j,"cp_lect_date",extFormat(popResult.rs[1][j].cp_lect_date,"yyyyMMdd"))}}else{if(i==2){setDataGrid([$.grdFile],popResult.rs[2],true);$.grdFile.selectRow(0)}}}}$.txtbefore_cp_id.setValue($.txtcp_id.getValue());$.txtcp_id.setValue("");$.txtcp_doc_no.setValue("")}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>