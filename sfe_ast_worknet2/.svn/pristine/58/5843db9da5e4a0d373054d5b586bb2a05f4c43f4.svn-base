<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.btnFileAdd=null;$.btnFileDelete=null;$.btnDocAdd=null;$.btnDocDelete=null;$.ediDetail=null;$.cmbBaseDate=null;$.panList=null;$.grdList=null;$.panDetail=null;$.lblBudgetName=null;$.txtBudgetName=null;$.lblPlanAmt=null;$.spePlanAmt=null;$.lblPromoCode=null;$.cmbPromoCode=null;$.lblPrProductCode=null;$.cmbPrProductCode=null;$.lblCompany=null;$.bteCompany=null;$.lblLocation=null;$.bteLocation=null;$.lblPlanVatAmt=null;$.spePlanVatAmt=null;$.lblPlanSumAmt=null;$.spePlanSumAmt=null;$.lblBank=null;$.cmbDepositType=null;$.txtBankAccount=null;$.lblEndDate=null;$.dteEndDate=null;$.grdFile=null;$.grdDoc=null;$.type="";$.varInstituteName="";$.strakr_clinical_no="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFBgtPlanPre"]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmBudgetPlan_Q",[workType,$.cmbBaseDate.getValue().substring(0,4),$.cmbBaseDate.getValue().substring(4,5),g_main.session.getValue("DeptCode"),g_main.session.getValue("EmpCode")]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmWFBudgetPlanD_S",[workType,$.wfDocId,$.cmbBaseDate.getValue().substring(0,4),$.cmbBaseDate.getValue().substring(4,5),$.grdList.getValue($.grdList.getSelectedRowIdx(),"dept_code"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"budget_code"),$.grdList.getValue($.grdList.getSelectedRowIdx(),"product_code"),parseInt($.grdList.getValue($.grdList.getSelectedRowIdx(),"assign_seq")),"40",Number(),parseInt($.spePlanAmt.getValue()),parseInt($.spePlanVatAmt.getValue()),"#DeptCode#","#UserID#",$.cmbPromoCode.getValue(),$.bteLocation.getValue(),$.bteLocation.getText(),$.bteCompany.getValue(),$.bteCompany.getText(),$.cmbPrProductCode.getValue(),$.grdList.getValue($.grdList.getSelectedRowIdx(),"wf_doc_id"),$.cmbPromoCode.getValue()=="0012"?"":"","",parseInt(1),$.varPayMe,$.varBankAccount,$.varBank,$.varAccount,$.varAcctName,$.varBpName,$.dteEndDate.getValue()]);return json}function searchWFDocument(workType){if(workType=="Q3"){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}else{if(workType=="Q2"){var json=createJSON_Q("Q2");callQuery(["req",json],"Q2",$)}}}function searchWFBqtPlanCom(workType){var json=createJSON_Q2("PRE");callQuery(["req",json],"PRE",$)}function saveWFBqtPlanCom(workType){var json=createJSON_S(workType);callExecute(["req",json],workType,$)}function tmpSave(){if(saveWFDocument("","N")){saveWFBqtPlanCom("N")}else{removeWFDocument($.wfDocId)}}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.businessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.ediDetail,$.wfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.wfDocId=ds.returnStr}return true}function validateBgtPlanPre(){if(!validateControls([$.txtTitle,$.cmbBaseDate,$.txtBudgetName,$.spePlanAmt,$.spePlanSumAmt,$.cmbDepositType,$.txtBankAccount,$.dteEndDate])){return false}if($.spePlanAmt.getValue()<=0){return false}if($.grdList.getRowCount()<1){MessageBoxShow("저장할 내용이 없습니다. 내용을 선택해 주십시요.");return false}if(Number($.grdList.getValue($.grdList.getSelectedRowIdx(),"half_amt"))!=0&&Number($.grdList.getValue($.grdList.getSelectedRowIdx(),"aval_amt"))<Number($.spePlanAmt.getValue())){MessageBoxShow("계획금액이 가용금액을 초과할 수 없습니다.");return false}if($.grdList.getValue($.grdList.getSelectedRowIdx(),"promo_budget_yn")!=null&&$.grdList.getValue($.grdList.getSelectedRowIdx(),"promo_budget_yn")=="Y"){if(!validateControls([$.cmbPromoCode,$.cmbPrProductCode])){return false}}return true}function moveWFGeneralProc(){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1345);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFDetail=new FingerPanel(host,"panWFDetail",0,660,1200,385);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,1055,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,1055,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.btnFileAdd=new FingerButton(host,"btnFileAdd",215,-37.5,120,20);$.btnFileAdd.setText("파일추가");$.btnFileDelete=new FingerButton(host,"btnFileDelete",320,-37.5,120,20);$.btnFileDelete.setText("파일삭제");$.btnDocAdd=new FingerButton(host,"btnDocAdd",525,-37.5,120,20);$.btnDocAdd.setText("문서추가");$.btnDocDelete=new FingerButton(host,"btnDocDelete",630,-37.5,120,20);$.btnDocDelete.setText("문서삭제");$.ediDetail=new FingerWebEditor(host,"ediDetail",0,0,1200,310);$.cmbBaseDate=new FingerComboBox(host,"cmbBaseDate",875,-37.5,140,20);$.panList=new FingerPanel(host,"panList",0,65,1200,380);$.panList.setText("예산사용집계");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,335);$.panDetail=new FingerPanel(host,"panDetail",0,455,1200,195);$.panDetail.setText("사용계획");$.panDetail.setBottomLine(true);$.lblBudgetName=new FingerLabel(host,"lblBudgetName",0,15,100,20);$.lblBudgetName.setText("예산항목");$.txtBudgetName=new FingerEdit(host,"txtBudgetName",105,15,300,20);$.lblPlanAmt=new FingerLabel(host,"lblPlanAmt",385,15,100,20);$.lblPlanAmt.setText("금액");$.spePlanAmt=new FingerSpinEdit(host,"spePlanAmt",490,15,140,20);$.lblPromoCode=new FingerLabel(host,"lblPromoCode",0,75,100,20);$.lblPromoCode.setText("판촉항목");$.cmbPromoCode=new FingerComboBox(host,"cmbPromoCode",105,75,300,20);$.lblPrProductCode=new FingerLabel(host,"lblPrProductCode",385,75,100,20);$.lblPrProductCode.setText("품목");$.cmbPrProductCode=new FingerComboBox(host,"cmbPrProductCode",490,75,140,20);$.lblCompany=new FingerLabel(host,"lblCompany",0,105,100,20);$.lblCompany.setText("거래처");$.bteCompany=new FingerButtonEdit(host,"bteCompany",105,105,525,20);$.bteCompany.setText("");$.lblLocation=new FingerLabel(host,"lblLocation",635,105,100,20);$.lblLocation.setText("지역");$.bteLocation=new FingerButtonEdit(host,"bteLocation",740,105,365,20);$.bteLocation.setText("");$.lblPlanVatAmt=new FingerLabel(host,"lblPlanVatAmt",635,15,100,20);$.lblPlanVatAmt.setText("부가세액");$.spePlanVatAmt=new FingerSpinEdit(host,"spePlanVatAmt",740,15,140,20);$.lblPlanSumAmt=new FingerLabel(host,"lblPlanSumAmt",860,15,100,20);$.lblPlanSumAmt.setText("합계금액");$.spePlanSumAmt=new FingerSpinEdit(host,"spePlanSumAmt",965,15,140,20);$.lblBank=new FingerLabel(host,"lblBank",0,45,100,20);$.lblBank.setText("입금계좌");$.cmbDepositType=new FingerComboBox(host,"cmbDepositType",105,45,140,20);$.txtBankAccount=new FingerEdit(host,"txtBankAccount",250,45,380,20);$.lblEndDate=new FingerLabel(host,"lblEndDate",635,45,100,20);$.lblEndDate.setText("가불정리기한");$.dteEndDate=new FingerDateEdit(host,"dteEndDate",740,45,140,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,235);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,235);$.spePlanSumAmt.setReadOnly(true);$.txtBankAccount.setReadOnly(true);$.panTitle.setBorder(true);$.txtTitle.setAllowBlank(false,"문서제목");$.cmbBaseDate.setEnable(false);$.cmbBaseDate.setAllowBlank(false,"기간");$.txtBudgetName.setAllowBlank(false,"예산항목");$.spePlanAmt.setAllowBlank(false,"금액");$.cmbPromoCode.setAllowBlank(false,"판촉항목");$.cmbPrProductCode.setEnable(false);$.cmbPrProductCode.setAllowBlank(false,"품목");$.spePlanVatAmt.setAllowBlank(false,"부가세액");$.spePlanSumAmt.setAllowBlank(false,"합계금액");$.cmbDepositType.setAllowBlank(false,"입금처");$.txtBankAccount.setAllowBlank(false,"입금계좌");$.dteEndDate.setAllowBlank(false,"가불정리기한");$.spePlanAmt.setValue(0);$.spePlanVatAmt.setValue(0);$.spePlanSumAmt.setValue(0);$.txtBudgetName.setEnable(false);$.cmbPrProductCode.setEmptyRow(true);$.cmbPromoCode.setEmptyRow(true);$.cmbDepositType.setEmptyRow(true);$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("dept_code",100,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("budget_code",100,"left","string","예산코드",{hidden:true}),new FingerDataGridColumn("budget_name",270,"left","string","예산항목"),new FingerDataGridColumn("product_code",90,"right","string","품목코드",{hidden:true}),new FingerDataGridColumn("assign_seq",90,"right","string","공유순번",{hidden:true}),new FingerDataGridColumn("half_amt",150,"right","string","배정금액",{format:"int"}),new FingerDataGridColumn("plan_use_amt",150,"right","string","사용금액",{format:"int"}),new FingerDataGridColumn("plan_using_amt",150,"right","string","결재중금액",{format:"int"}),new FingerDataGridColumn("plan_aval_amt",150,"right","string","Hold금액",{format:"int"}),new FingerDataGridColumn("aval_amt",150,"right","string","가용금액",{format:"int"}),new FingerDataGridColumn("use_percent",80,"right","string","사용비율",{format:"int"}),new FingerDataGridColumn("use_count",80,"right","string","건수",{format:"int"}),new FingerDataGridColumn("share_yn",100,"left","string","공유여부",{hidden:true}),new FingerDataGridColumn("wf_doc_id",100,"left","string","결재문서아이디",{hidden:true}),new FingerDataGridColumn("promo_budget_yn",100,"left","string","판촉항목필수여부",{hidden:true})]);$.grdList.init({panel:$.panList});$.grdList.setEditable(false);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.btnFileAdd.setVisible(false);$.btnFileDelete.setVisible(false);$.btnDocAdd.setVisible(false);$.btnDocDelete.setVisible(false);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panList);$.panMain.add($.panDetail);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFDetail.add($.ediDetail);$.panFile.add($.btnFileAdd);$.panFile.add($.btnFileDelete);$.panFile.add($.grdFile);$.panDoc.add($.btnDocAdd);$.panDoc.add($.btnDocDelete);$.panDoc.add($.grdDoc);$.panList.add($.grdList);$.panList.add($.cmbBaseDate);$.panDetail.add($.lblPlanAmt);$.panDetail.add($.lblBudgetName);$.panDetail.add($.txtBudgetName);$.panDetail.add($.spePlanAmt);$.panDetail.add($.cmbPromoCode);$.panDetail.add($.lblPromoCode);$.panDetail.add($.lblPrProductCode);$.panDetail.add($.cmbPrProductCode);$.panDetail.add($.lblCompany);$.panDetail.add($.bteCompany);$.panDetail.add($.lblLocation);$.panDetail.add($.bteLocation);$.panDetail.add($.lblPlanVatAmt);$.panDetail.add($.spePlanVatAmt);$.panDetail.add($.lblPlanSumAmt);$.panDetail.add($.spePlanSumAmt);$.panDetail.add($.lblBank);$.panDetail.add($.cmbDepositType);$.panDetail.add($.txtBankAccount);$.panDetail.add($.lblEndDate);$.panDetail.add($.dteEndDate);searchWFDocument("Q3");$.receiptStartDate="";$.receiptEndDate="";$.wfDocId="";$.varCompanyId="";$.varLocationId="";var ds=bizComponentData2($,"Q1","L_CRM0008_3|L_CRM0059|L_CRM0072");$.cmbBaseDate.setColumn("half_code","half_name");$.cmbPrProductCode.setColumn("product_code","product_name");$.cmbPromoCode.setColumn("promo_code","promo_name");setComboBind([$.cmbBaseDate,$.cmbPrProductCode,$.cmbPromoCode],ds);var ds2=bizComponentData2($,"Q2","L_CRM267");setComboBind([$.cmbDepositType],ds2);if(g_main.session.obj.DeptCode=="C310"){$.cmbBaseDate.setValue("20192")}else{$.cmbBaseDate.setValue("")}$.receiptStartDate=ds.resultList[0][0].receipt_start_date;$.receiptEndDate=ds.resultList[0][0].receipt_end_date;searchWFBqtPlanCom("COM")};$.callback=function(type,ds){if(type=="Q3"){$.businessId=ds.resultList[0][0].business_id;$.wfType=ds.resultList[0][0].wf_type;$.txtTitle.setValue("["+g_main.session.getValue("DeptName")+"] "+ds.resultList[0][0].business_title);if($.p_argument){var p_arg=$.p_argument;if(p_arg.title!=""){$.type="POP";$.strclinical_id=p_arg.clinical_id;$.txtTitle.setValue($.p_argument.title);$.ediDetail.setValue(convertRtfToHtml($.p_argument.content));if(p_arg.files.length>0){setDataGrid([$.grdFile],p_arg.files,true)}}}}else{if(type=="N"){if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);removeWFDocument($.wfDocId);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);removeWFDocument($.wfDocId);return}}if($.saveType=="summit"){var param={wf_doc_id:$.wfDocId,wf_form_id:"crmWFBgtPlanPre",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","결재라인 지정",0,0,"","",param,"","")}else{if($.type=="POP"){var share={wf_doc_id:$.wfDocId,doc_title:$.txtTitle.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{moveWFGeneralProc()}}}}else{if(type=="PRE"){if(ds.resultList[0].length<=0){$.grdList.extObj.clearAll();$.grdList.setDisplayPanelRowCount("0")}else{setDataGrid([$.grdList],ds);if($.strbudget_code){for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"budget_code")==$.strbudget_code){$.grdList.selectRow(i)}$.spePlanAmt.setValue($.md.plan_amt);$.spePlanVatAmt.setValue($.md.plan_vat_amt);$.spePlanSumAmt.setValue($.md.total_plan_amt);$.cmbPromoCode.setValue($.md.promo_code);$.cmbPrProductCode.setValue($.md.pr_product_code);$.varCompanyId=$.md.sidogu_code_list;$.bteCompany.setValue($.md.sidogu_code_list);$.bteCompany.setText($.md.sidogu_name_list);$.varLocationId=$.md.company_id_list;$.bteLocation.setValue($.md.company_id_list);$.bteLocation.setText($.md.company_name_list);$.dteEndDate.setValue($.md.due_date)}}else{$.grdList.selectRow(0)}}}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{if(cs.wf_status=="60"){$.wfDocId=cs.wf_doc_id}}$.txtTitle.setValue(cs.doc_title);$.ediDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var md=args[6][0];console.log(JSON.stringify(args));if(md){$.md=md;$.strbudget_code=md.budget_code;$.strproduct_code=md.product_code;$.strplan_amt=md.plan_amt;$.plan_vat_amt=md.plan_vat_amt;$.total_plan_amt=md.total_plan_amt;$.due_date=md.due_date}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!validateBgtPlanPre()){return}confirmBoxShow("입금계좌 : "+$.txtBankAccount.getValue()+"<br/> 입금계좌가 맞는지 다시 한번 확인해 주세요.",function(){if(g_main.msgShare==true){$.saveType="summit";tmpSave()}})}else{if(id=="btnTmpSave"){if($.type=="POP"){MessageBoxShow("기안 업무 연동시 임시저장은 사용 불가 합니다.");return}if(!validateBgtPlanPre()){return}$.saveType="tmp";tmpSave()}else{if(id=="btnDocAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteCompany"){var param={company_id:$.bteCompany.getValue()||"",company_name:$.bteCompany.getText()||""};g_main.openPopup("popCompanyListSub.html","popCompanyListSub","",0,0,"","",param,"","")}else{if(id=="bteLocation"){var param={sidogu_code:$.bteLocation.getValue()||"",sidogu_name:$.bteLocation.getText()||""};g_main.openPopup("popSidogu.html","popSidogu","",0,0,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbBaseDate"){searchWFBqtPlanCom("COM")}else{if(id=="cmbDepositType"){$.varCardCode="";$.txtBankAccount.setValue("");$.varPayMe="";$.varBankAccount="";$.varBank="";$.varAccount="";$.varAcctName="";$.varBpName="";if($.cmbDepositType.getValue()=="0010"){$.popUpCallId="0010";var param={};g_main.openPopup("popDepositEmpSub.html","popDepositEmpSub","",0,0,"","",param,"","")}else{if($.cmbDepositType.getValue()=="0020"){$.popUpCallId="0020";var param={};g_main.openPopup("popAccountCompany.html","popAccountCompany","",0,0,"","",param,"","")}else{if($.cmbDepositType.getValue()=="0030"){$.popUpCallId="0030";var param={};g_main.openPopup("popWithholdmentSub.html","popWithholdmentSub","",0,0,"","",param,"","")}}}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.varCompanyId="";$.varLocationId="";$.bteCompany.setValue("");$.bteCompany.setText("");$.bteLocation.setValue("");$.bteLocation.setText("");$.cmbPrProductCode.setValue("");$.txtBudgetName.setValue($.grdList.getValue(rId,"budget_name"));$.cmbPromoCode.clear();var strQuery=" and budget_code = '"+$.grdList.getValue(rId,"budget_code")+"'";var ds=bizComponentData2($,"Q4","L_CRM0072_2",strQuery,"","");$.cmbPromoCode.setColumn("promo_code","promo_name");setComboBind([$.cmbPromoCode],ds);if($.grdList.getValue(rId,"promo_budget_yn")!=null&&$.grdList.getValue(rId,"promo_budget_yn")=="Y"){$.lblPromoCode.setVisible(true);$.cmbPromoCode.setVisible(true);$.lblPrProductCode.setVisible(true);$.cmbPrProductCode.setVisible(true);$.lblCompany.setVisible(true);$.bteCompany.setVisible(true);$.lblLocation.setVisible(true);$.bteLocation.setVisible(true);if($.grdList.getValue(rId,"product_code")!=null){if($.grdList.getValue(rId,"product_code")==""){$.cmbPrProductCode.setEnable(true);$.cmbPrProductCode.setAllowBlank(false,"품목")}else{$.cmbPrProductCode.setEnable(false);$.cmbPrProductCode.setValue($.grdList.getValue(rId,"product_code"));$.cmbPrProductCode.setAllowBlank(false,"품목")}}}else{$.lblPromoCode.setVisible(false);$.cmbPromoCode.setVisible(false);$.lblPrProductCode.setVisible(false);$.cmbPrProductCode.setVisible(false);$.lblCompany.setVisible(false);$.bteCompany.setVisible(false);$.lblLocation.setVisible(false);$.bteLocation.setVisible(false)}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="spePlanAmt"||id=="spePlanVatAmt"){$.spePlanSumAmt.setValue(Number(Number($.spePlanAmt.getValue())+Number($.spePlanVatAmt.getValue())))}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panDoc"){if(btnId=="btnAdd"){$.popUpCallId="btnDocAdd";var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getSSSSValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCompanyListSub"){if($.popUpCallId=="bteCompany"){if(!popResult.company_id){$.varCompanyId="";$.bteCompany.setValue("");$.bteCompany.setText("")}else{if($.varLocationId!=""&&$.bteLocation.getValue()!=""){$.varLocationId="";$.bteLocation.setValue("");$.bteLocation.setText("")}$.varCompanyId=popResult.company_id;$.bteCompany.setValue(popResult.company_id);$.bteCompany.setText(popResult.company_name)}}}else{if(id=="popSidogu"){if($.popUpCallId=="bteLocation"){if(!popResult.sidogu_code){$.varLocationId="";$.bteLocation.setValue("");$.bteLocation.setText("")}else{if($.varCompanyId!=""&&$.bteCompany.getValue()!=""){$.varCompanyId="";$.bteCompany.setValue("");$.bteCompany.setText("")}$.varLocationId=popResult.sidogu_code;$.bteLocation.setValue(popResult.sidogu_code);$.bteLocation.setText(popResult.sidogu_name)}}}else{if(id=="popDepositEmpSub"){if($.popUpCallId=="0010"){if(!popResult.code){$.varCardCode="";$.txtBankAccount.setValue("");$.varPayMe="";$.varBankAccount="";$.varBank="";$.varAccount="";$.varAcctName="";$.varBpName=""}else{$.varCardCode=popResult.code;$.txtBankAccount.setValue(popResult.bank_account);$.varPayMe=popResult.pay_me;$.varBankAccount=popResult.bank_account;$.varBank=popResult.bank;$.varAccount=popResult.account;$.varAcctName=popResult.acct_name;$.varBpName=popResult.emp_name}}}else{if(id=="popAccountCompany"){if($.popUpCallId=="0020"){if(!popResult.card_code){$.varCardCode="";$.txtBankAccount.setValue("");$.varPayMe="";$.varBankAccount="";$.varBank="";$.varAccount="";$.varAcctName="";$.varBpName=""}else{$.varCardCode=popResult.card_code;$.txtBankAccount.setValue(popResult.bank_account);$.varPayMe=popResult.pay_me;$.varBankAccount=popResult.bank_account;$.varBank=popResult.bank;$.varAccount=popResult.account;$.varAcctName=popResult.acct_name;$.varBpName=popResult.card_name}}}else{if(id=="popWithholdmentSub"){if($.popUpCallId=="0030"){if(!popResult.code){$.varCardCode="";$.txtBankAccount.setValue("");$.varPayMe="";$.varBankAccount="";$.varBank="";$.varAccount="";$.varAcctName="";$.varBpName=""}else{$.varCardCode=popResult.code;$.txtBankAccount.setValue(popResult.target_info2);$.varPayMe=popResult.pay_me;$.varBankAccount=popResult.bank_account;$.varBank=popResult.bank;$.varAccount=popResult.account;$.varAcctName=popResult.acct_name;$.varBpName=popResult.bp_name}}}else{if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.wfDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){$.saveType="";saveWFBqtPlanCom("N")}}}}else{if(id=="crmWFEndDocSub"){if($.popUpCallId=="btnDocAdd"){var rows=[];for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>