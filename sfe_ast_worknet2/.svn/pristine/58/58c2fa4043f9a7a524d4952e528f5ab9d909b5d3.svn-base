<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panBase=null;$.panFile=null;$.grdFile=null;$.panConfirm=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.btnReportYnSave=null;$.btnSeminarCancel=null;$.memCPDescr=null;$.chkReportYN=null;$.lblCpId=null;$.txtCpId=null;$.lblCpDeptCode=null;$.cmbCpDeptCode=null;$.lblCpEmpId=null;$.cmbCpEmpId=null;$.lblCpConductOrg=null;$.txtCpConductOrg=null;$.lblCpSymposiumTitle=null;$.txtCpSymposiumTitle=null;$.lblCpDate=null;$.dteCpStartDate=null;$.lblEx1=null;$.dteCpEndDate=null;$.lblCpHostCountry=null;$.txtCpHostCountry=null;$.lblCpHostCity=null;$.txtCpHostCity=null;$.lblContactCnt=null;$.speContactCnt=null;$.lblStatus=null;$.cmbStatus=null;$.lblEx2=null;$.lblEx3=null;$.lblEx4=null;$.lblEx5=null;$.lbl_cp_bgt_mgr=null;$.cmb_cp_bgt_mgr=null;$.lblEstimatedAmt=null;$.numEstimatedAmt=null;$.lblReason=null;$.memoReason=null;$.lblApproveYN=null;$.rdoApproveYN=null;$.btnMAConfirm=null;$.btnMACancel=null;$.btnGAConfirm=null;$.btnGACancel=null;$.memMADescr=null;$.memGADescr=null;$.btnGAMemoSave=null;$.btnMAMemoSave=null;$.lbl_ma_mgr=null;$.cmb_ma_mgr=null;$.cmb_product_code=null;$.lbl_notice2=null;$.btnMAConfirm2=null;$.btnMACancel2=null;$.btnLimitFree=null;$.lblContactCnt2=null;$.cpDocNo="";$.beforeCpId="";$.beforeCpCode="";$.idPopUp="N";$.approver_1st="";$.approver_1st_yn="";$.approver_2nd="";$.approver_2nd_yn="";$.varModify="";function fnEnabelSet(bo){if(bo){$.panBase.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"])}else{$.panBase.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.txtCpSymposiumTitle.setReadOnly(!bo);$.txtCpConductOrg.setReadOnly(!bo);$.txtCpHostCountry.setReadOnly(!bo);$.txtCpHostCity.setReadOnly(!bo);$.dteCpStartDate.setEnable(bo);$.dteCpEndDate.setEnable(bo);$.speContactCnt.setEnable(bo);$.memoReason.setEnable(bo);$.cmb_product_code.setEnable(bo);$.numEstimatedAmt.setEnable(bo)}function closeSharePopUp(share){if(share.save_mode=="MACONFIRM"||share.save_mode=="MAMEMO"){share.cp_descr=$.memMADescr.getValue()}else{if(share.save_mode=="GACONFIRM"||share.save_mode=="GAMEMO"){share.cp_descr=$.memGADescr.getValue()}else{if(share.save_mode=="CONFIRM"||share.save_mode=="MEMO"){share.cp_descr=$.memCPDescr.getValue()}}}g_popupStack.setData(share);g_popupStack.close()}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txtCpId.getValue(),$.chkReportYN.getValue(),"#UserID#"]);return json}function saveReportYN(workType){var json=createJSON_S(workType);callQuery(["req",json],workType,$)}function createJSON_S2(workType){var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}var json=createExecuteParamInfo("P_crmCPSympAttendBef_S",[workType,$.txtCpId.getValue(),$.cpDocNo,"#DeptCode#","#UserID#",$.cmb_ma_mgr.getValue(),$.cmb_cp_bgt_mgr.getValue()||"",$.rdoApproveYN.getValue(),$.cmb_product_code.getValue(),$.txtCpSymposiumTitle.getValue(),$.txtCpConductOrg.getValue(),$.dteCpStartDate.getValue(),$.dteCpEndDate.getValue(),$.numEstimatedAmt.getValue(),$.txtCpHostCountry.getValue(),$.txtCpHostCity.getValue(),$.speContactCnt.getValue(),$.memoReason.getValue(),strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname]);return json}function saveCpSymposiumBefore(workType){if(!validateControls([$.cmbCpDeptCode,$.cmbCpEmpId,$.txtCpConductOrg,$.txtCpSymposiumTitle,$.dteCpStartDate,$.dteCpEndDate,$.txtCpHostCountry,$.txtCpHostCity,$.speContactCnt,$.rdoApproveYN,$.numEstimatedAmt,$.cmb_ma_mgr])){return}var dt1=getToday();var dt2=$.dteCpStartDate.getValue();var dt3=$.dteCpEndDate.getValue();var dt4=getCompareDate(dt1,dt2);var dt5=getCompareDate(dt2,dt3);log(dt4);log(dt5);if(dt5<0){MessageBoxShow("지원기간을 올바르게 설정하시기 바랍니다.");return}if(workType!="D"){workType=$.txtCpId.getValue()==""?"N":"U";if($.varModify=="N"){if(dt4<63){MessageBoxShow("지원개시일로부터 63일 이내에만 신청가능합니다.");return}}}var json=createJSON_S2(workType);callQuery(["req",json],workType,$)}function setMAMgr(){$.cmb_ma_mgr.setValue("");var dept_code=g_main.session.getValue("DeptCode");var product_code=$.cmb_product_code.getValue();if(dept_code.substring(0,2)=="F2"){$.cmb_product_code.setReadOnly(true);$.cmb_ma_mgr.setValue("ka190437")}else{if(dept_code.substring(0,2)=="F3"){$.cmb_product_code.setReadOnly(true);$.cmb_ma_mgr.setValue("ka011049")}else{if(dept_code.substring(0,2)=="F5"){$.cmb_product_code.setReadOnly(true);$.cmb_ma_mgr.setValue("ka011049")}}}}function saveExtraFunction(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0004"){MessageBoxShow("정상적으로 저장되었습니다.")}}}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,850);$.panMain.setText("");$.panMain.setBottomLine(true);$.panBase=new FingerPanel(host,"panBase",0,0,1200,335);$.panBase.setText("국내외 학술대회 참가지원(사전)");$.panBase.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,345,1200,190);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,140);$.panConfirm=new FingerPanel(host,"panConfirm",0,535,1200,270);$.panConfirm.setText("");$.panConfirm.setBottomLine(true);$.btnConfirm=new FingerButton(host,"btnConfirm",10,170,120,30);$.btnConfirm.setText("E&C 승인");$.btnCancel=new FingerButton(host,"btnCancel",10,205,120,30);$.btnCancel.setText("E&C 승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",985,170,120,30);$.btnMemoSave.setText("E&C 메모저장");$.btnReportYnSave=new FingerButton(host,"btnReportYnSave",1090,165,120,20);$.btnReportYnSave.setText("신고상태저장");$.btnSeminarCancel=new FingerButton(host,"btnSeminarCancel",1090,210,120,20);$.btnSeminarCancel.setText("지원취소");$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",120,170,850,60);$.chkReportYN=new FingerCheckBox(host,"chkReportYN",1100,190,100,20);$.chkReportYN.setText("협회신고");$.lblCpId=new FingerLabel(host,"lblCpId",25,10,100,20);$.lblCpId.setText("문서번호");$.txtCpId=new FingerEdit(host,"txtCpId",130,10,135,20);$.lblCpDeptCode=new FingerLabel(host,"lblCpDeptCode",25,40,100,20);$.lblCpDeptCode.setText("소속부서");$.cmbCpDeptCode=new FingerComboBox(host,"cmbCpDeptCode",130,40,140,20);$.lblCpEmpId=new FingerLabel(host,"lblCpEmpId",415,40,100,20);$.lblCpEmpId.setText("담당자");$.cmbCpEmpId=new FingerComboBox(host,"cmbCpEmpId",520,40,140,20);$.lblCpConductOrg=new FingerLabel(host,"lblCpConductOrg",25,70,100,20);$.lblCpConductOrg.setText("주최단체");$.txtCpConductOrg=new FingerEdit(host,"txtCpConductOrg",130,70,240,20);$.lblCpSymposiumTitle=new FingerLabel(host,"lblCpSymposiumTitle",25,100,100,20);$.lblCpSymposiumTitle.setText("학술대회명");$.txtCpSymposiumTitle=new FingerEdit(host,"txtCpSymposiumTitle",130,100,530,20);$.lblCpDate=new FingerLabel(host,"lblCpDate",25,130,100,20);$.lblCpDate.setText("개최일자");$.dteCpStartDate=new FingerDateEdit(host,"dteCpStartDate",130,130,140,20);$.lblEx1=new FingerLabel(host,"lblEx1",265,130,20,20);$.lblEx1.setText("~");$.dteCpEndDate=new FingerDateEdit(host,"dteCpEndDate",285,130,140,20);$.lblCpHostCountry=new FingerLabel(host,"lblCpHostCountry",25,160,100,20);$.lblCpHostCountry.setText("개최국가");$.txtCpHostCountry=new FingerEdit(host,"txtCpHostCountry",130,160,140,20);$.lblCpHostCity=new FingerLabel(host,"lblCpHostCity",415,160,100,20);$.lblCpHostCity.setText("개최도시");$.txtCpHostCity=new FingerEdit(host,"txtCpHostCity",520,160,140,20);$.lblContactCnt=new FingerLabel(host,"lblContactCnt",25,190,100,20);$.lblContactCnt.setText("지원인원");$.speContactCnt=new FingerSpinEdit(host,"speContactCnt",130,190,140,20);$.lblStatus=new FingerLabel(host,"lblStatus",415,10,100,20);$.lblStatus.setText("승인상태");$.cmbStatus=new FingerComboBox(host,"cmbStatus",520,10,140,20);$.lblEx2=new FingerLabel(host,"lblEx2",10,230,410,20);$.lblEx2.setText("*학술대회 개최 63일전까지 신청서를 제출하여 주시기 바랍니다.");$.lblEx3=new FingerLabel(host,"lblEx3",75,255,245,20);$.lblEx3.setText("현재 개최일로부터 60일 전입니다.");$.lblEx4=new FingerLabel(host,"lblEx4",660,100,360,20);$.lblEx4.setText("* [(학술대회약자)풀네임]형태로 작성하여 주시기 바랍니다.");$.lblEx5=new FingerLabel(host,"lblEx5",660,160,365,20);$.lblEx5.setText("* 개최국가 및 도시는 국문명으로 작성하여 주시기 바랍니다.");$.lbl_cp_bgt_mgr=new FingerLabel(host,"lbl_cp_bgt_mgr",680,40,120,20);$.lbl_cp_bgt_mgr.setText("예산처리담당자");$.cmb_cp_bgt_mgr=new FingerComboBox(host,"cmb_cp_bgt_mgr",805,40,140,20);$.lblEstimatedAmt=new FingerLabel(host,"lblEstimatedAmt",415,130,100,20);$.lblEstimatedAmt.setText("예상금액");$.numEstimatedAmt=new FingerSpinEdit(host,"numEstimatedAmt",520,130,140,20);$.lblReason=new FingerLabel(host,"lblReason",415,190,100,20);$.lblReason.setText("추가신청사유");$.memoReason=new FingerMemoEdit(host,"memoReason",520,190,415,60);$.lblApproveYN=new FingerLabel(host,"lblApproveYN",660,70,140,20);$.lblApproveYN.setText("Annual B.P. 승인여부");$.rdoApproveYN=new FingerRadioBox(host,"rdoApproveYN",805,70,140,20);$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",10,10,120,30);$.btnMAConfirm.setText("MA 승인");$.btnMACancel=new FingerButton(host,"btnMACancel",10,45,120,30);$.btnMACancel.setText("MA 승인취소");$.btnGAConfirm=new FingerButton(host,"btnGAConfirm",10,90,120,30);$.btnGAConfirm.setText("GA 승인");$.btnGACancel=new FingerButton(host,"btnGACancel",10,125,120,30);$.btnGACancel.setText("GA 승인취소");$.memMADescr=new FingerMemoEdit(host,"memMADescr",120,10,850,60);$.memGADescr=new FingerMemoEdit(host,"memGADescr",120,90,850,60);$.btnGAMemoSave=new FingerButton(host,"btnGAMemoSave",985,90,120,65);$.btnGAMemoSave.setText("GA 메모저장");$.btnMAMemoSave=new FingerButton(host,"btnMAMemoSave",985,10,120,65);$.btnMAMemoSave.setText("MA 메모저장");$.lbl_ma_mgr=new FingerLabel(host,"lbl_ma_mgr",680,10,120,20);$.lbl_ma_mgr.setText("MA 담당자");$.cmb_ma_mgr=new FingerComboBox(host,"cmb_ma_mgr",805,10,140,20);$.cmb_product_code=new FingerComboBox(host,"cmb_product_code",805,130,140,20);$.lbl_notice2=new FingerLabel(host,"lbl_notice2",350,70,140,20);$.lbl_notice2.setText("[해외 주최단체 기입]");$.btnMAConfirm2=new FingerButton(host,"btnMAConfirm2",920,240,140,20);$.btnMAConfirm2.setText("MA부서장 승인");$.btnMACancel2=new FingerButton(host,"btnMACancel2",1050,240,150,20);$.btnMACancel2.setText("MA부서장 승인취소");$.btnLimitFree=new FingerButton(host,"btnLimitFree",985,205,120,30);$.btnLimitFree.setText("기한 해제");$.lblContactCnt2=new FingerLabel(host,"lblContactCnt2",240,190,50,20);$.lblContactCnt2.setText("명");relocateChildIndexInPanel([$.panBase]);$.cmbCpDeptCode.setAllowBlank(false,"소속부서");$.cmbCpEmpId.setAllowBlank(false,"담당자");$.txtCpConductOrg.setAllowBlank(false,"주최단체");$.txtCpSymposiumTitle.setAllowBlank(false,"학술대회명");$.dteCpStartDate.setAllowBlank(false,"개최일자 시작일");$.dteCpEndDate.setAllowBlank(false,"개최일자 종료일");$.txtCpHostCountry.setAllowBlank(false,"개최국가");$.txtCpHostCity.setAllowBlank(false,"개최도시");$.speContactCnt.setAllowBlank(false,"지원인원");$.numEstimatedAmt.setAllowBlank(false,"예상금액");$.cmb_ma_mgr.setAllowBlank(false,"MA 담당자");$.rdoApproveYN.addButtons([{code_name:"승인",sub_code:"Y"},{code_name:"미승인",sub_code:"N"}]);$.grdFile.colIdx=$.grdFile.setColumns([new FingerDataGridColumn("seq",100,"left","string","일렬번호",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("server_path",215,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",500,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.panBase.addButtons(["btnDelete","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.cmbCpEmpId.setEnable(false);$.cmb_cp_bgt_mgr.setEnable(false);$.cmb_ma_mgr.setEnable(false);$.cmbCpDeptCode.setEnable(false);$.txtCpId.setReadOnly(true);$.dteCpStartDate.setValue(getCalcDate(getToday(),70));$.dteCpEndDate.setValue(getCalcDate(getToday(),71));$.lblEx3.setAlign("left");$.lblEx4.setAlign("left");$.lblEx5.setAlign("left");$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);$.memMADescr.setReadOnly(true);$.btnMAMemoSave.setVisible(false);$.btnMAConfirm2.setVisible(false);$.btnMACancel2.setVisible(false);$.btnGAConfirm.setVisible(false);$.btnGACancel.setVisible(false);$.memGADescr.setReadOnly(true);$.btnGAMemoSave.setVisible(false);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.memCPDescr.setReadOnly(true);$.btnMemoSave.setVisible(false);$.btnLimitFree.setVisible(false);$.btnReportYnSave.setVisible(false);$.btnSeminarCancel.setVisible(false);$.chkReportYN.setVisible(false);$.cmb_product_code.setVisible(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panBase);$.panMain.add($.panFile);$.panMain.add($.panConfirm);$.panBase.add($.lblCpId);$.panBase.add($.txtCpId);$.panBase.add($.lblCpDeptCode);$.panBase.add($.cmbCpDeptCode);$.panBase.add($.lblCpEmpId);$.panBase.add($.cmbCpEmpId);$.panBase.add($.lblCpConductOrg);$.panBase.add($.txtCpConductOrg);$.panBase.add($.lblCpSymposiumTitle);$.panBase.add($.txtCpSymposiumTitle);$.panBase.add($.lblCpDate);$.panBase.add($.dteCpStartDate);$.panBase.add($.lblEx1);$.panBase.add($.dteCpEndDate);$.panBase.add($.lblCpHostCountry);$.panBase.add($.txtCpHostCountry);$.panBase.add($.lblCpHostCity);$.panBase.add($.txtCpHostCity);$.panBase.add($.lblContactCnt);$.panBase.add($.speContactCnt);$.panBase.add($.lblStatus);$.panBase.add($.cmbStatus);$.panBase.add($.lblEx2);$.panBase.add($.lblEx3);$.panBase.add($.lblEx4);$.panBase.add($.lblEx5);$.panBase.add($.lbl_cp_bgt_mgr);$.panBase.add($.cmb_cp_bgt_mgr);$.panBase.add($.lblEstimatedAmt);$.panBase.add($.numEstimatedAmt);$.panBase.add($.memoReason);$.panBase.add($.lblReason);$.panBase.add($.lblApproveYN);$.panBase.add($.rdoApproveYN);$.panBase.add($.lbl_ma_mgr);$.panBase.add($.cmb_ma_mgr);$.panBase.add($.cmb_product_code);$.panBase.add($.lbl_notice2);$.panBase.add($.lblContactCnt2);$.panFile.add($.grdFile);$.panConfirm.add($.chkReportYN);$.panConfirm.add($.btnSeminarCancel);$.panConfirm.add($.btnReportYnSave);$.panConfirm.add($.btnMemoSave);$.panConfirm.add($.btnCancel);$.panConfirm.add($.btnConfirm);$.panConfirm.add($.memCPDescr);$.panConfirm.add($.btnMAConfirm);$.panConfirm.add($.btnMACancel);$.panConfirm.add($.btnGAConfirm);$.panConfirm.add($.btnGACancel);$.panConfirm.add($.memMADescr);$.panConfirm.add($.memGADescr);$.panConfirm.add($.btnGAMemoSave);$.panConfirm.add($.btnMAMemoSave);$.panConfirm.add($.btnMAConfirm2);$.panConfirm.add($.btnMACancel2);$.panConfirm.add($.btnLimitFree);$.cmbCpEmpId.setColumn("employee_id","emp_name");$.cmb_cp_bgt_mgr.setColumn("employee_id","emp_name");$.cmb_ma_mgr.setColumn("employee_id","emp_name");$.cmbCpDeptCode.setColumn("dept_code","dept_name");$.cmb_product_code.setColumn("product_code","product_name");var ds=bizComponentData2($,"Q1","L_CRM0219|L_CRM0219|L_CRM0219|L_CRM0051|L_CRM0111|L_CRM0040");setComboBind([$.cmbCpEmpId,$.cmb_cp_bgt_mgr,$.cmb_ma_mgr,$.cmbCpDeptCode,$.cmbStatus,$.cmb_product_code],ds);var strQuery=" and extra_field1 LIKE '%' + 'CP08' + '%'";var ds=bizComponentData2($,"Q4","L_CRM0110",strQuery);$.grdFile.setColumnDropDownList("file_type",ds.resultList[0]);$.cmbCpEmpId.setValue(g_main.session.getValue("UserID"));$.cmbCpDeptCode.setValue(g_main.session.getValue("DeptCode"));if($.p_argument&&$.p_argument.length>0){$.idPopUp="Y";$.cmbStatus.setEnable(false);var rs=$.p_argument[0][0];if(rs.CallType){$.strCallType=rs.CallType}$.cmbStatus.setValue(rs.cp_status);$.memCPDescr.setValue(rs.cp_descr);$.bAllReport=rs.AllReport;$.bMyReport=rs.MyReport;$.bConfirm=rs.Confirm;$.varModify=rs.modify_yn;if(!$.bConfirm){$.panConfirm.setVisible(false)}else{$.panConfirm.setVisible(true)}if(rs.save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnabelSet(false)}if($.strCallType=="BUCall"){$.panBase.disableButton(["btnSave","btnDelete","btnNew"]);$.panConfirm.setVisible(false)}$.txtCpId.setValue(rs.cp_id);$.cpDocNo=rs.cp_doc_no;$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;$.cmbCpEmpId.setValue(rs.cp_emp_id);$.cmbCpDeptCode.setValue(rs.cp_dept_code);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtCpSymposiumTitle.setValue(rs.cp_symposium_title);$.dteCpStartDate.setValue(rs.cp_start_date);$.dteCpEndDate.setValue(rs.cp_end_date);$.txtCpHostCountry.setValue(rs.cp_host_country);$.txtCpHostCity.setValue(rs.cp_host_city);$.numEstimatedAmt.setValue(rs.estimated_amt);$.speContactCnt.setValue(rs.contact_cnt);$.cmb_product_code.setValue(rs.product_code);$.rdoApproveYN.setValue(rs.approve_yn);$.cmbStatus.setValue(rs.cp_status);$.cmb_cp_bgt_mgr.setValue(rs.cp_bgt_mgr);$.cmb_ma_mgr.setValue(rs.cp_ma_mgr);$.memMADescr.setValue(rs.approver_1st_memo);$.memGADescr.setValue(rs.approver_2nd_memo);$.approver_1st=rs.approver_1st;$.approver_1st_yn=rs.approver_1st_yn;$.approver_2nd=rs.approver_2nd;$.approver_2nd_yn=rs.approver_2nd_yn;$.memoReason.setValue(rs.reason);setDataGrid([$.grdFile],$.p_argument[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn);setDataGrid([$.grdFile],$.p_argument[1],true);$.panConfirm.setVisible(true);if($.cmbStatus.getValue()=="05"&&$.approver_1st==g_main.session.getValue("UserID")){if($.approver_1st_yn=="N"){$.btnMAConfirm.setVisible(true);$.memMADescr.setReadOnly(false);$.btnMAMemoSave.setVisible(true)}if($.approver_1st_yn=="Y"&&$.approver_2nd_yn=="N"){$.btnMACancel.setVisible(true);$.memMADescr.setReadOnly(false);$.btnMAMemoSave.setVisible(true)}if(!$.bSave){$.panBase.disableButton(["btnDelete"])}}if($.cmbStatus.getValue()=="05"&&($.approver_2nd==g_main.session.getValue("DeptCode")||$.approver_2nd==g_main.session.getValue("UserID"))){if($.approver_1st_yn=="Y"&&$.approver_2nd_yn=="N"){$.btnGAConfirm.setVisible(true);$.memGADescr.setReadOnly(false);$.btnGAMemoSave.setVisible(true)}if($.approver_1st_yn=="Y"&&$.approver_2nd_yn=="Y"){$.btnGACancel.setVisible(true);$.memGADescr.setReadOnly(false);$.btnGAMemoSave.setVisible(true)}if(!$.bSave){$.panBase.disableButton(["btnDelete"])}}if($.cmbStatus.getValue()=="05"&&$.bConfirm&&$.approver_1st_yn=="N"){$.btnLimitFree.setVisible(true)}if($.cmbStatus.getValue()=="10"){if($.approver_2nd==g_main.session.getValue("UserID")){$.btnGACancel.setVisible(true);$.memGADescr.setReadOnly(false);$.btnGAMemoSave.setVisible(true)}if($.bConfirm){$.btnConfirm.setVisible(true);$.btnMemoSave.setVisible(true);$.chkReportYN.setVisible(true);$.memCPDescr.setReadOnly(false);$.btnSeminarCancel.setVisible(true);$.btnReportYnSave.setVisible(true)}if(!$.bSave){$.panBase.disableButton(["btnDelete"])}}if($.cmb_ma_mgr.getValue()==""){setMAMgr()}else{if($.cmbStatus.getValue()=="90"){if($.bConfirm){$.btnCancel.setVisible(true);$.chkReportYN.setVisible(true);$.btnSeminarCancel.setVisible(true);$.btnReportYnSave.setVisible(true)}}}}else{$.panBase.clear();$.cmbCpEmpId.setValue(g_main.session.getValue("UserID"));$.cmbCpDeptCode.setValue(g_main.session.getValue("DeptCode"));$.cmbStatus.setEnable(false);$.cmbStatus.setValue("05");setMAMgr();$.rdoApproveYN.setValue("Y");$.dteCpStartDate.setValue(getCalcDate(getToday(),70));$.dteCpEndDate.setValue(getCalcDate(getToday(),71));$.grdFile.clear();$.panConfirm.setVisible(false)}};$.callback=function(type,ds){if(type=="D"){if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.");var share={save_mode:"DEL"};closeSharePopUp(share)}}else{if(type=="N"){if(ds.returnStr){var temp=ds.returnStr.split("|");$.txtCpId.setValue(temp[0])}}else{if(type=="U"){if(ds.errorCode=="P_crmCPMaster_S_001"){MessageBoxShow("승인이 진행중인 건은 수정이 불가능합니다.")}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){var share={};if(id=="btnMAConfirm"){share.save_mode="MACONFIRM";closeSharePopUp(share)}else{if(id=="btnMACancel"){share.save_mode="MACANCEL";closeSharePopUp(share)}else{if(id=="btnMAMemoSave"){share.save_mode="MAMEMO";closeSharePopUp(share)}else{if(id=="btnGAConfirm"){share.save_mode="GACONFIRM";closeSharePopUp(share)}else{if(id=="btnGACancel"){share.save_mode="GACANCEL";closeSharePopUp(share)}else{if(id=="btnGAMemoSave"){share.save_mode="GAMEMO";closeSharePopUp(share)}else{if(id=="btnConfirm"){share.save_mode="CONFIRM";closeSharePopUp(share)}else{if(id=="btnCancel"){share.save_mode="CANCEL";closeSharePopUp(share)}else{if(id=="btnMemoSave"){share.save_mode="MEMO";closeSharePopUp(share)}else{if(id=="btnReportYnSave"){saveReportYN("REPORT")}else{if(id=="btnSeminarCancel"){confirmBoxShow("지원취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("CANCEL")}})}else{if(id=="btnMAConfirm2"){share.save_mode="MACONFIRM2";closeSharePopUp(share)}else{if(id=="btnMACancel2"){share.save_mode="MACANCEL2";closeSharePopUp(share)}else{if(id=="btnLimitFree"){confirmBoxShow("입력 기한을 해제하시겠습니까?",function(){if(g_main.msgShare==true){if(saveExtraFunction("LimitFree")){MessageBoxShow("해제되었습니다.")}}})}}}}}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmb_product_code"){if($.cmb_product_code.getValue!=""){setMAMgr()}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteCpStartDate"){if($.dteCpStartDate.getValue()){var dt1=getToday("");var dt2=value;var tmp_dt1=new Date(dt1.substr(0,4),dt1.substr(4,2),dt1.substr(6,2));var tmp_dt2=new Date(dt2.substr(0,4),dt2.substr(4,2),dt2.substr(6,2));var btMs=tmp_dt2.getTime()-tmp_dt1.getTime();var btDay=btMs/(1000*60*60*24);$.lblEx3.setText("현재 개최일로부터 "+btDay+"일 전입니다.")}else{$.lblEx3.setText("현재 개최일로부터  일 전입니다.")}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panBase"){if(btnId=="btnSave"){var docuCheck=false;var fileRow=$.grdFile.getAllRows();if(fileRow.length>0){for(var i in fileRow){if(fileRow[i].file_type=="061"){docuCheck=true;break}}}if(docuCheck){saveCpSymposiumBefore()}else{MessageBoxShow("학회프로그램(Agenda)는 필수 첨부 파일입니다.");return}}else{if(btnId=="btnDelete"){confirmBoxShow("["+$.txtCpId.getValue()+"] 국내외 학술대회 참가지원(사후)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCpSymposiumBefore("D")}})}else{if(btnId=="btnNew"){$.panBase.clear();$.cmbCpEmpId.setValue(g_main.session.getValue("UserID"));$.cmbCpDeptCode.setValue(g_main.session.getValue("DeptCode"));$.cmbStatus.setValue("05");$.cmb_cp_bgt_mgr.setValue("ka002009");setMAMgr();$.dteCpStartDate.setValue(getCalcDate(getToday(),71));$.dteCpEndDate.setValue(getCalcDate(getToday(),72));$.grdFile.clear();$.rdoApproveYN.setValue("Y")}else{if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={cp_type:"CP08"};g_main.openPopup("popCPDonationBf.html","popCPDonationBf","",0,0,"","",param,"","")}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList);for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}}}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}};$.fingerpopup_close=function(id){if(g_main.popShare!=null){var popResult=g_main.popShare;if(id=="popCPDonationBf"){if($.popUpCallId=="btnLoad"){if(popResult[0][0].before_cp_id){var rs=popResult[0][0];$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;$.beforeCpDocNo=rs.before_cp_doc_no;$.cmbCpEmpId.setValue(rs.cp_emp_id);$.cmbCpDeptCode.setValue(rs.cp_dept_code);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtCpSymposiumTitle.setValue(rs.cp_symposium_title);$.dteCpStartDate.setValue(rs.cp_start_date);$.dteCpEndDate.setValue(rs.cp_end_date);$.txtCpHostCountry.setValue(rs.cp_host_country);$.txtCpHostCity.setValue(rs.cp_host_city);$.speContactCnt.setValue(rs.contact_cnt);$.txtReceiptNo.setValue(rs.receipt_no);$.speTotalAmt.setValue(rs.total_amt);$.speChargeAmt.setValue(rs.charge_amt);$.cmbStatus.setValue(rs.cp_status);setDataGrid([$.grdFile],popResult[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn)}else{$.beforeCpId="";$.beforeCpCode="";$.beforeCpDocNo="";$.panBase.clear();$.cmbCpEmpId.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteCpStartDate.setValue(getCalcDate(getToday(),60));$.dteCpEndDate.setValue(getCalcDate(getToday(),61));$.grdFile.clear();$.memCPDescr.setValue("");$.chkReportYN.setValue("")}}}}};$.fingerpopup2_close=function(id){if(g_main.popShare2!=null){var popResult=g_main.popShare2;if(id=="popCPDonationBf"){if($.popUpCallId=="btnLoad"){if(popResult[0][0].before_cp_id){var rs=popResult[0][0];$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;$.beforeCpDocNo=rs.before_cp_doc_no;$.cmbEmp.setValue(rs.cp_emp_id);$.cmbCpEmpPm.setValue(rs.cp_emp_pm);$.txtNoticeNo.setValue(rs.notice_no);$.cmbProductCode.setValue(rs.product_code);$.cmbStatus.setValue(rs.cp_status);$.txtCpSymposium.setValue(rs.cp_symposium);$.dteAppDate.setValue(rs.app_date);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtCpDonEmp.setValue(rs.cp_don_emp);$.txtCpDonTel.setValue(rs.cp_don_tel);$.txtCpDonEmail.setValue(rs.cp_don_email);$.dteStart.setValue(rs.cp_start_date);$.dteEnd.setValue(rs.cp_end_date);$.dteNoticeTerm.setValue(rs.limit_date);$.speCpDonationAmt.setValue(rs.cp_donation_amt);$.dteCpDonationDate.setValue(rs.cp_donation_date);$.speCpVoteAmt.setValue(rs.cp_vote_amt);$.txtCpPlace.setValue(rs.cp_place);setDataGrid([$.grdFile],popResult[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn)}else{$.beforeCpId="";$.beforeCpCode="";$.beforeCpDocNo="";$.panBase.clear();$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteAppDate.setValue(getToday());$.grdFile.clear();$.memCPDescr.setValue("");$.chkReportYN.setValue("")}}}}};$.fingerradiobox_change=function(id,value){if(id=="rdoApproveYN"){if($.rdoApproveYN.getValue()=="Y"){$.memoReason.setAllowBlank(true,"추가신청사유")}else{if($.rdoApproveYN.getValue()=="N"){$.memoReason.setAllowBlank(false,"추가신청사유")}}}};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>