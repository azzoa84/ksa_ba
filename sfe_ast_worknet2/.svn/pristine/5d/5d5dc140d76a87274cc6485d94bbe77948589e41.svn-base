<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panInfo=null;$.panDept=null;$.panEmp=null;$.lblSystemRoleCode=null;$.lblSystemRoleName=null;$.txtSystemRoleCode=null;$.txtSystemRoleName=null;$.btnSearch=null;$.grdSystemRole=null;$.lblSystemRoleCode1=null;$.lblSystemRoleName1=null;$.lblSystemRoleDesc1=null;$.txtSystemRoleCode1=null;$.txtSystemRoleName1=null;$.memSystemRoleDesc=null;$.grdSystemRoleEmp=null;$.grdSystemRoleDept=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmSystemRole1_Q",[workType,workType=="Q"?$.txtSystemRoleCode.getValue():$.systemRoleCode,$.txtSystemRoleName.getValue()]);return json}function createJSON_S(workType){var json="";if(workType=="D"||workType=="U"||workType=="N"||workType=="DEPTD"||workType=="EMPD"){json=createExecuteParamInfo("P_crmSystemRole1_S",[workType,$.txtSystemRoleCode1.getValue(),$.txtSystemRoleName1.getValue(),$.memSystemRoleDesc.getValue(),$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"employee_id"):"","N","N","N","N","N",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"etc_role1"):"",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"etc_role2"):"",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"ect_role3"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"dept_code"):"","N","N","N","N","N",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"etc_role1"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"etc_role2"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"ect_role3"):"","#UserID#"])}else{if(workType=="DEPT"){var changedRows=$.grdSystemRoleDept.getChangedRows();if(changedRows.length<1){return}var rows=[];for(var i in changedRows){if(changedRows[i].rowType=="N"){changedRows[i].rowType="DEPTN"}else{if(changedRows[i].rowType=="U"){changedRows[i].rowType="DEPTU"}}workType=changedRows[i].rowType;rows.push([workType,$.txtSystemRoleCode1.getValue(),$.txtSystemRoleName1.getValue(),$.memSystemRoleDesc.getValue(),$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"employee_id"):"","N","N","N","N","N",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"etc_role1"):"",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"etc_role2"):"",$.grdSystemRoleEmp.getRowCount()>0?$.grdSystemRoleEmp.getValue($.grdSystemRoleEmp.getSelectedRowIdx(),"ect_role3"):"",$.grdSystemRoleDept.getRowCount()>0?changedRows[i].dept_code:"","N","N","N","N","N",$.grdSystemRoleDept.getRowCount()>0?((changedRows[i].etc_role1==true||changedRows[i].etc_role1=="Y")?"Y":"N"):"",$.grdSystemRoleDept.getRowCount()>0?((changedRows[i].etc_role2==true||changedRows[i].etc_role2=="Y")?"Y":"N"):"",$.grdSystemRoleDept.getRowCount()>0?((changedRows[i].ect_role3==true||changedRows[i].ect_role3=="Y")?"Y":"N"):"","#UserID#"])}json=createExecuteParamInfo("P_crmSystemRole1_S",rows)}else{if(workType=="EMP"){console.log("123");var changedRows=$.grdSystemRoleEmp.getChangedRows();if(changedRows.length<1){return}var rows=[];console.log($.grdSystemRoleDept.getSelectedRowIdx());for(var i in changedRows){if(changedRows[i].rowType=="N"){changedRows[i].rowType="EMPN"}else{if(changedRows[i].rowType=="U"){changedRows[i].rowType="EMPU"}}workType=changedRows[i].rowType;rows.push([workType,$.txtSystemRoleCode1.getValue(),$.txtSystemRoleName1.getValue(),$.memSystemRoleDesc.getValue(),$.grdSystemRoleEmp.getRowCount()>0?changedRows[i].employee_id:"","N","N","N","N","N",$.grdSystemRoleEmp.getRowCount()>0?((changedRows[i].etc_role1==true||changedRows[i].etc_role1=="Y")?"Y":"N"):"",$.grdSystemRoleEmp.getRowCount()>0?((changedRows[i].etc_role2==true||changedRows[i].etc_role2=="Y")?"Y":"N"):"",$.grdSystemRoleEmp.getRowCount()>0?((changedRows[i].ect_role3==true||changedRows[i].ect_role3=="Y")?"Y":"N"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"dept_code"):"","N","N","N","N","N",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"etc_role1"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"etc_role2"):"",$.grdSystemRoleDept.getRowCount()>0?$.grdSystemRoleDept.getValue($.grdSystemRoleDept.getSelectedRowIdx(),"ect_role3"):"","#UserID#"])}json=createExecuteParamInfo("P_crmSystemRole1_S",rows)}}}return json}function searchSystemRole(workType){if(workType=="Q"){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}else{if(workType=="ROLE"){var json=createJSON_Q("ROLE");callQuery(["req",json],"ROLE",$)}}}function saveSystemRole(workType){if(workType=="D"){var json=createJSON_S("D");callQuery(["req",json],"D",$)}else{if(workType==""){if($.systemRoleCode==""){var json=createJSON_S("N");callQuery(["req",json],"N",$)}else{var json=createJSON_S("U");callQuery(["req",json],"U",$)}}else{if(workType=="DEPT"){var json=createJSON_S("DEPT");callQuery(["req",json],"DEPT",$)}else{if(workType=="DEPTD"){var json=createJSON_S("DEPTD");callQuery(["req",json],"DEPTD",$)}else{if(workType=="EMP"){var json=createJSON_S("EMP");callQuery(["req",json],"EMP",$)}else{if(workType=="EMPD"){var json=createJSON_S("EMPD");callQuery(["req",json],"EMPD",$)}}}}}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,765);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,300,760);$.panQuery.setText("역할리스트");$.panQuery.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",310,0,885,180);$.panInfo.setText("역할정보");$.panInfo.setBottomLine(true);$.panDept=new FingerPanel(host,"panDept",310,190,885,235);$.panDept.setText("부서권한");$.panDept.setBottomLine(true);$.panEmp=new FingerPanel(host,"panEmp",310,435,885,325);$.panEmp.setText("사원권한");$.panEmp.setBottomLine(true);$.lblSystemRoleCode=new FingerLabel(host,"lblSystemRoleCode",0,10,110,20);$.lblSystemRoleCode.setText("시스템역할코드");$.lblSystemRoleName=new FingerLabel(host,"lblSystemRoleName",0,40,110,20);$.lblSystemRoleName.setText("시스템역할명");$.txtSystemRoleCode=new FingerEdit(host,"txtSystemRoleCode",120,10,140,20);$.txtSystemRoleName=new FingerEdit(host,"txtSystemRoleName",120,40,140,20);$.btnSearch=new FingerButton(host,"btnSearch",220,-37.5,80,20);$.btnSearch.setText("조회");$.grdSystemRole=new FingerDataGrid(host,"grdSystemRole",0,75,300,635);$.lblSystemRoleCode1=new FingerLabel(host,"lblSystemRoleCode1",0,10,120,20);$.lblSystemRoleCode1.setText("시스템역할코드");$.lblSystemRoleName1=new FingerLabel(host,"lblSystemRoleName1",0,40,120,20);$.lblSystemRoleName1.setText("시스템역할명");$.lblSystemRoleDesc1=new FingerLabel(host,"lblSystemRoleDesc1",0,70,120,20);$.lblSystemRoleDesc1.setText("시스템역할설명");$.txtSystemRoleCode1=new FingerEdit(host,"txtSystemRoleCode1",130,10,140,20);$.txtSystemRoleName1=new FingerEdit(host,"txtSystemRoleName1",130,40,140,20);$.memSystemRoleDesc=new FingerMemoEdit(host,"memSystemRoleDesc",130,70,400,50);$.grdSystemRoleEmp=new FingerDataGrid(host,"grdSystemRoleEmp",0,0,880,275);$.grdSystemRoleDept=new FingerDataGrid(host,"grdSystemRoleDept",0,0,880,185);$.txtSystemRoleCode1.setAllowBlank(false,"시스템역할코드");$.txtSystemRoleName1.setAllowBlank(false,"시스템역할명");$.grdSystemRole.colIdx=$.grdSystemRole.setColumns([new FingerDataGridColumn("system_role_code",140,"left","string","시스템역할코드"),new FingerDataGridColumn("system_role_name",145,"left","string","시스템역할명"),new FingerDataGridColumn("system_role_desc",130,"left","string","시스템역할설명")]);$.grdSystemRole.init();$.grdSystemRole.setColumnHidden(["system_role_desc"],true);$.grdSystemRole.setBorder(false);$.grdSystemRoleDept.colIdx=$.grdSystemRoleDept.setColumns([new FingerDataGridColumn("dept_code",140,"left","string","부서코드"),new FingerDataGridColumn("dept_name",320,"left","string","부서명"),new FingerDataGridColumn("etc_role1",180,"center","checkbox","기타1"),new FingerDataGridColumn("etc_role2",180,"center","checkbox","기타2"),new FingerDataGridColumn("ect_role3",180,"center","checkbox","기타3")]);$.grdSystemRoleDept.init();$.grdSystemRoleDept.setColumnHidden(["dept_code"],true);$.grdSystemRoleDept.setBorder(false);$.grdSystemRoleDept.setEditable(true);$.grdSystemRoleEmp.colIdx=$.grdSystemRoleEmp.setColumns([new FingerDataGridColumn("employee_id",140,"left","string","사원코드"),new FingerDataGridColumn("emp_name",320,"left","string","사원명"),new FingerDataGridColumn("etc_role1",180,"center","checkbox","기타1"),new FingerDataGridColumn("etc_role2",180,"center","checkbox","기타2"),new FingerDataGridColumn("ect_role3",180,"center","checkbox","기타3")]);$.grdSystemRoleEmp.init();$.grdSystemRoleEmp.setColumnHidden(["employee_id"],true);$.grdSystemRoleEmp.setBorder(false);$.grdSystemRoleEmp.setEditable(true);$.panInfo.addButton("btnDelete","삭제");$.panInfo.addButton("btnSave","저장");$.panInfo.addButton("btnNew","신규");$.panInfo.setButtonAction("btnNew","new");$.panInfo.setButtonAction("btnSave","save");$.panInfo.setButtonAction("btnDelete","delete");$.panDept.addButton("btnDelete","삭제");$.panDept.addButton("btnSave","저장");$.panDept.addButton("btnNew","신규");$.panDept.setButtonAction("btnNew","new");$.panDept.setButtonAction("btnSave","save");$.panDept.setButtonAction("btnDelete","delete");$.panEmp.addButton("btnDelete","삭제");$.panEmp.addButton("btnSave","저장");$.panEmp.addButton("btnNew","신규");$.panEmp.setButtonAction("btnNew","new");$.panEmp.setButtonAction("btnSave","save");$.panEmp.setButtonAction("btnDelete","delete");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panInfo);$.panMain.add($.panDept);$.panMain.add($.panEmp);$.panQuery.add($.lblSystemRoleCode);$.panQuery.add($.lblSystemRoleName);$.panQuery.add($.txtSystemRoleCode);$.panQuery.add($.txtSystemRoleName);$.panQuery.add($.btnSearch);$.panQuery.add($.grdSystemRole);$.panInfo.add($.lblSystemRoleCode1);$.panInfo.add($.lblSystemRoleName1);$.panInfo.add($.lblSystemRoleDesc1);$.panInfo.add($.txtSystemRoleCode1);$.panInfo.add($.txtSystemRoleName1);$.panInfo.add($.memSystemRoleDesc);$.panDept.add($.grdSystemRoleDept);$.panEmp.add($.grdSystemRoleEmp);searchSystemRole("Q");$.systemRoleCode="";$.rId=0;$.txtSystemRoleCode1.setReadOnly(true)};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdSystemRole],ds);if($.rId>0){$.grdSystemRole.selectRow(0)}else{$.grdSystemRole.selectRow(0)}}else{if(type=="ROLE"){if(ds.resultList[0].length>0){setDataGrid([$.grdSystemRoleEmp],ds.resultList[0],true);$.grdSystemRoleEmp.selectRow(0)}else{$.grdSystemRoleEmp.extObj.clearAll()}if(ds.resultList.length>1){if(ds.resultList[1].length>0){setDataGrid([$.grdSystemRoleDept],ds.resultList[1],true);$.grdSystemRoleDept.selectRow(0)}else{$.grdSystemRoleDept.extObj.clearAll()}}}else{if(type=="N"||type=="U"||type=="D"||type=="DEPT"||type=="DEPTD"||type=="EMP"||type=="EMPD"){searchSystemRole("Q")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchSystemRole("Q")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdSystemRoleEmp"){$.varRowId="";if(cInd=="emp_name"){$.varRowId=rId;$.popUpCallId="grdSystemRoleEmp";var param={employee_id:"",emp_name:cInd.value||"",p3:"",p4:"",p5:""};g_main.openPopup("popEmp.html","popEmp","사원팝업",750,500,"","",param,"","")}}else{if(id=="grdSystemRoleDept"){$.varRowId="";if(cInd=="dept_name"){$.varRowId=rId;$.popUpCallId="grdSystemRoleDept";console.log(cInd.value);var param={dept_code:"",dept_name:cInd.value||"",p3:"",p4:"",p5:""};g_main.openPopup("popDept.html","popDept","부서팝업",350,580,"","",param,"","")}}}};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdSystemRole"){$.rId=rId;$.txtSystemRoleCode1.setReadOnly(true);$.systemRoleCode=$.grdSystemRole.getValue(rId,"system_role_code");$.txtSystemRoleCode1.setValue($.grdSystemRole.getValue(rId,"system_role_code"));$.txtSystemRoleName1.setValue($.grdSystemRole.getValue(rId,"system_role_name"));$.memSystemRoleDesc.setValue($.grdSystemRole.getValue(rId,"system_role_desc"));searchSystemRole("ROLE")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtSystemRoleCode")&&value=="13"){searchSystemRole("Q")}else{if((id=="txtSystemRoleName")&&value=="13"){searchSystemRole("Q")}}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){$.txtSystemRoleCode1.setReadOnly(false);$.systemRoleCode="";$.txtSystemRoleCode1.setValue("");$.txtSystemRoleName1.setValue("");$.memSystemRoleDesc.setValue("");$.grdSystemRoleDept.extObj.clearAll();$.grdSystemRoleEmp.extObj.clearAll();$.txtSystemRoleCode1.setFocus()}else{if(btnId=="btnSave"){if(!validateControls([$.txtSystemRoleCode1,$.txtSystemRoleName1])){return}else{saveSystemRole("")}}else{if(btnId=="btnDelete"){confirmBoxShow("["+$.grdSystemRole.getValue($.grdSystemRole.getSelectedRowIdx(),"system_role_name")+"] 을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveSystemRole("D")}})}}}}else{if(panelId=="panDept"){if(btnId=="btnNew"){$.grdSystemRoleDept.addRow()}else{if(btnId=="btnSave"){var returnTemp=0;for(var i=0;i<$.grdSystemRoleDept.getRowCount();i++){if($.grdSystemRoleDept.getValue(i,"dept_code")==""||$.grdSystemRoleDept.getValue(i,"dept_code")==null||typeof $.grdSystemRoleDept.getValue(i,"dept_code")=="undefined"){MessageBoxShow("부서코드 은(는) 필수입력항목입니다.");returnTemp++;break}}if(returnTemp==0){saveSystemRole("DEPT")}}else{if(btnId=="btnDelete"){if($.grdSystemRoleDept.getRowStatus($.grdSystemRoleDept.getSelectedRowIdx())=="N"){$.grdSystemRoleDept.deleteRow($.grdSystemRoleDept.getSelectedRowIdx())}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){saveSystemRole("DEPTD")}})}}}}}else{if(panelId=="panEmp"){if(btnId=="btnNew"){$.grdSystemRoleEmp.addRow()}else{if(btnId=="btnSave"){var returnTemp=0;for(var i=0;i<$.grdSystemRoleEmp.getRowCount();i++){if($.grdSystemRoleEmp.getValue(i,"employee_id")==""||$.grdSystemRoleEmp.getValue(i,"employee_id")==null||typeof $.grdSystemRoleEmp.getValue(i,"employee_id")=="undefined"){MessageBoxShow("사원코드 은(는) 필수입력항목입니다.");returnTemp++;break}}if(returnTemp==0){saveSystemRole("EMP")}}else{if(btnId=="btnDelete"){if($.grdSystemRoleEmp.getRowStatus($.grdSystemRoleEmp.getSelectedRowIdx())=="N"){$.grdSystemRoleEmp.deleteRow($.grdSystemRoleEmp.getSelectedRowIdx())}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){saveSystemRole("EMPD")}})}}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="grdSystemRoleEmp"){$.grdSystemRoleEmp.setValue($.varRowId,"employee_id",popResult.employee_id);$.grdSystemRoleEmp.setValue($.varRowId,"emp_name",popResult.emp_name)}}else{if(id=="popDept"){if($.popUpCallId=="grdSystemRoleDept"){$.grdSystemRoleDept.setValue($.varRowId,"dept_code",popResult.dept_code);$.grdSystemRoleDept.setValue($.varRowId,"dept_name",popResult.dept_name)}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){}};</script>