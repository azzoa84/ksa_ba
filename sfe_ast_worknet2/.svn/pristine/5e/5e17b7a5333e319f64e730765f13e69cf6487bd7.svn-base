<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.grdList=null;$.lbl_Product=null;$.cmb_Product=null;$.lbl_Type=null;$.cmb_Type=null;$.lbl_Dept=null;$.cmb_Dept=null;$.lbl_Employee=null;$.cmb_Employee=null;$.rbo_Group=null;$.btnSearch=null;function createJson_Q(workType){var json=createExecuteParamInfo("P_crmDDDshare_Q",[workType,$.rbo_Group.getValue(),$.cmb_Type.getValue(),$.cmb_Product.getValue(),$.cmb_Dept.getValue()||"",$.cmb_Employee.getValue()||""]);return json}function searchDDDshare(workType){if(!validateControls([$.cmb_Product,$.cmb_Type])){return}var json=createJson_Q(workType);callQuery(["req",json],workType,$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,715);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine();$.panList=new FingerPanel(host,"panList",0,65,1200,635);$.panList.setText("DDD점유율(전체)");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,590);$.lbl_Product=new FingerLabel(host,"lbl_Product",0,15,100,20);$.lbl_Product.setText("품목");$.cmb_Product=new FingerComboBox(host,"cmb_Product",105,15,100,20);$.lbl_Type=new FingerLabel(host,"lbl_Type",185,15,100,20);$.lbl_Type.setText("구분");$.cmb_Type=new FingerComboBox(host,"cmb_Type",290,15,100,20);$.lbl_Dept=new FingerLabel(host,"lbl_Dept",370,15,100,20);$.lbl_Dept.setText("부서");$.cmb_Dept=new FingerComboBox(host,"cmb_Dept",475,15,140,20);$.lbl_Employee=new FingerLabel(host,"lbl_Employee",595,15,100,20);$.lbl_Employee.setText("이름");$.cmb_Employee=new FingerComboBox(host,"cmb_Employee",700,15,120,20);$.rbo_Group=new FingerRadioBox(host,"rbo_Group",870,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panQuery.setBorder(true);$.cmb_Product.setEmptyRow(true);$.cmb_Type.setEmptyRow(true);$.cmb_Dept.setEmptyRow(true);$.cmb_Employee.setEmptyRow(true);$.rbo_Group.addButtons([{sub_code:"1",code_name:"점유율"},{sub_code:"2",code_name:"금액"}]);$.rbo_Group.setValue("1");$.cmb_Product.setAllowBlank(false,"품목");$.cmb_Type.setAllowBlank(false,"구분");$.cmb_Product.setColumnConfig([{id:"sub_code",width:100},{id:"code_name",width:150}]);$.grdList.colIdx=$.grdList.setColumns([]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panQuery.add($.lbl_Product);$.panQuery.add($.cmb_Product);$.panQuery.add($.lbl_Type);$.panQuery.add($.cmb_Type);$.panQuery.add($.lbl_Dept);$.panQuery.add($.cmb_Dept);$.panQuery.add($.lbl_Employee);$.panQuery.add($.cmb_Employee);$.panQuery.add($.rbo_Group);$.panQuery.add($.btnSearch);$.panList.add($.grdList);var ds=bizComponentData2($,"Q1","L_CRM00195");$.cmb_Dept.setColumn("dept_code","dept_name");setComboBind([$.cmb_Dept],ds);var ds2=bizComponentData2($,"Q2","L_CRM233");setComboBind([$.cmb_Type],ds2);var ds3=bizComponentData2($,"Q2","L_CRM0138");setComboBind([$.cmb_Product],ds3);var subQuery1=" and dept_code = '"+$.cmb_Dept.getValue()+"' and delete_yn <> 'Y'";var ds4=bizComponentData2($,"Q4","L_CRM0052",subQuery1);$.cmb_Employee.setColumn("employee_id","emp_name");setComboBind([$.cmb_Employee],ds4)};$.callback=function(type,ds){if(type=="Q"){if(ds){$.grdList.removeColumns();var rs=ds.resultList[0];if(rs.length>0){var cols=[];var obj=Object.keys(rs[0]);var format_col=2;var format_type=$.rbo_Group.getValue()=="1"?"number":"int";for(var i=0;i<obj.length;i++){if(i>format_col){cols.push(new FingerDataGridColumn(obj[i],90,"right","int",obj[i],{format:format_type}))}else{cols.push(new FingerDataGridColumn(obj[i],100,"left","string",obj[i]))}}$.grdList.resetColumns(cols);setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchDDDshare("Q")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmb_Dept"){$.cmb_Employee.clear();var subQuery=" and dept_code = '"+$.cmb_Dept.getValue()+"' and delete_yn <> 'Y'";var ds=bizComponentData2($,"Q4","L_CRM0052",subQuery);$.cmb_Employee.setColumn("employee_id","emp_name");setComboBind([$.cmb_Employee],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>