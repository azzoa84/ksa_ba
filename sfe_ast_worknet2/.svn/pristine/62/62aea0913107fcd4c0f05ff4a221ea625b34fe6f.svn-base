<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panBase=null;$.panFile=null;$.grdFile=null;$.panConfirm=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.btnReportYnSave=null;$.btnSeminarCancel=null;$.memCPDescr=null;$.chkReportYN=null;$.btnEditPic=null;$.lblCpId=null;$.txtCpId=null;$.lblStatus=null;$.cmbStatus=null;$.lblAppDate=null;$.dteAppDate=null;$.lblEmp=null;$.cmbEmp=null;$.lblPm=null;$.cmbEmpPm=null;$.lblNoticeNo=null;$.txtNoticeNo=null;$.lblProductCode=null;$.cmbProductCode=null;$.lblCpConductOrg=null;$.txtCpConductOrg=null;$.lblConfirmNo=null;$.txtConfirmNo=null;$.lblCpSymposium=null;$.txtCpSymposium=null;$.lblCpDate=null;$.dteStartDate=null;$.lblEx1=null;$.dteEndDate=null;$.lblSubmitDate=null;$.dteSubmitStartDate=null;$.lblEx2=null;$.dteSubmitEndDate=null;$.lblNotedItems=null;$.memNotedItems=null;$.lblCpTotalAmt=null;$.speCpTotalAmt=null;$.lblEx3=null;$.lblCpDonationDate=null;$.dteCpDonationDate=null;$.lblBoothQty=null;$.txtBoothQty=null;$.lblBoothAmt=null;$.speBoothAmt=null;$.lblEx4=null;$.lblEx5=null;$.lblAdDesc=null;$.txtAdDesc=null;$.lblAdAmt=null;$.speAdAmt=null;$.lblEx6=null;$.lblBanner=null;$.txtBanner=null;$.lblSympoYn=null;$.chkSatelliteYn=null;$.lblCpPlace=null;$.txtCpPlace=null;$.imgCpPicture1=null;$.imgCpPicture2=null;$.imgCpPicture3=null;$.btnMAConfirm=null;$.btmMACancel=null;$.btnViewBfCP=null;$.cpDocNo="";$.beforeCpId="";$.beforeCpCode="";$.varBfcpcode="";function fnEnabelSet(bo){if(bo){$.panBase.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"])}else{$.panBase.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.cmbProductCode.setEnable(bo);$.txtCpSymposium.setReadOnly(!bo);$.txtConfirmNo.setReadOnly(!bo);$.txtCpConductOrg.setReadOnly(!bo);$.txtCpPlace.setReadOnly(!bo);$.dteStartDate.setEnable(bo);$.dteEndDate.setEnable(bo);$.speCpTotalAmt.setEnable(bo);$.memNotedItems.setEnable(bo);$.dteCpDonationDate.setEnable(bo);$.speBoothAmt.setEnable(bo);$.txtBoothQty.setReadOnly(!bo);$.txtAdDesc.setReadOnly(!bo);$.txtBanner.setReadOnly(!bo);$.chkSatelliteYn.setEnable(bo);$.cmbEmpPm.setEnable(bo);$.speAdAmt.setEnable(bo);$.dteSubmitStartDate.setEnable(bo);$.dteSubmitEndDate.setEnable(bo);$.txtNoticeNo.setReadOnly(!bo)}function closeSharePopUp(share){share.cp_descr=$.memCPDescr.getValue();g_popupStack.setData(share);g_popupStack.close()}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.varBfcpcode]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.beforeCpId])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.beforeCpId,"#UserID#"])}return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txtCpId.getValue(),$.chkReportYN.getValue(),"#UserID#"]);return json}function saveReportYN(workType){var json=createJSON_S(workType);callQuery(["req",json],workType,$)}function createJSON_S2(workType){if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()<0){MessageBoxShow("첨부파일이 등록되어야 합니다.");return false}else{var bFileOK=false;var bFileOK2=false;var bFileOK3=false;var bFileOK4=false;for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"local_fname")==""){MessageBoxShow("국제학술대회 확인서, 규약심의 캡쳐화면, Sponsorship 안내문, 입금확인증은 필수 첨부파일입니다.");return false}if($.grdFile.getValue(i,"file_type")=="020"){bFileOK=true}else{if($.grdFile.getValue(i,"file_type")=="046"){bFileOK2=true}else{if($.grdFile.getValue(i,"file_type")=="017"){bFileOK3=true}else{if($.grdFile.getValue(i,"file_type")=="055"){bFileOK4=true}}}}}if(!bFileOK||!bFileOK2||!bFileOK3||!bFileOK4){MessageBoxShow("국제학술대회 확인서, 규약심의 캡쳐화면, Sponsorship 안내문, 입금확인증은 필수 첨부파일입니다.");return false}}}var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=i;strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}}var json="";if(workType!="Pic"){json=createExecuteParamInfo("P_crmCPInterSymposiumAfter_S_B64",[workType,$.txtCpId.getValue(),$.cpDocNo,$.cmbEmp.getValue(),"#DeptCode#",$.cmbEmpPm.getValue(),$.txtNoticeNo.getValue(),$.cmbProductCode.getValue(),$.txtCpConductOrg.getValue(),$.txtConfirmNo.getValue(),$.txtCpSymposium.getValue(),$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.txtCpPlace.getValue(),$.dteCpDonationDate.getValue(),$.dteSubmitStartDate.getValue(),$.dteSubmitEndDate.getValue(),$.memNotedItems.getValue(),$.speCpTotalAmt.getValue(),$.txtBoothQty.getValue(),$.speBoothAmt.getValue(),$.txtAdDesc.getValue(),$.speAdAmt.getValue(),$.txtBanner.getValue(),$.chkSatelliteYn.getValue(),($.imgCpPicture1.getValue()||$.imgCpPicture1.getValue()!=""?$.imgCpPicture1.getUploadParam().image_base64:""),($.imgCpPicture2.getValue()||$.imgCpPicture2.getValue()!=""?$.imgCpPicture2.getUploadParam().image_base64:""),($.imgCpPicture3.getValue()||$.imgCpPicture3.getValue()!=""?$.imgCpPicture3.getUploadParam().image_base64:""),$.dteAppDate.getValue(),"CP33","#UserID#",$.beforeCpId,$.beforeCpCode,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname])}else{json=createExecuteParamInfo("P_crmCPInterSymposiumAfter_S_B64",[workType,$.txtCpId.getValue(),"","","","","","","","","","","","","","","","",0,"",0,"",0,"","",($.imgCpPicture1.getValue()||$.imgCpPicture1.getValue()!=""?$.imgCpPicture1.getUploadParam().image_base64:""),($.imgCpPicture2.getValue()||$.imgCpPicture2.getValue()!=""?$.imgCpPicture2.getUploadParam().image_base64:""),($.imgCpPicture3.getValue()||$.imgCpPicture3.getValue()!=""?$.imgCpPicture3.getUploadParam().image_base64:""),"","","","","","","","","","",""])}log(json);return json}function saveCpSymposiumAfter(workType){if(!validateControls([$.dteAppDate,$.cmbEmp,$.txtNoticeNo,$.txtCpConductOrg,$.txtConfirmNo,$.txtCpSymposium,$.dteStartDate,$.dteEndDate,$.dteSubmitStartDate,$.dteSubmitEndDate,$.speCpTotalAmt,$.txtCpPlace])){return}if(workType!="D"&&workType!="Pic"){workType=$.txtCpId.getValue()==""?"N":"U"}if(g_main.session.getValue("DeptCode")==g_main.session.getValue("CPDeptCode")){var json=createJSON_S2(workType);if(json){callExecute(["req",json],workType,$)}}else{if(Number($.dteStartDate.getValue())>Number($.dteEndDate.getValue())){MessageBoxShow("시작일은 종료일보다 빨라야 합니다.");return}var json=createJSON_S2(workType);if(json){callExecute(["req",json],workType,$)}}}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,810);$.panMain.setText("");$.panMain.setBottomLine(true);$.panBase=new FingerPanel(host,"panBase",0,0,1200,465);$.panBase.setText("국제학술대회 개최, 운영지원 - 사후");$.panBase.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,475,1200,205);$.panFile.setText("첨부서류");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,160);$.panConfirm=new FingerPanel(host,"panConfirm",0,695,1200,110);$.panConfirm.setText("");$.panConfirm.setBottomLine(true);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,45);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,55,120,45);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",880,5,90,95);$.btnMemoSave.setText("메모저장");$.btnReportYnSave=new FingerButton(host,"btnReportYnSave",960,5,120,20);$.btnReportYnSave.setText("신고상태저장");$.btnSeminarCancel=new FingerButton(host,"btnSeminarCancel",960,75,120,20);$.btnSeminarCancel.setText("개최취소");$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",115,700,750,90);$.chkReportYN=new FingerCheckBox(host,"chkReportYN",965,40,120,20);$.chkReportYN.setText("협회신고");$.btnEditPic=new FingerButton(host,"btnEditPic",770,-40.5,120,30);$.btnEditPic.setText("추후 사진 수정");$.lblCpId=new FingerLabel(host,"lblCpId",10,10,100,20);$.lblCpId.setText("문서번호");$.txtCpId=new FingerEdit(host,"txtCpId",115,10,140,20);$.lblStatus=new FingerLabel(host,"lblStatus",405,10,100,20);$.lblStatus.setText("승인여부");$.cmbStatus=new FingerComboBox(host,"cmbStatus",510,10,140,20);$.lblAppDate=new FingerLabel(host,"lblAppDate",670,10,100,20);$.lblAppDate.setText("승인요청일");$.dteAppDate=new FingerDateEdit(host,"dteAppDate",775,10,140,20);$.lblEmp=new FingerLabel(host,"lblEmp",10,40,100,20);$.lblEmp.setText("담당자");$.cmbEmp=new FingerComboBox(host,"cmbEmp",115,40,140,20);$.lblPm=new FingerLabel(host,"lblPm",405,40,100,20);$.lblPm.setText("PM");$.cmbEmpPm=new FingerComboBox(host,"cmbEmpPm",510,40,140,20);$.lblNoticeNo=new FingerLabel(host,"lblNoticeNo",10,70,100,20);$.lblNoticeNo.setText("심의번호");$.txtNoticeNo=new FingerEdit(host,"txtNoticeNo",115,70,295,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",405,70,100,20);$.lblProductCode.setText("품목");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",510,70,140,20);$.lblCpConductOrg=new FingerLabel(host,"lblCpConductOrg",10,100,100,20);$.lblCpConductOrg.setText("주최단체");$.txtCpConductOrg=new FingerEdit(host,"txtCpConductOrg",115,100,295,20);$.lblConfirmNo=new FingerLabel(host,"lblConfirmNo",405,100,100,20);$.lblConfirmNo.setText("확인번호");$.txtConfirmNo=new FingerEdit(host,"txtConfirmNo",510,100,295,20);$.lblCpSymposium=new FingerLabel(host,"lblCpSymposium",10,130,100,20);$.lblCpSymposium.setText("학술대회명");$.txtCpSymposium=new FingerEdit(host,"txtCpSymposium",115,130,690,20);$.lblCpDate=new FingerLabel(host,"lblCpDate",10,160,100,20);$.lblCpDate.setText("개최기간");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",115,160,140,20);$.lblEx1=new FingerLabel(host,"lblEx1",250,160,20,20);$.lblEx1.setText("~");$.dteEndDate=new FingerDateEdit(host,"dteEndDate",270,160,140,20);$.lblSubmitDate=new FingerLabel(host,"lblSubmitDate",405,160,100,20);$.lblSubmitDate.setText("신청기간");$.dteSubmitStartDate=new FingerDateEdit(host,"dteSubmitStartDate",510,160,140,20);$.lblEx2=new FingerLabel(host,"lblEx2",645,160,20,20);$.lblEx2.setText("~");$.dteSubmitEndDate=new FingerDateEdit(host,"dteSubmitEndDate",665,160,140,20);$.lblNotedItems=new FingerLabel(host,"lblNotedItems",0,190,110,20);$.lblNotedItems.setText("신청사 참고사항");$.memNotedItems=new FingerMemoEdit(host,"memNotedItems",115,190,685,55);$.lblCpTotalAmt=new FingerLabel(host,"lblCpTotalAmt",10,260,100,20);$.lblCpTotalAmt.setText("총지원금액");$.speCpTotalAmt=new FingerSpinEdit(host,"speCpTotalAmt",115,260,140,20);$.lblEx3=new FingerLabel(host,"lblEx3",250,260,20,20);$.lblEx3.setText("원");$.lblCpDonationDate=new FingerLabel(host,"lblCpDonationDate",405,260,100,20);$.lblCpDonationDate.setText("기부일자");$.dteCpDonationDate=new FingerDateEdit(host,"dteCpDonationDate",510,260,140,20);$.lblBoothQty=new FingerLabel(host,"lblBoothQty",10,290,100,20);$.lblBoothQty.setText("부스개수");$.txtBoothQty=new FingerEdit(host,"txtBoothQty",115,290,140,20);$.lblBoothAmt=new FingerLabel(host,"lblBoothAmt",405,290,100,20);$.lblBoothAmt.setText("부스비용");$.speBoothAmt=new FingerSpinEdit(host,"speBoothAmt",510,290,140,20);$.lblEx4=new FingerLabel(host,"lblEx4",250,290,20,20);$.lblEx4.setText("개");$.lblEx5=new FingerLabel(host,"lblEx5",645,290,20,20);$.lblEx5.setText("원");$.lblAdDesc=new FingerLabel(host,"lblAdDesc",10,320,100,20);$.lblAdDesc.setText("광고내역");$.txtAdDesc=new FingerEdit(host,"txtAdDesc",115,320,295,20);$.lblAdAmt=new FingerLabel(host,"lblAdAmt",405,320,100,20);$.lblAdAmt.setText("광고금액");$.speAdAmt=new FingerSpinEdit(host,"speAdAmt",510,320,140,20);$.lblEx6=new FingerLabel(host,"lblEx6",645,320,20,20);$.lblEx6.setText("원");$.lblBanner=new FingerLabel(host,"lblBanner",10,350,100,20);$.lblBanner.setText("홈페이지배너");$.txtBanner=new FingerEdit(host,"txtBanner",115,350,295,20);$.lblSympoYn=new FingerLabel(host,"lblSympoYn",405,350,100,20);$.lblSympoYn.setText("심포지움");$.chkSatelliteYn=new FingerCheckBox(host,"chkSatelliteYn",505,353,140,20);$.chkSatelliteYn.setText("Satellite");$.lblCpPlace=new FingerLabel(host,"lblCpPlace",10,380,100,20);$.lblCpPlace.setText("개최장소");$.txtCpPlace=new FingerEdit(host,"txtCpPlace",115,380,295,20);$.imgCpPicture1=new FingerImage(host,"imgCpPicture1",965,10,210,128);$.imgCpPicture2=new FingerImage(host,"imgCpPicture2",965,145,210,128);$.imgCpPicture3=new FingerImage(host,"imgCpPicture3",965,280,210,128);$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1080,5,120,45);$.btnMAConfirm.setText("MA승인");$.btmMACancel=new FingerButton(host,"btmMACancel",1080,55,120,45);$.btmMACancel.setText("MA승인취소");$.btnViewBfCP=new FingerButton(host,"btnViewBfCP",805,40,130,30);$.btnViewBfCP.setText("사전CP보기");relocateChildIndexInPanel([$.panBase]);$.dteAppDate.setEnable(false);$.dteAppDate.setAllowBlank(false,"승인요청일");$.cmbEmp.setAllowBlank(false,"담당자");$.txtNoticeNo.setAllowBlank(false,"심의번호");$.txtCpConductOrg.setAllowBlank(false,"주최단체");$.txtConfirmNo.setAllowBlank(false,"확인번호");$.txtCpSymposium.setAllowBlank(false,"학술대회명");$.dteStartDate.setAllowBlank(false,"개최기간");$.dteEndDate.setAllowBlank(false,"개최기간");$.dteSubmitStartDate.setAllowBlank(false,"신청기간");$.dteSubmitEndDate.setAllowBlank(false,"신청기간");$.speCpTotalAmt.setAllowBlank(false,"총지원금액");$.txtCpPlace.setAllowBlank(false,"개최장소");$.btnMAConfirm.setVisible(false);$.btmMACancel.setVisible(false);$.dteAppDate.setValue(getToday());$.grdFile.colIdx=$.grdFile.setColumns([new FingerDataGridColumn("cp_id",50,"left","string","CP아이디",{hidden:true}),new FingerDataGridColumn("seq",100,"left","string","일렬번호",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("server_path",215,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",500,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.panBase.addButtons(["btnLoad","btnDelete","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.cmbEmp.setEmptyRow(true);$.cmbEmpPm.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbProductCode.setEmptyRow(true);$.cmbEmp.setEnable(false);$.txtCpId.setReadOnly(true);$.imgCpPicture1.setMode("N");$.imgCpPicture2.setMode("N");$.imgCpPicture3.setMode("N");$.imgCpPicture1.setZooming(true);$.imgCpPicture2.setZooming(true);$.imgCpPicture3.setZooming(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panBase);$.panMain.add($.panFile);$.panMain.add($.panConfirm);$.panMain.add($.memCPDescr);$.panBase.add($.btnEditPic);$.panBase.add($.lblCpId);$.panBase.add($.txtCpId);$.panBase.add($.lblStatus);$.panBase.add($.cmbStatus);$.panBase.add($.lblAppDate);$.panBase.add($.dteAppDate);$.panBase.add($.lblEmp);$.panBase.add($.cmbEmp);$.panBase.add($.lblPm);$.panBase.add($.cmbEmpPm);$.panBase.add($.lblNoticeNo);$.panBase.add($.txtNoticeNo);$.panBase.add($.lblProductCode);$.panBase.add($.cmbProductCode);$.panBase.add($.lblCpConductOrg);$.panBase.add($.txtCpConductOrg);$.panBase.add($.lblConfirmNo);$.panBase.add($.txtConfirmNo);$.panBase.add($.lblCpSymposium);$.panBase.add($.txtCpSymposium);$.panBase.add($.lblCpDate);$.panBase.add($.dteStartDate);$.panBase.add($.lblEx1);$.panBase.add($.dteEndDate);$.panBase.add($.lblSubmitDate);$.panBase.add($.dteSubmitStartDate);$.panBase.add($.lblEx2);$.panBase.add($.dteSubmitEndDate);$.panBase.add($.lblNotedItems);$.panBase.add($.memNotedItems);$.panBase.add($.lblCpTotalAmt);$.panBase.add($.speCpTotalAmt);$.panBase.add($.lblEx3);$.panBase.add($.lblCpDonationDate);$.panBase.add($.dteCpDonationDate);$.panBase.add($.lblBoothQty);$.panBase.add($.txtBoothQty);$.panBase.add($.lblBoothAmt);$.panBase.add($.speBoothAmt);$.panBase.add($.lblEx4);$.panBase.add($.lblEx5);$.panBase.add($.lblAdDesc);$.panBase.add($.txtAdDesc);$.panBase.add($.lblAdAmt);$.panBase.add($.speAdAmt);$.panBase.add($.lblEx6);$.panBase.add($.lblBanner);$.panBase.add($.txtBanner);$.panBase.add($.lblSympoYn);$.panBase.add($.chkSatelliteYn);$.panBase.add($.lblCpPlace);$.panBase.add($.txtCpPlace);$.panBase.add($.imgCpPicture1);$.panBase.add($.imgCpPicture2);$.panBase.add($.imgCpPicture3);$.panBase.add($.btnViewBfCP);$.panFile.add($.grdFile);$.panConfirm.add($.chkReportYN);$.panConfirm.add($.btnSeminarCancel);$.panConfirm.add($.btnReportYnSave);$.panConfirm.add($.btnMemoSave);$.panConfirm.add($.btnCancel);$.panConfirm.add($.btnConfirm);$.panConfirm.add($.btnMAConfirm);$.panConfirm.add($.btmMACancel);$.txtBanner.setPlaceholder("배너 광고가 있는 경우 내역을 입력 해 주세요.");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbEmpPm.setColumn("employee_id","emp_name");$.cmbProductCode.setColumn("product_code","product_name");var ds=bizComponentData2($,"Q1","L_CRM0219|L_CRM192|L_CRM0111|L_CRM0084");setComboBind([$.cmbEmp,$.cmbEmpPm,$.cmbStatus,$.cmbProductCode],ds);var strQuery=" and extra_field1 LIKE '%' + 'CP33' + '%'";var ds=bizComponentData2($,"Q4","L_CRM0110",strQuery);$.grdFile.setColumnDropDownList("file_type",ds.resultList[0],null,true);$.cmbEmp.setValue(g_main.session.getValue("UserID"));if($.p_argument&&$.p_argument.length>0){$.cmbStatus.setEnable(false);var rs=$.p_argument[0][0];if(rs.CallType){$.strCallType=rs.CallType}$.cmbStatus.setValue(rs.cp_status);$.memCPDescr.setValue(rs.cp_descr);$.bAllReport=rs.AllReport;$.bMyReport=rs.MyReport;$.bConfirm=rs.Confirm;if(!$.bConfirm){$.panConfirm.setVisible(false);$.memCPDescr.setReadOnly(true)}else{$.panConfirm.setVisible(true);$.memCPDescr.setReadOnly(false)}if(rs.save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnabelSet(false)}if($.strCallType=="BUCall"){$.panBase.disableButton(["btnSave","btnDelete","btnNew"]);$.panConfirm.setVisible(false)}$.txtCpId.setValue(rs.cp_id);$.cmbStatus.setValue(rs.cp_status);$.dteAppDate.setValue(rs.app_date);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbEmpPm.setValue(rs.cp_emp_pm);$.txtNoticeNo.setValue(rs.notice_no);$.cmbProductCode.setValue(rs.product_code);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtConfirmNo.setValue(rs.confirm_no);$.txtCpSymposium.setValue(rs.cp_symposium);$.dteStartDate.setValue(rs.cp_start_date);$.dteEndDate.setValue(rs.cp_end_date);$.dteSubmitStartDate.setValue(rs.submit_start_date);$.dteSubmitEndDate.setValue(rs.submit_end_date);$.memNotedItems.setValue(rs.noted_items);$.speCpTotalAmt.setValue(rs.cp_total_amt);$.dteCpDonationDate.setValue(rs.cp_donation_date);$.txtBoothQty.setValue(rs.booth_qty);$.speBoothAmt.setValue(rs.booth_amt);$.txtAdDesc.setValue(rs.ad_desc);$.speAdAmt.setValue(rs.ad_amt);$.txtBanner.setValue(rs.banner);$.chkSatelliteYn.setValue(rs.satellite_yn);$.txtCpPlace.setValue(rs.cp_place);$.cpDocNo=rs.cp_doc_no;$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;if(convertByteArrayToImageSource(rs.cp_picture1)){$.imgCpPicture1.setValue(rs.cp_picture1)}if(convertByteArrayToImageSource(rs.cp_picture2)){$.imgCpPicture2.setValue(rs.cp_picture2)}if(convertByteArrayToImageSource(rs.cp_picture3)){$.imgCpPicture3.setValue(rs.cp_picture3)}setDataGrid([$.grdFile],$.p_argument[1],true);$.memCPDescr.setValue(rs.cp_descr);if($.cmbStatus.getValue()=="10"){$.btnConfirm.setEnable(true);$.btnCancel.setEnable(false);if(!$.bSave){$.panBase.disableButton(["btnDelete"])}}else{if($.cmbStatus.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panBase.disableButton(["btnDelete"]);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnMemoSave.setVisible(false);$.btnReportYnSave.setVisible(false);$.btnSeminarCancel.setVisible(false);$.chkReportYN.setVisible(false);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}}else{$.panConfirm.setVisible(false);$.memCPDescr.setVisible(false);$.cmbStatus.setEnable(false);$.cmbStatus.setValue("10")}};$.callback=function(type,ds){if(type=="D"){if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.")}var share={save_mode:"DEL"};closeSharePopUp(share)}else{if(type=="N"||type=="U"){log(ds);if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(type=="N"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txtCpId.setValue(id[0]);$.cpDocNo=id[1]}MessageBoxShow("정상적으로 저장 되었습니다.")}}else{MessageBoxShow("정상적으로 수정 되었습니다.")}}}else{if(type=="Pic"){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 저장 되었습니다.")}}else{if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="BUCall";param[0][0].Confirm=false;param[0][0].cp_descr=param.cp_desc;param[0][0].cp_status="90";param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){var share={};if(id=="btnConfirm"){share.save_mode="CONFIRM";closeSharePopUp(share)}else{if(id=="btnCancel"){share.save_mode="CANCEL";closeSharePopUp(share)}else{if(id=="btnMemoSave"){share.save_mode="MEMO";closeSharePopUp(share)}else{if(id=="btnMAConfirm"){share.save_mode="MACONFIRM";closeSharePopUp(share)}else{if(id=="btnMACancel"){share.save_mode="MACANCEL";closeSharePopUp(share)}else{if(id=="btnReportYnSave"){saveReportYN("REPORT")}else{if(id=="btnSeminarCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("CANCEL")}})}else{if(id=="btnEditPic"){confirmBoxShow("첨부 사진을 수정하시겠습니까?",function(){if(g_main.msgShare==true){saveCpSymposiumAfter("Pic")}})}else{if(id=="btnViewBfCP"){if($.beforeCpId!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.beforeCpId+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";$.varBfcpcode=ds.resultList[0][0].cp_type;searchCPInfo("FORM")}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panBase"){if(btnId=="btnSave"){if(!$.beforeCpId){MessageBoxShow("사전 데이터가 없습니다.");return}saveCpSymposiumAfter("")}else{if(btnId=="btnDelete"){if($.txtCpId.getValue()==""){return}confirmBoxShow("["+$.txtCpId.getValue()+"] 국제학술대회 개최.운영 지원(사후)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCpSymposiumAfter("D")}})}else{if(btnId=="btnNew"){$.panBase.clear();$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteAppDate.setValue(getToday());$.grdFile.clear();$.beforeCpId=""}else{if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={cp_type:"CP25"};g_main.openPopup("popCPDonationBf.html","popCPDonationBf","",0,0,"","",param,"","")}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){fileList[i].file_type="";fileList[i].seq=seq+i;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPDonationBf"){if($.popUpCallId=="btnLoad"){if(popResult[0][0].before_cp_id){var rs=popResult[0][0];$.dteAppDate.setValue(rs.app_date);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbEmpPm.setValue(rs.cp_emp_pm);$.txtNoticeNo.setValue(rs.notice_no);$.cmbProductCode.setValue(rs.product_code);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtConfirmNo.setValue(rs.confirm_no);$.txtCpSymposium.setValue(rs.cp_symposium);$.dteStartDate.setValue(rs.cp_start_date);$.dteEndDate.setValue(rs.cp_end_date);$.dteSubmitStartDate.setValue(rs.submit_start_date);$.dteSubmitEndDate.setValue(rs.submit_end_date);$.memNotedItems.setValue(rs.noted_items);$.speCpTotalAmt.setValue(rs.cp_total_amt);$.dteCpDonationDate.setValue(rs.cp_donation_date);$.txtBoothQty.setValue(rs.booth_qty);$.speBoothAmt.setValue(rs.booth_amt);$.txtAdDesc.setValue(rs.ad_desc);$.speAdAmt.setValue(rs.ad_amt);$.txtBanner.setValue(rs.banner);$.chkSatelliteYn.setValue(rs.satellite_yn);$.txtCpPlace.setValue(rs.cp_place);$.cpDocNo=rs.cp_doc_no;$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;setDataGrid([$.grdFile],popResult[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn)}else{$.beforeCpId="";$.beforeCpCode="";$.beforeCpDocNo="";$.panBase.clear();$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteAppDate.setValue(getToday());$.grdFile.clear();$.memCPDescr.setValue("");$.chkReportYN.setValue("")}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>