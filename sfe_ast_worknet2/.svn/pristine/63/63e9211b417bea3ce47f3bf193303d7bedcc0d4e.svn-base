<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.grdList=null;$.lblDept=null;$.cboDept=null;$.lblProduct=null;$.cboProduct=null;$.radioAmt=null;$.radioCount=null;$.radioSupply=null;$.lblRadioGroup=null;$.lblTeam=null;$.cboTeam=null;$.btnSearch=null;var arrBtn=["btnCustom1","btnCustom2","btnCustom3","btnCustom4","btnTmp","btnDelCompany"];var ignoreCol=["id","row_level","employee_id","emp_name","company_id","company_name","address_name","ddd","channel","channel_name","sidogu_code","sido_code","zip_sido","gungu_code","zip_gungu"];$.session=g_main.session.obj;$.radioId="AMT";$.resetEmpId="RESET";$.selectRowId="";$.saleResultYm="";$.companyId="";$.isDebug=false;$.saveType="";$.windowSize=1380;$.varWfDocId="";$.varDoc="";$.varBusinessId="";$.varOriginWfDocId="";$.varWFType="";$.saveData=[];$.yyyy="";$.half="";function initData(){$.saveData=[]}function getBizData(workType,codeName,target){var ds;ds=bizComponentData2($,workType,codeName);if(ds&&ds.resultList){setComboBind(target,ds);return true}else{return false}}function searchList(){if($.isDebug){doSearch()}else{if(validateControls([$.cboDept,$.cboTeam])){$.varWfDocId="";$.varOriginWfDocId="";$.yyyy="";$.half="";doSearch("Q")}}}function doDataSort(objGrid){var arrRows=objGrid.getAllRows();if(Array.isArray(arrRows)&&arrRows.length){var arrNotMatched=[];var objTotal=arrRows.splice(0,1)[0];delete objTotal.id;for(var index=0;index<arrRows.length;index++){if(arrRows[index].employee_id==$.resetEmpId){var objRow=arrRows.splice(index,1)[0];arrNotMatched.push(objRow);index--}}arrRows.sort(function(a,b){if(a.emp_name!=b.emp_name){return(a.emp_name?(a.emp_name>b.emp_name?1:-1):-1)}else{return a.company_name<b.company_name?-1:1}});arrNotMatched.sort(function(a,b){return a.company_name<b.company_name?-1:1});arrRows.splice(0,0,objTotal);arrNotMatched.forEach(function(item){delete item.id;arrRows.push(item)});objGrid.setData(arrRows);arrRows=objGrid.getAllRows();objGrid.setRowSpan("emp_name","webix_custom_text_center");objGrid.addSpan(arrRows[0].id,"emp_name",2,1,null,"company-batch-tot");objGrid.extObj.refresh()}}function doResetMatch(empId){var arrRows=$.grdList.getAllRows();var arrEmpId=$.grdList.extObj.collectValues("employee_id");var arrReset=[];var arrChk=[];var isExist=false;arrReset.push(arrRows[0]);for(var index=1;index<arrRows.length;index++){if(arrChk.indexOf(arrRows[index].employee_id)<0){arrReset.push({employee_id:arrRows[index].employee_id,emp_name:arrRows[index].emp_name||emptyCellStyle("[담당자 선택]"),company_name:emptyCellStyle("[거래처 선택]"),row_level:1});arrChk.push(arrRows[index].employee_id)}}arrRows.forEach(function(item){if(item.row_level==1){item.employee_id=$.resetEmpId;item.emp_name=emptyCellStyle("[배정되지 않음]");delete item.id;arrReset.push(item)}});$.grdList.setData(arrReset);doDataSort($.grdList);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center");$.grdList.addSpan(arrReset[0].id,"emp_name",2,1,null,"company-batch-tot")}function doMakeTotalRow(objRow){var arrKeys=Object.keys(objRow);var objTotal=JSON.parse(JSON.stringify(objRow));delete objTotal.id;for(var keyIndex=0;keyIndex<arrKeys.length;keyIndex++){if(ignoreCol.indexOf(arrKeys[keyIndex])<0){objTotal[arrKeys[keyIndex]]=0}else{if(arrKeys[keyIndex]=="employee_id"||arrKeys[keyIndex]=="emp_name"){objTotal.emp_name="합계"}else{objTotal[arrKeys[keyIndex]]=""}}}objTotal.row_level=2;return objTotal}function doCalcTotal(){var arrItem=$.grdList.extObj.collectValues("employee_id");var arrRows=$.grdList.getAllRows();var arrKeys=Object.keys(arrRows[0]);var objTotalInfo={};objTotalInfo.tot=arrRows[0];for(var index=0;index<arrRows.length;index++){if(arrRows[index].row_level==2){arrRows.splice(index,1);index--}}var iCount=0;for(var index=0;index<arrItem.length;index++){var empId=arrItem[index].id;if(!objTotalInfo[empId]){var rowIndex=$.grdList.getGridRowIndex("employee_id",empId);var rowId=$.grdList.getIdByIndex(rowIndex);var objRow=$.grdList.getValue(rowId);var objTotal=doMakeTotalRow(objRow);objTotalInfo[empId]=objTotal}arrRows.forEach(function(item){if(item.employee_id==empId){arrKeys.forEach(function(keyName){if(ignoreCol.indexOf(keyName)<0&&keyName.indexOf("ddd")<0){if(iCount==0){objTotalInfo.tot[keyName]=0}if(item[keyName]&&item[keyName]!="undefined"){objTotalInfo[empId][keyName]+=Number(item[keyName])||0;objTotalInfo.tot[keyName]+=Number(item[keyName])||0}else{}}});iCount++}})}for(var index=0;index<arrRows.length;index++){var objRow=arrRows[index];if(objTotalInfo.hasOwnProperty(objRow.employee_id)){if(arrRows[index+1]){if(objRow.employee_id!=arrRows[index+1].employee_id){arrRows.splice(index+1,0,objTotalInfo[objRow.employee_id]);index++}}else{arrRows.push(objTotalInfo[objRow.employee_id]);break}}}$.grdList.setData(arrRows);arrRows=$.grdList.getAllRows();var totTar=0;var resTar=0;for(var index=0;index<arrRows.length;index++){if(arrRows[index].row_level==0){$.grdList.setValue(index,"tar_share",1);$.grdList.setValue(index,"res_share",1);totTar=Number($.grdList.getValue(index,"tar_fy4"));resTar=Number($.grdList.getValue(index,"res_fy4"));$.grdList.addSpan(arrRows[index].id,"emp_name",2,1,null,"company-batch-tot")}else{if(arrRows[index].row_level==2){$.grdList.addSpan(arrRows[index].id,"emp_name",2,1,null,"company-batch-group")}}if(arrRows[index].row_level!=0){var rowTar=Number($.grdList.getValue(index,"tar_fy4"));var rowRes=Number($.grdList.getValue(index,"res_fy4"));if(rowTar){$.grdList.setValue(index,"tar_share",rowTar/totTar)}if(rowRes){$.grdList.setValue(index,"res_share",rowRes/resTar)}}}$.grdList.extObj.refresh()}function initSearchOption(){var ds;ds=bizComponentData2($,"Q2","L_CRM0122");if(ds&&ds.resultList){ds.resultList[0].unshift({sub_code:"S030",code_name:"SR영업소"})}setComboBind([$.cboDept],ds);getBizData("Q1","L_CRM0202",[$.cboProduct]);var json=createJSON_Q("Q_INFO");var ds=callQuerySync(["req",json],"Q_INFO");if(ds){if(ds.resultList[0]&&ds.resultList[0].length){var rs=ds.resultList[0][0];$.saleResultYm=rs.yyyymm}setColumnGridHalfText(ds.resultList[1])}setBindDept()}function doSearch(workType){if($.isDebug){var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{employee_id:"",emp_name:"영업소 전체 합계",company_id:"",company_name:"영업소 전체 합계",row_level:0,sidogu_code:"",num_beds:23514,channel:"",channel_name:"",zip_sido:"",sido_code:"",zip_gungu:"",gungu_code:"",address_name:"",tar_fy1:4736611.00081,tar_fy2:4997666.96358,tar_fy3:5189534.286020001,tar_fy4:9424323.51,tar_share:1,res_fy1:0.001,res_fy2:4570022.09454,res_fy3:4891164.25634,res_fy4:3574133.4784,res_share:1,kcm_now_sum:332,kcm_l_cnt:37,kcm_u_cnt:73,kcm_t_cnt:66,kcm_a_cnt:91,kcm_n_cnt:65,kcm_now_ab_sum:318,contact_p_count:42374,ddd1_share:0.591923,ddd2_share:0.567416,ddd3_share:0.558899,ddd4_share:0.5769300000000001},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00000017",company_name:"분당서울대학교병원",row_level:1,sidogu_code:"100033",num_beds:1165,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"성남시 분당구",gungu_code:"100033",address_name:"경기 성남시 분당구 구미로173번길 82",tar_fy1:229516.839,tar_fy2:215459.69652,tar_fy3:203091.618,tar_fy4:963353.508,tar_share:0.1022199107424316,res_fy1:182948.205,res_fy2:185981.381,res_fy3:130358.706,res_fy4:98024.68842000001,res_share:0.02742614091286871,kcm_now_sum:13,kcm_l_cnt:2,kcm_u_cnt:0,kcm_t_cnt:8,kcm_a_cnt:3,kcm_n_cnt:0,kcm_now_ab_sum:12,contact_p_count:3120,ddd1_share:0.315495,ddd2_share:0.222545,ddd3_share:0.191698,ddd4_share:0.321493},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00000018",company_name:"대진의료재단분당제생병원",row_level:1,sidogu_code:"100033",num_beds:555,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"성남시 분당구",gungu_code:"100033",address_name:"경기 성남시 분당구 서현로180번길 20",tar_fy1:71480.73,tar_fy2:77720.64994,tar_fy3:88386.894,tar_fy4:90472.06200000001,tar_share:0.009599846811710309,res_fy1:73098.39837,res_fy2:82294.12364999999,res_fy3:78406.626,res_fy4:59061.312,res_share:0.01652465201899495,kcm_now_sum:8,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:8,kcm_n_cnt:0,kcm_now_ab_sum:6,contact_p_count:710,ddd1_share:0.547738,ddd2_share:0.528718,ddd3_share:0.510015,ddd4_share:0.515343},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00000019",company_name:"차의과학대학교분당차병원",row_level:1,sidogu_code:"100033",num_beds:722,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"성남시 분당구",gungu_code:"100033",address_name:"경기 성남시 분당구 야탑로 59",tar_fy1:125692.848,tar_fy2:171874.06888,tar_fy3:178209.30601,tar_fy4:332602.572,tar_share:0.03529193067779143,res_fy1:131991.645,res_fy2:135523.05,res_fy3:140065.542,res_fy4:107739.0438,res_share:0.03014410190640965,kcm_now_sum:10,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:2,kcm_a_cnt:6,kcm_n_cnt:2,kcm_now_ab_sum:10,contact_p_count:1462,ddd1_share:0.592597,ddd2_share:0.604583,ddd3_share:0.538807,ddd4_share:0.545416},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00000020",company_name:"국군수도병원",row_level:1,sidogu_code:"100033",num_beds:529,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"성남시 분당구",gungu_code:"100033",address_name:"경기 성남시 분당구 새마을로177번길 81",tar_fy1:26256.783,tar_fy2:0,tar_fy3:0,tar_fy4:0,tar_share:0,res_fy1:4246.38,res_fy2:5944.932,res_fy3:2734.32,res_fy4:8202.959999999999,res_share:0.002295090558193743,kcm_now_sum:2,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:2,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:2,contact_p_count:200,ddd1_share:0,ddd2_share:0,ddd3_share:0,ddd4_share:0},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00000026",company_name:"한림대학교성심병원",row_level:1,sidogu_code:"100044",num_beds:734,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"안양시 동안구",gungu_code:"100044",address_name:"경기 안양시 동안구 관평로170번길 22",tar_fy1:183372.843,tar_fy2:203540.64948,tar_fy3:192496.128,tar_fy4:217158.642,tar_share:0.02304235861275097,res_fy1:187265.358,res_fy2:169109.27,res_fy3:147379.848,res_fy4:103152.222,res_share:0.02886076376928632,kcm_now_sum:11,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:3,kcm_a_cnt:8,kcm_n_cnt:0,kcm_now_ab_sum:10,contact_p_count:1440,ddd1_share:0.235026,ddd2_share:0.238941,ddd3_share:0.220224,ddd4_share:0.247911},{employee_id:"ka032020",emp_name:"김태영",company_id:"H00001093",company_name:"한림대학교동탄성심병원",row_level:1,sidogu_code:"100062",num_beds:624,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"화성시",gungu_code:"100062",address_name:"경기 화성시 큰재봉길 7",tar_fy1:92641.857,tar_fy2:78990.13424,tar_fy3:80662.44,tar_fy4:72887.34,tar_share:0.007733959888225441,res_fy1:62358.0903,res_fy2:56018.73,res_fy3:52909.092,res_fy4:43954.194,res_share:0.01229786024098814,kcm_now_sum:8,kcm_l_cnt:0,kcm_u_cnt:3,kcm_t_cnt:0,kcm_a_cnt:4,kcm_n_cnt:1,kcm_now_ab_sum:8,contact_p_count:873,ddd1_share:0.449093,ddd2_share:0.410354,ddd3_share:0.428976,ddd4_share:0.395802},{employee_id:"ka110203",emp_name:"원석현",company_id:"H00000071",company_name:"학교법인가톨릭학원가톨릭대학교서울성모병원",row_level:1,sidogu_code:"100155",num_beds:1117,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"서초구",gungu_code:"100155",address_name:"서울 서초구 반포대로 222",tar_fy1:274174.602,tar_fy2:303688.85538,tar_fy3:401603.25,tar_fy4:1101885.012,tar_share:0.1169192686170851,res_fy1:308641.053,res_fy2:531698.754,res_fy3:830071.194,res_fy4:558553.218,res_share:0.1562765412583423,kcm_now_sum:24,kcm_l_cnt:3,kcm_u_cnt:8,kcm_t_cnt:3,kcm_a_cnt:6,kcm_n_cnt:4,kcm_now_ab_sum:24,contact_p_count:3200,ddd1_share:0.515263,ddd2_share:0.499814,ddd3_share:0.520865,ddd4_share:0.557213},{employee_id:"ka110203",emp_name:"원석현",company_id:"H00000079",company_name:"가톨릭대학교여의도성모병원",row_level:1,sidogu_code:"100160",num_beds:387,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"영등포구",gungu_code:"100160",address_name:"서울 영등포구 63로 10",tar_fy1:123428.112,tar_fy2:113971.4794,tar_fy3:118259.34,tar_fy4:152781.624,tar_share:0.01621141547591038,res_fy1:110547.426,res_fy2:113079.146,res_fy3:124958.424,res_fy4:84217.056,res_share:0.02356292973078909,kcm_now_sum:5,kcm_l_cnt:0,kcm_u_cnt:2,kcm_t_cnt:1,kcm_a_cnt:2,kcm_n_cnt:0,kcm_now_ab_sum:5,contact_p_count:825,ddd1_share:0.622721,ddd2_share:0.5984620000000001,ddd3_share:0.666975,ddd4_share:0.650322},{employee_id:"ka110203",emp_name:"원석현",company_id:"H00000150",company_name:"가톨릭대학교인천성모병원",row_level:1,sidogu_code:"100176",num_beds:754,channel:"11",channel_name:"UH",zip_sido:"인천",sido_code:"002000",zip_gungu:"부평구",gungu_code:"100176",address_name:"인천 부평구 동수로 56",tar_fy1:239000.421,tar_fy2:261866.40038,tar_fy3:291068.364,tar_fy4:418734.15,tar_share:0.04443121562578872,res_fy1:258637.60007,res_fy2:260360.986,res_fy3:285121.218,res_fy4:209722.344,res_share:0.05867781527115336,kcm_now_sum:8,kcm_l_cnt:0,kcm_u_cnt:3,kcm_t_cnt:2,kcm_a_cnt:3,kcm_n_cnt:0,kcm_now_ab_sum:8,contact_p_count:1260,ddd1_share:0.660953,ddd2_share:0.647068,ddd3_share:0.631784,ddd4_share:0.583631},{employee_id:"ka110203",emp_name:"원석현",company_id:"H00001098",company_name:"가톨릭관동대학교국제성모병원",row_level:1,sidogu_code:"100177",num_beds:536,channel:"12",channel_name:"GH",zip_sido:"인천",sido_code:"002000",zip_gungu:"서구",gungu_code:"100177",address_name:"인천 서구 심곡로100번길 25",tar_fy1:0,tar_fy2:18336.99545,tar_fy3:0,tar_fy4:16509.204,tar_share:0.001751765416635194,res_fy1:0,res_fy2:0,res_fy3:0,res_fy4:0,res_share:0,kcm_now_sum:7,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:7,kcm_n_cnt:0,kcm_now_ab_sum:4,contact_p_count:705,ddd1_share:0.003182,ddd2_share:0.008529,ddd3_share:0.01332,ddd4_share:0.007577},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000012",company_name:"광명성애병원",row_level:1,sidogu_code:"100023",num_beds:368,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"광명시",gungu_code:"100023",address_name:"경기 광명시 디지털로 36",tar_fy1:0,tar_fy2:38648.74426,tar_fy3:48670.89599,tar_fy4:0,tar_share:0,res_fy1:29370.795,res_fy2:27704.581,res_fy3:25087.386,res_fy4:8408.034,res_share:0.002352467822148587,kcm_now_sum:0,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:0,contact_p_count:0,ddd1_share:0,ddd2_share:0,ddd3_share:0.134696,ddd4_share:0.577481},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000025",company_name:"고려대학교의과대학부속안산병원",row_level:1,sidogu_code:"100041",num_beds:705,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"안산시 단원구",gungu_code:"100041",address_name:"경기 안산시 단원구 적금로 123",tar_fy1:83688.13688999999,tar_fy2:88359.59372999999,tar_fy3:100417.90201,tar_fy4:126122.004,tar_share:0.01338260553833641,res_fy1:83299.821,res_fy2:95596.719,res_fy3:69930.234,res_fy4:49217.76,res_share:0.01377054334916246,kcm_now_sum:11,kcm_l_cnt:0,kcm_u_cnt:4,kcm_t_cnt:1,kcm_a_cnt:2,kcm_n_cnt:4,kcm_now_ab_sum:11,contact_p_count:900,ddd1_share:0.227628,ddd2_share:0.130699,ddd3_share:0.236143,ddd4_share:0.34815},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000068",company_name:"서울특별시보라매병원",row_level:1,sidogu_code:"100152",num_beds:699,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"동작구",gungu_code:"100152",address_name:"서울 동작구 보라매로5길 20",tar_fy1:244803.807,tar_fy2:257423.20532,tar_fy3:242739.258,tar_fy4:333796.098,tar_share:0.03541857382610161,res_fy1:251456.469,res_fy2:226409.107,res_fy3:238432.704,res_fy4:147789.996,res_share:0.0413498815567906,kcm_now_sum:15,kcm_l_cnt:4,kcm_u_cnt:3,kcm_t_cnt:0,kcm_a_cnt:4,kcm_n_cnt:4,kcm_now_ab_sum:15,contact_p_count:2152,ddd1_share:0.756023,ddd2_share:0.697588,ddd3_share:0.724344,ddd4_share:0.729599},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000077",company_name:"한림대학교강남성심병원",row_level:1,sidogu_code:"100160",num_beds:438,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"영등포구",gungu_code:"100160",address_name:"서울 영등포구 신길로 1",tar_fy1:164405.679,tar_fy2:186473.13833,tar_fy3:185318.538,tar_fy4:280254.57,tar_share:0.02973736732430994,res_fy1:170350.611,res_fy2:173868.726,res_fy3:184088.094,res_fy4:161188.164,res_share:0.04509852946850704,kcm_now_sum:15,kcm_l_cnt:3,kcm_u_cnt:2,kcm_t_cnt:2,kcm_a_cnt:3,kcm_n_cnt:5,kcm_now_ab_sum:15,contact_p_count:1310,ddd1_share:0.727677,ddd2_share:0.462096,ddd3_share:0.382401,ddd4_share:0.709856},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000080",company_name:"한림대학교한강성심병원",row_level:1,sidogu_code:"100160",num_beds:269,channel:"13",channel_name:"GH2",zip_sido:"서울",sido_code:"001000",zip_gungu:"영등포구",gungu_code:"100160",address_name:"서울 영등포구 버드나루로7길 12",tar_fy1:4246.38,tar_fy2:4372.66815,tar_fy3:9023.255999999999,tar_fy4:15927.414,tar_share:0.00169003260373009,res_fy1:2830.92,res_fy2:4795.36,res_fy3:10458.774,res_fy4:7382.664,res_share:0.002065581502374369,kcm_now_sum:2,kcm_l_cnt:1,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:1,kcm_now_ab_sum:2,contact_p_count:70,ddd1_share:0.5576950000000001,ddd2_share:0.586377,ddd3_share:0.552239,ddd4_share:0.703471},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000106",company_name:"대아의료재단한도병원",row_level:1,sidogu_code:"100041",num_beds:350,channel:"12",channel_name:"GH",zip_sido:"경기",sido_code:"001100",zip_gungu:"안산시 단원구",gungu_code:"100041",address_name:"경기 안산시 단원구 선부광장로 103",tar_fy1:58600.044,tar_fy2:89075.48174,tar_fy3:88318.53599999999,tar_fy4:89343.906,tar_share:0.009480139970279947,res_fy1:87192.336,res_fy2:87893.48913,res_fy3:66649.05,res_fy4:43680.762,res_share:0.01222135722238168,kcm_now_sum:1,kcm_l_cnt:1,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:1,contact_p_count:500,ddd1_share:0.674669,ddd2_share:0.70882,ddd3_share:0.703094,ddd4_share:0.764008},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000107",company_name:"근로복지공단안산병원",row_level:1,sidogu_code:"100042",num_beds:425,channel:"12",channel_name:"GH",zip_sido:"경기",sido_code:"001100",zip_gungu:"안산시 상록구",gungu_code:"100042",address_name:"경기 안산시 상록구 구룡로 87",tar_fy1:14437.692,tar_fy2:12483.26229,tar_fy3:12031.00799,tar_fy4:20575.758,tar_share:0.002183261003101962,res_fy1:10969.815,res_fy2:11061.993,res_fy3:17226.216,res_fy4:12988.02,res_share:0.003633893383806759,kcm_now_sum:3,kcm_l_cnt:1,kcm_u_cnt:1,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:1,kcm_now_ab_sum:3,contact_p_count:170,ddd1_share:0.789118,ddd2_share:0.7579050000000001,ddd3_share:0.707767,ddd4_share:0.678579},{employee_id:"ka120237",emp_name:"김부석",company_id:"H00000141",company_name:"대림성모병원",row_level:1,sidogu_code:"100160",num_beds:208,channel:"13",channel_name:"GH2",zip_sido:"서울",sido_code:"001000",zip_gungu:"영등포구",gungu_code:"100160",address_name:"서울 영등포구 시흥대로 657",tar_fy1:11748.318,tar_fy2:13541.16587,tar_fy3:10116.984,tar_fy4:17431.29,tar_share:0.001849606497644519,res_fy1:9129.717000000001,res_fy2:9448.426,res_fy3:8954.897999999999,res_fy4:7177.59,res_share:0.002008204238419525,kcm_now_sum:5,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:5,kcm_now_ab_sum:5,contact_p_count:150,ddd1_share:0.50895,ddd2_share:0.603416,ddd3_share:0.543074,ddd4_share:0.619043},{employee_id:"ka120242",emp_name:"심정희",company_id:"H00000055",company_name:"연세대학교의과대학강남세브란스병원",row_level:1,sidogu_code:"100141",num_beds:738,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"강남구",gungu_code:"100141",address_name:"서울 강남구 언주로 211",tar_fy1:134397.927,tar_fy2:184992.07331,tar_fy3:147448.20601,tar_fy4:401049.63,tar_share:0.04255473929502236,res_fy1:151378.49289,res_fy2:136619.514,res_fy3:165494.718,res_fy4:110945.034,res_share:0.03104109979957037,kcm_now_sum:9,kcm_l_cnt:0,kcm_u_cnt:3,kcm_t_cnt:3,kcm_a_cnt:2,kcm_n_cnt:1,kcm_now_ab_sum:9,contact_p_count:1545,ddd1_share:0.556144,ddd2_share:0.535505,ddd3_share:0.545333,ddd4_share:0.496627},{employee_id:"ka120242",emp_name:"심정희",company_id:"H00000057",company_name:"삼성서울병원",row_level:1,sidogu_code:"100141",num_beds:1720,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"강남구",gungu_code:"100141",address_name:"서울 강남구 일원로 81",tar_fy1:427539.693,tar_fy2:421327.73388,tar_fy3:432295.992,tar_fy4:1081832.646,tar_share:0.1147915439078555,res_fy1:376866.225,res_fy2:327590.335,res_fy3:326574.19278,res_fy4:207018.29702,res_share:0.05792125511570822,kcm_now_sum:26,kcm_l_cnt:2,kcm_u_cnt:7,kcm_t_cnt:12,kcm_a_cnt:3,kcm_n_cnt:2,kcm_now_ab_sum:24,contact_p_count:4870,ddd1_share:0.59709,ddd2_share:0.563392,ddd3_share:0.611453,ddd4_share:0.6418430000000001},{employee_id:"ka120242",emp_name:"심정희",company_id:"H00000069",company_name:"중앙대학교병원",row_level:1,sidogu_code:"100152",num_beds:718,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"동작구",gungu_code:"100152",address_name:"서울 동작구 흑석로 102",tar_fy1:138927.399,tar_fy2:163763.47473,tar_fy3:163717.41,tar_fy4:346805.814,tar_share:0.03679901412891969,res_fy1:151524.993,res_fy2:145549.1142,res_fy3:130632.138,res_fy4:98948.205,res_share:0.02768452985821202,kcm_now_sum:16,kcm_l_cnt:2,kcm_u_cnt:3,kcm_t_cnt:4,kcm_a_cnt:5,kcm_n_cnt:2,kcm_now_ab_sum:16,contact_p_count:1755,ddd1_share:0.594024,ddd2_share:0.582603,ddd3_share:0.436692,ddd4_share:0.602958},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00000014",company_name:"원광대학교의과대학산본병원",row_level:1,sidogu_code:"100026",num_beds:259,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"군포시",gungu_code:"100026",address_name:"경기 군포시 산본로 321",tar_fy1:64191.111,tar_fy2:52401.49084,tar_fy3:52430.58601,tar_fy4:56600.424,tar_share:0.006005781098233968,res_fy1:45082.401,res_fy2:41265.321,res_fy3:44227.626,res_fy4:36298.098,res_share:0.01015577572000731,kcm_now_sum:2,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:1,kcm_n_cnt:1,kcm_now_ab_sum:2,contact_p_count:380,ddd1_share:0.7628200000000001,ddd2_share:0.753711,ddd3_share:0.728263,ddd4_share:0.737204},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00000022",company_name:"아주대학교병원",row_level:1,sidogu_code:"100037",num_beds:985,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"수원시 영통구",gungu_code:"100037",address_name:"경기 수원시 영통구 월드컵로 164",tar_fy1:210832.767,tar_fy2:193455.30198,tar_fy3:204390.42,tar_fy4:370814.694,tar_share:0.03934655825498078,res_fy1:180825.015,res_fy2:194940.38,res_fy3:181285.416,res_fy4:109919.664,res_share:0.03075421347979615,kcm_now_sum:18,kcm_l_cnt:6,kcm_u_cnt:5,kcm_t_cnt:1,kcm_a_cnt:5,kcm_n_cnt:1,kcm_now_ab_sum:17,contact_p_count:1785,ddd1_share:0.496284,ddd2_share:0.377515,ddd3_share:0.34768,ddd4_share:0.483167},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00000023",company_name:"의료법인녹산의료재단동수원병원",row_level:1,sidogu_code:"100039",num_beds:354,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"수원시 팔달구",gungu_code:"100039",address_name:"경기 수원시 팔달구 중부대로 165",tar_fy1:28026.108,tar_fy2:33570.80705,tar_fy3:35272.72799,tar_fy4:37733.616,tar_share:0.004003854065489311,res_fy1:28283.4181,res_fy2:35721.32609,res_fy3:33700.494,res_fy4:19482.03,res_share:0.005450840075710139,kcm_now_sum:5,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:1,kcm_a_cnt:1,kcm_n_cnt:2,kcm_now_ab_sum:5,contact_p_count:301,ddd1_share:0.823279,ddd2_share:0.636041,ddd3_share:0.842436,ddd4_share:0.904913},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00000024",company_name:"가톨릭대학교성빈센트병원",row_level:1,sidogu_code:"100039",num_beds:779,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"수원시 팔달구",gungu_code:"100039",address_name:"경기 수원시 팔달구 중부대로 93",tar_fy1:222156.447,tar_fy2:239227.26369,tar_fy3:296468.646,tar_fy4:498985.944,tar_share:0.05294660603177872,res_fy1:243685.5936,res_fy2:300017.976,res_fy3:363391.128,res_fy4:157633.548,res_share:0.04410399022662309,kcm_now_sum:9,kcm_l_cnt:1,kcm_u_cnt:4,kcm_t_cnt:2,kcm_a_cnt:1,kcm_n_cnt:1,kcm_now_ab_sum:9,contact_p_count:1860,ddd1_share:0.35809,ddd2_share:0.388891,ddd3_share:0.239869,ddd4_share:0.118101},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00000108",company_name:"효산의료재단안양샘병원",row_level:1,sidogu_code:"100045",num_beds:312,channel:"12",channel_name:"GH",zip_sido:"경기",sido_code:"001100",zip_gungu:"안양시 만안구",gungu_code:"100045",address_name:"경기 안양시 만안구 삼덕로 9",tar_fy1:103965.537,tar_fy2:89569.17008,tar_fy3:89548.98001,tar_fy4:98059.8,tar_share:0.01040496964009675,res_fy1:82450.545,res_fy2:78586.054,res_fy3:74920.368,res_fy4:55205.9208,res_share:0.01544595945664389,kcm_now_sum:7,kcm_l_cnt:0,kcm_u_cnt:2,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:5,kcm_now_ab_sum:7,contact_p_count:700,ddd1_share:0.30351,ddd2_share:0.285889,ddd3_share:0.208515,ddd4_share:0.222176},{employee_id:"ka120251",emp_name:"김지현",company_id:"H00001096",company_name:"효산의료재단지샘병원",row_level:1,sidogu_code:"100026",num_beds:355,channel:"12",channel_name:"GH",zip_sido:"경기",sido_code:"001100",zip_gungu:"군포시",gungu_code:"100026",address_name:"경기 군포시 군포로 591",tar_fy1:14862.33,tar_fy2:11566.41252,tar_fy3:8818.182000000001,tar_fy4:15825.126,tar_share:0.001679178986503192,res_fy1:7077.3,res_fy2:6422.391,res_fy3:12782.946,res_fy4:15448.908,res_share:0.004322420551264882,kcm_now_sum:6,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:3,kcm_n_cnt:3,kcm_now_ab_sum:5,contact_p_count:207,ddd1_share:0.339404,ddd2_share:0.307844,ddd3_share:0.138962,ddd4_share:0.059677},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00000089",company_name:"의료법인길의료재단길병원",row_level:1,sidogu_code:"100174",num_beds:1210,channel:"11",channel_name:"UH",zip_sido:"인천",sido_code:"002000",zip_gungu:"남동구",gungu_code:"100174",address_name:"인천 남동구 남동대로774번길 21",tar_fy1:425982.687,tar_fy2:467099.69559,tar_fy3:470166.324,tar_fy4:609178.542,tar_share:0.06463896759842872,res_fy1:452158.78878,res_fy2:445375.6176,res_fy3:438995.076,res_fy4:319224.04736,res_share:0.08931508833937119,kcm_now_sum:14,kcm_l_cnt:5,kcm_u_cnt:4,kcm_t_cnt:0,kcm_a_cnt:2,kcm_n_cnt:3,kcm_now_ab_sum:13,contact_p_count:2680,ddd1_share:0.766881,ddd2_share:0.764926,ddd3_share:0.760642,ddd4_share:0.718489},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00000090",company_name:"근로복지공단인천병원",row_level:1,sidogu_code:"100176",num_beds:284,channel:"11",channel_name:"UH",zip_sido:"인천",sido_code:"002000",zip_gungu:"부평구",gungu_code:"100176",address_name:"인천 부평구 무네미로 446",tar_fy1:60086.277,tar_fy2:65660.54908,tar_fy3:57352.36199,tar_fy4:60838.62,tar_share:0.006455489344720086,res_fy1:53221.296,res_fy2:51676.893,res_fy3:52567.302,res_fy4:33016.914,res_share:0.009237739496729815,kcm_now_sum:3,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:2,kcm_now_ab_sum:3,contact_p_count:420,ddd1_share:0.716142,ddd2_share:0.6387659999999999,ddd3_share:0.66931,ddd4_share:0.66233},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00000092",company_name:"인하대학교의과대학부속병원",row_level:1,sidogu_code:"100180",num_beds:812,channel:"11",channel_name:"UH",zip_sido:"인천",sido_code:"002000",zip_gungu:"중구",gungu_code:"100180",address_name:"인천 중구 인항로 27",tar_fy1:189600.867,tar_fy2:163410.84021,tar_fy3:203501.766,tar_fy4:371071.41,tar_share:0.03937379798202619,res_fy1:154639.005,res_fy2:200754.36867,res_fy3:201656.1,res_fy4:135758.988,res_share:0.03798374873810644,kcm_now_sum:11,kcm_l_cnt:5,kcm_u_cnt:4,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:2,kcm_now_ab_sum:10,contact_p_count:1268,ddd1_share:0.722171,ddd2_share:0.749861,ddd3_share:0.719142,ddd4_share:0.719154},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00000103",company_name:"의료법인혜원의료재단세종병원",row_level:1,sidogu_code:"100030",num_beds:295,channel:"13",channel_name:"GH2",zip_sido:"경기",sido_code:"001100",zip_gungu:"부천시 소사구",gungu_code:"100030",address_name:"경기 부천시 소사구 호현로489번길 28",tar_fy1:90872.53200000001,tar_fy2:93307.09607,tar_fy3:93035.23801,tar_fy4:118995.06,tar_share:0.01262637682946009,res_fy1:83582.913,res_fy2:91178.586,res_fy3:91941.51,res_fy4:71229.03599999999,res_share:0.01992903634698233,kcm_now_sum:4,kcm_l_cnt:1,kcm_u_cnt:1,kcm_t_cnt:0,kcm_a_cnt:1,kcm_n_cnt:1,kcm_now_ab_sum:4,contact_p_count:620,ddd1_share:0.831053,ddd2_share:0.838468,ddd3_share:0.842036,ddd4_share:0.834005},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00000152",company_name:"인천기독병원",row_level:1,sidogu_code:"100180",num_beds:200,channel:"13",channel_name:"GH2",zip_sido:"인천",sido_code:"002000",zip_gungu:"중구",gungu_code:"100180",address_name:"인천 중구 답동로30번길 10",tar_fy1:22788.906,tar_fy2:25389.686,tar_fy3:24062.016,tar_fy4:27479.916,tar_share:0.002915850243345477,res_fy1:21656.538,res_fy2:20035.952,res_fy3:23310.078,res_fy4:15448.908,res_share:0.004322420551264882,kcm_now_sum:2,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:0,kcm_a_cnt:1,kcm_n_cnt:0,kcm_now_ab_sum:2,contact_p_count:243,ddd1_share:0.775103,ddd2_share:0.731222,ddd3_share:0.650703,ddd4_share:0.6432560000000001},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00001106",company_name:"메디플렉스세종병원",row_level:1,sidogu_code:"100172",num_beds:278,channel:"13",channel_name:"GH2",zip_sido:"인천",sido_code:"002000",zip_gungu:"계양구",gungu_code:"100172",address_name:"인천 계양구 계양문화로 20",tar_fy1:12266.48092,tar_fy2:39283.48641,tar_fy3:36571.52999,tar_fy4:36844.962,tar_share:0.003909560400903513,res_fy1:16065.471,res_fy2:33683.634,res_fy3:38606.64541,res_fy4:19687.104,res_share:0.005508217339664983,kcm_now_sum:2,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:1,kcm_a_cnt:0,kcm_n_cnt:1,kcm_now_ab_sum:2,contact_p_count:105,ddd1_share:0,ddd2_share:0,ddd3_share:0,ddd4_share:0},{employee_id:"ka140301",emp_name:"이학주",company_id:"H00001107",company_name:"한국보훈복지의료공단인천보훈병원",row_level:1,sidogu_code:"100260",num_beds:130,channel:"13",channel_name:"GH2",zip_sido:"인천",sido_code:"002000",zip_gungu:"미추홀구",gungu_code:"100260",address_name:"인천 미추홀구 인주대로 138",tar_fy1:0,tar_fy2:0,tar_fy3:0,tar_fy4:0,tar_share:0,res_fy1:0,res_fy2:0,res_fy3:6152.22,res_fy4:8271.317999999999,res_share:0.002314216312845357,kcm_now_sum:1,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:1,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:1,contact_p_count:100,ddd1_share:0,ddd2_share:0,ddd3_share:0,ddd4_share:0},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00000015",company_name:"가톨릭대학교부천성모병원",row_level:1,sidogu_code:"100032",num_beds:582,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"부천시 원미구",gungu_code:"100032",address_name:"경기 부천시 원미구 소사로 327",tar_fy1:183797.481,tar_fy2:173637.24151,tar_fy3:199331.928,tar_fy4:283908.486,tar_share:0.03012507854794556,res_fy1:168510.513,res_fy2:242645.644,res_fy3:313079.64,res_fy4:205757.58,res_share:0.05756852150135972,kcm_now_sum:10,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:3,kcm_a_cnt:3,kcm_n_cnt:3,kcm_now_ab_sum:10,contact_p_count:1056,ddd1_share:0.474601,ddd2_share:0.469335,ddd3_share:0.566475,ddd4_share:0.584204},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00000016",company_name:"순천향대학교부속부천병원",row_level:1,sidogu_code:"100032",num_beds:832,channel:"11",channel_name:"UH",zip_sido:"경기",sido_code:"001100",zip_gungu:"부천시 원미구",gungu_code:"100032",address_name:"경기 부천시 원미구 조마루로 170",tar_fy1:109627.377,tar_fy2:95140.79562,tar_fy3:77244.53999000001,tar_fy4:126925.086,tar_share:0.01346781929390707,res_fy1:69074.448,res_fy2:71689.65700000001,res_fy3:70682.17200000001,res_fy4:49422.834,res_share:0.0138279206131173,kcm_now_sum:10,kcm_l_cnt:0,kcm_u_cnt:3,kcm_t_cnt:3,kcm_a_cnt:2,kcm_n_cnt:2,kcm_now_ab_sum:10,contact_p_count:802,ddd1_share:0.5477,ddd2_share:0.556687,ddd3_share:0.576936,ddd4_share:0.420425},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00000063",company_name:"고려대학교의과대학부속구로병원",row_level:1,sidogu_code:"100147",num_beds:929,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"구로구",gungu_code:"100147",address_name:"서울 구로구 구로동로 148",tar_fy1:122720.382,tar_fy2:143874.88735,tar_fy3:143961.94801,tar_fy4:298644.864,tar_share:0.03168873221331087,res_fy1:132416.283,res_fy2:138723.256,res_fy3:142252.998,res_fy4:110945.034,res_share:0.03104109979957037,kcm_now_sum:14,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:7,kcm_a_cnt:3,kcm_n_cnt:3,kcm_now_ab_sum:13,contact_p_count:1189,ddd1_share:0.641062,ddd2_share:0.601871,ddd3_share:0.620207,ddd4_share:0.584191},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00000076",company_name:"이화여자대학교의과대학부속목동병원",row_level:1,sidogu_code:"100159",num_beds:548,channel:"11",channel_name:"UH",zip_sido:"서울",sido_code:"001000",zip_gungu:"양천구",gungu_code:"100159",address_name:"서울 양천구 안양천로 1071",tar_fy1:169713.654,tar_fy2:166725.60477,tar_fy3:161393.23801,tar_fy4:281830.29,tar_share:0.02990456447096223,res_fy1:140481.57408,res_fy2:116307.95,res_fy3:93787.17600000001,res_fy4:56873.856,res_share:0.01591262787014328,kcm_now_sum:14,kcm_l_cnt:0,kcm_u_cnt:5,kcm_t_cnt:4,kcm_a_cnt:2,kcm_n_cnt:3,kcm_now_ab_sum:14,contact_p_count:1141,ddd1_share:0.222129,ddd2_share:0.321433,ddd3_share:0.314837,ddd4_share:0.619647},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00000167",company_name:"서울특별시서남병원",row_level:1,sidogu_code:"100159",num_beds:311,channel:"12",channel_name:"GH",zip_sido:"서울",sido_code:"001000",zip_gungu:"양천구",gungu_code:"100159",address_name:"서울 양천구 신정이펜1로 20",tar_fy1:56759.946,tar_fy2:38437.16353,tar_fy3:42108.528,tar_fy4:51063.426,tar_share:0.005418259034276297,res_fy1:46706.64135,res_fy2:35591.513,res_fy3:41630.022,res_fy4:25907.682,res_share:0.007248661012961904,kcm_now_sum:1,kcm_l_cnt:0,kcm_u_cnt:1,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:1,contact_p_count:300,ddd1_share:0.502624,ddd2_share:0.893477,ddd3_share:0.811176,ddd4_share:0.838037},{employee_id:"ka170403",emp_name:"송한솔",company_id:"H00001108",company_name:"이화여자대학교의과대학부속서울병원",row_level:1,sidogu_code:"100144",num_beds:298,channel:"13",channel_name:"GH2",zip_sido:"서울",sido_code:"001000",zip_gungu:"강서구",gungu_code:"100144",address_name:"서울 강서구 공항대로 260",tar_fy1:0,tar_fy2:0,tar_fy3:0,tar_fy4:0,tar_share:0,res_fy1:0,res_fy2:0,res_fy3:0,res_fy4:1230.444,res_share:0.0003442635837290614,kcm_now_sum:0,kcm_l_cnt:0,kcm_u_cnt:0,kcm_t_cnt:0,kcm_a_cnt:0,kcm_n_cnt:0,kcm_now_ab_sum:0,contact_p_count:0,ddd1_share:0,ddd2_share:0,ddd3_share:0,ddd4_share:0}],[{yyyy:"2018",half:"2"}]]};setDataGrid([$.grdList],ds);doDataSort($.grdList);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center");$.panList.enableButton(arrBtn);return}var json=createJSON_Q(workType);callQuery(["req",json],"SEARCH_Q",$)}function doMoveRow(objData){if(objData.assign&&objData.assign.length){var arrData=objData.assign;var arrRows=$.grdList.getAllRows();for(var index=0;index<arrRows.length;index++){if(arrRows[index].employee_id==arrData[0].employee_id){if(!arrRows[index].hasOwnProperty("company_id")||arrRows[index].company_id==""){$.grdList.deleteRow(arrRows[index].id)}}}arrRows=$.grdList.getAllRows();for(var rowIndex=0;rowIndex<arrData.length;rowIndex++){var objRow=arrData[rowIndex];var rowId="";var isSearch=objRow.isSearch;for(var index=0;index<arrRows.length;index++){if(arrRows[index].company_id==objRow.company_id&&!isSearch){rowId=arrRows[index].id;break}}if(isSearch){objRow.row_level="1";$.grdList.addRow(objRow)}else{$.grdList.setValue(rowId,"employee_id",objRow.employee_id);$.grdList.setValue(rowId,"emp_name",objRow.emp_name||emptyCellStyle("[담당자 선택]"));$.selectRowId=rowId}}}if(objData.unsign&&objData.unsign.length){var arrData=objData.unsign;var arrRows=$.grdList.getAllRows();for(var rowIndex=0;rowIndex<arrData.length;rowIndex++){var objRow=arrData[rowIndex];var rowId="";for(var index=0;index<arrRows.length;index++){if(arrRows[index].company_id==objRow.company_id){rowId=arrRows[index].id;break}}$.grdList.setValue(rowId,"employee_id",$.resetEmpId);$.grdList.setValue(rowId,"emp_name",emptyCellStyle("[배정되지 않음]"))}}doDataSort($.grdList);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center")}function saveList(workType){var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],(workType=="N"?"SAVE":"SAVE_DETAIL"));var bResult=false;if(ds&&ds.errorCode=="MSG0002"){bResult=true}return bResult}function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmTargetAllocation_Q",[workType,$.isDebug?"201807":$.saleResultYm,$.isDebug?"S300":$.cboDept.getValue(),$.isDebug?"S320":$.cboTeam.getValue(),$.cboProduct.getValue(),$.radioId,"",$.varWfDocId||$.varOriginWfDocId,"","","","#UserID#","#DeptCode#"]);return json}function createJSON_Q4(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmTargetAllocation"]);return json}function createJSON_S(workType){var json="";var rows=[];if(workType=="N"){json=createExecuteParamInfo("P_crmTargetAllocation_S",[workType,$.varWfDocId,$.yyyy,$.half,"","","","","#UserID#"])}else{for(var i=0;i<$.saveData.length;i++){var rowData=$.saveData[i];rows.push([workType,$.varWfDocId,$.yyyy,$.half,rowData.employee_id||"",$.cboTeam.getValue(),rowData.company_id&&rowData.company_id!=rowData.sidogu_code?rowData.company_id:"",rowData.sidogu_code||"","#UserID#"])}json=createExecuteParamInfo("P_crmTargetAllocation_S",rows)}return json}$.dashboard_radio_click=function(id,value){if(id=="AMT"){setArrayRadioColor([$.radioAmt],"#DA1E48","#FFFFFF");setArrayRadioColor([$.radioCount],"#FFFFFF","#333333");setArrayRadioColor([$.radioSupply],"#FFFFFF","#333333")}else{if(id=="QTY"){setArrayRadioColor([$.radioAmt],"#FFFFFF","#333333");setArrayRadioColor([$.radioCount],"#DA1E48","#FFFFFF");setArrayRadioColor([$.radioSupply],"#FFFFFF","#333333")}else{setArrayRadioColor([$.radioAmt],"#FFFFFF","#333333");setArrayRadioColor([$.radioCount],"#FFFFFF","#333333");setArrayRadioColor([$.radioSupply],"#DA1E48","#FFFFFF")}}$.radioId=id;if(!$.panQuery.validateControls()){return}};function emptyCellStyle(value){var tag="<span style='color: blue; text-decoration:underline; cursor: pointer;'>";tag+=value;tag+="</span>";return tag}function searchWFDocument(){var json=createJSON_Q4("Q3");var ds=callQuerySync(["req",json],"Q3");if(ds&&ds.errorCode=="MSG0001"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.varDoc="["+g_main.session.obj.DeptName+"] "+result.business_title}}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.varDoc,$.varBusinessId,$.varOriginWfDocId,wfLine,"","","",$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function sumColumnStyle(obj,common,value,col,colIdx){var styleObj="";if(common.row_level=="0"){styleObj={background:"#ffc166 !important;"}}else{if(common.row_level=="2"){styleObj={background:"#BCCAF9 !important;"}}}return styleObj}function setColumnGridHalfText(data){if(data&&data.length){var rs=data[0];var yh=rs.yyyy+rs.half;$.grdList.setColumnText("tar_fy4",createHalfText(yh),2);$.grdList.setColumnText("res_fy4",createHalfText(yh),2);$.grdList.setColumnText("kcm_now_sum",createHalfText(yh)+" 합계",2);$.grdList.setColumnText("contact_p_count",createHalfText(yh),2);yh=calcHalf(yh);$.grdList.setColumnText("tar_fy3",createHalfText(yh),2);$.grdList.setColumnText("res_fy3",createHalfText(yh),2);yh=calcHalf(yh);$.grdList.setColumnText("tar_fy2",createHalfText(yh),2);$.grdList.setColumnText("res_fy2",createHalfText(yh),2);yh=calcHalf(yh);$.grdList.setColumnText("tar_fy1",createHalfText(yh),2);$.grdList.setColumnText("res_fy1",createHalfText(yh),2)}}function calcHalf(yyyyHalf){var yyyy=Number(yyyyHalf.substr(0,4));var half=Number(yyyyHalf.substr(4,1));if(half=="1"){yyyy=yyyy-1;half="2"}else{half="1"}return yyyy+""+half}function createHalfText(value){var half=value.substr(4,1);return value.substr(2,2)+"("+(half=="1"?"상":"하")+")"}function setSizeByWindow(){var width=screen.availWidth;if(width<$.windowSize){$.panMain.setSize(1200,510,true);$.panList.setSize(1200,425,false);$.grdList.setSize(1200,380)}else{$.panMain.setSize(1200,800,true);$.panList.setSize(1200,715,false);$.grdList.setSize(1200,670)}}function saveChk(){if(!$.grdList.getRowCount()){MessageBoxShow("기안 상신할 내역이 없습니다.");return false}if(!$.cboTeam.getValue()){MessageBoxShow("영업소를 선택해 주세요.");return false}var dt=deepCopyObj($.grdList.getAllRows());$.saveData=[];for(var i=0;i<dt.length;i++){var rowData=dt[i];if(rowData.row_level=="1"){if(!rowData.employee_id||rowData.employee_id=="RESET"){$.grdList.selectRow(i);MessageBoxShow("담당자를 선택해 주세요.");return false}if(!rowData.company_id){$.grdList.selectRow(i);MessageBoxShow("거래처를 선택해 주세요.");return false}$.saveData.push(rowData)}}if(!$.saveData.length){var msg=($.saveType=="TMP"?"임시저장":"기안 상신");MessageBoxShow(msg+"할 내역이 없습니다.");return}return true}function setBindDept(){var teamCode=$.session.DeptCode;var deptCode=teamCode.substr(0,2)+"00";$.cboDept.setValue(deptCode);$.cboTeam.setValue(teamCode)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",5,0,1200,800);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,65,1200,715);$.panList.setText("MR-거래처(지역) 배치");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,670);$.lblDept=new FingerLabel(host,"lblDept",0,15,100,20);$.lblDept.setText("부서 선택");$.cboDept=new FingerComboBox(host,"cboDept",105,15,180,20);$.lblProduct=new FingerLabel(host,"lblProduct",545,15,100,20);$.lblProduct.setText("품목 선택");$.cboProduct=new FingerComboBox(host,"cboProduct",650,15,140,20);$.radioAmt=new FingerHTMLView(host,"radioAmt",895,15,50,20);$.radioCount=new FingerHTMLView(host,"radioCount",945,15,50,20);$.radioSupply=new FingerHTMLView(host,"radioSupply",995,15,50,20);$.lblRadioGroup=new FingerLabel(host,"lblRadioGroup",790,15,100,20);$.lblRadioGroup.setText("조회 구분");$.lblTeam=new FingerLabel(host,"lblTeam",285,15,85,20);$.lblTeam.setText("영업소");$.cboTeam=new FingerComboBox(host,"cboTeam",375,15,170,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panQuery.setBorder(true);$.radioAmt.setValue("금액");$.radioCount.setValue("수량");$.radioSupply.setValue("물량");setArrayRadio([$.radioAmt,$.radioCount,$.radioSupply]);setArrayClickUrl([$.radioAmt],"AMT");setArrayClickUrl([$.radioCount],"QTY");setArrayClickUrl([$.radioSupply],"SUPPLY");setArrayRadioColor([$.radioAmt],"#DA1E48","#FFFFFF");setArrayRadioColor([$.radioCount],"#FFFFFF","#333333");setArrayRadioColor([$.radioSupply],"#FFFFFF","#333333");$.cboDept.setEmptyRow(true);$.cboTeam.setEmptyRow(true);$.cboProduct.setEmptyRow(true);$.cboTeam.setColumn("dept_code","dept_name");$.cboProduct.setColumn("product_code","product_name");if(!$.isDebug){$.cboDept.setAllowBlank(false,"부서");$.cboTeam.setAllowBlank(false,"영업소")}$.panList.addButton("btnCustom1","상신");$.panList.addButton("btnTmp","임시저장");$.panList.addButton("btnDelCompany","거래처 삭제");$.panList.addButton("btnCustom2","담당자 삭제");$.panList.addButton("btnCustom3","신규담당자추가");$.panList.addButton("btnCustom4","병원위치확인");$.panList.addButton("btnCustom5","배정 거래처 초기화");$.panList.setButtonAction("btnCustom1","submit",80);$.panList.setButtonAction("btnTmp","temp",80);$.panList.setButtonAction("btnDelCompany","custom",110);$.panList.setButtonAction("btnCustom2","custom",110);$.panList.setButtonAction("btnCustom3","custom",110);$.panList.setButtonAction("btnCustom4","custom",100);$.panList.setButtonAction("btnCustom5","custom",130);$.panList.disableButton(arrBtn);$.grdList.setColumns([new FingerDataGridColumn("emp_name",130,"center","string",[{text:"담당자",rowspan:2}],{sort:null,cssFormat:sumColumnStyle}),new FingerDataGridColumn("company_name",170,"center","string",[{text:"거래처명",rowspan:2}],{sort:null,cssFormat:sumColumnStyle}),new FingerDataGridColumn("row_level",170,"center","string",[{text:"합계여부",rowspan:2}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("num_beds",100,"right","int",[{text:"베드 수",rowspan:2}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("channel",100,"center","string",[{text:"채널코드",rowspan:2}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("channel_name",100,"center","string",[{text:"채널",rowspan:2}],{sort:null,cssFormat:sumColumnStyle}),new FingerDataGridColumn("sidogu_code",100,"center","string",[{text:"시도구 코드",rowspan:2}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("sido_code",100,"center","string",[{text:"시도",rowspan:2}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("zip_sido",100,"center","string",[{text:"시도",rowspan:2}],{sort:null,cssFormat:sumColumnStyle}),new FingerDataGridColumn("gungu_code",100,"center","string",[{text:"구",rowspan:2}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("zip_gungu",100,"center","string",[{text:"구",rowspan:2}],{sort:null,cssFormat:sumColumnStyle}),new FingerDataGridColumn("tar_fy1",100,"right","int",[{text:"목표현황",colspan:5},{text:"16(하)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("tar_fy2",100,"right","int",[{text:""},{text:"17(상)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("tar_fy3",100,"right","int",[{text:""},{text:"17(하)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("tar_fy4",100,"right","int",[{text:""},{text:"18(상)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("tar_share",100,"right","int",[{text:""},{text:"영업소내<br>share",autoheight:true,css:"multi_h_line"}],{sort:null,format:"percent_2",cssFormat:sumColumnStyle}),new FingerDataGridColumn("res_fy1",100,"right","int",[{text:"실적현황",colspan:5},{text:"16(하)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("res_fy2",100,"right","int",[{text:""},{text:"17(상)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("res_fy3",100,"right","int",[{text:""},{text:"17(하)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("res_fy4",100,"right","int",[{text:""},{text:"18(상)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("res_share",100,"right","int",[{text:""},{text:"영업소내<br>share",autoheight:true,css:"multi_h_line"}],{sort:null,format:"percent_2",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_now_sum",100,"right","int",[{text:"KCM고객수",colspan:7},{text:"18(상) 합계"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_l_cnt",100,"right","int",[{text:""},{text:"L"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_u_cnt",100,"right","int",[{text:""},{text:"U"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_t_cnt",100,"right","int",[{text:""},{text:"T"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_a_cnt",100,"right","int",[{text:""},{text:"A"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_n_cnt",100,"right","int",[{text:""},{text:"N"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("kcm_now_ab_sum",100,"right","int",[{text:""},{text:"절대<br>고객수",autoheight:true,css:"multi_h_line"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("contact_p_count",100,"right","int",[{text:"질환환자수"},{text:"18(상)"}],{sort:null,format:"int",cssFormat:sumColumnStyle}),new FingerDataGridColumn("ddd1_share",100,"right","int",[{text:"DDD share",colspan:4},{text:"당월 ~ -2월"}],{sort:null,format:"no_zero_percent",cssFormat:sumColumnStyle}),new FingerDataGridColumn("ddd2_share",100,"right","int",[{text:""},{text:"-3월 ~ -5월"}],{sort:null,format:"no_zero_percent",cssFormat:sumColumnStyle}),new FingerDataGridColumn("ddd3_share",100,"right","int",[{text:""},{text:"-6월 ~ -8월"}],{sort:null,format:"no_zero_percent",cssFormat:sumColumnStyle}),new FingerDataGridColumn("ddd4_share",100,"right","int",[{text:""},{text:"-9월 ~ -11월"}],{sort:null,format:"no_zero_percent",cssFormat:sumColumnStyle}),new FingerDataGridColumn("select_chk",100,"right","int",[{text:""},{text:""}],{hidden:true,cssFormat:sumColumnStyle}),new FingerDataGridColumn("id",130,"center","string",[{text:"담당자ID",rowspan:2}],{hidden:true}),new FingerDataGridColumn("employee_id",130,"center","string",[{text:"담당자ID",rowspan:2}],{hidden:true}),new FingerDataGridColumn("company_id",170,"center","string",[{text:"거래처ID",rowspan:2}],{hidden:true})]);$.grdList.init({panel:$.panList,scroll:"xy",headerRowHeight:40,view:"grouptable",nonExcel:false,isFilter:false,leftSplit:2});$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panQuery.add($.lblDept);$.panQuery.add($.cboDept);$.panQuery.add($.lblProduct);$.panQuery.add($.cboProduct);$.panQuery.add($.radioAmt);$.panQuery.add($.radioCount);$.panQuery.add($.radioSupply);$.panQuery.add($.lblRadioGroup);$.panQuery.add($.lblTeam);$.panQuery.add($.cboTeam);$.panQuery.add($.btnSearch);$.panList.add($.grdList);setSizeByWindow();if($.isDebug){var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{business_id:"BP00000082",wf_type:"00",business_title:"거래처(지역)배치 지원"}]]};var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.varDoc="["+g_main.session.obj.DeptName+"] "+result.business_title}else{searchWFDocument();initSearchOption()}};$.callback=function(type,ds){if(type=="SEARCH_Q"){$.grdList.clear();if(ds&&ds.resultList){setDataGrid([$.grdList],ds);doDataSort($.grdList,true);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center");$.panList.enableButton(arrBtn)}else{$.panList.disableButton(arrBtn)}}else{if(type=="Q3"){}else{if(type=="SAVE"){if(ds&&ds.errorCode=="MSG0002"){saveList("N_DETAIL")}else{removeWFDocument($.varWfDocId);MessageBoxShow("기안 상신도중 오류가 발생하였습니다.")}}else{if(type=="SAVE_DETAIL"){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{if(cs.wf_status=="60"){$.varWfDocId=cs.wf_doc_id}}var ds=args[6][0];if(ds.team_code=="S030"){ds.dept_code="S030"}$.cboDept.setValue(ds.dept_code);$.cboTeam.setValue(ds.team_code);doSearch("Q_DOC")}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if($.grdList.getRowCount()>0){var msg="현재 테이블 상의 거래처 배치 데이터가 초기화 됩니다. 재 조회 하시겠습니까?";confirmBoxShow(msg,function(){if(g_main.msgShare==true){searchList()}})}else{searchList()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cboDept"){var strQuery=" and parent_dept_code = '"+value+"'";var ds;$.cboTeam.clear();if(value){if(value=="S030"){ds={resultList:[[{dept_code:"S030",dept_name:"SR영업소"}]]};setComboBind([$.cboTeam],ds);$.cboTeam.setValue("S030")}else{ds=bizComponentData2($,"Q4","L_CRM0120",strQuery,"","");setComboBind([$.cboTeam],ds)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){$.selectRowId=$.grdList.getSelectedRowIdx();if(cInd=="emp_name"){var objRow=$.grdList.getValue(rId);if(objRow.row_level==1){var objParam={employee_id:"",emp_name:objRow.employee_id&&objRow.employee_id!="RESET"?objRow.emp_name:""};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",objParam,"","")}}else{if(cInd=="company_name"){var objSelectedRow=$.grdList.getValue(rId);if(!$.cboTeam.getValue()){MessageBoxShow("영업소를 선택하세요.");return}if(!objSelectedRow.employee_id||objSelectedRow.employee_id=="RESET"){MessageBoxShow("담당자를 먼저 선택하세요.");return}if(objSelectedRow.row_level==1&&objSelectedRow.employee_id!=$.resetEmpId){var arrRows=$.grdList.getAllRows();var selectedRow=$.grdList.getSelectedItem();var arrCompany=[];var arrSelected=[];var arrCol=["employee_id","emp_name","company_id","company_name","num_beds","channel","channel_name","sidogu_code","zip_sido","sido_code","zip_gungu","gungu_code"];for(var index=0;index<arrRows.length;index++){var objRow=arrRows[index];var objCompany={};var isSelected=objRow.employee_id==selectedRow.employee_id?true:false;for(var keyIndex in arrCol){var colName=arrCol[keyIndex];if(objRow[colName]){objCompany[colName]=objRow[colName]}}if(objRow.row_level==1){if(isSelected){arrSelected.push(objCompany)}else{objCompany.emp_name=(objCompany.employee_id=="RESET"?"배정되지 않음":objCompany.emp_name);arrCompany.push(objCompany)}}}var objParam={totalInfo:arrCompany,selectedInfo:arrSelected,emp_id:selectedRow.employee_id,emp_name:selectedRow.emp_name,deptCode:$.cboTeam.getValue()};g_main.openPopup("popAssignManager.html","popAssignManager","거래처 담당자 배정",800,720,"","",objParam,"","")}}}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnCustom1"){$.saveType="SUBMIT";if(!saveChk()){return}g_main.openPopup("popSelectHalf.html","popSelectHalf","",0,0,"","",{},"","")}else{if(btnId=="btnCustom2"){var rowData=$.grdList.getSelectedItem();if(rowData.row_level!="1"){MessageBoxShow("담당자를 선택해 주세요.");return}if(!rowData.employee_id||rowData.employee_id=="RESET"){MessageBoxShow("담당자가 배정되지 않았습니다.");return}var msg=rowData.emp_name+"님의 거래처를 모두 삭제하시겠습니까?";confirmBoxShow(msg,function(){if(g_main.msgShare==true){var gridCopy=deepCopyObj($.grdList.getAllRows());var selEmpGroup=[];for(var i=0;i<gridCopy.length;i++){var gridRow=gridCopy[i];if(gridRow.employee_id==rowData.employee_id&&gridRow.row_level=="1"){gridRow.employee_id="RESET";gridRow.emp_name="배정되지 않음";selEmpGroup.push(gridRow)}}var objReturn={unsign:selEmpGroup};doMoveRow(objReturn)}})}else{if(btnId=="btnCustom3"){var arrRows=$.grdList.getAllRows();var addIndex=arrRows.length;arrRows.some(function(item,index){if(item.employee_id==$.resetEmpId){addIndex=index;return true}});$.grdList.addRow({row_level:1,emp_name:emptyCellStyle("[담당자 선택]"),company_name:emptyCellStyle("[거래처 선택]")},addIndex)}else{if(btnId=="btnCustom4"){if($.grdList.getRowCount()<2){MessageBoxShow("위치를 확인할 내역이 없습니다.");return}var dt=$.grdList.getAllRows();var compEmployeeId=dt[0].employee_id;var matchingData=[];var employeeList=[];for(var i=0;i<dt.length;i++){if(dt[i].row_level=="1"&&dt[i].company_id){matchingData.push(dt[i]);if(compEmployeeId!=dt[i].employee_id){employeeList.push({employee_id:dt[i].employee_id,emp_name:dt[i].emp_name})}compEmployeeId=dt[i].employee_id}}var params={data:matchingData,selectCompanyId:"",companyType:"",employeeList:employeeList};g_main.openPopup("popCompanyMap.html","popCompanyMap","병원위치확인",0,0,"","",params,"","")}else{if(btnId=="btnCustom5"){if($.grdList.getRowCount()<2){MessageBoxShow("초기화할 내역이 없습니다.");return}confirmBoxShow("리스트상에 담당자별로 배정되어 있는 거래처를 모두 삭제하시겠습니까?",function(){if(g_main.msgShare==true){doResetMatch()}})}else{if(btnId=="btnExcelDown"){}else{if(btnId=="btnTmp"){$.saveType="TMP";if(!saveChk()){return}g_main.openPopup("popSelectHalf.html","popSelectHalf","",0,0,"","",{},"","")}else{if(btnId=="btnDelCompany"){var rId=$.grdList.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 내역이 없습니다.");return}var rowData=$.grdList.getValue(rId);if(rowData.row_level!="1"){MessageBoxShow("거래처를 선택하세요.");return}confirmBoxShow("선택하신 거래처를 삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdList.deleteCurrentRow();doDataSort($.grdList);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center")}})}}}}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(id=="popEmp"){if(popResult){var rId=$.grdList.getSelectedRowIdx();var selectedEployeeId=$.grdList.getValue(rId).employee_id;var isFirst=true;for(var i=0;i<$.grdList.getRowCount();i++){var rowData=$.grdList.getValue(i);if(selectedEployeeId==rowData.employee_id&&rowData.row_level=="1"){$.grdList.setValue(i,"employee_id",popResult.employee_id);$.grdList.setValue(i,"emp_name",popResult.emp_name);if(isFirst){$.grdList.setValue(i,"select_chk","Y");isFirst=false}}}doDataSort($.grdList);doCalcTotal();$.grdList.setRowSpan("emp_name","webix_custom_text_center");var index=$.grdList.getGridRowIndex("select_chk","Y");$.grdList.selectRow(index);$.grdList.setValue(index,"select_chk","")}}else{if(id=="popAssignManager"){if(popResult){var popData=popResult.assign;var grdData=$.grdList.getAllRows();doMoveRow(popResult);$.grdList.selectRow($.selectRowId)}}else{if(id=="popSelectHalf"){if(popResult){if(popResult.isOk){var yyyyHalf=popResult.yyyy_hf;$.yyyy=yyyyHalf.substr(0,4);$.half=yyyyHalf.substr(5,1);if(!$.varWfDocId){saveWFDocument("","N")}if(saveList("N")){if(saveList("N_DETAIL")){var param="";if($.saveType=="TMP"){param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{param={wf_doc_id:$.varWfDocId,wf_form_id:"crmTargetAllocation",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","결재라인 지정",0,0,"","",param,"","")}}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}}}else{if(id=="popModAppr"){if(popResult){if(popResult.isCancel){$.varWfDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWfDocId)}}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>