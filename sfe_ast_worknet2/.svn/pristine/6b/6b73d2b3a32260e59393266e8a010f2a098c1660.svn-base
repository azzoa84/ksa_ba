<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.cmbBaseDate=null;$.panList=null;$.grdList=null;$.panDetail=null;$.lblBudgList=null;$.lblAssignMoney=null;$.lblFusibleMoney=null;$.lblApplyMoney=null;$.lblReason=null;$.cmbBudgList=null;$.lblObjectType=null;$.lblObjectDept=null;$.lblObjectEmp=null;$.cmbObjectType=null;$.bteObjectDept=null;$.bteObjectEmp=null;$.speAssignMoney=null;$.speFusibleMoney=null;$.speApplyMoney=null;$.memReason=null;$.panObject=null;$.grdFile=null;$.grdDoc=null;$.lblAfterMoney=null;$.speAfterMoney=null;$.varWfDocId="";$.varBusinessId="";$.strsave_type="N";$.txttarget_dept_code="";$.txttarget_emp_id="";$.btarget=false;$.isSave=false;$.saveType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFBgtAssignChg_30"]);return json}function createJSON_Q1(workType){var json=createExecuteParamInfo("P_crmWFBgtAssignChg_Q",[workType,$.varWfDocId,"30",$.cmbBaseDate.getValue().substring(0,4),$.cmbBaseDate.getValue().substring(4,5),$.cmbBudgList.getValue("dept_code"),$.cmbBudgList.getValue("budget_code"),$.cmbBudgList.getValue("product_code"),"#UserID#"]);return json}function createJSON_S(workType){var gRow=$.grdList.getAllRows();var rows=[];var iCount=1;for(var i in gRow){rows.push([workType,$.varWfDocId,$.cmbBaseDate.getValue().substring(0,4),$.cmbBaseDate.getValue().substring(4,5),gRow[i].dept_code,gRow[i].budget_code,gRow[i].product_code,parseInt(iCount),"30",gRow[i].target_dept_code,gRow[i].target_emp_id,"","",Number(gRow[i].target_req_amt),parseInt(0),gRow[i].change_remark,"#UserID#"]);iCount++}var json=createExecuteParamInfo("P_crmWFBgtAssignChgD_S",rows);return json}function createJSON_S1(workType){var json=createExecuteParamInfo("P_crmBudgetTotal_S",[workType,$.varWfDocId,$.cmbBaseDate.getValue().substring(0,4),$.cmbBaseDate.getValue().substring(4,5),$.cmbBudgList.getValue("dept_code"),$.cmbBudgList.getValue("budget_code"),$.cmbBudgList.getValue("product_code"),parseInt(0),"30"]);return json}function newClick(){$.panDetail.clear();$.panObject.clear();$.wbeWFDetail.setClear();$.grdFile.clear();$.grdDoc.clear()}function searchWFDocument(workType){var json=createJSON_Q(workType);if(workType=="Q3"){callQuery(["req",json],workType,$)}else{if(workType=="Q2"){log(json);var ds=callExecuteSync(["req",json],workType,$);log(ds.returnStr)}}}function summit(popResult){if(saveWFDocument("","Y",popResult)){saveBudgetTotal("10")}else{removeWFDocument($.varWfDocId)}}function tmpSave(){if(saveWFDocument("","N")){saveWFBqtAssignChg_30("N")}else{removeWFDocument($.varWfDocId)}}function saveWFBqtAssignChg_30(workType,paramId){var json=createJSON_S(workType);callExecute(["req",json],workType,$)}function saveBudgetTotal(workType){var json=createJSON_S1(workType);callExecute(["req",json],workType,$)}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function searchApplyList(workType){var json=createJSON_Q1(workType);callQuery(["req",json],workType,$)}function setbudget_amt(btarget_yn){$.btarget=btarget_yn;searchApplyList("Q1")}function cmbObjectTypeChange(){if($.cmbObjectType.getValue()=="10"){$.bteObjectDept.setAllowBlank(true,"대상부서");$.bteObjectDept.setEnable(false);$.bteObjectEmp.setEnable(true);$.bteObjectDept.setText("");$.txttarget_dept_code="";$.bteObjectEmp.setAllowBlank(false,"대상임직원")}else{if($.cmbObjectType.getValue()=="20"){$.bteObjectEmp.setAllowBlank(true,"대상임직원");$.bteObjectDept.setEnable(true);$.bteObjectEmp.setEnable(false);$.bteObjectEmp.setText("");$.txttarget_emp_id="";$.bteObjectDept.setAllowBlank(false,"대상부서")}else{if($.cmbObjectType.getValue()==""){$.bteObjectDept.setAllowBlank(false,"대상부서");$.bteObjectEmp.setAllowBlank(false,"대상임직원");$.bteObjectDept.setEnable(false);$.bteObjectEmp.setEnable(false);$.bteObjectDept.setText("");$.bteObjectEmp.setText("");$.txttarget_dept_code="";$.txttarget_emp_id=""}}}}function cmbBudgListChange(){if($.cmbBudgList.getValue("budget_code")==""){return}setbudget_amt(false)}function changeMoney(){$.speAfterMoney.setValue(Number($.speApplyMoney.getValue())+Number($.speFusibleMoney.getValue()))}function checkValidation(){if(!validateControls([$.txtTitle,$.cmbBaseDate])){return false}if($.grdList.getRowCount()<1){MessageBoxShow("저장할 내용이 존재하지 않습니다.");return false}return true}function moveWFGeneralProc(){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1200);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,535,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFDetail=new FingerPanel(host,"panWFDetail",0,600,1200,285);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,900,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,900,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,210);$.cmbBaseDate=new FingerComboBox(host,"cmbBaseDate",505,77,140,20);$.panList=new FingerPanel(host,"panList",0,345,1200,240);$.panList.setText("신청추가");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,195);$.panDetail=new FingerPanel(host,"panDetail",0,65,700,270);$.panDetail.setText("신청내역");$.panDetail.setBottomLine(true);$.lblBudgList=new FingerLabel(host,"lblBudgList",0,15,100,20);$.lblBudgList.setText("예산항목");$.lblAssignMoney=new FingerLabel(host,"lblAssignMoney",0,45,100,20);$.lblAssignMoney.setText("배정금액");$.lblFusibleMoney=new FingerLabel(host,"lblFusibleMoney",325,45,100,20);$.lblFusibleMoney.setText("가용잔액");$.lblApplyMoney=new FingerLabel(host,"lblApplyMoney",0,75,100,20);$.lblApplyMoney.setText("신청금액");$.lblReason=new FingerLabel(host,"lblReason",0,140,100,20);$.lblReason.setText("사유");$.cmbBudgList=new FingerComboBox(host,"cmbBudgList",105,15,540,20);$.lblObjectType=new FingerLabel(host,"lblObjectType",20,15,100,20);$.lblObjectType.setText("대상유형");$.lblObjectDept=new FingerLabel(host,"lblObjectDept",20,45,100,20);$.lblObjectDept.setText("대상부서");$.lblObjectEmp=new FingerLabel(host,"lblObjectEmp",20,75,100,20);$.lblObjectEmp.setText("대상임직원");$.cmbObjectType=new FingerComboBox(host,"cmbObjectType",125,15,276,20);$.bteObjectDept=new FingerButtonEdit(host,"bteObjectDept",125,45,270,20);$.bteObjectDept.setText("");$.bteObjectEmp=new FingerButtonEdit(host,"bteObjectEmp",125,75,270,20);$.bteObjectEmp.setText("");$.speAssignMoney=new FingerSpinEdit(host,"speAssignMoney",105,45,210,20);$.speFusibleMoney=new FingerSpinEdit(host,"speFusibleMoney",430,45,210,20);$.speApplyMoney=new FingerSpinEdit(host,"speApplyMoney",105,75,210,20);$.memReason=new FingerMemoEdit(host,"memReason",105,105,530,95);$.panObject=new FingerPanel(host,"panObject",710,65,490,270);$.panObject.setText("대상내역");$.panObject.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,235);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,235);$.lblAfterMoney=new FingerLabel(host,"lblAfterMoney",325,75,100,20);$.lblAfterMoney.setText("신청후잔액");$.speAfterMoney=new FingerSpinEdit(host,"speAfterMoney",430,75,210,20);$.panTitle.setBorder(true);$.panList.addButtons(["btnDelete","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.txtTitle.setAllowBlank(false,"문서제목");$.cmbBaseDate.setAllowBlank(false,"기준년도/반기");$.cmbBudgList.setEmptyRow(true);$.cmbBudgList.setAllowBlank(false,"예산항목");$.speAssignMoney.setReadOnly(true);$.speAssignMoney.setValue(0);$.speFusibleMoney.setReadOnly(true);$.speFusibleMoney.setValue(0);$.speApplyMoney.setValue(0);$.speApplyMoney.setAllowBlank(false,"예산항목");$.lblAfterMoney.setVisible(false);$.speAfterMoney.setReadOnly(true);$.speAfterMoney.setVisible(false);$.cmbObjectType.setEmptyRow(true);$.cmbObjectType.setAllowBlank(false,"대상유형");$.bteObjectDept.setEnable(false);$.bteObjectEmp.setEnable(false);$.cmbBaseDate.setReadOnly(true);$.cmbBudgList.setColumnConfig([{id:"budget_name",width:200},{id:"dept_code",width:60},{id:"dept_name",width:60},{id:"budget_code",width:80},{id:"product_code",width:60},{id:"not_transfer_yn",width:50},{id:"budget_transfer_type",width:60},{id:"dept_leader",hidden:true},{id:"base_yyyy",hidden:true},{id:"base_half",hidden:true}]);$.cmbObjectType.setColumnConfig([{id:"sub_code",width:120},{id:"code_name",width:120}]);$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("dept_code",120,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",120,"left","string","부서"),new FingerDataGridColumn("budget_code",240,"left","string","예산코드",{hidden:true}),new FingerDataGridColumn("budget_name",280,"left","string","예산항목"),new FingerDataGridColumn("product_code",200,"left","string","품목코드",{hidden:true}),new FingerDataGridColumn("target_req_amt",120,"right","int","신청금액",{format:"int"}),new FingerDataGridColumn("target_emp_id",100,"left","string","대상직원아이디",{hidden:true}),new FingerDataGridColumn("target_dept_name",140,"left","string","대상부서"),new FingerDataGridColumn("target_emp_name",120,"left","string","대상임직원"),new FingerDataGridColumn("target_dept_code",100,"left","string","대상부서코드",{hidden:true}),new FingerDataGridColumn("aval_amt",120,"right","int","가용잔액",{format:"int"}),new FingerDataGridColumn("change_remark",290,"left","string","사유"),new FingerDataGridColumn("target_product_name",290,"left","string","대상품목",{hidden:true}),new FingerDataGridColumn("target_budget_code",290,"left","string","대상예산코드",{hidden:true}),new FingerDataGridColumn("target_budget_name",290,"left","string","대상예산항목",{hidden:true}),new FingerDataGridColumn("target_product_code",290,"left","string","대상품목코드",{hidden:true})]);$.grdList.init({panel:$.panList,nonExcel:true,isFilter:false});$.grdList.setEditable(false);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panList);$.panMain.add($.panDetail);$.panMain.add($.panObject);$.panMain.add($.cmbBaseDate);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.panList.add($.grdList);$.panDetail.add($.lblBudgList);$.panDetail.add($.lblAssignMoney);$.panDetail.add($.lblFusibleMoney);$.panDetail.add($.lblApplyMoney);$.panDetail.add($.lblReason);$.panDetail.add($.cmbBudgList);$.panDetail.add($.speAssignMoney);$.panDetail.add($.speFusibleMoney);$.panDetail.add($.speApplyMoney);$.panDetail.add($.memReason);$.panDetail.add($.lblAfterMoney);$.panDetail.add($.speAfterMoney);$.panObject.add($.lblObjectType);$.panObject.add($.lblObjectDept);$.panObject.add($.lblObjectEmp);$.panObject.add($.cmbObjectType);$.panObject.add($.bteObjectDept);$.panObject.add($.bteObjectEmp);relocateChildIndexInPanel([$.panTitle,$.panDetail,$.panObject]);var strdept_code2="";if(g_main.session.obj.DeptCode=="G100"){strdept_code2="G100"}if(g_main.session.obj.DeptCode=="S300"){strdept_code2="S340"}if(g_main.session.obj.DeptCode=="T200"){strdept_code2="T220"}if(g_main.session.obj.DeptCode=="U100"){strdept_code2="U110"}searchWFDocument("Q3");var ds=bizComponentData2($,"Q1","L_CRM0008|L_CRM0043");$.cmbBaseDate.setColumn("half_code","half_name");setComboBind([$.cmbBaseDate,$.cmbObjectType],ds);$.cmbBaseDate.setValue(ds.resultList[0][0].half_code);var subQuery=" where base_yyyy = '"+$.cmbBaseDate.getValue().substring(0,4)+"' AND base_half = '"+$.cmbBaseDate.getValue().substring(4)+"' AND (dept_code = '"+g_main.session.obj.DeptCode+"' OR dept_leader = '"+g_main.session.obj.UserID+"')";var ds1=bizComponentData2($,"Q4","L_CRM0078_3",subQuery);$.cmbBudgList.setColumn("budget_code","budget_name");setComboBind([$.cmbBudgList],ds1)};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue("["+g_main.session.getValue("DeptName")+"] "+result.business_title)}else{if(type=="N"){if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);removeWFDocument($.varWfDocId);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);removeWFDocument($.varWfDocId);return}}if($.saveType=="summit"){var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFBgtAssignChg_30",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if($.saveType=="tmp"){moveWFGeneralProc()}}}}else{if(type=="10"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);removeWFDocument($.varWfDocId)}else{if(ds.errorCode=="MSG0002"){moveWFGeneralProc()}else{if(ds.errorCode=="MSG0029"){MessageBoxShow("등록된 레코드가 없습니다.")}}}}}else{if(type=="Q1"){if(ds){if(ds.resultList[0].length<1){return}$.speAssignMoney.setValue(ds.resultList[0][0].half_amt);$.speFusibleMoney.setValue(ds.resultList[0][0].aval_amt);changeMoney()}}}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);setDataGrid([$.grdList],args[6],true);$.grdList.selectRow(0);$.isSave=true}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!checkValidation()){return}confirmBoxShow("상신 하시겠습니까?",function(){if(g_main.msgShare==true){$.saveType="summit";tmpSave()}})}else{if(id=="btnTmpSave"){if(!checkValidation()){return}confirmBoxShow("임시저장 하시겠습니까?",function(){if(g_main.msgShare==true){$.saveType="tmp";tmpSave()}})}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteObjectDept"){var param={dept_name:$.bteObjectDept.getText()||"",};g_main.openPopup("popDept.html","popDept","",0,0,"","",param,"","")}else{if(id=="bteObjectEmp"){var param={emp_name:$.bteObjectEmp.getText()||"",};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbObjectType"){if(!$.grid_change){cmbObjectTypeChange()}}else{if(id=="cmbBudgList"){cmbBudgListChange()}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){if($.grdList.getValue(rId,"budget_code")==""){return}$.txttarget_dept_code=$.grdList.getValue(rId,"target_dept_code");$.txttarget_emp_id=$.grdList.getValue(rId,"target_emp_id");$.bteObjectEmp.setText($.grdList.getValue(rId,"target_emp_name"));$.bteObjectDept.setText($.grdList.getValue(rId,"target_dept_name"));$.speApplyMoney.setValue($.grdList.getValue(rId,"target_req_amt"));$.memReason.setValue($.grdList.getValue(rId,"change_remark"));$.grid_change=true;if($.txttarget_emp_id==""){$.cmbObjectType.setValue("20");$.bteObjectEmp.setAllowBlank(true,"대상임직원");$.bteObjectDept.setEnable(true);$.bteObjectEmp.setEnable(false);$.bteObjectEmp.setText("");$.txttarget_emp_id="";$.bteObjectDept.setAllowBlank(false,"대상부서")}else{if($.txttarget_dept_code==""){$.cmbObjectType.setValue("10");$.bteObjectDept.setAllowBlank(true,"대상부서");$.bteObjectDept.setEnable(false);$.bteObjectEmp.setEnable(true);$.bteObjectDept.setText("");$.txttarget_dept_code="";$.bteObjectEmp.setAllowBlank(false,"대상임직원")}else{$.cmbObjectType.setValue("")}}$.grid_change=false}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){if(id=="speApplyMoney"){if($.speApplyMoney.getValue()==""){$.speApplyMoney.setValue(0)}changeMoney()}};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnSave"){if(!validateControls([$.cmbBudgList,$.cmbBaseDate,$.cmbObjectType,$.bteObjectDept,$.bteObjectEmp])){return}var iRow=0;$.strsave_type="N";for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"dept_code")==$.cmbBudgList.getValue("dept_code")&&$.grdList.getValue(i,"budget_code")==$.cmbBudgList.getValue("budget_code")&&$.grdList.getValue(i,"product_code")==$.cmbBudgList.getValue("product_code")&&$.grdList.getValue(i,"target_dept_code")==$.txttarget_dept_code&&$.grdList.getValue(i,"target_emp_id")==$.txttarget_emp_id){$.strsave_type="Y";iRow=i;break}}if($.strsave_type=="N"){$.grdList.addRow({dept_code:$.cmbBudgList.getValue("dept_code"),dept_name:$.cmbBudgList.getValue("dept_name"),budget_code:$.cmbBudgList.getValue("budget_code"),budget_name:$.cmbBudgList.getValue("budget_name"),product_code:$.cmbBudgList.getValue("product_code"),target_req_amt:$.speApplyMoney.getValue(),target_emp_id:$.txttarget_emp_id,target_emp_name:$.bteObjectEmp.getText(),target_dept_code:$.txttarget_dept_code,target_dept_name:$.bteObjectDept.getText(),aval_amt:$.speFusibleMoney.getValue(),change_remark:$.memReason.getValue(),})}else{$.grdList.setValue(iRow,"target_req_amt",$.speApplyMoney.getValue());$.grdList.setValue(iRow,"change_remark",$.memReason.getValue());$.grdList.selectRow(iRow);$.grdList.getItem(iRow).rowType="N"}$.strsave_type="N"}else{if(btnId=="btnNew"){$.panDetail.clear();$.panObject.clear();$.strsave_type="N";$.cmbBudgList.setFocus()}else{if(btnId=="btnDelete"){if($.grdList.getRowCount()<1){MessageBoxShow("선택된 행이 존재하지 않습니다.");newClick();return}$.grdList.deleteCurrentRow();newClick()}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",1100,735,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popDept"){if($.popUpCallId=="bteObjectDept"){$.txttarget_dept_code=popResult.dept_code;$.bteObjectDept.setText(popResult.dept_name)}}else{if(id=="popEmp"){if($.popUpCallId=="bteObjectEmp"){$.txttarget_emp_id=popResult.employee_id;$.bteObjectEmp.setText(popResult.emp_name)}}else{if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWfDocId=popResult.wf_doc_id}else{$.isSave=false;summit(popResult)}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>