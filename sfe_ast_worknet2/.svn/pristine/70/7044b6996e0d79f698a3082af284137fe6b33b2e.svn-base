<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.panBase=null;$.lblSiteCode=null;$.cmbSiteCode=null;$.lblDate=null;$.dteDate=null;$.lblWorkDayType=null;$.cmbWorkDayType=null;$.lblWeekSeq=null;$.speWeekSeq=null;$.lblDaySeq=null;$.speDaySeq=null;$.lblDescr=null;$.txtDescr=null;$.schVacation=null;$.btnSearch=null;$.selectDate=getToday();function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRB1300_Q",[workType,$.cmbSiteCode.getValue(),$.selectDate.substring(0,6),workType=="Q"?"":$.selectDate,$.selectDate.substring(0,4)]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("HR..P_HRB1300_S",[workType,$.cmbSiteCode.getValue(),$.selectDate,$.cmbWorkDayType.getValue(),$.txtDescr.getValue()]);return json}function searchList(workType){if(!validateControls([$.cmbSiteCode])){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveBase(workType){if(!validateControls([$.dteDate])){return}var json=createJSON_S(workType);callQuery(["req",json],workType,$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,790);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine();$.panList=new FingerPanel(host,"panList",0,65,890,695);$.panList.setText("달력정보");$.panList.setBottomLine(true);$.panBase=new FingerPanel(host,"panBase",900,65,300,695);$.panBase.setText("달력편집");$.panBase.setBottomLine(true);$.lblSiteCode=new FingerLabel(host,"lblSiteCode",0,15,100,20);$.lblSiteCode.setText("사업장");$.cmbSiteCode=new FingerComboBox(host,"cmbSiteCode",105,15,200,20);$.lblDate=new FingerLabel(host,"lblDate",20,10,100,20);$.lblDate.setText("기준일");$.dteDate=new FingerDateEdit(host,"dteDate",125,10,140,20);$.lblWorkDayType=new FingerLabel(host,"lblWorkDayType",20,40,100,20);$.lblWorkDayType.setText("근무일구분");$.cmbWorkDayType=new FingerComboBox(host,"cmbWorkDayType",125,40,140,20);$.lblWeekSeq=new FingerLabel(host,"lblWeekSeq",20,70,100,20);$.lblWeekSeq.setText("주차");$.speWeekSeq=new FingerSpinEdit(host,"speWeekSeq",125,70,140,20);$.lblDaySeq=new FingerLabel(host,"lblDaySeq",20,100,100,20);$.lblDaySeq.setText("연누계일수");$.speDaySeq=new FingerSpinEdit(host,"speDaySeq",125,100,140,20);$.lblDescr=new FingerLabel(host,"lblDescr",20,130,100,20);$.lblDescr.setText("적요");$.txtDescr=new FingerEdit(host,"txtDescr",125,130,140,20);$.schVacation=new FingerScheduler(host,"schVacation","workweek",["30"],[],10,15,870,625);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panQuery.setBorder(true);$.cmbSiteCode.setEmptyRow(true);$.cmbWorkDayType.setEmptyRow(true);$.cmbSiteCode.setAllowBlank(false,"사업장");$.dteDate.setAllowBlank(false,"기준일");$.dteDate.setEnable(false);$.speWeekSeq.setEnable(false);$.speDaySeq.setEnable(false);$.panBase.addButtons(["btnDelete","btnSave"]);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panBase);$.panQuery.add($.lblSiteCode);$.panQuery.add($.cmbSiteCode);$.panQuery.add($.btnSearch);$.panList.add($.schVacation);$.panBase.add($.lblDate);$.panBase.add($.dteDate);$.panBase.add($.lblWorkDayType);$.panBase.add($.cmbWorkDayType);$.panBase.add($.lblWeekSeq);$.panBase.add($.speWeekSeq);$.panBase.add($.lblDaySeq);$.panBase.add($.speDaySeq);$.panBase.add($.lblDescr);$.panBase.add($.txtDescr);$.cmbSiteCode.setColumn("site_code","site_name");$.cmbWorkDayType.setColumn("work_type_code","work_type_name");var ds=bizComponentData2($,"Q1","L_ORG001|L_HRB001");setComboBind([$.cmbSiteCode,$.cmbWorkDayType],ds);$.cmbSiteCode.setValue(g_main.session.getValue("SiteCode"));searchList("Q")};$.callback=function(type,ds){if(type=="Q"){if(ds.errorCode.substring(0,1)!="E"&&ds.errorCode.substring(0,1)!="P"){convertJavaDateToJs(ds.resultList,"yyyymmddhhmmss");var tmp=ds.resultList[0];for(var i in tmp){if(tmp[i].work_day_type=="FULL"){tmp[i].type="FULL"}else{if(tmp[i].work_day_type=="BOFF"){tmp[i].type="CM20"}else{if(tmp[i].work_day_type=="NOFF"){tmp[i].type="PLAN"}else{if(tmp[i].work_day_type=="APOFF"){tmp[i].type="COMPLETE"}else{if(tmp[i].appointID.substring(0,1)=="0"){tmp[i].type="CM20"}else{tmp[i].type="WEEKEND"}}}}}tmp[i].title=tmp[i].descr;tmp[i].start=tmp[i].yyyymmdd_start;tmp[i].end=tmp[i].yyyymmdd_end;tmp[i].bindId=tmp[i].appointID}$.schVacation.removeEvents();$.schVacation.addEventSource(tmp)}else{log(ds);return false}searchList("COUNT")}else{if(type=="COUNT"){$.weekCount=ds.resultList[0][0][Object.keys(ds.resultList[0][0])];log("$.weekCount : "+$.weekCount)}else{if(type=="SELECT"){$.cmbWorkDayType.setValue(ds.resultList[0][0].work_day_type);$.speWeekSeq.setValue(ds.resultList[0][0].week_seq);$.speDaySeq.setValue(ds.resultList[0][0].day_seq);$.txtDescr.setValue(ds.resultList[0][0].descr)}else{if(type=="U"){log(ds);if(ds.errorMsg==""){searchList("Q")}else{MessageBoxShow(ds.errorMsg)}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("Q")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panBase"){if(btnId=="btnSave"){saveBase("U")}else{if(btnId=="btnDelete"){$.txtDescr.setValue("");saveBase("U")}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){if(id=="schVacation"){if(event_id=="dayClick"){$.dteDate.setValue(event_object.date.substring(0,8));$.selectDate=event_object.date.substring(0,8);searchList("SELECT")}else{if(event_id=="eventClick"){log(event_object.data.work_day_type);log(event_object.date);$.selectDate=event_object.date.substring(0,8);$.dteDate.setValue(event_object.date.substring(0,8));$.cmbWorkDayType.setValue(event_object.data.work_day_type);$.speWeekSeq.setValue(event_object.data.week_seq);$.speDaySeq.setValue(event_object.data.day_seq);$.txtDescr.setValue(event_object.data.descr)}}}};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){if(id=="schVacation"){var temp=view.start.toString();var d=new Date(temp);var date=d.getDate();var month=d.getMonth()+1;var year=d.getFullYear();var tempMonth="";if(date=="1"){tempMonth=month}else{tempMonth=Number(month)+1}if(tempMonth=="13"){tempMonth="1";if(date!="1"){year++}}if(Number(tempMonth)<10){tempMonth="0"+tempMonth}else{tempMonth=tempMonth.toString()}var fullDay=year+tempMonth+"01";$.selectDate=fullDay;searchList("Q")}};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>