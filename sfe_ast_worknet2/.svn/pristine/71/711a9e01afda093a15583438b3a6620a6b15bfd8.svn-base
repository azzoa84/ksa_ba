<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.panList1=null;$.grdList1=null;$.panList2=null;$.grdList2=null;$.lblYYYYMM=null;$.dteYYYYMM=null;$.lblChannel=null;$.cmbChannel=null;$.lblProductCode=null;$.cmbProductCode=null;$.btnSearch=null;$.panDailyAvgCall=null;$.chartDailyAvgCall=null;$.panChartA=null;$.panChartS=null;$.panChartG=null;$.panChartK=null;$.chartA=null;$.chartS=null;$.chartG=null;$.chartK=null;$.htmlDailyAvgCallTitle=null;$.htmlDailyAvgCallCnt=null;$.htmlChartNameA=null;$.htmlChartNameS=null;$.htmlChartNameG=null;$.htmlChartNameK=null;$.tabPanel=null;$.panTab1=null;$.panTab2=null;$.DailyAvgLine1=null;$.DailyAvgLine2=null;$.DailyAvgLine3=null;$.DailyAvgLine4=null;$.DailyAvgLine5=null;$.DailyAvgLine6=null;$.DailyAvgLine7=null;$.DailyAvgLine8=null;$.DailyAvgLbl1=null;$.DailyAvgLbl2=null;$.DailyAvgLbl3=null;$.DailyAvgLbl4=null;$.DailyAvgValue1=null;$.DailyAvgValue2=null;$.DailyAvgValue3=null;$.DailyAvgValue4=null;$.ALine1=null;$.ALine2=null;$.ALine3=null;$.ALine4=null;$.ALine5=null;$.ALine6=null;$.ALine7=null;$.AValue1=null;$.AValue2=null;$.AValue3=null;$.AValue4=null;$.GLine1=null;$.GLine2=null;$.GLine3=null;$.GLine4=null;$.GLine5=null;$.GLine6=null;$.GLine7=null;$.GValue1=null;$.GValue2=null;$.GValue3=null;$.GValue4=null;$.KLine1=null;$.KLine2=null;$.KLine3=null;$.KLine4=null;$.KLine5=null;$.KLine6=null;$.KLine7=null;$.KValue1=null;$.KValue2=null;$.KValue3=null;$.KValue4=null;$.SLine1=null;$.SLine2=null;$.SLine3=null;$.SLine4=null;$.SLine5=null;$.SLine6=null;$.SLine7=null;$.SValue1=null;$.SValue2=null;$.SValue3=null;$.SValue4=null;$.ALbl1=null;$.ALbl2=null;$.ALbl3=null;$.ALbl4=null;$.GLbl1=null;$.GLbl2=null;$.GLbl3=null;$.GLbl4=null;$.KLbl1=null;$.KLbl2=null;$.KLbl3=null;$.KLbl4=null;$.SLbl1=null;$.SLbl2=null;$.SLbl3=null;$.SLbl4=null;$.lblDeptCode=null;$.lblEmployeeId=null;$.cmbDeptCode=null;$.cmbEmployeeId=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmPortalCall_Q",[workType,$.dteYYYYMM.getValue(),$.cmbChannel.getValue(),$.cmbProductCode.getValue(),$.cmbDeptCode.getValue(),$.cmbEmployeeId.getValue(),"#UserID#"]);return json}function searchCallCustomer(workType){if(!$.panTop.validateControls()){return}var json=createJSON_Q(workType);callExecute(["req",json],workType,$)}function initData(args){var ds=bizComponentData2($,"Q1","L_CRM0271|L_CRM00195");setComboBind([$.cmbProductCode,$.cmbDeptCode],ds);var ds=bizComponentData2($,"Q2","L_CRM233");setComboBind([$.cmbChannel],ds);$.dteYYYYMM.setValue(getToday());initCharts($.chartDailyAvgCall,299,290);initCharts($.chartA,234,230);initCharts($.chartS,234,230);initCharts($.chartG,234,230);initCharts($.chartK,234,230);if(args&&(args.dept_code||args.employee_id||args.product_code)){$.cmbDeptCode.setValue(args.dept_code);$.cmbEmployeeId.setValue(args.employee_id);$.cmbProductCode.setValue(args.product_code)}}function initLayout(){$.htmlDailyAvgCallTitle.setHTML("일일 평균Call수");$.htmlDailyAvgCallTitle.setStyleArray(cssFontInit(12,"5D5D5D"));$.htmlDailyAvgCallCnt.setStyleArray(cssFontInit(23,"FF0000"));$.DailyAvgValue1.setStyleArray(cssLabelStyle(15,"18ac1e"));$.DailyAvgValue2.setStyleArray(cssLabelStyle(15,"44d3c3"));$.DailyAvgValue3.setStyleArray(cssLabelStyle(15,"5D5D5D"));$.DailyAvgValue4.setStyleArray(cssLabelStyle(25,"FF0000"));$.htmlChartNameA.setHTML("L");$.htmlChartNameA.setStyleArray(cssChartName());$.AValue1.setStyleArray(cssLabelStyle(15,"18ac1e"));$.AValue2.setStyleArray(cssLabelStyle(15,"44d3c3"));$.AValue3.setStyleArray(cssLabelStyle(15,"5D5D5D"));$.AValue4.setStyleArray(cssLabelStyle(25,"FF0000"));$.htmlChartNameG.setHTML("T");$.htmlChartNameG.setStyleArray(cssChartName());$.GValue1.setStyleArray(cssLabelStyle(15,"18ac1e"));$.GValue2.setStyleArray(cssLabelStyle(15,"44d3c3"));$.GValue3.setStyleArray(cssLabelStyle(15,"5D5D5D"));$.GValue4.setStyleArray(cssLabelStyle(25,"FF0000"));$.htmlChartNameK.setHTML("A");$.htmlChartNameK.setStyleArray(cssChartName());$.KValue1.setStyleArray(cssLabelStyle(15,"18ac1e"));$.KValue2.setStyleArray(cssLabelStyle(15,"44d3c3"));$.KValue3.setStyleArray(cssLabelStyle(15,"5D5D5D"));$.KValue4.setStyleArray(cssLabelStyle(25,"FF0000"));$.htmlChartNameS.setHTML("U");$.htmlChartNameS.setStyleArray(cssChartName());$.SValue1.setStyleArray(cssLabelStyle(15,"18ac1e"));$.SValue2.setStyleArray(cssLabelStyle(15,"44d3c3"));$.SValue3.setStyleArray(cssLabelStyle(15,"5D5D5D"));$.SValue4.setStyleArray(cssLabelStyle(25,"FF0000"))}function initAuthentication(){var objInfo=g_main.session.obj;if(objInfo.SystemDeveloper=="Y"){return}if(objInfo.DeptLeaderYN=="Y"){$.cmbDeptCode.setValue(objInfo.DeptCode)}else{if(objInfo.DeptLeaderYN=="N"){$.cmbDeptCode.setValue(objInfo.DeptCode);$.cmbEmployeeId.setValue(objInfo.EmpCode)}}}function initCharts(id,width,height){id.init({chart:{width:width,height:height,type:"column"},title:{text:null},xAxis:{categories:null,label:{enabled:true}},yAxis:[{min:0,title:{text:null},}],credits:{enabled:false},series:[],tooltip:{shared:true}})}function doClearChart(obj){var cnt=obj.series.length;if(cnt>0){for(var i=0;i<cnt;i++){obj.series[0].remove()}}}function doRenderChart(obj,fxCall,targetCall,title){var colors=getChartColor("fixed_3");var plan_ratio=((targetCall/fxCall)*100).toFixed(0);obj.xAxis[0].setCategories(["목표대비 실행 Call("+title+")"]);obj.addSeries({name:["목표 Call"],data:[fxCall],color:colors[0]});obj.addSeries({name:["실행 Call"],data:[targetCall],color:colors[1],dataLabels:{enabled:true,format:plan_ratio+"%",style:{fontSize:"15px",fontWeight:"bold"}}})}function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function cssFontInit(fontSize,fontColor){return[{styleAttr:"font-weight",value:"600"},{styleAttr:"color",value:"#"+fontColor},{styleAttr:"text-align",value:"center"},{styleAttr:"font-size",value:fontSize+"px"}]}function cssChartName(){return[{styleAttr:"font-weight",value:"600"},{styleAttr:"line-height",value:"40px"},{styleAttr:"text-align",value:"center"},{styleAttr:"font-size",value:"22px"},{styleAttr:"border",value:"1px solid rgb(229, 229, 229)"}]}function cssLabelStyle(fontSize,fontColor){return[{styleAttr:"font-weight",value:"600"},{styleAttr:"vertical-align",value:"middel"},{styleAttr:"text-align",value:"center"},{styleAttr:"font-size",value:fontSize+"px"},{styleAttr:"color",value:"#"+fontColor},]}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1380);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,85);$.panTop.setText("");$.panTop.setBottomLine(true);$.panList1=new FingerPanel(host,"panList1",0,0,1200,740);$.panList1.setText("제품별 목표 대비 실행 현황");$.panList1.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,1195,690);$.panList2=new FingerPanel(host,"panList2",0,0,1200,740);$.panList2.setText("거래처별 목표 대비 실행 현황");$.panList2.setBottomLine(true);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1195,690);$.lblYYYYMM=new FingerLabel(host,"lblYYYYMM",0,15,100,20);$.lblYYYYMM.setText("연월");$.dteYYYYMM=new FingerDateEdit(host,"dteYYYYMM",115,15,135,20);$.lblChannel=new FingerLabel(host,"lblChannel",285,15,100,20);$.lblChannel.setText("채널");$.cmbChannel=new FingerComboBox(host,"cmbChannel",395,15,140,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",540,15,80,20);$.lblProductCode.setText("품목");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",635,15,145,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,50,80,20);$.btnSearch.setText("조회");$.panDailyAvgCall=new FingerPanel(host,"panDailyAvgCall",0,95,300,490);$.panDailyAvgCall.setText("");$.panDailyAvgCall.setBottomLine(true);$.chartDailyAvgCall=new FingerBarChart(host,"chartDailyAvgCall",0,190,300,300);$.panChartA=new FingerPanel(host,"panChartA",310,95,440,240);$.panChartA.setText("");$.panChartA.setBottomLine(true);$.panChartS=new FingerPanel(host,"panChartS",760,95,440,240);$.panChartS.setText("");$.panChartS.setBottomLine(true);$.panChartG=new FingerPanel(host,"panChartG",310,345,440,240);$.panChartG.setText("");$.panChartG.setBottomLine(true);$.panChartK=new FingerPanel(host,"panChartK",760,345,440,240);$.panChartK.setText("");$.panChartK.setBottomLine(true);$.chartA=new FingerBarChart(host,"chartA",165,0,235,240);$.chartS=new FingerBarChart(host,"chartS",40,0,235,240);$.chartG=new FingerBarChart(host,"chartG",165,0,235,240);$.chartK=new FingerBarChart(host,"chartK",40,0,235,240);$.htmlDailyAvgCallTitle=new FingerHTMLView(host,"htmlDailyAvgCallTitle",0,10,300,15);$.htmlDailyAvgCallCnt=new FingerHTMLView(host,"htmlDailyAvgCallCnt",0,30,300,30);$.htmlChartNameA=new FingerHTMLView(host,"htmlChartNameA",400,200,40,40);$.htmlChartNameS=new FingerHTMLView(host,"htmlChartNameS",0,200,40,40);$.htmlChartNameG=new FingerHTMLView(host,"htmlChartNameG",400,0,40,40);$.htmlChartNameK=new FingerHTMLView(host,"htmlChartNameK",0,0,40,40);$.tabPanel=new FingerTab(host,"tabPanel",0,605,1200,860);$.panTab1=new FingerPanel(host,"panTab1",0,0,1200,745);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,1200,745);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.DailyAvgLine1=new FingerLine(host,"DailyAvgLine1",25,70,245,1);$.DailyAvgLine2=new FingerLine(host,"DailyAvgLine2",25,100,245,1);$.DailyAvgLine3=new FingerLine(host,"DailyAvgLine3",25,130,245,1);$.DailyAvgLine4=new FingerLine(host,"DailyAvgLine4",25,180,245,1);$.DailyAvgLine5=new FingerLine(host,"DailyAvgLine5",25,70,1,111);$.DailyAvgLine6=new FingerLine(host,"DailyAvgLine6",270,70,1,111);$.DailyAvgLine7=new FingerLine(host,"DailyAvgLine7",105,70,1,61);$.DailyAvgLine8=new FingerLine(host,"DailyAvgLine8",190,70,1,61);$.DailyAvgLbl1=new FingerLabel(host,"DailyAvgLbl1",25,75,70,20);$.DailyAvgLbl1.setText("반기 목표");$.DailyAvgLbl2=new FingerLabel(host,"DailyAvgLbl2",105,75,70,20);$.DailyAvgLbl2.setText("반기 실행");$.DailyAvgLbl3=new FingerLabel(host,"DailyAvgLbl3",190,75,60,20);$.DailyAvgLbl3.setText("실행률");$.DailyAvgLbl4=new FingerLabel(host,"DailyAvgLbl4",25,130,80,45);$.DailyAvgLbl4.setText("고객수");$.DailyAvgValue1=new FingerHTMLView(host,"DailyAvgValue1",25,110,80,20);$.DailyAvgValue2=new FingerHTMLView(host,"DailyAvgValue2",105,110,85,20);$.DailyAvgValue3=new FingerHTMLView(host,"DailyAvgValue3",190,110,80,20);$.DailyAvgValue4=new FingerHTMLView(host,"DailyAvgValue4",140,140,130,35);$.ALine1=new FingerLine(host,"ALine1",5,15,155,1);$.ALine2=new FingerLine(host,"ALine2",5,50,155,1);$.ALine3=new FingerLine(host,"ALine3",5,85,155,1);$.ALine4=new FingerLine(host,"ALine4",5,120,155,1);$.ALine5=new FingerLine(host,"ALine5",5,165,155,1);$.ALine6=new FingerLine(host,"ALine6",5,15,1,151);$.ALine7=new FingerLine(host,"ALine7",160,15,1,151);$.AValue1=new FingerHTMLView(host,"AValue1",100,25,50,20);$.AValue2=new FingerHTMLView(host,"AValue2",100,60,50,20);$.AValue3=new FingerHTMLView(host,"AValue3",100,95,50,20);$.AValue4=new FingerHTMLView(host,"AValue4",75,130,85,35);$.GLine1=new FingerLine(host,"GLine1",5,15,155,1);$.GLine2=new FingerLine(host,"GLine2",5,50,155,1);$.GLine3=new FingerLine(host,"GLine3",5,85,155,1);$.GLine4=new FingerLine(host,"GLine4",5,120,155,1);$.GLine5=new FingerLine(host,"GLine5",5,165,155,1);$.GLine6=new FingerLine(host,"GLine6",5,15,1,151);$.GLine7=new FingerLine(host,"GLine7",160,15,1,151);$.GValue1=new FingerHTMLView(host,"GValue1",100,25,50,20);$.GValue2=new FingerHTMLView(host,"GValue2",100,60,50,20);$.GValue3=new FingerHTMLView(host,"GValue3",100,95,50,20);$.GValue4=new FingerHTMLView(host,"GValue4",75,130,85,35);$.KLine1=new FingerLine(host,"KLine1",280,15,155,1);$.KLine2=new FingerLine(host,"KLine2",280,50,155,1);$.KLine3=new FingerLine(host,"KLine3",280,85,155,1);$.KLine4=new FingerLine(host,"KLine4",280,120,155,1);$.KLine5=new FingerLine(host,"KLine5",280,165,155,1);$.KLine6=new FingerLine(host,"KLine6",280,15,1,151);$.KLine7=new FingerLine(host,"KLine7",435,15,1,151);$.KValue1=new FingerHTMLView(host,"KValue1",375,25,50,20);$.KValue2=new FingerHTMLView(host,"KValue2",375,60,50,20);$.KValue3=new FingerHTMLView(host,"KValue3",375,95,50,20);$.KValue4=new FingerHTMLView(host,"KValue4",350,130,85,35);$.SLine1=new FingerLine(host,"SLine1",280,15,155,1);$.SLine2=new FingerLine(host,"SLine2",280,50,155,1);$.SLine3=new FingerLine(host,"SLine3",280,85,155,1);$.SLine4=new FingerLine(host,"SLine4",280,120,155,1);$.SLine5=new FingerLine(host,"SLine5",280,165,155,1);$.SLine6=new FingerLine(host,"SLine6",280,15,1,151);$.SLine7=new FingerLine(host,"SLine7",435,15,1,151);$.SValue1=new FingerHTMLView(host,"SValue1",375,25,50,20);$.SValue2=new FingerHTMLView(host,"SValue2",375,60,50,20);$.SValue3=new FingerHTMLView(host,"SValue3",375,95,50,20);$.SValue4=new FingerHTMLView(host,"SValue4",350,130,85,35);$.ALbl1=new FingerLabel(host,"ALbl1",5,20,70,20);$.ALbl1.setText("반기 목표");$.ALbl2=new FingerLabel(host,"ALbl2",5,55,70,20);$.ALbl2.setText("반기 실행");$.ALbl3=new FingerLabel(host,"ALbl3",5,90,70,20);$.ALbl3.setText("실행률");$.ALbl4=new FingerLabel(host,"ALbl4",5,130,70,20);$.ALbl4.setText("고객수");$.GLbl1=new FingerLabel(host,"GLbl1",5,20,70,20);$.GLbl1.setText("반기 목표");$.GLbl2=new FingerLabel(host,"GLbl2",5,55,70,20);$.GLbl2.setText("반기 실행");$.GLbl3=new FingerLabel(host,"GLbl3",5,90,70,20);$.GLbl3.setText("실행률");$.GLbl4=new FingerLabel(host,"GLbl4",5,130,70,20);$.GLbl4.setText("고객수");$.KLbl1=new FingerLabel(host,"KLbl1",280,20,70,20);$.KLbl1.setText("반기 목표");$.KLbl2=new FingerLabel(host,"KLbl2",280,55,70,20);$.KLbl2.setText("반기 실행");$.KLbl3=new FingerLabel(host,"KLbl3",280,90,70,20);$.KLbl3.setText("실행률");$.KLbl4=new FingerLabel(host,"KLbl4",280,130,70,20);$.KLbl4.setText("고객수");$.SLbl1=new FingerLabel(host,"SLbl1",280,20,70,20);$.SLbl1.setText("반기 목표");$.SLbl2=new FingerLabel(host,"SLbl2",280,55,70,20);$.SLbl2.setText("반기 실행");$.SLbl3=new FingerLabel(host,"SLbl3",280,90,70,20);$.SLbl3.setText("실행률");$.SLbl4=new FingerLabel(host,"SLbl4",280,130,70,20);$.SLbl4.setText("고객수");$.lblDeptCode=new FingerLabel(host,"lblDeptCode",20,50,80,20);$.lblDeptCode.setText("부서");$.lblEmployeeId=new FingerLabel(host,"lblEmployeeId",285,50,100,20);$.lblEmployeeId.setText("담당자");$.cmbDeptCode=new FingerComboBox(host,"cmbDeptCode",115,50,140,20);$.cmbEmployeeId=new FingerComboBox(host,"cmbEmployeeId",395,50,140,20);$.panTop.setBorder(true);$.panDailyAvgCall.setBorder(true);$.panChartA.setBorder(true);$.panChartS.setBorder(true);$.panChartG.setBorder(true);$.panChartK.setBorder(true);$.dteYYYYMM.setDateFormat("yyyymm");$.cmbChannel.setEmptyRow(true);$.cmbProductCode.setEmptyRow(true);$.cmbDeptCode.setEmptyRow(true);$.cmbEmployeeId.setEmptyRow(true);$.cmbDeptCode.setColumn("dept_code","dept_name");$.cmbEmployeeId.setColumn("employee_id","emp_name");$.dteYYYYMM.setAllowBlank(false,"연월");$.grdList1.setColumns([new FingerDataGridColumn("parent_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("key_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("p_name",220,"left","string","",{template:"tree"}),new FingerDataGridColumn("contact_cnt",60,"right","string","고객 수",{format:"int"}),new FingerDataGridColumn("tar_call",90,"right","string","월 목표 Call",{format:"int"}),new FingerDataGridColumn("exc_call",90,"right","string","월 실행 Call",{format:"int"}),new FingerDataGridColumn("rate",100,"right","string","월 실행률(%)",{format:"only_percent"}),new FingerDataGridColumn("half_tar_call",100,"right","string","반기목표 Call",{format:"int"}),new FingerDataGridColumn("half_exc_call",100,"right","string","반기실행 Call",{format:"int"}),new FingerDataGridColumn("half_rate",110,"right","string","반기 실행률(%)",{format:"only_percent"}),new FingerDataGridColumn("territory_rate",150,"right","string","Call 비율(%)",{format:"only_percent"}),new FingerDataGridColumn("dept_rate",160,"right","string","영업부 월 평균 실행률(%)",{format:"only_percent"})]);$.grdList1.init({panel:$.panList1,scroll:"xy",view:"treetable",treeKey:{id:"key_id",parent:"parent_id"}});$.grdList1.setBorder(true);$.grdList2.setColumns([new FingerDataGridColumn("parent_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("key_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("p_name",220,"left","string","",{template:"tree"}),new FingerDataGridColumn("contact_cnt",60,"right","string","고객 수",{format:"int"}),new FingerDataGridColumn("tar_call",90,"right","string","월 목표 Call",{format:"int"}),new FingerDataGridColumn("exc_call",90,"right","string","월 실행 Call",{format:"int"}),new FingerDataGridColumn("rate",100,"right","string","월 실행률(%)",{format:"only_percent"}),new FingerDataGridColumn("half_tar_call",100,"right","string","반기목표 Call",{format:"int"}),new FingerDataGridColumn("half_exc_call",100,"right","string","반기실행 Call",{format:"int"}),new FingerDataGridColumn("half_rate",110,"right","string","반기 실행률(%)",{format:"only_percent"}),new FingerDataGridColumn("territory_rate",150,"right","string","Call 비율(%)",{format:"only_percent"}),new FingerDataGridColumn("dept_rate",160,"right","string","영업부 월 평균 실행률(%)",{format:"only_percent"})]);$.grdList2.init({panel:$.panList2,scroll:"xy",view:"treetable",treeKey:{id:"key_id",parent:"parent_id"}});$.grdList2.setBorder(true);$.tabPanel.addTab([{text:"제품 기준",body:$.panTab1,width:100},{text:"거래처 기준",body:$.panTab2,width:120}]);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panDailyAvgCall);$.panMain.add($.panChartA);$.panMain.add($.panChartS);$.panMain.add($.panChartG);$.panMain.add($.panChartK);$.panMain.add($.tabPanel);$.panTop.add($.dteYYYYMM);$.panTop.add($.lblChannel);$.panTop.add($.cmbChannel);$.panTop.add($.lblProductCode);$.panTop.add($.cmbProductCode);$.panTop.add($.btnSearch);$.panTop.add($.lblDeptCode);$.panTop.add($.lblEmployeeId);$.panTop.add($.cmbDeptCode);$.panTop.add($.cmbEmployeeId);$.panList1.add($.grdList1);$.panList2.add($.grdList2);$.panDailyAvgCall.add($.chartDailyAvgCall);$.panDailyAvgCall.add($.htmlDailyAvgCallTitle);$.panDailyAvgCall.add($.htmlDailyAvgCallCnt);$.panDailyAvgCall.add($.DailyAvgLine1);$.panDailyAvgCall.add($.DailyAvgLine2);$.panDailyAvgCall.add($.DailyAvgLine3);$.panDailyAvgCall.add($.DailyAvgLine4);$.panDailyAvgCall.add($.DailyAvgLine5);$.panDailyAvgCall.add($.DailyAvgLine6);$.panDailyAvgCall.add($.DailyAvgLine7);$.panDailyAvgCall.add($.DailyAvgLine8);$.panDailyAvgCall.add($.DailyAvgLbl1);$.panDailyAvgCall.add($.DailyAvgLbl2);$.panDailyAvgCall.add($.DailyAvgLbl3);$.panDailyAvgCall.add($.DailyAvgLbl4);$.panDailyAvgCall.add($.DailyAvgValue1);$.panDailyAvgCall.add($.DailyAvgValue2);$.panDailyAvgCall.add($.DailyAvgValue3);$.panDailyAvgCall.add($.DailyAvgValue4);$.panChartA.add($.chartA);$.panChartA.add($.htmlChartNameA);$.panChartA.add($.ALine1);$.panChartA.add($.ALine2);$.panChartA.add($.ALine3);$.panChartA.add($.ALine4);$.panChartA.add($.ALine5);$.panChartA.add($.ALine6);$.panChartA.add($.ALine7);$.panChartA.add($.AValue1);$.panChartA.add($.AValue2);$.panChartA.add($.AValue3);$.panChartA.add($.AValue4);$.panChartA.add($.ALbl1);$.panChartA.add($.ALbl3);$.panChartA.add($.ALbl4);$.panChartA.add($.ALbl2);$.panChartS.add($.chartS);$.panChartS.add($.htmlChartNameS);$.panChartS.add($.SLine1);$.panChartS.add($.SLine2);$.panChartS.add($.SLine3);$.panChartS.add($.SLine4);$.panChartS.add($.SLine5);$.panChartS.add($.SLine6);$.panChartS.add($.SLine7);$.panChartS.add($.SLbl1);$.panChartS.add($.SLbl2);$.panChartS.add($.SLbl3);$.panChartS.add($.SLbl4);$.panChartS.add($.SValue1);$.panChartS.add($.SValue2);$.panChartS.add($.SValue3);$.panChartS.add($.SValue4);$.panChartG.add($.chartG);$.panChartG.add($.htmlChartNameG);$.panChartG.add($.GValue4);$.panChartG.add($.GValue3);$.panChartG.add($.GValue2);$.panChartG.add($.GValue1);$.panChartG.add($.GLine7);$.panChartG.add($.GLine6);$.panChartG.add($.GLine5);$.panChartG.add($.GLine4);$.panChartG.add($.GLine3);$.panChartG.add($.GLine2);$.panChartG.add($.GLine1);$.panChartG.add($.GLbl1);$.panChartG.add($.GLbl2);$.panChartG.add($.GLbl3);$.panChartG.add($.GLbl4);$.panChartK.add($.chartK);$.panChartK.add($.htmlChartNameK);$.panChartK.add($.KValue4);$.panChartK.add($.KValue3);$.panChartK.add($.KValue2);$.panChartK.add($.KValue1);$.panChartK.add($.KLine7);$.panChartK.add($.KLine6);$.panChartK.add($.KLine5);$.panChartK.add($.KLine4);$.panChartK.add($.KLine3);$.panChartK.add($.KLine2);$.panChartK.add($.KLine1);$.panChartK.add($.KLbl4);$.panChartK.add($.KLbl3);$.panChartK.add($.KLbl2);$.panChartK.add($.KLbl1);$.panTab1.add($.panList1);$.panTab2.add($.panList2);$.startAfterChain=true;relocateChildIndexInPanel([$.panTop]);initData($.args);initLayout();initAuthentication()};$.callback=function(type,ds){if(type=="Q1"){if(ds){if(ds.resultList[0]){$.htmlDailyAvgCallCnt.setHTML(ds.resultList[0][0].days_call)}if(ds.resultList[1]){var aIdx=0,gIdx=0,sIdx=0,kIdx=0,tIdx=0;for(var i=0;i<ds.resultList[1].length;i++){var clsRow=ds.resultList[1][i];var fxCall=clsRow.tar_call;var targetCall=clsRow.exc_call;var contactCnt=clsRow.contact_cnt;var rate=clsRow.a_rate;if(clsRow.grade=="L"){$.AValue1.setHTML(numberWithCommas(fxCall));$.AValue2.setHTML(numberWithCommas(targetCall));$.AValue3.setHTML(rate+"%");$.AValue4.setHTML(numberWithCommas(contactCnt));aIdx++}else{if(clsRow.grade=="T"){$.GValue1.setHTML(numberWithCommas(fxCall));$.GValue2.setHTML(numberWithCommas(targetCall));$.GValue3.setHTML(rate+"%");$.GValue4.setHTML(numberWithCommas(contactCnt));gIdx++}else{if(clsRow.grade=="A"){$.KValue1.setHTML(numberWithCommas(fxCall));$.KValue2.setHTML(numberWithCommas(targetCall));$.KValue3.setHTML(rate+"%");$.KValue4.setHTML(numberWithCommas(contactCnt));kIdx++}else{if(clsRow.grade=="U"){$.SValue1.setHTML(numberWithCommas(fxCall));$.SValue2.setHTML(numberWithCommas(targetCall));$.SValue3.setHTML(rate+"%");$.SValue4.setHTML(numberWithCommas(contactCnt));sIdx++}else{if(clsRow.grade=="TOTAL"){$.DailyAvgValue1.setHTML(numberWithCommas(fxCall));$.DailyAvgValue2.setHTML(numberWithCommas(targetCall));$.DailyAvgValue3.setHTML(rate+"%");$.DailyAvgValue4.setHTML(numberWithCommas(contactCnt));tIdx++}}}}}}if(aIdx!=0||gIdx!=0||sIdx!=0||kIdx!=0||tIdx!=0){}else{$.DailyAvgValue1.setHTML("");$.DailyAvgValue2.setHTML("");$.DailyAvgValue3.setHTML("");$.DailyAvgValue4.setHTML("")}if(aIdx==0){$.AValue1.setHTML("");$.AValue2.setHTML("");$.AValue3.setHTML("");$.AValue4.setHTML("")}if(gIdx==0){$.GValue1.setHTML("");$.GValue2.setHTML("");$.GValue3.setHTML("");$.GValue4.setHTML("")}if(sIdx==0){$.SValue1.setHTML("");$.SValue2.setHTML("");$.SValue3.setHTML("");$.SValue4.setHTML("")}if(kIdx==0){$.KValue1.setHTML("");$.KValue2.setHTML("");$.KValue3.setHTML("");$.KValue4.setHTML("")}}if(ds.resultList[2]){var totVal1=0;var totVal2=0;var totVal3=0;var aIdx=0,gIdx=0,sIdx=0,kIdx=0;for(var i=0;i<ds.resultList[2].length;i++){var clsRow=ds.resultList[2][i];var fxCall=clsRow.tar_call;var targetCall=clsRow.exc_call;var contactCnt=clsRow.contact_cnt;var rate=clsRow.a_rate;var chart=null;if(clsRow.grade=="L"){chart=$.chartA.getChart();totVal1+=fxCall;totVal2+=targetCall;totVal3+=contactCnt;doClearChart(chart);doRenderChart(chart,fxCall,targetCall,"L");aIdx++}else{if(clsRow.grade=="T"){chart=$.chartG.getChart();totVal1+=fxCall;totVal2+=targetCall;totVal3+=contactCnt;doClearChart(chart);doRenderChart(chart,fxCall,targetCall,"T");gIdx++}else{if(clsRow.grade=="A"){chart=$.chartK.getChart();totVal1+=fxCall;totVal2+=targetCall;totVal3+=contactCnt;doClearChart(chart);doRenderChart(chart,fxCall,targetCall,"A");kIdx++}else{if(clsRow.grade=="U"){chart=$.chartS.getChart();totVal1+=fxCall;totVal2+=targetCall;totVal3+=contactCnt;doClearChart(chart);doRenderChart(chart,fxCall,targetCall,"U");sIdx++}else{if(clsRow.grade=="N"){totVal1+=fxCall;totVal2+=targetCall;totVal3+=contactCnt}}}}}}if(aIdx!=0||gIdx!=0||sIdx!=0||kIdx!=0){var chart=$.chartDailyAvgCall.getChart();doClearChart(chart);doRenderChart(chart,totVal1,totVal2,"전체")}else{var chart=$.chartDailyAvgCall.getChart();doClearChart(chart)}if(aIdx==0){var chart=$.chartA.getChart();doClearChart(chart)}if(gIdx==0){var chart=$.chartG.getChart();doClearChart(chart)}if(sIdx==0){var chart=$.chartS.getChart();doClearChart(chart)}if(kIdx==0){var chart=$.chartK.getChart();doClearChart(chart)}}}if(ds.resultList[3]){setDataGrid([$.grdList1],ds.resultList[3],true);$.grdList1.openNode("2","true")}if(ds.resultList[4]){setDataGrid([$.grdList2],ds.resultList[4],true);$.grdList2.openNode("2","true")}}};$.update=function(args){if($.startAfterChain){$.startAfterChain=false}else{if(args){initData(args)}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){var tabIndex=$.tabPanel.getActiveTab();searchCallCustomer("Q1")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDeptCode"){var strQuery=" and dept_code ='"+$.cmbDeptCode.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmployeeId.clear();setComboBind([$.cmbEmployeeId],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>