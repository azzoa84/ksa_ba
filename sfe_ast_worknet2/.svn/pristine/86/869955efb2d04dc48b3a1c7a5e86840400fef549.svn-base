<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMap=null;$.btnClose=null;$.cmbEmployee=null;$.lblEmployee=null;$.popData=[];$.isClose=[];$.overlayArr=[];$.colorArr=["#ff9ff3","#feca57","#ff6b6b","#48dbfb","#1dd1a1","#5f27cd","#c8d6e5","#f3a683"];$.selectCompanyId="";$.isMark=true;$.companyType="";$.mapWidth="1200";$.mapHeight="667";$.returnDistance="";var markers=[];$.latitude=0;$.longitude=0;$.dmExpLocLatitude=0;$.dmExpLocLongitude=0;$.dmFoodLocLatitude=0;$.dmFoodLocLongitude=0;$.map_data={m1:[],m2:[]};$.varInfowindow="";function setMapDisplay(map_ix){var bounds=new daum.maps.LatLngBounds();for(var i=0;i<$.gMarkers[map_ix].length;i++){if($.gMarkers[map_ix][i]!=null){bounds.extend($.gMarkers[map_ix][i].getPosition())}}$.gMap[map_ix].setBounds(bounds);$.gMap[map_ix].relayout()}function createMap(map_ix){delete $.mapCanvas;if(!$.mapCanvas){$.mapCanvas=[]}if(!$.gMap){$.gMap=[]}for(var i=map_ix;i<=map_ix;i++){$.mapContainer[i].innerHTML="";$.mapCanvas[i]=document.createElement("div");$.mapCanvas[i].style.borderStyle="solid";$.mapCanvas[i].style.borderWidth="1px";$.mapCanvas[i].style.borderColor="#808080";$.mapCanvas[i].style.width=$.mapWidth+"px";$.mapCanvas[i].style.height=$.mapHeight+"px";$.mapCanvas[i].style.top="0px";$.mapCanvas[i].style.left="0px";$.mapCanvas[i].style.position="absolute";$.mapContainer[i].appendChild($.mapCanvas[i]);var mapOptions={center:$.varHQ_GeoPoint,autosize:true,level:3};$.gMap[i]=new daum.maps.Map($.mapCanvas[i],mapOptions);var mapTypeControl=new daum.maps.MapTypeControl();$.gMap[i].addControl(mapTypeControl,daum.maps.ControlPosition.TOPRIGHT);var zoomControl=new daum.maps.ZoomControl();$.gMap[i].addControl(zoomControl,daum.maps.ControlPosition.RIGHT)}}function defaultMap(){$.varHQ_GeoPoint=new daum.maps.LatLng(37.482359,127.017484);$.varInfowindow=new daum.maps.InfoWindow({zIndex:1});$.mapContainer=[$.panMap.id];$.map_data.m1=[];$.map_data.m2=[];for(var i=0;i<1;i++){var cObj=document.createElement("div");cObj.id=$.panMap.id+"__mapContainer"+i;cObj.style.position="absolute";document.getElementById($.mapContainer[i]).childNodes[2].appendChild(cObj);$.mapContainer[i]=cObj}$.gMarkers=new Array();$.gPaths=new Array();createMap(0)}function setDataMap(){var bounds=new daum.maps.LatLngBounds();var index=1;var duplCnt=0;var firstEmployeeId=$.popData[0].employee_id;for(var i=0;i<$.popData.length;i++){var rowData=$.popData[i];var latLng=getGeoCodeKakao(rowData.address_name);if(firstEmployeeId!=rowData.employee_id){duplCnt++}firstEmployeeId=rowData.employee_id;displayMarker(latLng,rowData,index,$.colorArr[duplCnt]);bounds.extend(new daum.maps.LatLng(latLng[0],latLng[1]));index++}$.gMap[0].setBounds(bounds);jQuery(".kakao-overay .close").each(function(index){jQuery(this).click(function(){$.overlayArr[index].setMap(null);$.isClose[index+1]=true})})}function displayMarker(place,rowData,index,color){var marker=new daum.maps.Marker({map:$.gMap[0],position:new daum.maps.LatLng(place[0],place[1])});var content="";content='<div class="kakao-overay"> <div class="wrap">    <div class="info">			  <div class="title" style="background: '+color+';">'+(rowData.employee_id&&rowData.employee_id!="RESET"?rowData.emp_name:"")+'            <div class="close">x</div>        </div>        <div class="body">            <div class="desc">                <div class="ellipsis">'+rowData.company_name+"</div>            </div>        </div>    </div></div></div>";var overlay=new daum.maps.CustomOverlay({content:content,map:$.gMap[0],position:marker.getPosition()});$.isClose.push(false);$.overlayArr.push(overlay);daum.maps.event.addListener(marker,"click",function(){if(!$.isClose[index]){overlay.setMap(null)}else{overlay.setMap($.gMap[0])}$.isClose[index]=!$.isClose[index]})}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,730);$.panMain.setText("");$.panMain.setBottomLine(false);$.panMap=new FingerPanel(host,"panMap",0,50,1200,667);$.panMap.setText("");$.panMap.setBottomLine(false);$.btnClose=new FingerButton(host,"btnClose",1135,11,80,20);$.btnClose.setText("닫기");$.cmbEmployee=new FingerComboBox(host,"cmbEmployee",980,10,140,20);$.lblEmployee=new FingerLabel(host,"lblEmployee",875,10,100,20);$.lblEmployee.setText("담당자");$.gMarkers=new Array();$.gPaths=new Array();$.cmbEmployee.setEmptyRow(true);$.cmbEmployee.setColumn("employee_id","emp_name");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMap);$.panMain.add($.btnClose);$.panMain.add($.cmbEmployee);$.panMain.add($.lblEmployee);if($.p_argument){$.popData=$.p_argument.data;$.selectCompanyId=$.p_argument.selectCompanyId;$.companyType=$.p_argument.companyType;$.cmbEmployee.setData($.p_argument.employeeList)}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnClose"){g_popupStack.close()}};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;switch(id){case"bteEmployee":var param=[];param[0]=$.varEmployeeId;param[1]=$.bteEmployee.getText();g_main.openPopup("popEmp.html","popEmp","사원 조회",710,450,"","",param,"","");break}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbEmployee"){defaultMap();var data=deepCopyObj($.p_argument.data);if(!value){$.popData=$.p_argument.data}else{$.popData=$.p_argument.data.filter(function(el){return value==el.employee_id})}setDataMap()}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtDept"&&value=="13"){if(!$.panQuery.validateControls()){return}displayMap1(0,$.txtDept.getValue())}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingertree_refresh=function(id){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>