<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panInfo=null;$.panMsg=null;$.lblId=null;$.lblCaption=null;$.txtId=null;$.txtCaption=null;$.btnSearch=null;$.grdList=null;$.lblIdInfo=null;$.lblNameInfo=null;$.txtIdInfo=null;$.txtNameInfo=null;$.grdInfo=null;$.varFormID="";$.varDeleteRows=[];function createJSON_Q(workType){var json=createExecuteParamInfo("FingerCRMTools..P_FormMessageManage_Q",[workType,$.txtId.getValue(),$.txtCaption.getValue(),$.varFormID]);return json}function createJSON_S(){var cRow=$.grdInfo.getChangedRows();var rows=[];if(cRow.length<=0&&$.varDeleteRows.length<=0){return}for(var i in $.varDeleteRows){rows.push(["D",$.txtIdInfo.getValue(),$.varDeleteRows[i].MessageID,"",($.txtIdInfo.getValue()=="BROWSER_MSG"?"BROWSER_MSG":$.txtIdInfo.getValue()=="BROWSER_CAPTION"?"BROWSER_CAPTION":$.txtIdInfo.getValue()=="FINGERBASE"?"FINGERFORM":$.txtIdInfo.getValue()=="PROJECTBASE"?"PROJECTFORM":"BIZFORM")])}for(var i in cRow){rows.push([cRow[i].rowType,$.txtIdInfo.getValue(),cRow[i].MessageID,cRow[i].AppMessage,($.txtIdInfo.getValue()=="BROWSER_MSG"?"BROWSER_MSG":$.txtIdInfo.getValue()=="BROWSER_CAPTION"?"BROWSER_CAPTION":$.txtIdInfo.getValue()=="FINGERBASE"?"FINGERFORM":$.txtIdInfo.getValue()=="PROJECTBASE"?"PROJECTFORM":"BIZFORM")])}return createExecuteParamInfo("FingerCRMTools..P_FormMessageManage_S",rows)}function searchData(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveData(){var json=createJSON_S();if(json){callExecute(["req",json],"S",$)}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,800);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,450,770);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",460,0,740,120);$.panInfo.setText("Form 정보");$.panInfo.setBottomLine(true);$.panMsg=new FingerPanel(host,"panMsg",460,130,740,640);$.panMsg.setText("메시지 정보");$.panMsg.setBottomLine(true);$.lblId=new FingerLabel(host,"lblId",0,10,100,20);$.lblId.setText("Form ID");$.lblCaption=new FingerLabel(host,"lblCaption",0,40,100,20);$.lblCaption.setText("Form 캡션");$.txtId=new FingerEdit(host,"txtId",105,10,190,20);$.txtCaption=new FingerEdit(host,"txtCaption",105,40,190,20);$.btnSearch=new FingerButton(host,"btnSearch",370,40,80,20);$.btnSearch.setText("조회");$.grdList=new FingerDataGrid(host,"grdList",0,75,450,695);$.lblIdInfo=new FingerLabel(host,"lblIdInfo",0,10,100,20);$.lblIdInfo.setText("Form ID");$.lblNameInfo=new FingerLabel(host,"lblNameInfo",0,40,100,20);$.lblNameInfo.setText("Form 캡션");$.txtIdInfo=new FingerEdit(host,"txtIdInfo",105,10,300,20);$.txtNameInfo=new FingerEdit(host,"txtNameInfo",105,40,300,20);$.grdInfo=new FingerDataGrid(host,"grdInfo",0,0,740,595);$.panQuery.setBorder(true);$.panMsg.addButtons(["btnDelete","btnSave","btnAdd"]);$.grdList.setColumns([new FingerDataGridColumn("parent_id",99,"left","string","상위ID",{hidden:true}),new FingerDataGridColumn("key_id",250,"left","string","폼ID",{template:"tree"}),new FingerDataGridColumn("name",180,"left","string","폼 명")]);$.grdList.init({panel:$.panList,view:"treetable",treeKey:{id:"key_id",parent:"parent_id"}});$.grdList.setBorder(false);$.grdInfo.setColumns([new FingerDataGridColumn("MessageID",200,"left","string","메시지ID",{readonly:true}),new FingerDataGridColumn("AppMessage",520,"left","string","메시지")]);$.grdInfo.init({panel:$.panMsg});$.grdInfo.setBorder(false);$.grdInfo.setEditable(true);$.txtIdInfo.setEnable(false);$.txtNameInfo.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panInfo);$.panMain.add($.panMsg);$.panQuery.add($.txtId);$.panQuery.add($.txtCaption);$.panQuery.add($.lblId);$.panQuery.add($.lblCaption);$.panQuery.add($.btnSearch);$.panQuery.add($.grdList);$.panInfo.add($.lblIdInfo);$.panInfo.add($.lblNameInfo);$.panInfo.add($.txtIdInfo);$.panInfo.add($.txtNameInfo);$.panMsg.add($.grdInfo);searchData("Q_T")};$.callback=function(type,ds){if(type=="Q_T"){setDataGrid([$.grdList],ds);$.varDeleteRows=[]}else{if(type=="Q_D"){setDataGrid([$.grdInfo],ds);$.varDeleteRows=[]}else{if(type=="S"){if(ds.errorCode=="MSG0001"){MessageBoxShow("정상적으로 저장되었습니다.");searchData("Q_D")}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchData("Q_T")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.varDeleteRows=[];$.varFormID=$.grdList.getValue(rId,"key_id");$.txtIdInfo.setValue($.grdList.getValue(rId,"key_id"));$.txtNameInfo.setValue($.grdList.getValue(rId,"name"));searchData("Q_D")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtId"||id=="txtCaption")&&value=="13"){searchData("Q_T")}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panMsg"){if(btnId=="btnAdd"){if($.grdInfo.getAllRows().length>0){var lastNum=Number($.grdInfo.getValue($.grdInfo.getAllRows().length-1,"MessageID").substr($.txtIdInfo.getValue().length+1,3))+1;$.grdInfo.addRow({MessageID:$.txtIdInfo.getValue()+"_"+(lastNum.toString.length==2?"0":lastNum.toString.length==1?"00":"")+lastNum,AppMessage:""})}else{$.grdInfo.addRow({MessageID:$.txtIdInfo.getValue()+"_001",AppMessage:""})}}else{if(btnId=="btnSave"){if($.txtIdInfo.getValue()==""||$.txtNameInfo.getValue()==""){MessageBoxShow("좌측 메뉴 트리에서 메시지를 등록할 메뉴를 선택하여 주십시오.");return}saveData()}else{if(btnId=="btnDelete"){confirmBoxShow("선택한 메시지를 삭제 하시겠습니까?",function(){if(g_main.msgShare){var rId=$.grdInfo.getSelectedRowIdx();$.varDeleteRows.push({rowType:"D",MessageID:$.grdInfo.getValue(rId,"MessageID")});$.grdInfo.deleteCurrentRow()}})}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>