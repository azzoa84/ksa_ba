<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblType=null;$.lblDate=null;$.lblTitle=null;$.dteFromDate=null;$.cmbType=null;$.btnSave=null;$.btnCancel=null;$.txtTitle=null;$.dteToDate=null;$.lblWave=null;$.saveType="";$.eventKey="";function createJSON_S(workType){var json=createExecuteParamInfo("P_crmCalendarManage_S",[workType,$.eventKey||"",$.txtTitle.getText(),$.cmbType.getValue(),$.dteFromDate.getValue(),$.dteToDate.getValue(),"#UserID#"]);return json}function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmCalendarManage_Q",[workType,$.eventKey,"","",""]);return json}function saveCalendar(){var json=createJSON_S($.saveType);var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0001"){var share={};g_popupStack.setData(share);g_popupStack.close()}}function searchScheduleDetail(){var json=createJSON_Q("Q2");callQuery(["req",json],"Q",$,false)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,350,230);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblType=new FingerLabel(host,"lblType",0,25,60,20);$.lblType.setText("구분");$.lblDate=new FingerLabel(host,"lblDate",0,125,60,20);$.lblDate.setText("일자");$.lblTitle=new FingerLabel(host,"lblTitle",0,75,60,20);$.lblTitle.setText("제목");$.dteFromDate=new FingerDateEdit(host,"dteFromDate",80,125,100,20);$.cmbType=new FingerComboBox(host,"cmbType",80,25,140,20);$.btnSave=new FingerButton(host,"btnSave",205,190,80,20);$.btnSave.setText("등록");$.btnCancel=new FingerButton(host,"btnCancel",270,190,80,20);$.btnCancel.setText("취소");$.txtTitle=new FingerEdit(host,"txtTitle",80,75,225,20);$.dteToDate=new FingerDateEdit(host,"dteToDate",210,125,100,20);$.lblWave=new FingerLabel(host,"lblWave",185,125,20,20);$.lblWave.setText("~");$.txtTitle.setAllowBlank(false,"제목");$.dteFromDate.setAllowBlank(false,"시작일자");$.dteToDate.setAllowBlank(false,"종료일자");$.cmbType.setAllowBlank(false,"구분");$.host=host;$.args=args};$.start=function(){$.panMain.add($.lblType);$.panMain.add($.lblDate);$.panMain.add($.lblTitle);$.panMain.add($.dteFromDate);$.panMain.add($.cmbType);$.panMain.add($.btnSave);$.panMain.add($.btnCancel);$.panMain.add($.dteToDate);$.panMain.add($.txtTitle);$.panMain.add($.lblWave);if($.p_argument&&$.p_argument!=""){$.saveType=$.p_argument.save_type;if($.saveType=="N"){$.dteFromDate.setValue($.p_argument.date);$.dteToDate.setValue($.p_argument.date);$.btnSave.setText("등록")}else{if($.saveType=="U"){$.eventKey=$.p_argument.event_key;$.btnSave.setText("저장");searchScheduleDetail()}}}var ds=commCodeData2($,"ComboBind","CRM0277");setComboBind([$.cmbType],ds);relocateChildIndexInPanel([$.panMain])};$.callback=function(type,ds){if(type=="Q"){var rs=ds.resultList[0][0];$.dteFromDate.setValue(rs.start_date);$.dteToDate.setValue(rs.end_date);$.cmbType.setValue(rs.schedule_type);$.txtTitle.setText(rs.schedule_title)}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSave"){if(!validateControls([$.txtTitle,$.dteFromDate,$.dteToDate,$.cmbType])){return}if($.dteFromDate.getValue()>$.dteToDate.getValue()){MessageBoxShow("시작일자는 종료일자보다 클 수 없습니다.");return}var deptCode=g_main.session.getValue("DeptCode");var userId=g_main.session.getValue("UserID");if(deptCode=="A110"||deptCode=="A120"||deptCode=="F510"||deptCode=="F520"||deptCode=="J110"||g_main.session.obj.SystemDeveloper=="Y"){saveCalendar()}else{MessageBoxShow("연간일정을 등록할 수 있는 권한이 없습니다.");return}}else{if(id=="btnCancel"){g_popupStack.close()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>