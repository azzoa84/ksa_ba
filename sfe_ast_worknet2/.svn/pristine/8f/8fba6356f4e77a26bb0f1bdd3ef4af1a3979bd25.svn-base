<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.bteEmpNameList=null;$.dteStartDate=null;$.panLeftTop=null;$.panTop=null;$.panList=null;$.grdList=null;$.lblDeptName=null;$.lblEmpName=null;$.lblEmpNameList=null;$.lblJobDesc=null;$.lblOvertimeType=null;$.lblPlace=null;$.lblStartDate=null;$.memPlacement=null;$.btnClear=null;$.txtDeptName=null;$.txtEmpName=null;$.txtEmpNameList1=null;$.txtEmployeeIdList=null;$.txtEmployeeIdList1=null;$.txtJobDesc=null;$.txtPlace=null;$.rdoOvertimeType=null;$.grdFile=null;$.grdDoc=null;$.lblNotice1=null;$.lblNotice2=null;$.lblNotice3=null;$.lblNotice4=null;$.lblStartTime=null;$.lblEndTime=null;$.comStartHH=null;$.comStartMM=null;$.comEndHH=null;$.comEndMM=null;$.lblColon1=null;$.lblColon2=null;$.rdoTimePeriod=null;$.lblTotalTime=null;$.txtTotalTime=null;$.lblNotice5=null;$.lblNotice6=null;$.lblNotice7=null;$.lblNotice8=null;$.lblNotice9=null;$.lblNotice10=null;$.wfType="";$.varBusinessId="";$.varWfDocId="";$.total_hour=0;$.total_min=0;function createJSON_S(workType){var stremployee_id="";var strwork_type="";var strstart_date="";var strweek="";var strstart_time="";var strend_time="";var strjob_desc="";var strplace="";for(var i=0;i<$.grdList.getRowCount();i++){var start_date=extFormat(getFormatDate($.grdList.getValue(i).start_date,"yyyyMMdd"),"yyyyMMdd");stremployee_id+=$.grdList.getValue(i).employee_id+"|";strwork_type+=$.grdList.getValue(i).work_type+"|";strstart_date+=getFormatDate($.grdList.getValue(i).start_date,"yyyyMMdd")+"|";strweek+=$.grdList.getValue(i).week+"|";strstart_time+=$.grdList.getValue(i).start_time+":00.000|";strend_time+=$.grdList.getValue(i).end_time+":00.000|";strjob_desc+=($.grdList.getValue(i).job_desc||"")+"|";strplace+=($.grdList.getValue(i).job_place||"")+"|"}if($.grdList.getRowCount()>0){stremployee_id=stremployee_id.substring(0,stremployee_id.length-1);strwork_type=strwork_type.substring(0,strwork_type.length-1);strstart_date=strstart_date.substring(0,strstart_date.length-1);strweek=strweek.substring(0,strweek.length-1);strstart_time=strstart_time.substring(0,strstart_time.length-1);strend_time=strend_time.substring(0,strend_time.length-1);strjob_desc=strjob_desc.substring(0,strjob_desc.length-1);strplace=strplace.substring(0,strplace.length-1)}var json=createExecuteParamInfo("P_crmWFOverTimeDetail_S",[workType,$.varWfDocId,$.txtTotalTime.getValue(),$.total_hour,$.total_min,stremployee_id,strwork_type,strstart_date,strweek,strstart_time,strend_time,strjob_desc,strplace]);return json}function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFOverTimeOrder"]);return json}function searchWFDocument(workType){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function saveWFOverTimeOrder(){log(111);getTimeSpan();var json=createJSON_S("N");if(json){var ds=callExecuteSync(["req",json],"S",$);if(ds){return true}}return false}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}function getWeekday(sDate){var yy=parseInt(sDate.substr(0,4),10);var mm=sDate.length==8?parseInt(sDate.substr(4,2),10):parseInt(sDate.substr(4,2),10);var dd=sDate.length==8?parseInt(sDate.substr(6),10):parseInt(sDate.substr(7),10);var d=new Date(yy,mm-1,dd);var weekday=[];weekday[0]="0";weekday[1]="1";weekday[2]="2";weekday[3]="3";weekday[4]="4";weekday[5]="5";weekday[6]="6";return weekday[d.getDay()]}function parserDate(start_hour,end_hour,calc){var parser=webix.Date.strToDate("%H:%i");var nTotalSec=(parser(end_hour)-parser(start_hour))/1000;var nHour=parseInt(nTotalSec/3600);var nMin=parseInt((nTotalSec%3600)/60);nHour=(nHour<10?"0":"")+nHour;nMin=(nMin<10?"0":"")+nMin;return[nHour,nMin,nTotalSec]}function CheckTime(){var dt1=$.comStartHH.getValue()+":"+$.comStartMM.getValue();var dt2=$.comEndHH.getValue()+":"+$.comEndMM.getValue();if((Number(dt1.toString().substring(0,2))>Number(dt2.toString().substring(0,2)))&&Number(dt2.toString().substring(0,2))!=0){MessageBoxShow("종료시각이 시작시각보다 같거나 빠를 수 없습니다.");return}else{if(Number(dt1.toString().substring(0,2))==Number(dt2.toString().substring(0,2))){if((Number(dt2.toString().substring(3))-Number(dt1.toString().substring(3)))<30){MessageBoxShow("최소 인정 시간은 30분입니다.");return}}}if($.rdoOvertimeType.getValue()!="50"){if((Number(dt1.toString().substring(0,2))==12)||(Number(dt1.toString().substring(0,2))==18)){MessageBoxShow("휴게 시간이 시작 시간이 될 수 없습니다.");return}if(((Number(dt2.toString().substring(0,2))==12)||(Number(dt2.toString().substring(0,2))==18))&&(Number(dt2.toString().substring(3))>0)){MessageBoxShow("휴게 시간이 종료 시간이 될 수 없습니다.");return}if((Number(dt2.toString().substring(0,2))==19)&&(Number(dt2.toString().substring(3))==0)){MessageBoxShow("휴게 시간이 종료 시간이 될 수 없습니다.");return}}if($.rdoOvertimeType.getValue()=="40"){if((Number(dt1.toString().substring(0,2))<19)||(Number(dt1.toString().substring(0,2))>21)){MessageBoxShow("주중 연장 근무는 19시부터 22시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))<19)||(Number(dt2.toString().substring(0,2))>22)){MessageBoxShow("주중 연장 근무는 19시부터 22시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))==22)&&(Number(dt2.toString().substring(3))>0)){MessageBoxShow("주중 연장 근무는 19시부터 22시까지만 가능합니다.");return}}else{if($.rdoOvertimeType.getValue()=="50"){if((Number(dt1.toString().substring(0,2))<7)||(Number(dt1.toString().substring(0,2))>21)){MessageBoxShow("휴일 근무는 7시부터 22시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))<7)||(Number(dt2.toString().substring(0,2))>22)){MessageBoxShow("휴일 근무는 7시부터 22시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))==22)&&(Number(dt2.toString().substring(3))>0)){MessageBoxShow("휴일 근무는 7시부터 22시까지만 가능합니다.");return}}else{if($.rdoOvertimeType.getValue()=="60"){if($.comEndHH.getValue()=="00"){dt2="24:00"}if((Number(dt1.toString().substring(0,2))<22)&&(Number(dt1.toString().substring(0,2))>5)){MessageBoxShow("야간 근무는 22시부터 익일 오전 6시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))<22)&&(Number(dt2.toString().substring(0,2))>6)){MessageBoxShow("야간 근무는 22시부터 익일 오전 6시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))==6)&&(Number(dt2.toString().substring(3))>0)){MessageBoxShow("야간 근무는 22시부터 익일 오전 6시까지만 가능합니다.");return}}else{if($.rdoOvertimeType.getValue()=="30"){if((Number(dt1.toString().substring(0,2))<9)||(Number(dt1.toString().substring(0,2))>17)){MessageBoxShow("전사 휴일 근무는 9시부터 18시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))<9)||(Number(dt2.toString().substring(0,2))>18)){MessageBoxShow("전사 휴일 근무는 9시부터 18시까지만 가능합니다.");return}if((Number(dt2.toString().substring(0,2))==18)&&(Number(dt2.toString().substring(3))>0)){MessageBoxShow("전사 휴일 근무는 9시부터 18시까지만 가능합니다.");return}}}}}if($.rdoOvertimeType.getValue()=="50"){MakeTimeList2(dt1,dt2)}else{MakeTimeList(dt1,dt2)}getTimeSpan()}function MakeTimeList(start_time,end_time){var end_yn=false;var time1="";var time2="";var new_time1="";var data="";var data1="";var data2="";var s_hour_h=start_time.substring(0,2);var s_hour_m=start_time.substring(3);var e_hour_h=end_time.substring(0,2);var e_hour_m=end_time.substring(3);if(s_hour_h==e_hour_h){if(s_hour_m==e_hour_m){return}else{time1=start_time;time2=end_time;end_yn=true}}else{if(Number(e_hour_h)<12){data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}else{if(Number(e_hour_h)==12){data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}else{if(Number(e_hour_h)>12&&Number(e_hour_h)<18){data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;if((Number(s_hour_h)+1)==12){time2="12:00";new_time1="13:00";end_yn=false}else{time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}}else{if(Number(e_hour_h)==18){data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;if((Number(s_hour_h)+1)==12){time2="12:00";new_time1="13:00";end_yn=false}else{time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}}else{if(Number(e_hour_h)>18){data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;if((Number(s_hour_h)+1)==12){time2="12:00";new_time1="13:00";end_yn=false}else{if((Number(s_hour_h)+1)==18){time2="18:00";new_time1="19:00";end_yn=false}else{time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}}}}}}}}$.grdList.addRow({work_type:$.rdoOvertimeType.getValue(),start_date:extFormat($.dteStartDate.getValue(),"yyyyMMdd"),week:getWeekday(getFormatDate($.dteStartDate.getValue(),"yyyyMMdd")),start_time:extFormat($.dteStartDate.getValue(),"yyyyMMdd")+" "+time1,end_time:extFormat($.dteStartDate.getValue(),"yyyyMMdd")+" "+time2,job_desc:$.txtJobDesc.getValue(),job_place:$.txtPlace.getValue(),employee_id:g_main.session.getValue("EmpCode"),emp_name:g_main.session.getValue("UserName")});if(end_yn){return}else{MakeTimeList(new_time1,end_time)}}function MakeTimeList2(start_time,end_time){var end_yn=false;var time1="";var time2="";var new_time1="";var data="";var data1="";var data2="";var s_hour_h=start_time.substring(0,2);var s_hour_m=start_time.substring(3);var e_hour_h=end_time.substring(0,2);var e_hour_m=end_time.substring(3);if(s_hour_h==e_hour_h){if(s_hour_m==e_hour_m){return}else{time1=start_time;time2=end_time;end_yn=true}}else{data=parserDate(start_time,end_time);if(Number(data[0])==0&&Number(data[1])==30){time1=start_time;time2=end_time;end_yn=true}else{if(Number(data[0])==1&&Number(data[1])==0){time1=start_time;time2=end_time;end_yn=true}else{time1=start_time;time2=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;new_time1=(((Number(s_hour_h)<9)?"0":"")+(Number(s_hour_h)+1))+":"+s_hour_m;end_yn=false}}}$.grdList.addRow({work_type:$.rdoOvertimeType.getValue(),start_date:extFormat($.dteStartDate.getValue(),"yyyyMMdd"),week:getWeekday(getFormatDate($.dteStartDate.getValue(),"yyyyMMdd")),start_time:extFormat($.dteStartDate.getValue(),"yyyyMMdd")+" "+time1,end_time:extFormat($.dteStartDate.getValue(),"yyyyMMdd")+" "+time2,job_desc:$.txtJobDesc.getValue(),job_place:$.txtPlace.getValue(),employee_id:g_main.session.getValue("EmpCode"),emp_name:g_main.session.getValue("UserName")});if(end_yn){return}else{MakeTimeList2(new_time1,end_time)}}function getTimeSpan(){$.total_hour=0;$.total_min=0;var total_hour2=0;var total_min2=0;var data="";for(var i=0;i<$.grdList.getRowCount();i++){data=parserDate($.grdList.getValue(i,"start_time").substring(11),$.grdList.getValue(i,"end_time").substring(11));$.total_hour+=Number(data[0]);$.total_min+=Number(data[1]);if($.grdList.getValue(i,"work_type")=="50"){total_hour2+=Number(data[0]);total_min2+=Number(data[1])}}if($.total_min>=60){$.total_hour+=($.total_min/60);$.total_min=($.total_min%60)}if(total_min2>=60){total_hour2+=(total_min2/60);total_min2=(total_min2%60)}if((total_hour2==8&&total_min2==30)||total_hour2>8){MessageBoxShow("8시간을 초과한 휴일근무는 지양하여 주시기 바랍니다.")}$.txtTotalTime.setValue($.total_hour+"시간 "+$.total_min+"분")}function CheckDate(){var chkResult=true;for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"start_date")==extFormat($.dteStartDate.getValue(),"yyyyMMdd")){chkResult=false}}return chkResult}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1370);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,610);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,700,1200,385);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,1090,440,270);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,1090,750,270);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,340);$.bteEmpNameList=new FingerButtonEdit(host,"bteEmpNameList",0,0,140,20);$.bteEmpNameList.setText("");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",110,130,140,20);$.panLeftTop=new FingerPanel(host,"panLeftTop",0,0,1200,290);$.panLeftTop.setText("");$.panLeftTop.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,290);$.panTop.setText("");$.panTop.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,295,1200,290);$.panList.setText("근무시간 및 업무내역");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,240);$.lblDeptName=new FingerLabel(host,"lblDeptName",0,40,100,20);$.lblDeptName.setText("소속");$.lblEmpName=new FingerLabel(host,"lblEmpName",0,70,100,20);$.lblEmpName.setText("성명");$.lblEmpNameList=new FingerLabel(host,"lblEmpNameList",0,0,100,20);$.lblEmpNameList.setText("참석자");$.lblJobDesc=new FingerLabel(host,"lblJobDesc",0,100,100,20);$.lblJobDesc.setText("계획상세내용");$.lblOvertimeType=new FingerLabel(host,"lblOvertimeType",0,10,100,20);$.lblOvertimeType.setText("연장근무구분");$.lblPlace=new FingerLabel(host,"lblPlace",0,190,100,20);$.lblPlace.setText("장소");$.lblStartDate=new FingerLabel(host,"lblStartDate",0,130,100,20);$.lblStartDate.setText("근무일자");$.memPlacement=new FingerMemoEdit(host,"memPlacement",0,0,140,20);$.btnClear=new FingerButton(host,"btnClear",525,10,100,20);$.btnClear.setText("초기화");$.txtDeptName=new FingerEdit(host,"txtDeptName",110,40,140,20);$.txtEmpName=new FingerEdit(host,"txtEmpName",110,70,140,20);$.txtEmpNameList1=new FingerEdit(host,"txtEmpNameList1",0,0,140,20);$.txtEmployeeIdList=new FingerEdit(host,"txtEmployeeIdList",0,0,140,20);$.txtEmployeeIdList1=new FingerEdit(host,"txtEmployeeIdList1",0,0,140,20);$.txtJobDesc=new FingerEdit(host,"txtJobDesc",110,100,500,20);$.txtPlace=new FingerEdit(host,"txtPlace",110,190,500,20);$.rdoOvertimeType=new FingerRadioBox(host,"rdoOvertimeType",110,10,300,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,225);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,225);$.lblNotice1=new FingerLabel(host,"lblNotice1",615,5,200,20);$.lblNotice1.setText("근로기준법 제 53조 1항에 의거");$.lblNotice2=new FingerLabel(host,"lblNotice2",625,145,510,20);$.lblNotice2.setText("주 40시간을 초과한 연장(휴일)근로에 대해서는 1주에 12시간을 한도로 운용할 수 있습니다.");$.lblNotice3=new FingerLabel(host,"lblNotice3",675,230,330,20);$.lblNotice3.setText("야간 근로는 부득이한 사유 외에는 지양해주시기 바랍니다.         ");$.lblNotice4=new FingerLabel(host,"lblNotice4",635,60,270,20);$.lblNotice4.setText("※ 계획서는 시간단위로 작성해주시기 바랍니다.");$.lblStartTime=new FingerLabel(host,"lblStartTime",0,160,100,20);$.lblStartTime.setText("업무시작시간");$.lblEndTime=new FingerLabel(host,"lblEndTime",260,160,100,20);$.lblEndTime.setText("업무종료시간");$.comStartHH=new FingerComboBox(host,"comStartHH",110,160,60,20);$.comStartMM=new FingerComboBox(host,"comStartMM",180,160,60,20);$.comEndHH=new FingerComboBox(host,"comEndHH",360,160,60,20);$.comEndMM=new FingerComboBox(host,"comEndMM",430,160,60,20);$.lblColon1=new FingerLabel(host,"lblColon1",160,160,20,20);$.lblColon1.setText(":");$.lblColon2=new FingerLabel(host,"lblColon2",405,160,20,20);$.lblColon2.setText(":");$.rdoTimePeriod=new FingerRadioBox(host,"rdoTimePeriod",515,160,140,20);$.lblTotalTime=new FingerLabel(host,"lblTotalTime",335,55,130,20);$.lblTotalTime.setText("총 연장근무 계획시간");$.txtTotalTime=new FingerEdit(host,"txtTotalTime",470,55,140,20);$.lblNotice5=new FingerLabel(host,"lblNotice5",625,120,300,20);$.lblNotice5.setText("※ 주중연장: 평일 연장근무 (19:00 ~ 22:00) 시 선택");$.lblNotice6=new FingerLabel(host,"lblNotice6",625,150,460,20);$.lblNotice6.setText("※ 휴일:  휴일 근무 시 선택, 8 시간을 초과한 휴일근무는 지양하여 주시기 바랍니다.");$.lblNotice7=new FingerLabel(host,"lblNotice7",625,180,310,20);$.lblNotice7.setText("※ 야간: 평일 및 휴일 야간근무(22:00~06:00) 시 선택");$.lblNotice8=new FingerLabel(host,"lblNotice8",655,205,470,20);$.lblNotice8.setText("주중연장근무와 시간이 연속되더라도 별도 분리하여 추가 기안해주시기 바랍니다. ");$.lblNotice9=new FingerLabel(host,"lblNotice9",625,260,435,20);$.lblNotice9.setText("※ 전사휴일: 전사휴일 근무 시 선택(전사휴일은 의무사항이 아닌, 선택사항임)");$.lblNotice10=new FingerLabel(host,"lblNotice10",620,90,570,20);$.lblNotice10.setText("※ Agenda 를 첨부할 경우, lunch time과 dinner time은 업무계획 시간에서 제외해주시기 바랍니다.");$.panList.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.panTitle.setBorder(true);$.panLeftTop.setBorder(true);$.bteEmpNameList.setVisible(false);$.lblEmpNameList.setVisible(false);$.memPlacement.setVisible(false);$.txtEmpNameList1.setVisible(false);$.txtEmployeeIdList.setVisible(false);$.txtEmployeeIdList1.setVisible(false);$.rdoTimePeriod.setVisible(false);$.bteEmpNameList.setReadOnly(true);$.txtDeptName.setReadOnly(true);$.txtEmpName.setReadOnly(true);$.txtTotalTime.setReadOnly(true);$.rdoOvertimeType.addButtons([{sub_code:"40",code_name:"주중연장"},{sub_code:"50",code_name:"휴일"},{sub_code:"60",code_name:"야간"},{sub_code:"30",code_name:"전사휴일"}]);$.rdoTimePeriod.addButtons([{sub_code:"10",code_name:"30분"},{sub_code:"20",code_name:"1시간"}]);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.grdList.setColumns([new FingerDataGridColumn("work_type",100,"center","string","구분",{readonly:true}),new FingerDataGridColumn("start_date",120,"center","date","근무일자",{format:"ymd",readonly:true}),new FingerDataGridColumn("week",100,"center","string","요일",{readonly:true}),new FingerDataGridColumn("start_time",110,"center","date","시작시간",{format:"hm",suggest:{type:"calendar",body:{type:"time",weekNumber:false}},readonly:true}),new FingerDataGridColumn("end_time",110,"center","date","종료시간",{format:"hm",suggest:{type:"calendar",body:{type:"time",weekNumber:false}},readonly:true}),new FingerDataGridColumn("job_desc",400,"left","string","계획상세내용"),new FingerDataGridColumn("job_place",230,"left","string","장소"),new FingerDataGridColumn("employee_id",130,"left","string","사원코드",{hidden:true}),new FingerDataGridColumn("emp_name",130,"left","string","성명",{hidden:true})]);$.grdList.init({panel:$.panList});$.grdList.setEditable(true);$.grdList.setBorder(false);$.dteStartDate.setAllowBlank(false,"일자 시작일");$.txtJobDesc.setAllowBlank(false,"업무명");$.txtPlace.setAllowBlank(false,"장소");$.txtTitle.setAllowBlank(false,"문서제목");$.comStartHH.setAllowBlank(false,"시작시각");$.comStartMM.setAllowBlank(false,"시작시각");$.comEndHH.setAllowBlank(false,"종료시각");$.comEndMM.setAllowBlank(false,"종료시각");$.panWFMain.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.panTop);$.panWFMain.add($.panList);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.panLeftTop.add($.bteEmpNameList);$.panLeftTop.add($.dteStartDate);$.panLeftTop.add($.txtPlace);$.panLeftTop.add($.txtJobDesc);$.panLeftTop.add($.txtEmployeeIdList1);$.panLeftTop.add($.txtEmployeeIdList);$.panLeftTop.add($.txtEmpNameList1);$.panLeftTop.add($.txtEmpName);$.panLeftTop.add($.txtDeptName);$.panLeftTop.add($.btnClear);$.panLeftTop.add($.memPlacement);$.panLeftTop.add($.lblStartDate);$.panLeftTop.add($.lblPlace);$.panLeftTop.add($.lblOvertimeType);$.panLeftTop.add($.lblJobDesc);$.panLeftTop.add($.lblEmpNameList);$.panLeftTop.add($.lblEmpName);$.panLeftTop.add($.lblDeptName);$.panLeftTop.add($.rdoOvertimeType);$.panLeftTop.add($.lblNotice1);$.panLeftTop.add($.lblNotice3);$.panLeftTop.add($.lblNotice4);$.panLeftTop.add($.lblStartTime);$.panLeftTop.add($.lblEndTime);$.panLeftTop.add($.comStartHH);$.panLeftTop.add($.comStartMM);$.panLeftTop.add($.comEndHH);$.panLeftTop.add($.lblColon1);$.panLeftTop.add($.lblColon2);$.panLeftTop.add($.comEndMM);$.panLeftTop.add($.rdoTimePeriod);$.panLeftTop.add($.lblTotalTime);$.panLeftTop.add($.txtTotalTime);$.panLeftTop.add($.lblNotice5);$.panLeftTop.add($.lblNotice6);$.panLeftTop.add($.lblNotice7);$.panLeftTop.add($.lblNotice8);$.panLeftTop.add($.lblNotice9);$.panLeftTop.add($.lblNotice10);$.panTop.add($.panLeftTop);$.panList.add($.grdList);$.txtDeptName.setDefaultValue(g_main.session.getValue("DeptName"));$.txtEmpName.setDefaultValue(g_main.session.getValue("UserName"));$.panTop.clear();$.panLeftTop.clear();relocateChildIndexInPanel([$.panLeftTop]);$.rdoOvertimeType.setValue("40");var ds=bizComponentData2($,"Q1","L_COM017||L_COM017|");setComboBind([$.comStartHH,$.comEndHH],ds);var ds3=bizComponentData2($,"Q4","L_COM018"," and sub_code in ('00', '30')");setComboBind([$.comStartMM],ds3);setComboBind([$.comEndMM],ds3);var ds2=bizComponentData2($,"Q1","L_COM016|L_CRM0061");$.grdList.setColumnDropDownList("week",ds2.resultList[0],{key:"sub_code",name:"code_name"});$.grdList.setColumnDropDownList("work_type",ds2.resultList[1],{key:"sub_code",name:"code_name"});searchWFDocument()};$.callback=function(type,ds){if(type=="Q3"){$.varBusinessId=ds.resultList[0][0].business_id;$.wfType=ds.resultList[0][0].wf_type;$.txtTitle.setValue(ds.resultList[0][0].business_title)}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);setDataGrid([$.grdList],args[6],true)}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!$.varWfDocId){saveWFDocument("","N")}if(saveWFOverTimeOrder()){var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFOverTimeOrder",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{removeWFDocument($.varWfDocId)}}else{if(id=="btnTmpSave"){if(saveWFDocument("","N")){if(saveWFOverTimeOrder()){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}}}else{if(id=="btnClear"){$.panLeftTop.clear();$.rdoOvertimeType.setValue("40")}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="start_date"){if(nValue==""){$.grdList.setValue($.grdList.getSelectedRowIdx(),"week","");return}var day=getWeekday(getFormatDate(nValue,"yyyyMMdd").substr(0,8));$.grdList.setValue($.grdList.getSelectedRowIdx(),"week",day)}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panList"){if(btnId=="btnAdd"){if(!validateControls([$.txtJobDesc,$.dteStartDate,$.txtPlace,$.comStartHH,$.comStartMM,$.comEndHH,$.comEndMM])){MessageBoxShow("연장근무 정보를 올바르게 입력하시기 바랍니다.");return}if($.rdoOvertimeType.getValue()=="60"){for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"work_type")=="30"||$.grdList.getValue(i,"work_type")=="40"||$.grdList.getValue(i,"work_type")=="50"){MessageBoxShow("야간근무는 주중연장근무와 별도 분리하여 기안해주시기 바랍니다.");return}}}else{for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"work_type")=="60"){MessageBoxShow("야간근무는 주중연장근무와 별도 분리하여 기안해주시기 바랍니다.");return}}}if(CheckDate()){CheckTime()}else{MessageBoxShow("동일 일자 초과 근무 내역이 존재합니다");return}}else{if(btnId=="btnDelete"){$.grdList.deleteCurrentRow()}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWfDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){if(saveWFOverTimeOrder()){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){if(id=="rdoOvertimeType"){if($.rdoOvertimeType.getValue()=="60"){MessageBoxShow("야간근무는 주중연장근무와 별도 분리하여 기안해주시기 바랍니다.")}}};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>