<script>function Main(){var $=this;$.host=null;$.panMain=null;$.tabMain=null;$.panTab1=null;$.panTab2=null;$.panQuery2=null;$.lblYear2=null;$.cmbBudgetHalf2=null;$.lblDept2=null;$.cmbDept2=null;$.lblEmp2=null;$.cmbEmp2=null;$.lblProduct2=null;$.cmbProduct2=null;$.btnSearch2=null;$.panChart2=null;$.panList2=null;$.grdList2=null;$.panQuery1=null;$.panChart1=null;$.panList1=null;$.grdList1=null;$.lblYear1=null;$.cmbBudgetHalf1=null;$.lblDept1=null;$.cmbDept1=null;$.lblEmp1=null;$.cmbEmp1=null;$.lblProduct1=null;$.cmbProduct1=null;$.btnSearch1=null;$.htmlChart1=null;$.htmlChart2=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmAM_result3_Q",[workType,$.cmbBudgetHalf2.getValue(),$.cmbDept2.getValue(),$.cmbEmp2.getValue(),$.cmbProduct2.getValue()]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmAM_result2_Q",[workType,$.cmbBudgetHalf1.getValue(),$.cmbDept1.getValue(),$.cmbEmp1.getValue(),$.cmbProduct1.getValue()]);return json}function searchList(workType){if(!validateControls([$.cmbBudgetHalf1,$.cmbDept1,$.cmbEmp1,$.cmbProduct1])){return}var json=createJSON_Q2(workType);callQuery(["req",json],"Q_Chart1",$)}function searchList2(workType){if(!validateControls([$.cmbBudgetHalf2,$.cmbDept2,$.cmbProduct2])){return}var json=createJSON_Q(workType);callQuery(["req",json],"Q_Chart2",$)}function initChart(){jQuery(function(){$.htmlChart1.init({chart:{width:1200,height:380},title:{text:"",x:-20},tooltip:{formatter:function(){return"The value for <b>"+this.x+"</b> is <b>"+this.y.toFixed(2)+"</b>"}},xAxis:{categories:[]},yAxis:{min:0,title:{text:""}},legend:{layout:"vertical",align:"right",verticalAlign:"top",borderWidth:0},series:[{type:"column",name:"Sales",data:[]},{type:"column",name:"Activity",data:[]},{type:"column",name:"Potency",data:[]},{type:"column",name:"Budget",data:[]}],})});jQuery(function(){$.htmlChart2.init({chart:{width:1200,height:380},title:{text:"",x:-20},tooltip:{formatter:function(){return"The value for <b>"+this.x+"</b> is <b>"+this.y.toFixed(2)+"</b>"}},xAxis:{categories:[]},yAxis:{min:0,title:{text:""}},legend:{layout:"vertical",align:"right",verticalAlign:"top",borderWidth:0},series:[{type:"column",name:"Dr",data:[]},{type:"column",name:"Activity",data:[]},{type:"column",name:"Sales",data:[]},{type:"column",name:"Potency",data:[]},{type:"column",name:"Share",data:[]}],})})}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,785);$.panMain.setText("");$.panMain.setBottomLine(true);$.tabMain=new FingerTab(host,"tabMain",0,0,1200,775);$.panTab1=new FingerPanel(host,"panTab1",0,0,1200,750);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,1200,750);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.panQuery2=new FingerPanel(host,"panQuery2",0,0,1200,55);$.panQuery2.setText("");$.panQuery2.setBottomLine();$.lblYear2=new FingerLabel(host,"lblYear2",0,15,100,20);$.lblYear2.setText("년도/반기");$.cmbBudgetHalf2=new FingerComboBox(host,"cmbBudgetHalf2",105,15,140,20);$.lblDept2=new FingerLabel(host,"lblDept2",225,15,100,20);$.lblDept2.setText("부서");$.cmbDept2=new FingerComboBox(host,"cmbDept2",330,15,140,20);$.lblEmp2=new FingerLabel(host,"lblEmp2",450,15,100,20);$.lblEmp2.setText("이름");$.cmbEmp2=new FingerComboBox(host,"cmbEmp2",555,15,140,20);$.lblProduct2=new FingerLabel(host,"lblProduct2",675,15,100,20);$.lblProduct2.setText("품목");$.cmbProduct2=new FingerComboBox(host,"cmbProduct2",780,15,140,20);$.btnSearch2=new FingerButton(host,"btnSearch2",1120,15,80,20);$.btnSearch2.setText("조회");$.panChart2=new FingerPanel(host,"panChart2",0,65,1200,430);$.panChart2.setText("AM 결과 현황 - Graph");$.panChart2.setBottomLine(true);$.panList2=new FingerPanel(host,"panList2",0,505,1200,235);$.panList2.setText("AM 결과 현황 - 도표");$.panList2.setBottomLine(true);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,190);$.panQuery1=new FingerPanel(host,"panQuery1",0,0,1200,55);$.panQuery1.setText("");$.panQuery1.setBottomLine();$.panChart1=new FingerPanel(host,"panChart1",0,65,1200,430);$.panChart1.setText("AM 결과 현황 - Graph");$.panChart1.setBottomLine(true);$.panList1=new FingerPanel(host,"panList1",0,505,1195,235);$.panList1.setText("AM 결과 현황 - 도표");$.panList1.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,1195,190);$.lblYear1=new FingerLabel(host,"lblYear1",0,15,100,20);$.lblYear1.setText("년도/반기");$.cmbBudgetHalf1=new FingerComboBox(host,"cmbBudgetHalf1",105,15,140,20);$.lblDept1=new FingerLabel(host,"lblDept1",225,15,100,20);$.lblDept1.setText("부서");$.cmbDept1=new FingerComboBox(host,"cmbDept1",330,15,140,20);$.lblEmp1=new FingerLabel(host,"lblEmp1",450,15,100,20);$.lblEmp1.setText("이름");$.cmbEmp1=new FingerComboBox(host,"cmbEmp1",555,15,140,20);$.lblProduct1=new FingerLabel(host,"lblProduct1",675,15,100,20);$.lblProduct1.setText("품목");$.cmbProduct1=new FingerComboBox(host,"cmbProduct1",780,15,140,20);$.btnSearch1=new FingerButton(host,"btnSearch1",1120,15,80,20);$.btnSearch1.setText("조회");$.htmlChart1=new FingerBarChart(host,"htmlChart1",0,0,1200,380);$.htmlChart2=new FingerBarChart(host,"htmlChart2",0,0,100,20);$.tabMain.addTab([{text:"AM결과확인(MR)",body:$.panTab1,width:150},{text:"AM결과확인(DR등급)",body:$.panTab2,width:150}]);$.panQuery1.setBorder(true);$.panQuery2.setBorder(true);$.cmbDept1.setEmptyRow(true);$.cmbEmp1.setEmptyRow(true);$.cmbProduct1.setEmptyRow(true);$.cmbDept2.setEmptyRow(true);$.cmbEmp2.setEmptyRow(true);$.cmbProduct2.setEmptyRow(true);$.cmbBudgetHalf1.setAllowBlank(false,"년도/반기");$.cmbDept1.setAllowBlank(false,"부서");$.cmbEmp1.setAllowBlank(false,"이름");$.cmbProduct1.setAllowBlank(false,"품목");$.cmbBudgetHalf2.setAllowBlank(false,"년도/반기");$.cmbDept2.setAllowBlank(false,"부서");$.cmbProduct2.setAllowBlank(false,"품목");$.grdList1.colIdx=$.grdList1.setColumns([new FingerDataGridColumn("Dept_name",180,"left","string","부서",{hidden:true}),new FingerDataGridColumn("Emp_name",180,"left","string","담당"),new FingerDataGridColumn("Area",280,"left","string","거래처 및 시도구"),new FingerDataGridColumn("Sales",180,"right","string","Sales",{format:"percent_s"}),new FingerDataGridColumn("Sales_value",180,"left","string","Sales_value",{hidden:true}),new FingerDataGridColumn("Activity",180,"right","string","Activity",{format:"percent_s"}),new FingerDataGridColumn("Activity_value",180,"left","string","Activity_value",{hidden:true}),new FingerDataGridColumn("Potency",180,"right","string","Potency",{format:"percent_s"}),new FingerDataGridColumn("Potency_value",180,"left","string","Potency_value",{hidden:true}),new FingerDataGridColumn("Budget",180,"right","string","Budget",{format:"percent_s"}),new FingerDataGridColumn("Budget_value",180,"left","string","Budget_value",{hidden:true})]);$.grdList1.init({panel:$.panList1});$.grdList1.setEditable(false);$.grdList2.colIdx=$.grdList2.setColumns([new FingerDataGridColumn("grade",180,"left","string","등급"),new FingerDataGridColumn("dr",200,"right","string","DR.비율",{format:"percent_s"}),new FingerDataGridColumn("dr_value",100,"left","string","DR.수",{hidden:true}),new FingerDataGridColumn("activity",200,"right","string","Activity",{format:"percent_s"}),new FingerDataGridColumn("activity_value",100,"left","string","Activity값",{hidden:true}),new FingerDataGridColumn("sales",200,"right","string","Sales",{format:"percent_s"}),new FingerDataGridColumn("sales_value",100,"left","string","Sales값",{hidden:true}),new FingerDataGridColumn("potency",200,"right","string","Potency",{format:"percent_s"}),new FingerDataGridColumn("potency_value",100,"left","string","Potency값",{hidden:true}),new FingerDataGridColumn("share",200,"right","string","Share",{format:"percent_s"}),new FingerDataGridColumn("share_value",100,"left","string","Share값",{hidden:true})]);$.grdList2.init({panel:$.panList2});$.grdList2.setEditable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.tabMain);$.panTab1.add($.panList1);$.panTab1.add($.panChart1);$.panTab1.add($.panQuery1);$.panTab2.add($.panQuery2);$.panTab2.add($.panChart2);$.panTab2.add($.panList2);$.panQuery2.add($.btnSearch2);$.panQuery2.add($.cmbProduct2);$.panQuery2.add($.lblProduct2);$.panQuery2.add($.cmbEmp2);$.panQuery2.add($.lblEmp2);$.panQuery2.add($.cmbDept2);$.panQuery2.add($.lblDept2);$.panQuery2.add($.cmbBudgetHalf2);$.panQuery2.add($.lblYear2);$.panChart2.add($.htmlChart2);$.panList2.add($.grdList2);$.panQuery1.add($.lblYear1);$.panQuery1.add($.cmbBudgetHalf1);$.panQuery1.add($.lblDept1);$.panQuery1.add($.cmbDept1);$.panQuery1.add($.lblEmp1);$.panQuery1.add($.cmbEmp1);$.panQuery1.add($.lblProduct1);$.panQuery1.add($.cmbProduct1);$.panQuery1.add($.btnSearch1);$.panChart1.add($.htmlChart1);$.panList1.add($.grdList1);var ds=bizComponentData2($,"Q1","L_CRM195|L_CRM195|L_CRM0059|L_CRM0059");$.cmbDept1.setColumn("dept_code","dept_name");$.cmbProduct1.setColumn("product_code","product_name");$.cmbDept2.setColumn("dept_code","dept_name");$.cmbProduct2.setColumn("product_code","product_name");setComboBind([$.cmbDept1,$.cmbDept2,$.cmbProduct1,$.cmbProduct2],ds);var ds2=bizComponentData2($,"Q2","S_9999_1|S_9999_1");setComboBind([$.cmbBudgetHalf1,$.cmbBudgetHalf2],ds2);$.cmbBudgetHalf1.setValue(ds2.resultList[0][0].sub_code);$.cmbBudgetHalf2.setValue(ds2.resultList[0][0].sub_code);$.cmbDept1.setValue(g_main.session.getValue("DeptCode"));$.cmbDept2.setValue(g_main.session.getValue("DeptCode"));$.cmbEmp1.setValue(g_main.session.getValue("UserID"));$.cmbEmp2.setValue(g_main.session.getValue("UserID"));if(g_main.session.getValue("SystemDeveloper")=="Y"||g_main.session.getValue("DeptCode")=="F110"||g_main.session.getValue("DeptCode").substring(0,2)=="F2"||g_main.session.getValue("DeptCode").substring(0,2)=="T2"||g_main.session.getValue("DeptCode").substring(2,2)=="90"){$.cmbDept1.setReadOnly(false);$.cmbDept2.setReadOnly(false)}else{$.cmbDept1.setReadOnly(true);$.cmbDept2.setReadOnly(true)}initChart()};$.callback=function(type,ds){if(type=="Q_Chart1"){setDataGrid([$.grdList1],ds);var chart1=$.htmlChart1.getChart();var categories=[];var target1=[];var target2=[];var target3=[];var target4=[];for(var i in ds.resultList[0]){categories.push(ds.resultList[0][i].Area);target1.push(Number(ds.resultList[0][i].Sales.toFixed(2)));target2.push(Number(ds.resultList[0][i].Activity.toFixed(2)));target3.push(Number(ds.resultList[0][i].Potency.toFixed(2)));target4.push(Number(ds.resultList[0][i].Budget.toFixed(2)))}chart1.xAxis[0].setCategories(categories);chart1.series[0].setData(target1);chart1.series[1].setData(target2);chart1.series[2].setData(target3);chart1.series[3].setData(target4)}else{if(type=="Q_Chart2"){setDataGrid([$.grdList2],ds);var chart2=$.htmlChart2.getChart();var categories=[];var target1=[];var target2=[];var target3=[];var target4=[];var target5=[];for(var i in ds.resultList[0]){categories.push(ds.resultList[0][i].grade);target1.push(Number(ds.resultList[0][i].dr.toFixed(2)));target2.push(Number(ds.resultList[0][i].activity.toFixed(2)));target3.push(Number(ds.resultList[0][i].sales.toFixed(2)));target4.push(Number(ds.resultList[0][i].potency.toFixed(2)));target5.push(Number(ds.resultList[0][i].share.toFixed(2)))}chart2.xAxis[0].setCategories(categories);chart2.series[0].setData(target1);chart2.series[1].setData(target2);chart2.series[2].setData(target3);chart2.series[3].setData(target4);chart2.series[4].setData(target5)}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch2"){searchList2("Q")}else{if(id=="btnSearch1"){searchList("Q")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDept2"){$.cmbEmp2.clear();var strQuery=" and dept_code = '"+$.cmbDept2.getValue()+"' and delete_yn <> 'Y'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery);$.cmbEmp2.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp2],ds)}else{if(id=="cmbDept1"){$.cmbEmp1.clear();var strQuery=" and dept_code = '"+$.cmbDept1.getValue()+"' and delete_yn <> 'Y'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery);$.cmbEmp1.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp1],ds)}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>