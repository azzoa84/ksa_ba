<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panInfo=null;$.panFile=null;$.grdFile=null;$.panAbroadSpeaker=null;$.panProcState=null;$.panFile2=null;$.grdFile2=null;$.grdAbroadSpeaker=null;$.lbl_cp_id=null;$.txt_cp_id=null;$.lbl_total_amt=null;$.spe_total_amt=null;$.lbl_Txt1=null;$.lbl_report_date=null;$.dte_report_date=null;$.cmb_Status=null;$.lbl_cp_emp_id=null;$.cmb_cp_emp_id=null;$.lbl_date=null;$.dte_start_date=null;$.lblTxt2=null;$.dte_end_date=null;$.lbl_place=null;$.txt_place=null;$.lbl_SeminarYN=null;$.rbo_SeminarYN=null;$.dte_seminar_start_date=null;$.lbl_Txt3=null;$.dte_seminar_end_date=null;$.lbl_seminar_place=null;$.txt_seminar_place=null;$.lbl_SeminarType=null;$.cmb_SeminarType=null;$.lbl_Seminar=null;$.txt_proc_status=null;$.txt_cp_doc_no=null;$.btnConfirm=null;$.btnCancel=null;$.mem_cp_descr=null;$.btnMemoSave=null;$.btnPrevious=null;$.btnNext=null;$.btnProcess1=null;$.btnProcess2=null;$.btnProcess3=null;$.btnProcess4=null;$.btnProcess5=null;$.panBottom=null;$.lblRight1=null;$.lblRight2=null;$.lblRight3=null;$.lblRight4=null;$.bConfirm=false;$.bSave=false;$.workType="";$.isMemo=false;function createJson_S(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txt_cp_id.getValue()||"",Number($.txt_proc_status.getValue())||"","#UserID#"]);return json}function createJson_S1(workType){var strcontact_id="";var strcompany_id="";var strattend_yn="";var stract_date="";var stract_time="";var stract_type="";var strlect_amt="";var stradvice_amt="";var strcp_food_yn="";var strcp_trans_yn="";var strcp_stay_yn="";var strdescr="";var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if(workType=="N"||workType=="U"){if($.grdAbroadSpeaker.getRowCount()<1){MessageBoxShow("고객이 등록되지 않았습니다.");return false}if($.grdAbroadSpeaker.getRowCount()>0){for(var i=0;i<$.grdAbroadSpeaker.getRowCount();i++){if(i>0){strcontact_id+="|";strcompany_id+="|";strattend_yn+="|";stract_date+="|";stract_time+="|";stract_type+="|";strlect_amt+="|";stradvice_amt+="|";strcp_food_yn+="|";strcp_trans_yn+="|";strcp_stay_yn+="|";strdescr+="|"}strcontact_id+=$.grdAbroadSpeaker.getValue(i,"contact_id");strcompany_id+=$.grdAbroadSpeaker.getValue(i,"company_id");strattend_yn+=$.grdAbroadSpeaker.getValue(i,"attend_yn")||"N";stract_date+=$.grdAbroadSpeaker.getValue(i,"act_date")||"";stract_time+=$.grdAbroadSpeaker.getValue(i,"act_time")||"";stract_type+=$.grdAbroadSpeaker.getValue(i,"act_type")||"";strlect_amt+=$.grdAbroadSpeaker.getValue(i,"lect_amt")||0;stradvice_amt+=$.grdAbroadSpeaker.getValue(i,"advice_amt")||0;strcp_food_yn+=$.grdAbroadSpeaker.getValue(i,"cp_food_yn")||"N";strcp_trans_yn+=$.grdAbroadSpeaker.getValue(i,"cp_trans_yn")||"N";strcp_stay_yn+=$.grdAbroadSpeaker.getValue(i,"cp_stay_yn")||"N";strdescr+=$.grdAbroadSpeaker.getValue(i,"descr")||""}}if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strfile_type+="|";strseq+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strfile_type+=$.grdFile.getValue(i,"file_type");strseq+=$.grdFile.getValue(i,"seq");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}if(strlocal_fname!=""){strfileYn="Y"}}if($.grdFile2.getRowCount()>0){for(var i=0;i<$.grdFile2.getRowCount();i++){strfile_type+="|";strseq+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|";strfile_type+=$.grdFile2.getValue(i,"file_type2");strseq+=$.grdFile2.getValue(i,"seq2");strserver_path+=$.grdFile2.getValue(i,"server_path2");strserver_fname+=$.grdFile2.getValue(i,"server_fname2");strlocal_fname+=$.grdFile2.getValue(i,"local_fname2")}if(strlocal_fname!=""){strfileYn="Y"}}}var json=createExecuteParamInfo("P_crmCPAbroadSpeaker_S",[workType,$.txt_cp_id.getValue()||"",$.txt_cp_doc_no.getValue()||"","#UserID#","#DeptCode#",$.dte_start_date.getValue()||"",$.dte_end_date.getValue()||"",$.txt_place.getValue()||"",$.rbo_SeminarYN.getValue(),$.dte_seminar_start_date.getValue()||"",$.dte_seminar_end_date.getValue()||"",$.txt_seminar_place.getValue()||"",$.cmb_SeminarType.getValue()||"",parseInt($.spe_total_amt.getValue()),"CP34",strcontact_id,strcompany_id,strattend_yn,stract_date||"",stract_time||"",stract_type||"",strlect_amt,stradvice_amt,strcp_food_yn,strcp_trans_yn,strcp_stay_yn,strdescr||"",strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname]);return json}function saveCPExtraFunction(workType){var json=createJson_S(workType);callExecute(["req",json],workType,$)}function saveCPAbroadSpeaker(workType){$.workType=workType;if(workType!="D"){if(!validateControls([$.dte_start_date,$.dte_end_date,$.txt_place,$.rbo_SeminarYN])){return}}var json=createJson_S1(workType);if(!json){return}callExecute(["req",json],workType,$)}function newClick(){$.panInfo.clear();$.grdAbroadSpeaker.clear();$.grdFile.clear();$.mem_cp_descr.setValue("");$.mem_cp_descr.setReadOnly(true);$.panInfo.enableButton(["btnDelete","btnSave"]);$.panAbroadSpeaker.enableButton(["btnDelete","btnAdd"]);$.panFile.enableButton(["btnDelete","btnAdd"]);$.panFile2.enableButton(["btnDelete","btnAdd"]);$.panBottom.setVisible(false);fnEnableSet(true);$.btnProcess1.setEnable(false);$.btnProcess2.setEnable(false);$.btnProcess3.setEnable(false);$.btnProcess4.setEnable(false);$.btnProcess5.setEnable(false);$.btnPrevious.setVisible(false);$.cmb_cp_emp_id.setValue(g_main.session.obj.EmpCode);$.dte_report_date.setValue(getToday(""))}function saveClick(){var file_check1="N";for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="014"){file_check1="Y"}}if(file_check1=="N"){MessageBoxShow("Agenda는 필수 첨부파일입니다.");return}getTotalAmt();saveCPAbroadSpeaker($.txt_cp_id.getValue()==""?"N":"U")}function deleteClick(){if($.txt_cp_id.getValue()==""){return}confirmBoxShow("삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCPAbroadSpeaker("D")}})}function setProcStatus(){$.btnProcess1.setEnable(false);$.btnProcess2.setEnable(false);$.btnProcess3.setEnable(false);$.btnProcess4.setEnable(false);$.btnProcess5.setEnable(false);if(Number($.txt_proc_status.getValue())==10){$.btnProcess1.setEnable(true)}else{if(Number($.txt_proc_status.getValue())==30){$.btnProcess2.setEnable(true)}else{if(Number($.txt_proc_status.getValue())==50){$.btnProcess3.setEnable(true)}else{if(Number($.txt_proc_status.getValue())==70){$.btnProcess4.setEnable(true)}else{if(Number($.txt_proc_status.getValue())==90){$.btnProcess5.setEnable(true)}}}}}}function fnEnableSet(bo){if(bo){$.panInfo.enableButton(["btnSave"]);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panAbroadSpeaker.enableButton(["btnAdd","btnDelete"])}else{$.panInfo.disableButton(["btnSave"]);$.panFile.disableButton(["btnAdd","btnDelete"]);$.panAbroadSpeaker.enableButton(["btnAdd","btnDelete"])}$.grdAbroadSpeaker.setEditable(bo);$.grdFile.setEditable(bo);$.dte_start_date.setReadOnly(!bo);$.dte_end_date.setReadOnly(!bo);$.dte_seminar_start_date.setReadOnly(!bo);$.dte_seminar_end_date.setReadOnly(!bo);$.txt_place.setReadOnly(!bo);$.txt_seminar_place.setReadOnly(!bo);$.rbo_SeminarYN.setEnable(bo);$.cmb_SeminarType.setEnable(bo)}function getTotalAmt(){$.spe_total_amt.setValue(0);var total_amt=0;for(var i=0;i<$.grdAbroadSpeaker.getRowCount();i++){total_amt+=Number($.grdAbroadSpeaker.getValue(i,"lect_amt"));total_amt+=Number($.grdAbroadSpeaker.getValue(i,"advice_amt"))}$.spe_total_amt.setValue(Number(total_amt))}function getObjectDate(objDate){var year=parseInt(objDate.year)+1900;var month=parseInt(objDate.month)+1;var date=objDate.date;if(parseInt(month)<10){month="0"+month}if(parseInt(date)<10){date="0"+date}return year+""+month+""+date}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1015);$.panMain.setText("");$.panMain.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,0,1200,185);$.panInfo.setText("기초 정보");$.panInfo.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,385,1200,180);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,135);$.panAbroadSpeaker=new FingerPanel(host,"panAbroadSpeaker",0,195,1200,180);$.panAbroadSpeaker.setText("연자 정보");$.panAbroadSpeaker.setBottomLine(true);$.panProcState=new FingerPanel(host,"panProcState",0,575,1200,125);$.panProcState.setText("진행상황");$.panProcState.setBottomLine(true);$.panFile2=new FingerPanel(host,"panFile2",0,710,1200,180);$.panFile2.setText("CP첨부파일");$.panFile2.setBottomLine(true);$.grdFile2=new FingerDataGrid(host,"grdFile2",0,0,1200,135);$.grdAbroadSpeaker=new FingerDataGrid(host,"grdAbroadSpeaker",0,0,1200,135);$.lbl_cp_id=new FingerLabel(host,"lbl_cp_id",0,10,100,20);$.lbl_cp_id.setText("CP번호");$.txt_cp_id=new FingerEdit(host,"txt_cp_id",105,10,175,20);$.lbl_total_amt=new FingerLabel(host,"lbl_total_amt",275,10,100,20);$.lbl_total_amt.setText("총 금액");$.spe_total_amt=new FingerSpinEdit(host,"spe_total_amt",380,10,140,20);$.lbl_Txt1=new FingerLabel(host,"lbl_Txt1",520,10,20,20);$.lbl_Txt1.setText("원");$.lbl_report_date=new FingerLabel(host,"lbl_report_date",760,10,100,20);$.lbl_report_date.setText("보고일자");$.dte_report_date=new FingerDateEdit(host,"dte_report_date",865,10,115,20);$.cmb_Status=new FingerComboBox(host,"cmb_Status",1005,10,145,20);$.lbl_cp_emp_id=new FingerLabel(host,"lbl_cp_emp_id",0,40,100,20);$.lbl_cp_emp_id.setText("담당자");$.cmb_cp_emp_id=new FingerComboBox(host,"cmb_cp_emp_id",105,40,180,20);$.lbl_date=new FingerLabel(host,"lbl_date",275,40,100,20);$.lbl_date.setText("개최기간");$.dte_start_date=new FingerDateEdit(host,"dte_start_date",380,40,140,20);$.lblTxt2=new FingerLabel(host,"lblTxt2",520,40,20,20);$.lblTxt2.setText("~");$.dte_end_date=new FingerDateEdit(host,"dte_end_date",545,40,140,20);$.lbl_place=new FingerLabel(host,"lbl_place",720,40,140,20);$.lbl_place.setText("개최장소 (국가/도시)");$.txt_place=new FingerEdit(host,"txt_place",865,40,280,20);$.lbl_SeminarYN=new FingerLabel(host,"lbl_SeminarYN",0,70,100,20);$.lbl_SeminarYN.setText("관련학회");$.rbo_SeminarYN=new FingerRadioBox(host,"rbo_SeminarYN",105,70,175,20);$.dte_seminar_start_date=new FingerDateEdit(host,"dte_seminar_start_date",380,70,140,20);$.lbl_Txt3=new FingerLabel(host,"lbl_Txt3",520,70,20,20);$.lbl_Txt3.setText("~");$.dte_seminar_end_date=new FingerDateEdit(host,"dte_seminar_end_date",545,70,140,20);$.lbl_seminar_place=new FingerLabel(host,"lbl_seminar_place",720,70,140,20);$.lbl_seminar_place.setText("학회장소 (국가/도시)");$.txt_seminar_place=new FingerEdit(host,"txt_seminar_place",865,70,280,20);$.lbl_SeminarType=new FingerLabel(host,"lbl_SeminarType",0,100,100,20);$.lbl_SeminarType.setText("구분");$.cmb_SeminarType=new FingerComboBox(host,"cmb_SeminarType",105,100,180,20);$.lbl_Seminar=new FingerLabel(host,"lbl_Seminar",275,70,100,20);$.lbl_Seminar.setText("학회기간");$.txt_proc_status=new FingerEdit(host,"txt_proc_status",620,10,15,20);$.txt_cp_doc_no=new FingerEdit(host,"txt_cp_doc_no",650,10,15,20);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.mem_cp_descr=new FingerMemoEdit(host,"mem_cp_descr",135,905,950,90);$.btnMemoSave=new FingerButton(host,"btnMemoSave",1105,5,105,95);$.btnMemoSave.setText("메모저장");$.btnPrevious=new FingerButton(host,"btnPrevious",1095,10,110,20);$.btnPrevious.setText("이전단계로");$.btnNext=new FingerButton(host,"btnNext",1095,40,110,20);$.btnNext.setText("다음단계로");$.btnProcess1=new FingerButton(host,"btnProcess1",255,10,110,55);$.btnProcess1.setText("CP 확인증");$.btnProcess2=new FingerButton(host,"btnProcess2",410,10,110,55);$.btnProcess2.setText("Zinc<br/>검토진행중");$.btnProcess3=new FingerButton(host,"btnProcess3",565,10,110,55);$.btnProcess3.setText("승인완료");$.btnProcess4=new FingerButton(host,"btnProcess4",720,10,110,55);$.btnProcess4.setText("<p>Agreement</p><p>검토완료</p>");$.btnProcess5=new FingerButton(host,"btnProcess5",880,10,110,55);$.btnProcess5.setText("CP레포트<br/>반영완료");$.panBottom=new FingerPanel(host,"panBottom",0,900,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.lblRight1=new FingerLabel(host,"lblRight1",365,20,20,20);$.lblRight1.setText("▶");$.lblRight2=new FingerLabel(host,"lblRight2",520,20,20,20);$.lblRight2.setText("▶");$.lblRight3=new FingerLabel(host,"lblRight3",675,20,20,20);$.lblRight3.setText("▶");$.lblRight4=new FingerLabel(host,"lblRight4",830,20,20,20);$.lblRight4.setText("▶");$.panInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panAbroadSpeaker.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panFile2.addButtons(["btnDelete","btnAdd"]);$.cmb_SeminarType.setEmptyRow(true);$.txt_proc_status.setVisible(false);$.txt_cp_doc_no.setVisible(false);$.spe_total_amt.setAllowBlank(false,"총 금액");$.dte_start_date.setAllowBlank(false,"개최기간 시작일");$.dte_end_date.setAllowBlank(false,"개최기간 종료일");$.txt_place.setAllowBlank(false,"개최장소 (국가/도시)");$.rbo_SeminarYN.setAllowBlank(false,"관련학회");$.btnProcess1.setEnable(false);$.btnProcess2.setEnable(false);$.btnProcess3.setEnable(false);$.btnProcess4.setEnable(false);$.btnProcess5.setEnable(false);$.btnPrevious.setVisible(false);$.btnNext.setVisible(false);$.dte_report_date.setEnable(false);$.txt_cp_id.setReadOnly(true);$.cmb_cp_emp_id.setEnable(false);$.spe_total_amt.setEnable(false);$.cmb_Status.setEnable(false);$.btnProcess2.setLineHeight(2);$.btnProcess4.setLineHeight(2);$.btnProcess5.setLineHeight(2);$.rbo_SeminarYN.addButtons([{sub_code:"Y",code_name:"있음"},{sub_code:"N",code_name:"없음"}]);$.mem_cp_descr.setReadOnly(true);$.grdAbroadSpeaker.setColumns([new FingerDataGridColumn("contact_name",130,"left","string","참가자",{readonly:true}),new FingerDataGridColumn("company_name",140,"left","string","소속",{readonly:true}),new FingerDataGridColumn("attend_yn",120,"center","checkbox","학회참석예정"),new FingerDataGridColumn("act_type",110,"left","string","유형"),new FingerDataGridColumn("lect_amt",110,"right","int","강연비용",{format:"int"}),new FingerDataGridColumn("advice_amt",110,"right","int","자문비용",{format:"int"}),new FingerDataGridColumn("cp_food_yn",90,"center","checkbox","식음료"),new FingerDataGridColumn("cp_trans_yn",90,"center","checkbox","교통비"),new FingerDataGridColumn("cp_stay_yn",90,"center","checkbox","숙박비"),new FingerDataGridColumn("descr",200,"left","string","비고"),new FingerDataGridColumn("contact_id",0,"left","string","참가자아이디",{hidden:true}),new FingerDataGridColumn("company_id",0,"left","string","거래처아이디",{hidden:true}),new FingerDataGridColumn("act_date",0,"left","string","일시",{hidden:true}),new FingerDataGridColumn("act_time",0,"left","string","시간",{hidden:true}),]);$.grdAbroadSpeaker.init({isFilter:false});$.grdAbroadSpeaker.setEditable(true);$.grdAbroadSpeaker.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",100,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",100,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",800,"left","string","사이즈",{hidden:true})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.grdFile2.setColumns([new FingerDataGridColumn("seq2",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path2",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname2",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type2",400,"left","string","자료유형"),new FingerDataGridColumn("local_fname2",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path2","server_fname2"]}),new FingerDataGridColumn("file_size2",800,"left","string","사이즈",{hidden:true})]);$.grdFile2.init({isFilter:false});$.grdFile2.setEditable(true);$.grdFile2.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panInfo);$.panMain.add($.panFile);$.panMain.add($.panFile2);$.panMain.add($.panProcState);$.panMain.add($.panAbroadSpeaker);$.panMain.add($.panBottom);$.panMain.add($.mem_cp_descr);$.panInfo.add($.lbl_cp_id);$.panInfo.add($.txt_cp_id);$.panInfo.add($.lbl_total_amt);$.panInfo.add($.spe_total_amt);$.panInfo.add($.lbl_Txt1);$.panInfo.add($.lbl_report_date);$.panInfo.add($.dte_report_date);$.panInfo.add($.cmb_Status);$.panInfo.add($.lbl_cp_emp_id);$.panInfo.add($.cmb_cp_emp_id);$.panInfo.add($.lbl_date);$.panInfo.add($.dte_start_date);$.panInfo.add($.lblTxt2);$.panInfo.add($.dte_end_date);$.panInfo.add($.lbl_place);$.panInfo.add($.txt_place);$.panInfo.add($.lbl_SeminarYN);$.panInfo.add($.rbo_SeminarYN);$.panInfo.add($.dte_seminar_start_date);$.panInfo.add($.lbl_Txt3);$.panInfo.add($.dte_seminar_end_date);$.panInfo.add($.lbl_seminar_place);$.panInfo.add($.txt_seminar_place);$.panInfo.add($.lbl_SeminarType);$.panInfo.add($.cmb_SeminarType);$.panInfo.add($.lbl_Seminar);$.panInfo.add($.txt_proc_status);$.panInfo.add($.txt_cp_doc_no);$.panFile.add($.grdFile);$.panAbroadSpeaker.add($.grdAbroadSpeaker);$.panProcState.add($.btnPrevious);$.panProcState.add($.btnNext);$.panProcState.add($.btnProcess1);$.panProcState.add($.btnProcess2);$.panProcState.add($.btnProcess3);$.panProcState.add($.btnProcess4);$.panProcState.add($.btnProcess5);$.panProcState.add($.lblRight1);$.panProcState.add($.lblRight2);$.panProcState.add($.lblRight3);$.panProcState.add($.lblRight4);$.panFile2.add($.grdFile2);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);relocateChildIndexInPanel([$.panInfo]);var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0111|L_CRM270");$.cmb_cp_emp_id.setColumn("employee_id","emp_name");setComboBind([$.cmb_cp_emp_id,$.cmb_Status,$.cmb_SeminarType],ds);var ds1=bizComponentData2($,"Q1","L_CRM269");$.grdAbroadSpeaker.setColumnDropDownList("act_type",ds1.resultList[0]);var subQuery1=" AND extra_field1 LIKE '%CP34%' and extra_field2 <> 'CP'";var ds2=bizComponentData2($,"Q4","L_CRM0110",subQuery1);$.grdFile.setColumnDropDownList("file_type",ds2.resultList[0],null,true);var subQuery2=" AND extra_field1 LIKE '%CP34%'";var ds3=bizComponentData2($,"Q4","L_CRM0110",subQuery2);$.grdFile2.setColumnDropDownList("file_type2",ds3.resultList[0],null,true);if($.p_argument){$.cmb_Status.setValue($.p_argument[0][0].cp_status);$.mem_cp_descr.setValue($.p_argument[0][0].cp_descr);$.bConfirm=$.p_argument[0][0].Confirm;$.txt_cp_id.setValue($.p_argument[0][0].cp_id);$.spe_total_amt.setValue($.p_argument[0][0].cp_amt);$.dte_report_date.setValue(getObjectDate($.p_argument[0][0].create_time));$.cmb_cp_emp_id.setValue($.p_argument[0][0].cp_emp_id);$.dte_start_date.setValue($.p_argument[0][0].cp_start_date);$.dte_end_date.setValue($.p_argument[0][0].cp_end_date);$.txt_place.setValue($.p_argument[0][0].cp_place);$.rbo_SeminarYN.setValue($.p_argument[0][0].seminar_yn);$.dte_seminar_start_date.setValue($.p_argument[0][0].seminar_start_date);$.dte_seminar_end_date.setValue($.p_argument[0][0].seminar_end_date);$.txt_seminar_place.setValue($.p_argument[0][0].seminar_place);$.cmb_SeminarType.setValue($.p_argument[0][0].seminar_type);$.txt_proc_status.setValue($.p_argument[0][0].proc_status);$.txt_cp_doc_no.setValue($.p_argument[0][0].cp_doc_no);setDataGrid([$.grdAbroadSpeaker],$.p_argument[1],true);$.grdAbroadSpeaker.selectRow(0);if($.p_argument[2].length>0){setDataGrid([$.grdFile],$.p_argument[2],true);$.grdFile.selectRow(0)}if($.p_argument[3].length>0){setDataGrid([$.grdFile2],$.p_argument[3],true);$.grdFile2.selectRow(0)}if(g_main.session.obj.DeptCode!=g_main.session.obj.CPDeptCode){$.btnPrevious.setVisible(false);$.btnNext.setVisible(false);$.panFile2.disableButton(["btnAdd","btnDelete"])}setProcStatus();$.bConfirm=$.p_argument[0][0].Confirm;if(!$.bConfirm){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnMemoSave.setVisible(false);$.mem_cp_descr.setReadOnly(true)}else{fnEnableSet(true);$.panInfo.enableButton(["btnSave"]);$.btnPrevious.setVisible(true);$.btnNext.setVisible(true);$.mem_cp_descr.setReadOnly(false)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false);$.panInfo.disableButton(["btnDelete"]);$.panAbroadSpeaker.disableButton(["btnAdd","btnDelete"])}}else{newClick();$.panBottom.setVisible(false);$.mem_cp_descr.setVisible(false)}};$.callback=function(type,ds){if(type=="N"||type=="U"||type=="D"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txt_cp_id.setValue(id[0]);$.txt_cp_doc_no.setValue(id[1])}MessageBoxShow("정상적으로 저장되었습니다.")}}else{if(ds.errorCode=="MSG0004"){MessageBoxShow("정상적으로 수정되었습니다.");if($.isMemo){$.isMemo=false;var share={save_mode:"MEMO",cp_descr:$.mem_cp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제되었습니다.");newClick();if($.p_argument){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}}}}}}else{if(type=="NEXT"||type=="PREV"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0004"){setProcStatus()}else{if(ds.errorCode=="MSG0030"){MessageBoxShow("수정된 레코드가 없습니다.")}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.mem_cp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.mem_cp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){$.isMemo=true;saveClick()}else{if(id=="btnNext"){confirmBoxShow("다음 단계로 변경하시겠습니까?",function(){if(g_main.msgShare==true){if(Number($.txt_proc_status.getValue())==90){MessageBoxShow("현재 최종 단계입니다.");return}else{$.txt_proc_status.setValue(Number($.txt_proc_status.getValue())+20)}saveCPExtraFunction("NEXT")}})}else{if(id=="btnPrevious"){confirmBoxShow("이전 단계로 변경하시겠습니까?",function(){if(g_main.msgShare==true){if(Number($.txt_proc_status.getValue())==10){MessageBoxShow("현재 최초 단계입니다.");return}else{$.txt_proc_status.setValue(Number($.txt_proc_status.getValue())-20)}saveCPExtraFunction("PREV")}})}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){newClick()}else{if(btnId=="btnSave"){saveClick()}else{if(btnId=="btnDelete"){deleteClick()}}}}else{if(panelId=="panAbroadSpeaker"){if(btnId=="btnAdd"){$.popUpCallId=btnId;var param={contact_name:"",check_yn:"Y",base_date:"29991231",inquiry_type:"abroadspeaker"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdAbroadSpeaker.getSelectedRowIdx();$.grdAbroadSpeaker.deleteRow(rId);$.grdAbroadSpeaker.selectRow(0)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){fileList[i].file_type="";fileList[i].seq=seq+i;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}log(fileList);$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);$.grdFile.selectRow(0)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}else{if(panelId=="panFile2"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile2.getRowCount();var seq=setSeq($.grdFile2,"seq2");for(var i=0;i<fileList.length;i++){fileList[i].file_type2="";fileList[i].local_fname2=fileList[i].local_fname;fileList[i].file_size2=fileList[i].file_size;fileList[i].server_fname2=fileList[i].server_fname;fileList[i].seq2=seq+i+50;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile2.getValue(j,"local_fname2")&&fileList[i]["file_size"]==$.grdFile2.getValue(j,"file_size2")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile2.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile2.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile2.getValue(rId,"server_path2")+$.grdFile2.getValue(rId,"server_fname2"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile2.deleteRow(rId);$.grdFile2.selectRow(0)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="btnAdd"){$.grdAbroadSpeaker.addRows(popResult.popRows,$.grdAbroadSpeaker.getRowCount());$.grdAbroadSpeaker.selectRow(0)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>