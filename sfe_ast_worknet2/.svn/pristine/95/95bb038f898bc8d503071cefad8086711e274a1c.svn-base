<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.lblSubject=null;$.lblTripType=null;$.lblEmpInfo=null;$.lblCompanion=null;$.lblTripDate=null;$.lblDestination=null;$.lblVisitCompany=null;$.lblMeetPersonTel=null;$.lblStayName=null;$.lblLocalContact=null;$.lblDeparture=null;$.lblDepartureDatetime=null;$.lblArrival=null;$.lblArrivalDatetime=null;$.lblDeparture2=null;$.lblDepartureDatetime2=null;$.lblArrival2=null;$.lblArrivalDatetime2=null;$.lblLabel1=null;$.lblLabel2=null;$.lblLabel3=null;$.txtSubject=null;$.cmbTripType=null;$.txtEmpInfo=null;$.txtCompanion=null;$.dteStart=null;$.dteEnd=null;$.txtDestination=null;$.txtVisitCompany=null;$.txtMeetPersonTel=null;$.txtStayName=null;$.txtLocalContact=null;$.txtDeparture=null;$.dteDepartureDate=null;$.txtArrival=null;$.dteArrivalDate=null;$.txtDeparture2=null;$.dteDepartureDate2=null;$.txtArrival2=null;$.dteArrivalDate2=null;$.lblLabel4=null;$.lblLabel5=null;$.lblLabel6=null;$.lblLabel7=null;$.lblLabel8=null;$.txtDepartureHour=null;$.txtDepartureMinute=null;$.txtArrivalHour=null;$.txtArrivalMinute=null;$.txtDepartureHour2=null;$.txtDepartureMinute2=null;$.txtArrivalHour2=null;$.txtArrivalMinute2=null;$.grdFile=null;$.grdDoc=null;$.varWFDocId="";$.varBusinessId="";$.varWFType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFGoAboard"]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmWFGoAboardD_S",[workType,$.varWfDocId,$.txtSubject.getValue(),"#UserID#",$.txtEmpInfo.getValue(),$.txtCompanion.getValue(),$.dteStart.getValue(),$.dteEnd.getValue(),$.txtDestination.getValue(),$.txtVisitCompany.getValue(),$.txtMeetPersonTel.getValue(),$.txtStayName.getValue(),$.txtLocalContact.getValue(),"",$.txtDeparture.getValue(),$.dteDepartureDate.getText()+" "+calcDate($.txtDepartureHour.getValue())+":"+calcDate($.txtDepartureMinute.getValue())+":00.000",$.txtArrival.getValue(),$.dteArrivalDate.getText()+" "+calcDate($.txtArrivalHour.getValue())+":"+calcDate($.txtArrivalMinute.getValue())+":00.000","",$.txtDeparture2.getValue(),$.dteDepartureDate2.getText()+" "+calcDate($.txtDepartureHour2.getValue())+":"+calcDate($.txtDepartureMinute2.getValue())+":00.000",$.txtArrival2.getValue(),$.dteArrivalDate2.getText()+" "+calcDate($.txtArrivalHour2.getValue())+":"+calcDate($.txtArrivalMinute2.getValue())+":00.000","","",$.cmbTripType.getValue()]);return json}function searchWFDocument(workType){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function saveWFGoAboard(workType){var json=createJSON_S("N");var ds=callExecuteSync(["req",json],"N",$,false);var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function calcDate(value){if(String(value).length==1){value="0"+value}return value}function convertObjectData(obj){var dte="";dte="20"+obj.year.toString().substr(1,3)+(((obj.month+1)<10?"0":"")+(obj.month+1).toString())+((obj.date<10?"0":"")+obj.date.toString())+((obj.hours<10?"0":"")+obj.hours.toString())+((obj.minutes<10?"0":"")+obj.minutes.toString())+((obj.seconds<10?"0":"")+obj.seconds.toString());return dte}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1180);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine();$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,410);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,490,1200,385);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(false);$.panFile=new FingerPanel(host,"panFile",0,890,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,890,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,310);$.lblSubject=new FingerLabel(host,"lblSubject",20,10,100,20);$.lblSubject.setText("제목");$.lblTripType=new FingerLabel(host,"lblTripType",610,10,100,20);$.lblTripType.setText("출장구분");$.lblEmpInfo=new FingerLabel(host,"lblEmpInfo",20,40,100,20);$.lblEmpInfo.setText("출장자");$.lblCompanion=new FingerLabel(host,"lblCompanion",610,40,100,20);$.lblCompanion.setText("동행자");$.lblTripDate=new FingerLabel(host,"lblTripDate",20,100,100,20);$.lblTripDate.setText("출장기간");$.lblDestination=new FingerLabel(host,"lblDestination",610,100,100,20);$.lblDestination.setText("출장지");$.lblVisitCompany=new FingerLabel(host,"lblVisitCompany",20,130,100,20);$.lblVisitCompany.setText("방문회사/부서");$.lblMeetPersonTel=new FingerLabel(host,"lblMeetPersonTel",610,130,100,20);$.lblMeetPersonTel.setText("만날사람/전화");$.lblStayName=new FingerLabel(host,"lblStayName",15,160,105,20);$.lblStayName.setText("숙박지(호텔명)");$.lblLocalContact=new FingerLabel(host,"lblLocalContact",610,160,100,20);$.lblLocalContact.setText("현지연락처");$.lblDeparture=new FingerLabel(host,"lblDeparture",140,210,100,20);$.lblDeparture.setText("출발공항");$.lblDepartureDatetime=new FingerLabel(host,"lblDepartureDatetime",140,240,100,20);$.lblDepartureDatetime.setText("출발예정시간");$.lblArrival=new FingerLabel(host,"lblArrival",610,210,100,20);$.lblArrival.setText("도착공항");$.lblArrivalDatetime=new FingerLabel(host,"lblArrivalDatetime",610,240,100,20);$.lblArrivalDatetime.setText("도착예정시간");$.lblDeparture2=new FingerLabel(host,"lblDeparture2",140,280,100,20);$.lblDeparture2.setText("현지출발공항");$.lblDepartureDatetime2=new FingerLabel(host,"lblDepartureDatetime2",125,310,120,20);$.lblDepartureDatetime2.setText("현지출발예정시간");$.lblArrival2=new FingerLabel(host,"lblArrival2",610,280,100,20);$.lblArrival2.setText("귀국공항");$.lblArrivalDatetime2=new FingerLabel(host,"lblArrivalDatetime2",610,310,100,20);$.lblArrivalDatetime2.setText("귀국예정시간");$.lblLabel1=new FingerLabel(host,"lblLabel1",115,65,720,20);$.lblLabel1.setText("출장자 및 동행자는 다음과 같이 입력해주시기 바랍니다.  한글이름(여권 영문명 / 성별)  예시 : 홍길동(Hong, GillDong / 남)");$.lblLabel2=new FingerLabel(host,"lblLabel2",20,210,100,20);$.lblLabel2.setText("출발편");$.lblLabel3=new FingerLabel(host,"lblLabel3",20,280,100,20);$.lblLabel3.setText("귀국편");$.txtSubject=new FingerEdit(host,"txtSubject",125,10,480,20);$.cmbTripType=new FingerComboBox(host,"cmbTripType",715,10,80,20);$.txtEmpInfo=new FingerEdit(host,"txtEmpInfo",125,40,260,20);$.txtCompanion=new FingerEdit(host,"txtCompanion",715,40,260,20);$.dteStart=new FingerDateEdit(host,"dteStart",125,100,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",250,100,100,20);$.txtDestination=new FingerEdit(host,"txtDestination",715,100,260,20);$.txtVisitCompany=new FingerEdit(host,"txtVisitCompany",125,130,260,20);$.txtMeetPersonTel=new FingerEdit(host,"txtMeetPersonTel",715,130,260,20);$.txtStayName=new FingerEdit(host,"txtStayName",125,160,260,20);$.txtLocalContact=new FingerEdit(host,"txtLocalContact",715,160,260,20);$.txtDeparture=new FingerEdit(host,"txtDeparture",245,210,260,20);$.dteDepartureDate=new FingerDateEdit(host,"dteDepartureDate",245,240,140,20);$.txtArrival=new FingerEdit(host,"txtArrival",715,210,260,20);$.dteArrivalDate=new FingerDateEdit(host,"dteArrivalDate",715,240,140,20);$.txtDeparture2=new FingerEdit(host,"txtDeparture2",245,280,260,20);$.dteDepartureDate2=new FingerDateEdit(host,"dteDepartureDate2",245,310,140,20);$.txtArrival2=new FingerEdit(host,"txtArrival2",715,280,260,20);$.dteArrivalDate2=new FingerDateEdit(host,"dteArrivalDate2",715,310,140,20);$.lblLabel4=new FingerLabel(host,"lblLabel4",225,100,20,20);$.lblLabel4.setText("~");$.lblLabel5=new FingerLabel(host,"lblLabel5",460,240,20,20);$.lblLabel5.setText(":");$.lblLabel6=new FingerLabel(host,"lblLabel6",930,240,20,20);$.lblLabel6.setText(":");$.lblLabel7=new FingerLabel(host,"lblLabel7",460,310,20,20);$.lblLabel7.setText(":");$.lblLabel8=new FingerLabel(host,"lblLabel8",930,310,20,20);$.lblLabel8.setText(":");$.txtDepartureHour=new FingerEdit(host,"txtDepartureHour",440,240,25,20);$.txtDepartureMinute=new FingerEdit(host,"txtDepartureMinute",480,240,25,20);$.txtArrivalHour=new FingerEdit(host,"txtArrivalHour",910,240,25,20);$.txtArrivalMinute=new FingerEdit(host,"txtArrivalMinute",950,240,25,20);$.txtDepartureHour2=new FingerEdit(host,"txtDepartureHour2",440,310,25,20);$.txtDepartureMinute2=new FingerEdit(host,"txtDepartureMinute2",480,310,25,20);$.txtArrivalHour2=new FingerEdit(host,"txtArrivalHour2",910,310,25,20);$.txtArrivalMinute2=new FingerEdit(host,"txtArrivalMinute2",950,310,25,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,230);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,230);$.panTitle.setBorder(true);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.txtTitle.setAllowBlank(false,"문서제목");$.txtSubject.setAllowBlank(false,"제목");$.cmbTripType.setAllowBlank(false,"출장구분");$.txtEmpInfo.setAllowBlank(false,"출장자");$.txtCompanion.setAllowBlank(false,"동행자");$.dteStart.setAllowBlank(false,"출장 시작일");$.dteEnd.setAllowBlank(false,"출장 종료일");$.txtDestination.setAllowBlank(false,"출장지");$.txtVisitCompany.setAllowBlank(false,"방문회사/부서");$.txtMeetPersonTel.setAllowBlank(false,"만날사람/전화");$.txtStayName.setAllowBlank(false,"숙박지(호텔명)");$.txtLocalContact.setAllowBlank(false,"현지연락처");$.txtDeparture.setAllowBlank(false,"출발공항");$.dteDepartureDate.setAllowBlank(false,"출발예정일");$.txtDepartureHour.setAllowBlank(false,"출발예정시간");$.txtDepartureMinute.setAllowBlank(false,"출발예정시간");$.txtArrival.setAllowBlank(false,"도착공항");$.dteArrivalDate.setAllowBlank(false,"도착예정일");$.txtArrivalHour.setAllowBlank(false,"도착예정시간");$.txtArrivalMinute.setAllowBlank(false,"도착예정시간");$.txtDeparture2.setAllowBlank(false,"현지출발공항");$.dteDepartureDate2.setAllowBlank(false,"현지출발예정일");$.txtDepartureHour2.setAllowBlank(false,"현지출발예정시간");$.txtDepartureMinute2.setAllowBlank(false,"현지출발예정시간");$.txtArrival2.setAllowBlank(false,"귀국공항");$.dteArrivalDate2.setAllowBlank(false,"귀국예정일");$.txtArrivalHour2.setAllowBlank(false,"귀국예정시간");$.txtArrivalMinute2.setAllowBlank(false,"귀국예정시간");$.cmbTripType.setEmptyRow(true,"");$.txtEmpInfo.setValue(g_main.session.obj.UserName);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.lblLabel3);$.panWFMain.add($.lblLabel2);$.panWFMain.add($.lblLabel1);$.panWFMain.add($.lblArrivalDatetime2);$.panWFMain.add($.lblArrival2);$.panWFMain.add($.lblDepartureDatetime2);$.panWFMain.add($.lblDeparture2);$.panWFMain.add($.lblArrivalDatetime);$.panWFMain.add($.lblArrival);$.panWFMain.add($.lblDepartureDatetime);$.panWFMain.add($.lblDeparture);$.panWFMain.add($.lblLocalContact);$.panWFMain.add($.lblStayName);$.panWFMain.add($.lblMeetPersonTel);$.panWFMain.add($.lblVisitCompany);$.panWFMain.add($.lblDestination);$.panWFMain.add($.lblTripDate);$.panWFMain.add($.lblCompanion);$.panWFMain.add($.lblEmpInfo);$.panWFMain.add($.lblTripType);$.panWFMain.add($.lblSubject);$.panWFMain.add($.txtSubject);$.panWFMain.add($.cmbTripType);$.panWFMain.add($.txtEmpInfo);$.panWFMain.add($.txtCompanion);$.panWFMain.add($.dteStart);$.panWFMain.add($.dteEnd);$.panWFMain.add($.txtDestination);$.panWFMain.add($.txtVisitCompany);$.panWFMain.add($.txtMeetPersonTel);$.panWFMain.add($.txtStayName);$.panWFMain.add($.txtLocalContact);$.panWFMain.add($.txtDeparture);$.panWFMain.add($.dteDepartureDate);$.panWFMain.add($.txtArrival);$.panWFMain.add($.dteArrivalDate);$.panWFMain.add($.txtDeparture2);$.panWFMain.add($.dteDepartureDate2);$.panWFMain.add($.txtArrival2);$.panWFMain.add($.dteArrivalDate2);$.panWFMain.add($.lblLabel4);$.panWFMain.add($.lblLabel5);$.panWFMain.add($.lblLabel6);$.panWFMain.add($.lblLabel7);$.panWFMain.add($.lblLabel8);$.panWFMain.add($.txtDepartureHour);$.panWFMain.add($.txtDepartureMinute);$.panWFMain.add($.txtArrivalHour);$.panWFMain.add($.txtArrivalMinute);$.panWFMain.add($.txtDepartureHour2);$.panWFMain.add($.txtDepartureMinute2);$.panWFMain.add($.txtArrivalHour2);$.panWFMain.add($.txtArrivalMinute2);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);var ds=bizComponentData2($,"Q2","L_CRM0246");setComboBind([$.cmbTripType],ds);searchWFDocument()};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue(result.business_title)}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var md=args[6][0];if(md){$.txtSubject.setValue(md.subject);$.cmbTripType.setValue(md.TripType);$.txtCompanion.setValue(md.companion);$.dteStart.setValue(md.trip_date_fr);$.dteEnd.setValue(md.trip_date_to);$.txtDestination.setValue(md.destination);$.txtVisitCompany.setValue(md.visit_company);$.txtMeetPersonTel.setValue(md.meet_person_tel);$.txtStayName.setValue(md.stay_name);$.txtLocalContact.setValue(md.local_contact);$.txtDeparture.setValue(md.departure);$.dteDepartureDate.setValue(convertObjectData(md.departure_datetime).substr(0,8));$.txtDepartureHour.setValue(convertObjectData(md.departure_datetime).substr(8,2));$.txtDepartureMinute.setValue(convertObjectData(md.departure_datetime).substr(10,2));$.txtArrival.setValue(md.arrival);$.dteArrivalDate.setValue(convertObjectData(md.arrival_datetime).substr(0,8));$.txtArrivalHour.setValue(convertObjectData(md.arrival_datetime).substr(8,2));$.txtArrivalMinute.setValue(convertObjectData(md.arrival_datetime).substr(10,2));$.txtDeparture2.setValue(md.departure2);$.dteDepartureDate2.setValue(convertObjectData(md.departure_datetime2).substr(0,8));$.txtDepartureHour2.setValue(convertObjectData(md.departure_datetime2).substr(8,2));$.txtDepartureMinute2.setValue(convertObjectData(md.departure_datetime2).substr(10,2));$.txtArrival2.setValue(md.arrival2);$.dteArrivalDate2.setValue(convertObjectData(md.arrival_datetime2).substr(0,8));$.txtArrivalHour2.setValue(convertObjectData(md.arrival_datetime2).substr(8,2));$.txtArrivalMinute2.setValue(convertObjectData(md.arrival_datetime2).substr(10,2))}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!validateControls([$.txtSubject,$.cmbTripType,$.txtEmpInfo,$.txtCompanion,$.dteStart,$.dteEnd,$.txtDestination,$.txtVisitCompany,$.txtMeetPersonTel,$.txtStayName,$.txtLocalContact,$.txtDeparture,$.dteDepartureDate,$.txtDepartureHour,$.txtDepartureMinute,$.txtArrival,$.dteArrivalDate,$.txtArrivalHour,$.txtArrivalMinute,$.txtDeparture2,$.dteDepartureDate2,$.txtDepartureHour2,$.txtDepartureMinute2,$.txtArrival2,$.dteArrivalDate2,$.txtArrivalHour2,$.txtArrivalMinute2])){return}if($.txtDepartureHour.getValue()>23||$.txtDepartureMinute.getValue()>59){MessageBoxShow("출발예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtArrivalHour.getValue()>23||$.txtArrivalMinute.getValue()>59){MessageBoxShow("도착예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtDepartureHour2.getValue()>23||$.txtDepartureMinute2.getValue()>59){MessageBoxShow("현지출발예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtArrivalHour2.getValue()>23||$.txtArrivalMinute2.getValue()>59){MessageBoxShow("귀국예정시간 은(는) 23:59 보다 클 수 없습니다.");return}}}}var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFGoAboard"};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if(id=="btnTmpSave"){if(!validateControls([$.txtSubject,$.cmbTripType,$.txtEmpInfo,$.txtCompanion,$.dteStart,$.dteEnd,$.txtDestination,$.txtVisitCompany,$.txtMeetPersonTel,$.txtStayName,$.txtLocalContact,$.txtDeparture,$.dteDepartureDate,$.txtDepartureHour,$.txtDepartureMinute,$.txtArrival,$.dteArrivalDate,$.txtArrivalHour,$.txtArrivalMinute,$.txtDeparture2,$.dteDepartureDate2,$.txtDepartureHour2,$.txtDepartureMinute2,$.txtArrival2,$.dteArrivalDate2,$.txtArrivalHour2,$.txtArrivalMinute2])){return}if($.txtDepartureHour.getValue()>23||$.txtDepartureMinute.getValue()>59){MessageBoxShow("출발예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtArrivalHour.getValue()>23||$.txtArrivalMinute.getValue()>59){MessageBoxShow("도착예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtDepartureHour2.getValue()>23||$.txtDepartureMinute2.getValue()>59){MessageBoxShow("현지출발예정시간 은(는) 23:59 보다 클 수 없습니다.");return}else{if($.txtArrivalHour2.getValue()>23||$.txtArrivalMinute2.getValue()>59){MessageBoxShow("귀국예정시간 은(는) 23:59 보다 클 수 없습니다.");return}}}}if(saveWFDocument("","N")){saveWFGoAboard()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){if(id=="chkContractTerm"){if(value=="Y"){$.lblContractTerm.setVisible(true);$.cmbContractTerm.setVisible(true)}else{$.lblContractTerm.setVisible(false);$.cmbContractTerm.setVisible(false)}}};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStart"){$.dteEnd.setValue(getCalcDate(value,3))}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWFDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){saveWFGoAboard()}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}else{if(id=="popWFGoAboardSub"){if($.popUpCallId=="bteSubject"){$.varSubWfDocId=popResult.wf_doc_id;$.bteSubject.setValue(popResult.subject)}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){}};</script>