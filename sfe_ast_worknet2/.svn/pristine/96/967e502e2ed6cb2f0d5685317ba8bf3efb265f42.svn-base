<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panDay=null;$.panSpecialDay=null;$.lblYear=null;$.dteYear=null;$.lblSiteCode=null;$.cmbSiteCode=null;$.grdDay=null;$.grdHoliday=null;$.btnSearch=null;$.btnCopy=null;$.btnCalendarCreate=null;function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRB1100_Q",[workType,$.dteYear.getValue(),$.cmbSiteCode.getValue()]);return json}function createJSON_S(workType){var bResult=false;if(workType=="BEFORE"){var json=createExecuteParamInfo("HR..P_HRB1100_S",[workType,$.dteYear.getValue(),$.cmbSiteCode.getValue(),"","","","","","","","#UserID#","#HostInfo#"]);return json}else{var json=createExecuteParamInfo("HR..P_HRB1100_S",[workType,$.dteYear.getValue(),$.cmbSiteCode.getValue(),$.grdDay.getValue(0,"work_type").toString(),$.grdDay.getValue(1,"work_type").toString(),$.grdDay.getValue(2,"work_type").toString(),$.grdDay.getValue(3,"work_type").toString(),$.grdDay.getValue(4,"work_type").toString(),$.grdDay.getValue(5,"work_type").toString(),$.grdDay.getValue(6,"work_type").toString(),"#UserID#","#HostInfo#"]);return json}}function createJSON_S2(workType){var json="";if(workType=="D"){json=createExecuteParamInfo("HR..P_HRB1100_S1",["D",$.dteYear.getValue(),$.cmbSiteCode.getValue(),$.grdHoliday.getValue($.grdHoliday.getSelectedRowIdx(),"work_type"),getFormatDate($.grdHoliday.getValue($.grdHoliday.getSelectedRowIdx(),"start_day"),"yyyyMMdd"),getFormatDate($.grdHoliday.getValue($.grdHoliday.getSelectedRowIdx(),"end_day"),"yyyyMMdd"),$.grdHoliday.getValue($.grdHoliday.getSelectedRowIdx(),"day_title"),$.grdHoliday.getValue($.grdHoliday.getSelectedRowIdx(),"memo")]);return json}else{var json="";var rows=$.grdHoliday.getAllRows();var tempRows=[];for(var i in rows){workType=$.grdHoliday.getRowStatus(i);tempRows.push([workType,$.dteYear.getValue(),$.cmbSiteCode.getValue(),rows[i].work_type,getFormatDate(rows[i].start_day,"yyyyMMdd"),getFormatDate(rows[i].end_day,"yyyyMMdd"),rows[i].day_title,rows[i].memo||""])}log(tempRows);json=createExecuteParamInfo("HR..P_HRB1100_S1",tempRows);return json}}function searchDay(workType){if(!validateControls([$.dteYear,$.cmbSiteCode])){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveHoliday(workType){if(chkGrdDay()){return}var json=createJSON_S(workType);callQuery(["req",json],workType,$)}function saveHolidayDetail(workType){for(var i=0;i<$.grdHoliday.getRowCount();i++){if($.grdHoliday.getValue(i,"start_day")==""){MessageBoxShow("시작일 은(는) 필수입력항목입니다.");return false}if($.grdHoliday.getValue(i,"end_day")==""){MessageBoxShow("종료일 은(는) 필수입력항목입니다.");return false}if($.grdHoliday.getValue(i,"work_type")==""){MessageBoxShow("근무유형 은(는) 필수입력항목입니다.");return false}if($.grdHoliday.getValue(i,"day_title")==""){MessageBoxShow("특정일명칭 은(는) 필수입력항목입니다.");return false}}var json=createJSON_S2(workType);if(workType=="D"||workType==""){callQuery(["req",json],"S_DETAIL",$)}else{if(workType=="N"){callQuery(["req",json],"N_DETAIL",$)}}}function chkGrdDay(){for(var i=0;i<$.grdDay.getRowCount();i++){if($.grdDay.getValue(i,"work_type")==""){MessageBoxShow("근무유형 은(는) 필수입력항목입니다.");return false}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,800);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine();$.panDay=new FingerPanel(host,"panDay",0,65,300,695);$.panDay.setText("요일 설정");$.panDay.setBottomLine(true);$.panSpecialDay=new FingerPanel(host,"panSpecialDay",310,65,890,695);$.panSpecialDay.setText("특정일 설정");$.panSpecialDay.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,15,100,20);$.lblYear.setText("기준년도");$.dteYear=new FingerDateEdit(host,"dteYear",105,15,140,20);$.lblSiteCode=new FingerLabel(host,"lblSiteCode",240,15,100,20);$.lblSiteCode.setText("사업장");$.cmbSiteCode=new FingerComboBox(host,"cmbSiteCode",345,15,200,20);$.grdDay=new FingerDataGrid(host,"grdDay",0,0,300,650);$.grdHoliday=new FingerDataGrid(host,"grdHoliday",0,0,890,650);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.btnCopy=new FingerButton(host,"btnCopy",870,15,140,20);$.btnCopy.setText("전년도 자료복사");$.btnCalendarCreate=new FingerButton(host,"btnCalendarCreate",995,15,140,20);$.btnCalendarCreate.setText("근태달력 생성");$.panQuery.setBorder(true);$.grdDay.colIdx=$.grdDay.setColumns([new FingerDataGridColumn("seq",170,"left","string","연번",{hidden:true}),new FingerDataGridColumn("day_name",140,"left","string","요일",{readonly:true}),new FingerDataGridColumn("work_type",140,"left","string",[{text:"근무유형",css:"col_chk"}])]);$.grdDay.init({});$.grdDay.setEditable(true);$.grdDay.setBorder(false);$.grdHoliday.colIdx=$.grdHoliday.setColumns([new FingerDataGridColumn("start_day",140,"left","date",[{text:"시작일",css:"col_chk"}],{format:"ymd"}),new FingerDataGridColumn("end_day",140,"left","date",[{text:"종료일",css:"col_chk"}],{format:"ymd"}),new FingerDataGridColumn("work_type",140,"left","string",[{text:"근무유형",css:"col_chk"}]),new FingerDataGridColumn("day_title",170,"left","string",[{text:"특정일명칭",css:"col_chk"}]),new FingerDataGridColumn("memo",280,"left","string","비고")]);$.grdHoliday.init({panel:$.panSpecialDay});$.grdHoliday.setEditable(true);$.grdHoliday.setBorder(false);$.panSpecialDay.addButtons(["btnSave","btnDelete","btnAdd"]);$.dteYear.setDateFormat("yyyy");$.cmbSiteCode.setEmptyRow(true);$.dteYear.setAllowBlank(false,"기준년도");$.cmbSiteCode.setAllowBlank(false,"사업장");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panSpecialDay);$.panMain.add($.panDay);$.panQuery.add($.lblYear);$.panQuery.add($.dteYear);$.panQuery.add($.lblSiteCode);$.panQuery.add($.cmbSiteCode);$.panQuery.add($.btnSearch);$.panQuery.add($.btnCopy);$.panQuery.add($.btnCalendarCreate);$.panDay.add($.grdDay);$.panSpecialDay.add($.grdHoliday);$.cmbSiteCode.setColumn("site_code","site_name");var ds=bizComponentData2($,"Q1","L_ORG001|L_HRB001");setComboBind([$.cmbSiteCode],ds);$.grdDay.setColumnDropDownList("work_type",ds.resultList[1],{key:"work_type_code",name:"work_type_name"});$.grdHoliday.setColumnDropDownList("work_type",ds.resultList[1],{key:"work_type_code",name:"work_type_name"});$.dteYear.setValue(getToday());$.cmbSiteCode.setValue(g_main.session.getValue("SiteCode"));searchDay("Q")};$.callback=function(type,ds){if(type=="Q"){for(var i in ds.resultList[1]){ds.resultList[1][i].start_day=extFormat(ds.resultList[1][i].start_day,"yyyyMMdd");ds.resultList[1][i].end_day=extFormat(ds.resultList[1][i].end_day,"yyyyMMdd")}setDataGrid([$.grdDay],ds.resultList[0],true);setDataGrid([$.grdHoliday],ds.resultList[1],true)}else{if(type=="BEFORE"){searchDay("Q")}else{if(type=="N"){saveHolidayDetail("N")}else{if(type=="S_DETAIL"){log("S_DETAIL");searchDay("Q")}else{if(type=="N_DETAIL"){searchDay("APPLY")}else{if(type=="APPLY"){log(ds)}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchDay("Q")}else{if(id=="btnCopy"){saveHoliday("BEFORE")}else{if(id=="btnCalendarCreate"){log(!chkGrdDay());if(chkGrdDay()){return}log("123");saveHoliday("N")}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteYear"){if($.grdHoliday.getRowCount()==0){return}for(var i=0;i<$.grdHoliday.getRowCount();i++){if($.grdHoliday.getValue(i,"start_day").substring(0,4)!=$.dteYear.getValue()){$.grdHoliday.setValue(i,"start_day","")}if($.grdHoliday.getValue(i,"end_day").substring(0,4)!=$.dteYear.getValue()){$.grdHoliday.setValue(i,"end_day","")}}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdHoliday"){if(cInd=="start_day"){if(nValue.getFullYear()!=$.dteYear.getValue()){$.grdHoliday.setValue(rId,"start_day","");MessageBoxShow("선택 가능한 범위를 넘어 났습니다.");return}if($.grdHoliday.getValue(rId,"end_day")!=""){if($.grdHoliday.getValue(rId,"start_day")>$.grdHoliday.getValue(rId,"end_day")){$.grdHoliday.setValue(rId,"start_day","");MessageBoxShow("시작일은 종료일 보다 느릴수 없습니다.");return}}}else{if(cInd=="end_day"){if(nValue.getFullYear()!=$.dteYear.getValue()){$.grdHoliday.setValue(rId,"end_day","");MessageBoxShow("선택 가능한 범위를 넘어 났습니다.");return}if($.grdHoliday.getValue(rId,"start_day")!=""){if($.grdHoliday.getValue(rId,"start_day")>$.grdHoliday.getValue(rId,"end_day")){$.grdHoliday.setValue(rId,"end_day","");MessageBoxShow("종료일은 시작일 보다 빠를수 없습니다.");return}}}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panSpecialDay"){if(btnId=="btnAdd"){$.grdHoliday.addRow()}else{if(btnId=="btnDelete"){var rId=$.grdHoliday.getSelectedRowIdx();if(!rId){return}confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){saveHolidayDetail("D")}})}else{if(btnId=="btnSave"){var rId=$.grdHoliday.getSelectedRowIdx();if(!rId){return}confirmBoxShow("저장하시겠습니까?",function(){if(g_main.msgShare==true){saveHolidayDetail("")}})}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>