<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblDate=null;$.dteStart=null;$.dteEnd=null;$.btnDownload=null;$.lblTerm=null;$.lblC1=null;$.lblC2=null;$.lblC3=null;$.lblC4=null;$.lblC5=null;$.lblC6=null;$.chkType1=null;$.chkType2=null;$.chkType3=null;$.chkType4=null;$.chkType5=null;$.chkType6=null;$.panType=null;$.lblHelp1=null;$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,720,120);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",165,64,50,20);$.lblDate.setText("기간");$.dteStart=new FingerDateEdit(host,"dteStart",220,65,110,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",360,65,110,20);$.btnDownload=new FingerButton(host,"btnDownload",580,65,130,20);$.btnDownload.setText("다운로드");$.lblTerm=new FingerLabel(host,"lblTerm",332,65,20,20);$.lblTerm.setText("~");$.lblC1=new FingerLabel(host,"lblC1",85,13,15,15);$.lblC1.setText("");$.lblC2=new FingerLabel(host,"lblC2",248,13,15,15);$.lblC2.setText("");$.lblC3=new FingerLabel(host,"lblC3",358,13,15,15);$.lblC3.setText("");$.lblC4=new FingerLabel(host,"lblC4",445,13,15,15);$.lblC4.setText("");$.lblC5=new FingerLabel(host,"lblC5",553,13,15,15);$.lblC5.setText("");$.lblC6=new FingerLabel(host,"lblC6",647,13,15,15);$.lblC6.setText("");$.chkType1=new FingerCheckBox(host,"chkType1",10,10,70,20);$.chkType1.setText("연간일정");$.chkType2=new FingerCheckBox(host,"chkType2",130,10,115,20);$.chkType2.setText("전사휴가/공휴일");$.chkType3=new FingerCheckBox(host,"chkType3",295,10,55,20);$.chkType3.setText("비뇨기");$.chkType4=new FingerCheckBox(host,"chkType4",405,10,45,20);$.chkType4.setText("SI");$.chkType5=new FingerCheckBox(host,"chkType5",490,10,55,20);$.chkType5.setText("개업의");$.chkType6=new FingerCheckBox(host,"chkType6",595,10,70,20);$.chkType6.setText("면역");$.panType=new FingerPanel(host,"panType",10,10,680,40);$.panType.setText("");$.panType.setBottomLine(true);$.lblHelp1=new FingerLabel(host,"lblHelp1",145,92,550,20);$.lblHelp1.setText("(* 파일을 다운로드 받는데 약 10초간 소요됩니다. 다운로드 후 기다려 주시기 바랍니다.)");$.dteStart.setValue(getToday("","yyyy")+"0401");$.dteEnd.setValue(getCalcMonth(getToday(""),12).substr(0,4)+"0331");$.panType.setBorder(true);$.lblC1.setStyle("backgroundColor",fingerSchedulerColors.CM10);$.lblC2.setStyle("backgroundColor",fingerSchedulerColors.CM20);$.lblC3.setStyle("backgroundColor",fingerSchedulerColors.CM30);$.lblC4.setStyle("backgroundColor",fingerSchedulerColors.CM40);$.lblC5.setStyle("backgroundColor",fingerSchedulerColors.CM50);$.lblC6.setStyle("backgroundColor",fingerSchedulerColors.CM60);$.chkType1.setValue("Y");$.chkType2.setValue("Y");$.chkType3.setValue("Y");$.chkType4.setValue("Y");$.chkType5.setValue("Y");$.chkType6.setValue("Y");$.host=host;$.args=args};$.start=function(){$.panMain.add($.lblDate);$.panMain.add($.dteStart);$.panMain.add($.dteEnd);$.panMain.add($.btnDownload);$.panMain.add($.lblTerm);$.panMain.add($.panType);$.panMain.add($.lblHelp1);$.panType.add($.lblC1);$.panType.add($.lblC2);$.panType.add($.lblC3);$.panType.add($.lblC4);$.panType.add($.lblC5);$.panType.add($.lblC6);$.panType.add($.chkType1);$.panType.add($.chkType2);$.panType.add($.chkType3);$.panType.add($.chkType4);$.panType.add($.chkType5);$.panType.add($.chkType6);if($.p_argument){$.varEvents=$.p_argument.events;var schCache=getStorage("home_sch_type");if(schCache){var schType=schCache.split("|");for(var i=0;i<schType.length;i++){$[("chkType"+(i+1))].setValue(schType[i])}}}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnDownload"){if($.varEvents){var type=[];if($.chkType1.getValue()=="Y"){type.push("CM10")}if($.chkType2.getValue()=="Y"){type.push("CM20")}if($.chkType3.getValue()=="Y"){type.push("CM30")}if($.chkType4.getValue()=="Y"){type.push("CM40")}if($.chkType5.getValue()=="Y"){type.push("CM50")}if($.chkType6.getValue()=="Y"){type.push("CM60")}var sta=extFormat($.dteStart.getText(),"yyyyMMdd");var end=extFormat($.dteEnd.getText(),"yyyyMMdd");var filts=$.varEvents.filter(function(el){return(el.end>=sta&&el.start<=end&&(type.indexOf(el.type)!=-1))});var sch_seq="";var sch_start="";var sch_end="";var sch_title="";for(var i=0;i<filts.length;i++){sch_seq+=(i==0?filts[i].seq:("||"+filts[i].seq));sch_start+=(i==0?filts[i].start:("||"+filts[i].start));sch_end+=(i==0?filts[i].end:("||"+filts[i].end));sch_title+=(i==0?filts[i].title:("||"+filts[i].title))}var params={p1:sch_seq,p2:sch_start,p3:sch_end,p4:sch_title};exportSchedule(params);$.btnDownload.setEnable(false);window.setTimeout(function(){$.btnDownload.setEnable(true)},20000)}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>