<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMaster=null;$.panList1=null;$.panList2=null;$.grdMaster=null;$.grdList2=null;$.lblpay_group_code=null;$.txtpay_group_code=null;$.lblpay_group_name=null;$.txtpay_group_name=null;$.lbldescr=null;$.memodescr=null;$.lblsort_seq=null;$.numsort_seq=null;$.lbluse_yn=null;$.chkuse_yn=null;$.btnSearch=null;$.stat1=null;$.stat2=null;$.stat3=null;$.stat4=null;$.deleteRows=[];function QueryClick(){fnQRY_P_HRB5100_Q("MASTER")}function fnQRY_P_HRB5100_Q(workType){var pay_group_code="";if(workType=="MASTER"){pay_group_code=""}else{var rId=$.grdMaster.getSelectedRowIdx();pay_group_code=$.grdMaster.getValue(rId,"pay_group_code")}var json=createJSON_Q(workType,pay_group_code);callQuery(["req",json],workType,$)}function createJSON_Q(workType,pay_group_code){var json=createExecuteParamInfo("HR..P_HRB5100_Q",[workType,pay_group_code]);return json}function fnSET_P_HRB5100_S(workType){if(!validateControls([$.txtpay_group_code,$.txtpay_group_name])){return false}if(!$.numsort_seq.getValue()){MessageBoxShow("정렬순서는 필수입력항목 입니다.");return}var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],workType,$,false);if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(workType!="D"){var rId=$.grdMaster.getSelectedRowIdx();$.pay_group_code=$.txtpay_group_code.getValue()}MessageBoxShow("정상적으로 저장되었습니다.");QueryClick()}}}function createJSON_S(workType){var json=createExecuteParamInfo("HR..P_HRB5100_S",[workType,$.txtpay_group_code.getValue()||"",$.txtpay_group_name.getValue()||"",$.chkuse_yn.getValue(),$.numsort_seq.getValue()||0,$.memodescr.getValue()||"",g_main.session.obj.EmpCode,"#HostInfo#"]);return json}function fnSet_P_HRB5100_S1(workType){for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"site_code")==""){MessageBoxShow("사업장 은(는) 필수입력항목입니다.");return}else{if($.grdList2.getValue(i,"pay_type")==""){MessageBoxShow("지급구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_day_month_type")==""){MessageBoxShow("급여월구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_day_dd")==""){MessageBoxShow("급여일 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_start_month_type")==""){MessageBoxShow("급여시작월구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_start_day_dd")==""){MessageBoxShow("급여시작일 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_end_month_type")==""){MessageBoxShow("급여종료월구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"pay_end_day_dd")==""){MessageBoxShow("급여종료일 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"work_start_month_type")==""){MessageBoxShow("근태시작월구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"work_start_day_dd")==""){MessageBoxShow("근태시작일 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"work_end_month_type")==""){MessageBoxShow("근태종료월구분 은(는) 필수입력 항목입니다.");return}else{if($.grdList2.getValue(i,"work_end_day_dd")==""){MessageBoxShow("근태종료일 은(는) 필수입력 항목입니다.");return}}}}}}}}}}}}}var rId=$.grdMaster.getSelectedRowIdx();$.pay_group_code=$.grdMaster.getValue(rId,"pay_group_code");var json=createJSON_S1(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}}MessageBoxShow("정상적으로 저장되었습니다.");QueryClick()}}}function createJSON_S1(workType){var json="";var changedRows=$.grdList2.getChangedRows();if($.deleteRows.length>0){for(var i in $.deleteRows){changedRows.push($.deleteRows[i])}}if(!changedRows.length){MessageBoxShow("저장할 내용이 존재하지 않습니다.");return false}var rows=[];for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,changedRows[i].site_code||"",$.txtpay_group_code.getValue(),changedRows[i].pay_type||"",changedRows[i].pay_day_month_type||"",changedRows[i].pay_day_dd||"",changedRows[i].pay_start_month_type||"",changedRows[i].pay_start_day_dd||"",changedRows[i].pay_end_month_type||"",changedRows[i].pay_end_day_dd||"",changedRows[i].work_start_month_type||"",changedRows[i].work_start_day_dd||"",changedRows[i].work_end_month_type||"",changedRows[i].work_end_day_dd||"",changedRows[i].memo||"",changedRows[i].use_yn||"",g_main.session.obj.EmpCode,"#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRB5100_S1",rows);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,725);$.panMain.setText("");$.panMain.setBottomLine(true);$.panMaster=new FingerPanel(host,"panMaster",0,0,265,700);$.panMaster.setText("급여체계");$.panMaster.setBottomLine(true);$.panList1=new FingerPanel(host,"panList1",275,0,925,225);$.panList1.setText("급여체계 기본 정보");$.panList1.setBottomLine(true);$.panList2=new FingerPanel(host,"panList2",275,230,925,470);$.panList2.setText("사업장별 급여/근태 기간 정보");$.panList2.setBottomLine(true);$.grdMaster=new FingerDataGrid(host,"grdMaster",0,0,265,655);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,925,425);$.lblpay_group_code=new FingerLabel(host,"lblpay_group_code",0,15,100,20);$.lblpay_group_code.setText("급여체계코드");$.txtpay_group_code=new FingerEdit(host,"txtpay_group_code",105,15,140,20);$.lblpay_group_name=new FingerLabel(host,"lblpay_group_name",0,45,100,20);$.lblpay_group_name.setText("급여체계명");$.txtpay_group_name=new FingerEdit(host,"txtpay_group_name",105,45,600,20);$.lbldescr=new FingerLabel(host,"lbldescr",0,75,100,20);$.lbldescr.setText("메모");$.memodescr=new FingerMemoEdit(host,"memodescr",105,75,595,50);$.lblsort_seq=new FingerLabel(host,"lblsort_seq",0,135,100,20);$.lblsort_seq.setText("정렬순서");$.numsort_seq=new FingerSpinEdit(host,"numsort_seq",105,135,140,20);$.lbluse_yn=new FingerLabel(host,"lbluse_yn",250,135,100,20);$.lbluse_yn.setText("사용여부");$.chkuse_yn=new FingerCheckBox(host,"chkuse_yn",355,135,140,20);$.chkuse_yn.setText("사용");$.btnSearch=new FingerButton(host,"btnSearch",600,-40,95,30);$.btnSearch.setText("조회");$.stat1=new FingerEdit(host,"stat1",920,155,0,20);$.stat2=new FingerEdit(host,"stat2",920,155,0,20);$.stat3=new FingerEdit(host,"stat3",920,155,0,20);$.stat4=new FingerEdit(host,"stat4",920,155,0,20);$.panMain.setBorder(false);$.panList1.addButtons(["btnDelete","btnSave","btnNew"]);$.panList2.addButtons(["btnDelete","btnSave","btnAdd",]);$.txtpay_group_code.setAllowBlank(false,"급여체계코드");$.txtpay_group_name.setAllowBlank(false,"급여체계명");$.numsort_seq.setAllowBlank(false,"정렬순서");$.stat1.setVisible(false);$.stat2.setVisible(false);$.stat3.setVisible(false);$.stat4.setVisible(false);$.btnSearch.setVisible(false);$.grdMaster.setColumns([new FingerDataGridColumn("pay_group_code",100,"left","string","급여체계코드"),new FingerDataGridColumn("pay_group_name",95,"left","string","급여체계명"),new FingerDataGridColumn("use_yn",50,"center","checkbox","사용")]);$.grdMaster.init({panel:$.panMaster,scroll:"xy",nonExcel:true,isFilter:false});$.grdList2.setColumns([new FingerDataGridColumn("site_code",140,"left","string",{text:"사업장",css:"col_chk"}),new FingerDataGridColumn("pay_type",80,"left","string",{text:"지급구분",css:"col_chk"}),new FingerDataGridColumn("pay_day_month_type",100,"left","string",[{text:"급여일",css:"col_chk",colspan:2},{text:"급여월구분",css:"col_chk"}]),new FingerDataGridColumn("pay_day_dd",100,"left","string",["",{text:"급여일",css:"col_chk"}]),new FingerDataGridColumn("pay_start_month_type",100,"left","string",[{text:"급여산정기준",css:"col_chk",colspan:4},{text:"급여시작월구분",css:"col_chk"}]),new FingerDataGridColumn("pay_start_day_dd",100,"left","string",["",{text:"급여시작일",css:"col_chk"}]),new FingerDataGridColumn("pay_end_month_type",100,"left","string",["",{text:"급여종료월구분",css:"col_chk"}]),new FingerDataGridColumn("pay_end_day_dd",100,"left","string",["",{text:"급여종료일",css:"col_chk"}]),new FingerDataGridColumn("work_start_month_type",100,"left","string",[{text:"근태산정기준",css:"col_chk",colspan:4},{text:"근태시작월구분",css:"col_chk"}]),new FingerDataGridColumn("work_start_day_dd",100,"left","string",["",{text:"근태시작일",css:"col_chk"}]),new FingerDataGridColumn("work_end_month_type",100,"left","string",["",{text:"근태종료월구분",css:"col_chk"}]),new FingerDataGridColumn("work_end_day_dd",100,"left","string",["",{text:"근태종료일",css:"col_chk"}]),new FingerDataGridColumn("memo",250,"left","string","메모"),new FingerDataGridColumn("use_yn",100,"center","checkbox","사용")]);$.grdList2.init({panel:$.panList2,scroll:"xy",nonExcel:true,isFilter:false,eventCellReadOnly:true});$.grdList2.setEditable(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMaster);$.panMain.add($.panList1);$.panMain.add($.panList2);$.panMaster.add($.grdMaster);$.panList1.add($.lblpay_group_code);$.panList1.add($.txtpay_group_code);$.panList1.add($.lblpay_group_name);$.panList1.add($.txtpay_group_name);$.panList1.add($.lbldescr);$.panList1.add($.memodescr);$.panList1.add($.lblsort_seq);$.panList1.add($.numsort_seq);$.panList1.add($.lbluse_yn);$.panList1.add($.chkuse_yn);$.panList1.add($.btnSearch);$.panList1.add($.stat4);$.panList1.add($.stat1);$.panList1.add($.stat2);$.panList1.add($.stat3);$.panList2.add($.grdList2);QueryClick();var ds=bizComponentData2($,"Q1","L_ORG001|L_HRB008|L_HRB016|L_HRB005");$.grdList2.setColumnDropDownList("site_code",ds.resultList[0],{key:"site_code",name:"site_name"});$.grdList2.setColumnDropDownList("pay_type",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_day_month_type",ds.resultList[2],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_day_dd",ds.resultList[3],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_start_month_type",ds.resultList[2],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_start_day_dd",ds.resultList[3],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_end_month_type",ds.resultList[2],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("pay_end_day_dd",ds.resultList[3],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("work_start_month_type",ds.resultList[2],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("work_start_day_dd",ds.resultList[3],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("work_end_month_type",ds.resultList[2],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("work_end_day_dd",ds.resultList[3],{key:"sub_code",name:"code_name"})};$.callback=function(type,ds){if(type=="MASTER"){$.deleteRows=[];setDataGrid([$.grdMaster],ds);var rIdx=0;if($.pay_group_code){rIdx=$.grdMaster.getGridRowIndex("pay_group_code",$.pay_group_code)}$.pay_group_code="";$.grdMaster.selectRow(rIdx)}else{if(type=="DETAIL"){$.deleteRows=[];setDataGrid([null,$.grdList2],ds);var aRow=$.grdList2.getAllRows();for(var i in aRow){if($.grdList2.getRowStatus(i)=="N"){aRow[i].site_code_readonly=false;aRow[i].pay_type_readonly=false}else{aRow[i].site_code_readonly=true;aRow[i].pay_type_readonly=true}if(aRow[i].pay_type=="1"){$.stat1.setValue("1")}else{if(aRow[i].pay_type=="2"){$.stat2.setValue("2")}else{if(aRow[i].pay_type=="3"){$.stat3.setValue("3")}else{if(aRow[i].pay_type=="4"){$.stat4.setValue("4")}}}}}$.txtpay_group_code.setValue(ds.resultList[0][0].pay_group_code);$.txtpay_group_name.setValue(ds.resultList[0][0].pay_group_name);$.memodescr.setValue(ds.resultList[0][0].descr);$.numsort_seq.setValue(ds.resultList[0][0].sort_seq);$.chkuse_yn.setValue(ds.resultList[0][0].use_yn);$.grdList2.selectRow($.grdList2.getRowCount()-1)}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){QueryClick()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdMaster"){$.deleteRows=[];fnQRY_P_HRB5100_Q("DETAIL");$.txtpay_group_code.setReadOnly(true)}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList1"){if(btnId=="btnNew"){$.deleteRows=[];$.panList1.clear();$.grdList2.clear();$.chkuse_yn.setValue("Y");$.txtpay_group_code.setReadOnly(false)}else{if(btnId=="btnSave"){var strStatus="";if($.txtpay_group_code.getReadOnly()==false){strStatus="N"}else{strStatus="U"}fnSET_P_HRB5100_S(strStatus)}else{if(btnId=="btnDelete"){var rId=$.grdMaster.getSelectedRowIdx();confirmBoxShow($.grdMaster.getValue(rId,"pay_group_name")+"을(를) 정말 삭제하시겠습니까?",function(){if(g_main.msgShare==true){fnSET_P_HRB5100_S("D")}})}}}}else{if(panelId=="panList2"){if(btnId=="btnAdd"){$.grdList2.addRow();var aRow=$.grdList2.getAllRows();for(var i in aRow){if($.grdList2.getRowStatus(i)=="N"){aRow[i].site_code_readonly=false;aRow[i].pay_type_readonly=false;aRow[i].pay_day_month_type="";aRow[i].pay_day_dd="";aRow[i].pay_start_month_type="";aRow[i].pay_start_day_dd="";aRow[i].pay_end_month_type="";aRow[i].pay_end_day_dd="";aRow[i].work_start_month_type="";aRow[i].work_start_day_dd="";aRow[i].work_end_month_type="";aRow[i].work_end_day_dd="";aRow[i].memo="";aRow[i].use_yn="Y"}else{aRow[i].site_code_readonly=true;aRow[i].pay_type_readonly=true}}}else{if(btnId=="btnDelete"){$.grdList2.editStop();var rId=$.grdList2.getSelectedRowIdx();if(!rId){return}if($.grdList2.getRowStatus(rId)!="N"){confirmBoxShow("삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdList2.getItem(rId).rowType="D";$.deleteRows.push($.grdList2.getValue(rId));$.grdList2.deleteCurrentRow()}})}else{$.grdList2.deleteCurrentRow()}}else{if(btnId=="btnSave"){$.grdList2.editStop();for(var i=0;i<$.grdList2.getRowCount();i++){for(var j=i+1;j<$.grdList2.getRowCount();j++){if($.grdList2.getValue(i,"pay_type")==$.grdList2.getValue(j,"pay_type")){MessageBoxShow("동일한 급여체계 내에서 중복된 사업장별 지급구분이 존재합니다.");return}}}fnSet_P_HRB5100_S1("")}}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>