<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panSummary=null;$.grdSummary=null;$.rdoView=null;$.panTotal=null;$.grdTotal=null;$.btnSearch=null;$.cmb_product=null;$.lbl_product=null;$.lbl_half=null;$.cmb_half=null;$.lbl_Ex1=null;$.cmb_half1=null;$.btnExpand=null;$.lbl_Ex2=null;$.total_h=445;$.total_w=1200;$.total_x=0;$.total_y=0;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmDailySales_Q",[workType,$.cmb_half.getValue(),$.cmb_half1.getValue(),$.cmb_product.getValue()||""]);return json}function searchData(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function dayChk(ym,day){var yy=ym.substr(0,4);var mm=ym.substr(4,2);var dd=day;var d=new Date(yy,mm-1,dd);if(d.getDay()==3){return true}else{return false}}function cellColor(value,obj,rId,colId){var key=Object.keys(obj);for(var i=0;i<key.length;i++){if(key[i]=="lv"&&obj[key[i]]==1){var ym=obj.ym;var day=obj[colId];if(day&&dayChk(ym,day)){return{"font-weight":"bold",color:"red !important"}}}}return}function columnNameChange(colId){var name=$.cmb_half1.getValue();var str="FY"+name.substr(2,2)+" Target";$.grdSummary.setColumnText(colId,str)}function radioChange(value){switch(value){case"S":$.panSummary.setVisible(true);$.panTotal.setVisible(false);break;case"T":$.panSummary.setVisible(false);$.panTotal.setVisible(true);$.total_x=0;$.total_y=65;$.panTotal.setProperty($.total_x,$.total_y,$.total_w,$.total_h);break;case"B":$.panSummary.setVisible(true);$.panTotal.setVisible(true);$.total_x=0;$.total_y=525;$.panTotal.setProperty($.total_x,$.total_y,$.total_w,$.total_h);break}}function exportToExcel(){var column=[{headertext:"ym_disp",datatype:"string",datafield:"ym_disp",width:"70px",headerHidden:true},{headertext:"r01",datatype:"int",datafield:"r01",width:"50px",headerHidden:true},{headertext:"r02",datatype:"int",datafield:"r02",width:"50px",headerHidden:true},{headertext:"r03",datatype:"int",datafield:"r03",width:"50px",headerHidden:true},{headertext:"r04",datatype:"int",datafield:"r04",width:"50px",headerHidden:true},{headertext:"r05",datatype:"int",datafield:"r05",width:"50px",headerHidden:true},{headertext:"r06",datatype:"int",datafield:"r06",width:"50px",headerHidden:true},{headertext:"r07",datatype:"int",datafield:"r07",width:"50px",headerHidden:true},{headertext:"r08",datatype:"int",datafield:"r08",width:"50px",headerHidden:true},{headertext:"r09",datatype:"int",datafield:"r09",width:"50px",headerHidden:true},{headertext:"r10",datatype:"int",datafield:"r10",width:"50px",headerHidden:true},{headertext:"r11",datatype:"int",datafield:"r11",width:"50px",headerHidden:true},{headertext:"r12",datatype:"int",datafield:"r12",width:"50px",headerHidden:true},{headertext:"r13",datatype:"int",datafield:"r13",width:"50px",headerHidden:true},{headertext:"r14",datatype:"int",datafield:"r14",width:"50px",headerHidden:true},{headertext:"r15",datatype:"int",datafield:"r15",width:"50px",headerHidden:true},{headertext:"r16",datatype:"int",datafield:"r16",width:"50px",headerHidden:true},{headertext:"r17",datatype:"int",datafield:"r17",width:"50px",headerHidden:true},{headertext:"r18",datatype:"int",datafield:"r18",width:"50px",headerHidden:true},{headertext:"r19",datatype:"int",datafield:"r19",width:"50px",headerHidden:true},{headertext:"r20",datatype:"int",datafield:"r20",width:"50px",headerHidden:true},{headertext:"r21",datatype:"int",datafield:"r21",width:"50px",headerHidden:true},{headertext:"r22",datatype:"int",datafield:"r22",width:"50px",headerHidden:true},{headertext:"r23",datatype:"int",datafield:"r23",width:"50px",headerHidden:true},{headertext:"landing",datatype:"string",datafield:"landing",width:"70px",headerHidden:true}];var data=$.grdTotal.getAllRows();for(var i in data){if(data[i].ym_disp){data[i].ym_disp=data[i].ym_disp.replace("(","").replace(")","")}}excelDown(data,column,"Daily Sales")}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1840);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panSummary=new FingerPanel(host,"panSummary",0,65,1200,450);$.panSummary.setText("Summary");$.panSummary.setBottomLine(true);$.grdSummary=new FingerDataGrid(host,"grdSummary",0,0,1200,405);$.rdoView=new FingerRadioBox(host,"rdoView",780,75,255,20);$.panTotal=new FingerPanel(host,"panTotal",0,525,1200,445);$.panTotal.setText("Total");$.panTotal.setBottomLine(true);$.grdTotal=new FingerDataGrid(host,"grdTotal",0,0,1200,400);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.cmb_product=new FingerComboBox(host,"cmb_product",480,15,140,20);$.lbl_product=new FingerLabel(host,"lbl_product",375,15,100,20);$.lbl_product.setText("품목");$.lbl_half=new FingerLabel(host,"lbl_half",0,15,100,20);$.lbl_half.setText("반기");$.cmb_half=new FingerComboBox(host,"cmb_half",105,15,140,20);$.lbl_Ex1=new FingerLabel(host,"lbl_Ex1",240,15,20,20);$.lbl_Ex1.setText("~");$.cmb_half1=new FingerComboBox(host,"cmb_half1",265,15,140,20);$.btnExpand=new FingerButton(host,"btnExpand",1040,-40,90,30);$.btnExpand.setText("확대보기");$.lbl_Ex2=new FingerLabel(host,"lbl_Ex2",1005,-37,100,20);$.lbl_Ex2.setText("단위 (백만원)");$.panQuery.setBorder(true);$.panTotal.setBorder(true);$.panTotal.addButton("btnExcelDown","엑셀다운로드");$.panTotal.setButtonAction("btnExcelDown","excel_down");$.rdoView.addButtons([{code_name:"Summary",sub_code:"S"},{code_name:"Total",sub_code:"T"},{code_name:"Both",sub_code:"B"}]);$.cmb_product.setEmptyRow(true);$.cmb_half.setEmptyRow(true);$.cmb_half1.setEmptyRow(true);$.cmb_half.setAllowBlank(false,"시작반기");$.cmb_half1.setAllowBlank(false,"종료반기");$.btnExpand.setVisible(false);$.grdSummary.setColumns([new FingerDataGridColumn("product_name",133,"left","string",""),new FingerDataGridColumn("Target",250,"right","int","Target",{format:"int"}),new FingerDataGridColumn("Month",250,"right","int","Month",{format:"int"}),new FingerDataGridColumn("Month_rate",150,"right","int","%",{format:"percent_2"}),new FingerDataGridColumn("YTD",250,"right","int","YTD",{format:"int"}),new FingerDataGridColumn("YTD_rate",150,"right","int","%",{format:"percent_2"})]);$.grdSummary.init({scroll:"xy"});$.grdSummary.setBorder(false);$.grdTotal.setColumns([new FingerDataGridColumn("yh",0,"left","string","",{hidden:true}),new FingerDataGridColumn("yh_disp",0,"left","string","yh_disp",{hidden:true}),new FingerDataGridColumn("ym_disp",52,"left","string","ym_disp",{template:function(obj,common){if(obj.$group){return common.treetable(obj,common)+obj.value}return obj.ym_disp}}),new FingerDataGridColumn("r01",51,"right","string","r01",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r02",51,"right","string","r02",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r03",51,"right","string","r03",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r04",51,"right","string","r04",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r05",51,"right","string","r05",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r06",51,"right","string","r06",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r07",51,"right","string","r07",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r08",51,"right","string","r08",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r09",51,"right","string","r09",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r10",51,"right","string","r10",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r11",51,"right","string","r11",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r12",51,"right","string","r12",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r13",51,"right","string","r13",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r14",51,"right","string","r14",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r15",51,"right","string","r15",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r16",51,"right","string","r16",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r17",51,"right","string","r17",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r18",51,"right","string","r18",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r19",51,"right","string","r19",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r20",51,"right","string","r20",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r21",51,"right","string","r21",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r22",51,"right","string","r22",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("r23",51,"right","string","r23",{format:"int",cssFormat:cellColor}),new FingerDataGridColumn("landing",60,"right","string","Landing"),new FingerDataGridColumn("lv",100,"left","string","lv",{hidden:true}),new FingerDataGridColumn("yh",100,"left","string","yh",{hidden:true}),new FingerDataGridColumn("ym",100,"left","string","ym",{hidden:true})]);$.grdTotal.init({header:false,isFilter:false,scroll:"xy",view:"grouptable",scheme:{$group:"yh_disp"}});$.grdTotal.setBorder(false);$.grdTotal.setStyle("font-size","12px");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panSummary);$.panMain.add($.panQuery);$.panMain.add($.rdoView);$.panMain.add($.panTotal);$.panQuery.add($.btnSearch);$.panQuery.add($.cmb_product);$.panQuery.add($.lbl_product);$.panQuery.add($.lbl_half);$.panQuery.add($.cmb_half);$.panQuery.add($.cmb_half1);$.panQuery.add($.lbl_Ex1);$.panSummary.add($.grdSummary);$.panTotal.add($.grdTotal);$.panTotal.add($.btnExpand);$.panTotal.add($.lbl_Ex2);$.cmb_half.setColumn("half_code","half_name");$.cmb_half1.setColumn("half_code","half_name");$.cmb_product.setColumn("product_code","product_name");var ds=bizComponentData2($,"Q1","L_CRM0008_2|L_CRM0008_2|L_CRM0059");setComboBind([$.cmb_half,$.cmb_half1,$.cmb_product],ds);$.cmb_half.setValue(ds.resultList[0][0].half_code);$.cmb_half1.setValue(ds.resultList[0][0].half_code);$.rdoView.setValue("B");radioChange($.rdoView.getValue());$.fingerbutton_click("btnSearch")};$.callback=function(type,ds){if(type=="Q_SUMMARY"){setDataGrid([$.grdSummary],ds)}else{if(type=="Q_TOTAL"){var grdRs=ds.resultList[0];if(grdRs.length>0){var len=grdRs.length/12;$.total_h=478+(417*(len-1));if($.total_h>1400){$.total_h=1310}$.panTotal.setProperty($.total_x,$.total_y,$.total_w,$.total_h);$.grdTotal.setSize($.total_w,$.total_h-45)}setDataGrid([$.grdTotal],ds);$.grdTotal.openNode("all");for(var i=0;i<$.grdTotal.getRowCount();i++){var row=$.grdTotal.getValue(i);if(row.$group){$.grdTotal.addSpan(row.id,"ym_disp",23,1,null,"highlight")}}if(ds&&ds.resultList[1].length){var rs=ds.resultList[1][0];var key=Object.keys(rs);for(var i=0;i<key.length;i++){if(rs[key[i]]=="Y"){$.grdTotal.setColumnHidden(key[i].split("_")[0],true)}else{$.grdTotal.setColumnHidden(key[i].split("_")[0],false)}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!$.panQuery.validateControls()){return}if(Number($.cmb_half.getValue())>Number($.cmb_half1.getValue())){MessageBoxShow("종료반기가 시작반기보다 빠릅니다.");return}columnNameChange("Target");searchData("Q_TOTAL");searchData("Q_SUMMARY")}else{if(id=="btnExpand"){if($.grdTotal.getRowCount()<1){return}$.popUpCallId=id;var param={data:$.grdTotal.getAllRows()};g_main.openPopup("popDailySalesTotal.html","popDailySalesTotal","Total",1927,1255,"","",param,"","")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panTotal"){if(btnId=="btnExcelDown"){exportToExcel()}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){if(id=="rdoView"){radioChange(value)}};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>