<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panWFGeneralProc=null;$.panNonCalculateReceipt=null;$.panBoard=null;$.panWeekSchedule=null;$.schWeek=null;$.panType=null;$.lblC1=null;$.lblC2=null;$.lblC3=null;$.lblC4=null;$.lblC5=null;$.lblC6=null;$.chkType1=null;$.chkType2=null;$.chkType3=null;$.chkType4=null;$.chkType5=null;$.chkType6=null;$.lblApproveCnt=null;$.lblDraftCnt=null;$.btnWfDetail=null;$.lblCardBillCnt=null;$.lblElectronicTaxCnt=null;$.lblDeliveryBillCnt=null;$.lbllblDeliveryElectronicTaxCnt=null;$.btnNonCalcDetail=null;function createJSON_Q(workType){var type=[];if($.chkType1.getValue()=="Y"){type.push("10")}if($.chkType2.getValue()=="Y"){type.push("20")}if($.chkType3.getValue()=="Y"){type.push("30")}if($.chkType4.getValue()=="Y"){type.push("40")}if($.chkType5.getValue()=="Y"){type.push("50")}if($.chkType6.getValue()=="Y"){type.push("60")}var sType="";for(var i=0;i<type.length;i++){sType+=((sType!=""?",":"")+type[i])}var json=createExecuteParamInfo("P_crmCalendarManage_Q",[workType,"",sType,$.calStart,$.calEnd]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_Dashboard_Q",[workType,"#UserID#"]);return json}function searchWeekSchedule(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function searchMain(workType){var json=createJSON_Q2(workType);callQuery(["req",json],workType,$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,760);$.panMain.setText("");$.panMain.setBottomLine(true);$.panWFGeneralProc=new FingerPanel(host,"panWFGeneralProc",0,0,300,300);$.panWFGeneralProc.setText("결재함/기안함");$.panWFGeneralProc.setBottomLine(true);$.panNonCalculateReceipt=new FingerPanel(host,"panNonCalculateReceipt",310,0,300,300);$.panNonCalculateReceipt.setText("미정산영수증");$.panNonCalculateReceipt.setBottomLine(true);$.panBoard=new FingerPanel(host,"panBoard",620,0,580,300);$.panBoard.setText("게시판 최신글");$.panBoard.setBottomLine(true);$.panWeekSchedule=new FingerPanel(host,"panWeekSchedule",0,310,1200,450);$.panWeekSchedule.setText("주간일정표");$.panWeekSchedule.setBottomLine(true);$.schWeek=new FingerScheduler(host,"schWeek","workweek",["30"],[],0,35,1200,370);$.panType=new FingerPanel(host,"panType",255,0,605,40);$.panType.setText("");$.panType.setBottomLine(true);$.lblC1=new FingerLabel(host,"lblC1",75,13,15,15);$.lblC1.setText("");$.lblC2=new FingerLabel(host,"lblC2",220,13,15,15);$.lblC2.setText("");$.lblC3=new FingerLabel(host,"lblC3",305,13,15,15);$.lblC3.setText("");$.lblC4=new FingerLabel(host,"lblC4",380,13,15,15);$.lblC4.setText("");$.lblC5=new FingerLabel(host,"lblC5",460,13,15,15);$.lblC5.setText("");$.lblC6=new FingerLabel(host,"lblC6",555,13,15,15);$.lblC6.setText("");$.chkType1=new FingerCheckBox(host,"chkType1",0,10,70,20);$.chkType1.setText("연간일정");$.chkType2=new FingerCheckBox(host,"chkType2",100,10,115,20);$.chkType2.setText("전사휴가/공휴일");$.chkType3=new FingerCheckBox(host,"chkType3",245,10,55,20);$.chkType3.setText("비뇨기");$.chkType4=new FingerCheckBox(host,"chkType4",330,10,45,20);$.chkType4.setText("내과");$.chkType5=new FingerCheckBox(host,"chkType5",400,10,55,20);$.chkType5.setText("개업의");$.chkType6=new FingerCheckBox(host,"chkType6",480,10,70,20);$.chkType6.setText("면역영업");$.lblApproveCnt=new FingerLabel(host,"lblApproveCnt",0,95,100,20);$.lblApproveCnt.setText("");$.lblDraftCnt=new FingerLabel(host,"lblDraftCnt",130,95,100,20);$.lblDraftCnt.setText("");$.btnWfDetail=new FingerButton(host,"btnWfDetail",80,200,180,20);$.btnWfDetail.setText("자세히 보기");$.lblCardBillCnt=new FingerLabel(host,"lblCardBillCnt",0,75,100,20);$.lblCardBillCnt.setText("");$.lblElectronicTaxCnt=new FingerLabel(host,"lblElectronicTaxCnt",130,75,100,20);$.lblElectronicTaxCnt.setText("");$.lblDeliveryBillCnt=new FingerLabel(host,"lblDeliveryBillCnt",0,135,100,20);$.lblDeliveryBillCnt.setText("");$.lbllblDeliveryElectronicTaxCnt=new FingerLabel(host,"lbllblDeliveryElectronicTaxCnt",130,135,100,20);$.lbllblDeliveryElectronicTaxCnt.setText("");$.btnNonCalcDetail=new FingerButton(host,"btnNonCalcDetail",80,200,180,20);$.btnNonCalcDetail.setText("자세히 보기");$.schWeek.setBasicWeek(true);$.lblC1.setStyle("backgroundColor","#C4B73B");$.lblC2.setStyle("backgroundColor","tomato");$.lblC3.setStyle("backgroundColor","limegreen");$.lblC4.setStyle("backgroundColor","skyblue");$.lblC5.setStyle("backgroundColor","goldenrod");$.lblC6.setStyle("backgroundColor","#868da9");$.chkType1.setValue("Y");$.chkType2.setValue("Y");$.chkType3.setValue("Y");$.chkType4.setValue("Y");$.chkType5.setValue("Y");$.chkType6.setValue("Y");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panWFGeneralProc);$.panMain.add($.panNonCalculateReceipt);$.panMain.add($.panBoard);$.panMain.add($.panWeekSchedule);$.panWFGeneralProc.add($.lblApproveCnt);$.panWFGeneralProc.add($.lblDraftCnt);$.panWFGeneralProc.add($.btnWfDetail);$.panNonCalculateReceipt.add($.lblCardBillCnt);$.panNonCalculateReceipt.add($.lblElectronicTaxCnt);$.panNonCalculateReceipt.add($.lblDeliveryBillCnt);$.panNonCalculateReceipt.add($.lbllblDeliveryElectronicTaxCnt);$.panNonCalculateReceipt.add($.btnNonCalcDetail);$.panWeekSchedule.add($.schWeek);$.panWeekSchedule.add($.panType);$.panType.add($.lblC1);$.panType.add($.lblC2);$.panType.add($.lblC3);$.panType.add($.lblC4);$.panType.add($.lblC5);$.panType.add($.lblC6);$.panType.add($.chkType1);$.panType.add($.chkType2);$.panType.add($.chkType3);$.panType.add($.chkType4);$.panType.add($.chkType5);$.panType.add($.chkType6);searchMain("WFCOUNT");searchMain("CARDCOUNT")};$.callback=function(type,ds){if(type=="WEEK"){$.schWeek.removeEvents();$.schWeek.addEventSource(ds.resultList[0]);$.varEvents=ds.resultList[0]}else{if(type=="WFCOUNT"){$.lblApproveCnt.setText(ds.resultList[0][0].approve_cnt);$.lblDraftCnt.setText(ds.resultList[0][0].draft_cnt)}else{if(type=="CARDCOUNT"){log(ds);$.lblCardBillCnt.setText(ds.resultList[0][0].cardBill_cnt);$.lblElectronicTaxCnt.setText(ds.resultList[0][0].electronictax_cnt);$.lblDeliveryBillCnt.setText(ds.resultList[0][0].deliverybill_cnt);$.lbllblDeliveryElectronicTaxCnt.setText(ds.resultList[0][0].deliveryelectronictax_cnt)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnWfDetail"){var param={wf_doc_id:""};g_main.openModelWithBusiness("crmWFGeneralProc",param)}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){searchWeekSchedule("WEEK")};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){log("4");if(id=="schWeek"){$.calStart=JSON.stringify($.schWeek.extObj.fullCalendar("getView").start).substr(1,10);$.calEnd=JSON.stringify($.schWeek.extObj.fullCalendar("getView").end).substr(1,10);$.calStart=moment($.calStart).format("YYYYMMDD");$.calEnd=moment($.calEnd).format("YYYYMMDD");searchWeekSchedule("WEEK")}};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){if(id=="schWeek"){$.calStart=moment(view.start).format("YYYYMMDD");$.calEnd=moment(view.end).format("YYYYMMDD");if(view.type=="basicWeek"){searchWeekSchedule("WEEK")}}};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>