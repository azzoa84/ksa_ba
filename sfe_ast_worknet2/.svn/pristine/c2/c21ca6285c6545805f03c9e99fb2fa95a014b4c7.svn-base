<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.panList=null;$.grdList=null;$.panDetail=null;$.grdFile=null;$.grdDoc=null;$.lbl_company_name=null;$.bte_company_name=null;$.lbl_address1=null;$.txt_address1=null;$.lbl_business_no=null;$.txt_business_no=null;$.lbl_company_phone=null;$.txt_company_phone=null;$.lbl_EditEx4=null;$.txt_EditEx4=null;$.lbl_Ex1=null;$.txt_EditEx2=null;$.cmb_EditEx3=null;$.lbl_Ex2=null;$.lbl_dept=null;$.cmb_dept=null;$.lbl_employee=null;$.cmb_employee=null;$.lbl_sale_date1=null;$.dte_sale_date1=null;$.txt_EditEx1=null;$.txt_company_nameChange=null;$.txt_businessChange=null;$.txt_company_id=null;$.txt_address2=null;$.txt_product_code=null;$.txt_dept_code=null;$.txt_employee_id=null;$.txt_EditEx1Change=null;$.txt_EditEx2Change=null;$.txt_EditEx3Change=null;$.txt_flag=null;$.txt_product_codeChange=null;$.txt_employee_idChange=null;$.txt_dept_codeChange=null;$.txt_EditEx5=null;$.txt_EditEx6=null;$.companychange="N";$.bizExcompany_id="";$.bizExcompany_name="";$.varWfDocId="";$.varBusinessId="";$.varOriginWfDocId="";$.varWFType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFCompanyOS"]);return json}function createJSON_S(workType){var gRow=$.grdList.getAllRows();var rows=[];for(var i in gRow){rows.push(["N",gRow[i].seq?Number(gRow[i].seq):"",$.varWfDocId,gRow[i].company_id||"",gRow[i].company_name||"",gRow[i].address1||"",gRow[i].product_code||"",gRow[i].employee_id||"",gRow[i].dept_code||"",gRow[i].employee_id2||"",gRow[i].dept_code2||"",gRow[i].start_date||"",gRow[i].sidogu_code||"",gRow[i].business_no||""])}log(rows);var json=createExecuteParamInfo("P_crmWFCompanyOS_S",rows);return json}function createJSON_S1(workType){var json=createExecuteParamInfo("P_crmcompanynew_check_S",[workType,$.txt_flag.getValue()||""]);return json}function searchWFDocument(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveWFCompanyOS(workType){var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],workType,$,false);log(ds);if(ds){return true}}function companyCheck(workType){var json=createJSON_S1(workType);var ds=callExecuteSync(["req",json],workType,$,false);log(ds);if(ds){return true}else{return false}}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function moveWFGeneralProc(){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}function initControl(){$.lbl_Ex1.setAlign("center");$.lbl_Ex2.setAlign("center");$.lbl_sale_date1.setAlign("center");$.txt_address1.setReadOnly(true);$.txt_EditEx4.setReadOnly(true);$.txt_company_phone.setReadOnly(true);$.txt_EditEx1.setReadOnly(true);$.txt_EditEx2.setReadOnly(true);$.txtTitle.setReadOnly(true);$.cmb_EditEx3.setEmptyRow(true);$.cmb_employee.setEmptyRow(true);$.cmb_dept.setEmptyRow(true);$.cmb_EditEx3.setColumn("product_code","product_name");$.cmb_employee.setColumn("employee_id","emp_name");$.cmb_dept.setColumn("dept_code","dept_name");$.cmb_EditEx3.setColumnConfig([{id:"product_code",width:100},{id:"product_name",width:100}]);$.txtTitle.setAllowBlank(false,"문서제목");$.bte_company_name.setAllowBlank(false,"거래처명");$.txt_business_no.setAllowBlank(false,"사업자번호");$.cmb_EditEx3.setAllowBlank(false,"품목");$.cmb_dept.setAllowBlank(false,"부서");$.cmb_employee.setAllowBlank(false,"이름");$.dte_sale_date1.setAllowBlank(false,"시작 일자");$.btnTmpSave.setEnable(false);$.txt_company_nameChange.setVisible(false);$.txt_businessChange.setVisible(false);$.txt_company_id.setVisible(false);$.txt_address2.setVisible(false);$.txt_product_code.setVisible(false);$.txt_dept_code.setVisible(false);$.txt_employee_id.setVisible(false);$.txt_EditEx1Change.setVisible(false);$.txt_EditEx2Change.setVisible(false);$.txt_EditEx3Change.setVisible(false);$.txt_flag.setVisible(false);$.txt_product_codeChange.setVisible(false);$.txt_employee_idChange.setVisible(false);$.txt_dept_codeChange.setVisible(false);$.txt_EditEx5.setVisible(false);$.txt_EditEx6.setVisible(false);$.session=g_main.session.obj}function bizComponentDataBinding(){var ds=bizComponentData2($,"Q1","L_CRM0040|L_CRM258|L_CRM195_1");setComboBind([$.cmb_EditEx3,$.cmb_employee,$.cmb_dept],ds);$.grdList.setColumnDropDownList("product_name",ds.resultList[0],{key:"product_code",name:"product_name"});$.grdList.setColumnDropDownList("dept_name2",ds.resultList[2],{key:"dept_code",name:"dept_name"});$.grdList.setColumnDropDownList("emp_name2",ds.resultList[1],{key:"employee_id",name:"emp_name"})}function business_no_Change(value){if(!value){return}if(value.length==3||value.length==6){var strbiz_no=value+"-";$.txt_business_no.setValue(strbiz_no)}$.companychange="Y"}function company_name_Change(){$.companychange="Y"}function dept_Change(value){if(!value){$.cmb_employee.setValue("");$.cmb_employee.setEnable(false);return}$.cmb_employee.clear();$.cmb_employee.setEnable(true);var subQuery=" and dept_code = '"+value+"'";var ds=bizComponentData2($,"Q4","L_CRM258",subQuery);setComboBind([$.cmb_employee],ds);$.txt_EditEx5.setValue(value)}function employee_Change(value){$.txt_EditEx6.setValue(value)}function editEx3_Change(value){if(!value){return}$.txt_product_code.setValue(value)}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1115);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFDetail=new FingerPanel(host,"panWFDetail",0,520,1200,285);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,815,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,815,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,210);$.panList=new FingerPanel(host,"panList",0,260,1200,250);$.panList.setText("기안목록");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,205);$.panDetail=new FingerPanel(host,"panDetail",0,65,1200,185);$.panDetail.setText("거래처 정보");$.panDetail.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,235);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,235);$.lbl_company_name=new FingerLabel(host,"lbl_company_name",0,10,100,20);$.lbl_company_name.setText("거래처명");$.bte_company_name=new FingerButtonEdit(host,"bte_company_name",105,10,370,20);$.bte_company_name.setText("");$.lbl_address1=new FingerLabel(host,"lbl_address1",0,40,100,20);$.lbl_address1.setText("주소");$.txt_address1=new FingerEdit(host,"txt_address1",105,40,373,20);$.lbl_business_no=new FingerLabel(host,"lbl_business_no",0,70,100,20);$.lbl_business_no.setText("사업자번호");$.txt_business_no=new FingerEdit(host,"txt_business_no",105,70,140,20);$.lbl_company_phone=new FingerLabel(host,"lbl_company_phone",230,70,100,20);$.lbl_company_phone.setText("전화번호");$.txt_company_phone=new FingerEdit(host,"txt_company_phone",335,70,144,20);$.lbl_EditEx4=new FingerLabel(host,"lbl_EditEx4",0,100,100,20);$.lbl_EditEx4.setText("시도구 코드");$.txt_EditEx4=new FingerEdit(host,"txt_EditEx4",105,100,140,20);$.lbl_Ex1=new FingerLabel(host,"lbl_Ex1",530,15,140,20);$.lbl_Ex1.setText("현재 담당자");$.txt_EditEx2=new FingerEdit(host,"txt_EditEx2",530,70,140,20);$.cmb_EditEx3=new FingerComboBox(host,"cmb_EditEx3",530,100,145,20);$.lbl_Ex2=new FingerLabel(host,"lbl_Ex2",750,15,140,20);$.lbl_Ex2.setText("변경 담당자");$.lbl_dept=new FingerLabel(host,"lbl_dept",645,40,100,20);$.lbl_dept.setText("부서");$.cmb_dept=new FingerComboBox(host,"cmb_dept",750,40,145,20);$.lbl_employee=new FingerLabel(host,"lbl_employee",645,70,100,20);$.lbl_employee.setText("이름");$.cmb_employee=new FingerComboBox(host,"cmb_employee",750,70,145,20);$.lbl_sale_date1=new FingerLabel(host,"lbl_sale_date1",945,15,140,20);$.lbl_sale_date1.setText("시작일자");$.dte_sale_date1=new FingerDateEdit(host,"dte_sale_date1",945,55,140,20);$.txt_EditEx1=new FingerEdit(host,"txt_EditEx1",530,40,140,20);$.txt_company_nameChange=new FingerEdit(host,"txt_company_nameChange",945,90,20,20);$.txt_businessChange=new FingerEdit(host,"txt_businessChange",970,90,20,20);$.txt_company_id=new FingerEdit(host,"txt_company_id",995,90,20,20);$.txt_address2=new FingerEdit(host,"txt_address2",1120,60,20,20);$.txt_product_code=new FingerEdit(host,"txt_product_code",1095,60,20,20);$.txt_dept_code=new FingerEdit(host,"txt_dept_code",1170,90,20,20);$.txt_employee_id=new FingerEdit(host,"txt_employee_id",1020,90,20,20);$.txt_EditEx1Change=new FingerEdit(host,"txt_EditEx1Change",505,40,20,20);$.txt_EditEx2Change=new FingerEdit(host,"txt_EditEx2Change",505,70,20,20);$.txt_EditEx3Change=new FingerEdit(host,"txt_EditEx3Change",505,100,20,20);$.txt_flag=new FingerEdit(host,"txt_flag",640,10,20,20);$.txt_product_codeChange=new FingerEdit(host,"txt_product_codeChange",1145,90,20,20);$.txt_employee_idChange=new FingerEdit(host,"txt_employee_idChange",1120,90,20,20);$.txt_dept_codeChange=new FingerEdit(host,"txt_dept_codeChange",1095,90,20,20);$.txt_EditEx5=new FingerEdit(host,"txt_EditEx5",1070,90,20,20);$.txt_EditEx6=new FingerEdit(host,"txt_EditEx6",1045,90,20,20);$.panTitle.setBorder(true);$.panList.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);initControl();$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("company_name",140,"left","string","거래처명"),new FingerDataGridColumn("sidogu_code",100,"left","string","시도구코드"),new FingerDataGridColumn("business_no",100,"left","string","사업자번호"),new FingerDataGridColumn("address1",120,"left","string","주소"),new FingerDataGridColumn("product_name",100,"left","string","품목명"),new FingerDataGridColumn("dept_name",120,"left","string","인계 담당부서"),new FingerDataGridColumn("emp_name",100,"left","string","인계 담당자"),new FingerDataGridColumn("",60,"left","string","====>"),new FingerDataGridColumn("dept_name2",120,"left","string","인수 부서"),new FingerDataGridColumn("emp_name2",100,"left","string","인수 담당자"),new FingerDataGridColumn("start_date",140,"left","date","시작일자(매월 1일)",{format:"s_ymd"}),new FingerDataGridColumn("employee_id",100,"left","string","인계담당자id"),new FingerDataGridColumn("dept_code",100,"left","string","인계담당자dept"),new FingerDataGridColumn("employee_id2",100,"left","string","인수담당자id"),new FingerDataGridColumn("dept_code2",100,"left","string","인수담당자dept"),new FingerDataGridColumn("company_id",0,"left","string","거래처코드",{hidden:true}),new FingerDataGridColumn("zip_code",0,"left","string","우편번호",{hidden:true}),new FingerDataGridColumn("address2",0,"left","string","주소2",{hidden:true}),new FingerDataGridColumn("company_phone",0,"left","string","거래처전화",{hidden:true}),new FingerDataGridColumn("approve_bed",0,"left","string","허가병상",{hidden:true}),new FingerDataGridColumn("main_speciality",0,"left","string","대표진료과목",{hidden:true}),new FingerDataGridColumn("company_remark",0,"left","string","거래처특이사항",{hidden:true}),new FingerDataGridColumn("office_phone",0,"left","string","회사전화번호",{hidden:true}),new FingerDataGridColumn("job_start_date",0,"left","string","근무시작일",{hidden:true}),new FingerDataGridColumn("influence_code",0,"left","string","원내영향력",{hidden:true}),new FingerDataGridColumn("contact_remark",0,"left","string","고객특이사항",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","순번",{hidden:true}),new FingerDataGridColumn("product_code",0,"left","string","품목코드",{hidden:true})]);$.grdList.init({panel:$.panList,nonExcel:true,isFilter:false,scroll:"xy"});$.grdList.setEditable(false);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panList);$.panMain.add($.panDetail);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.panList.add($.grdList);$.panDetail.add($.dte_sale_date1);$.panDetail.add($.lbl_sale_date1);$.panDetail.add($.cmb_employee);$.panDetail.add($.lbl_employee);$.panDetail.add($.cmb_dept);$.panDetail.add($.lbl_dept);$.panDetail.add($.lbl_Ex2);$.panDetail.add($.cmb_EditEx3);$.panDetail.add($.txt_EditEx2);$.panDetail.add($.lbl_Ex1);$.panDetail.add($.txt_EditEx4);$.panDetail.add($.lbl_EditEx4);$.panDetail.add($.txt_company_phone);$.panDetail.add($.lbl_company_phone);$.panDetail.add($.txt_business_no);$.panDetail.add($.lbl_business_no);$.panDetail.add($.txt_address1);$.panDetail.add($.lbl_address1);$.panDetail.add($.bte_company_name);$.panDetail.add($.lbl_company_name);$.panDetail.add($.txt_EditEx1);$.panDetail.add($.txt_EditEx6);$.panDetail.add($.txt_EditEx5);$.panDetail.add($.txt_dept_codeChange);$.panDetail.add($.txt_employee_idChange);$.panDetail.add($.txt_product_codeChange);$.panDetail.add($.txt_flag);$.panDetail.add($.txt_EditEx3Change);$.panDetail.add($.txt_EditEx2Change);$.panDetail.add($.txt_EditEx1Change);$.panDetail.add($.txt_employee_id);$.panDetail.add($.txt_dept_code);$.panDetail.add($.txt_product_code);$.panDetail.add($.txt_address2);$.panDetail.add($.txt_company_id);$.panDetail.add($.txt_businessChange);$.panDetail.add($.txt_company_nameChange);bizComponentDataBinding();searchWFDocument("Q3")};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue("OS 신규/인수인계등록("+$.session.DeptName+"/ "+$.session.EmpName+")")}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];console.log(args);if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var data=args[6];if(data){setDataGrid([$.grdList],args[6],true)}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!validateControls([$.txtTitle])){return}if($.grdList.getRowCount()<1){MessageBoxShow("저장할 내용이 없습니다.");return}var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFCompanyOS"};g_main.openPopup("popModAppr.html","popModAppr","결재라인 지정",0,0,"","",param,"","")}else{if(id=="btnTmpSave"){if($.grdList.getRowCount()<1){MessageBoxShow("저장할 내용이 없습니다.")}if(saveWFDocument("","N")){if(saveWFCompanyOS("N")){moveWFGeneralProc()}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bte_company_name"){var param={company_name:$.bte_company_name.getText()||"",};g_main.openPopup("popCompanyOS.html","popCompanyOS","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmb_dept"){dept_Change(value)}else{if(id=="cmb_employee"){employee_Change(value)}else{if(id=="cmb_EditEx3"){editEx3_Change(value)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="txt_business_no"){business_no_Change(value)}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnAdd"){if(!$.panDetail.validateControls()){return}if($.txt_business_no.getValue().length!=12){MessageBoxShow("");$.txt_business_no.setFocus();return}$.grdList.addRow({company_id:$.txt_company_id.getValue(),company_name:$.bte_company_name.getText(),address1:$.txt_address1.getValue(),business_no:$.txt_business_no.getValue(),product_name:$.cmb_EditEx3.getValue(),sidogu_code:$.txt_EditEx4.getValue(),dept_name2:$.cmb_dept.getValue(),emp_name2:$.cmb_employee.getValue(),start_date:$.dte_sale_date1.getValue(),dept_code:$.txt_dept_code.getValue(),employee_id:$.txt_employee_id.getValue(),product_code:$.txt_product_code.getValue(),employee_id2:$.txt_EditEx6.getValue(),dept_code2:$.txt_EditEx5.getValue(),dept_name:$.txt_EditEx1.getValue(),emp_name:$.txt_EditEx2.getValue()});companyCheck("S");$.panDetail.clear()}else{if(btnId=="btnDelete"){var rId=$.grdList.getSelectedRowIdx();if(!rId){return}$.grdList.deleteCurrentRow()}}}if(panelId=="panDoc"){if(btnId=="btnAdd"){$.popUpCallId="btnDocAdd";var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getSSSSValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWfDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){if(saveWFCompanyOS("N")){moveWFGeneralProc()}else{removeWFDocument($.varWfDocId)}}else{removeWFDocument($.varWfDocId)}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}else{if(id=="popCompanyOS"){$.txt_company_id.setValue(popResult.company_id);$.bte_company_name.setText(popResult.company_name);$.txt_company_nameChange.setValue(popResult.company_name);$.txt_company_phone.setValue(popResult.company_phone);$.txt_address1.setValue(popResult.address1);$.txt_business_no.setValue(popResult.business_no);$.txt_businessChange.setValue(popResult.business_no);$.txt_EditEx1.setValue(popResult.dept_name);$.txt_EditEx1Change.setValue(popResult.dept_name);$.txt_EditEx2.setValue(popResult.emp_name);$.txt_EditEx2Change.setValue(popResult.emp_name);$.cmb_EditEx3.setValue(popResult.product_code);$.txt_EditEx3Change.setValue(popResult.product_name);$.txt_EditEx4.setValue(popResult.sidogu_code);$.txt_employee_id.setValue(popResult.employee_id);$.txt_employee_idChange.setValue(popResult.employee_id);$.txt_dept_codeChange.setValue(popResult.dept_code);$.txt_dept_code.setValue(popResult.dept_code);$.txt_product_codeChange.setValue(popResult.product_code);$.txt_product_code.setValue(popResult.product_code);if(!$.txt_employee_id.getValue()){$.txt_employee_id.setValue("new");$.txt_dept_code.setValue("new");$.txt_EditEx1.setValue("신규");$.txt_EditEx2.setValue("신규")}if($.txt_employee_id.getValue()=="new"){$.txt_flag.setValue("1");companyCheck("S")}else{$.txt_flag.setValue("1");companyCheck("S")}$.companychange="N"}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>