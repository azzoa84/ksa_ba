<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panLeft=null;$.panRight=null;$.panQuery=null;$.panList=null;$.panProcess=null;$.panRequest=null;$.panConf=null;$.lblYear=null;$.lblDept=null;$.cmbDept=null;$.lblEmp=null;$.cmbEmp=null;$.cmbReqType=null;$.lblReqType=null;$.lblReqTitle=null;$.txtReqTitle=null;$.btnSearch=null;$.grdList=null;$.cmbConDept=null;$.lblConEmp=null;$.cmbConEmp=null;$.lblReqDueDate=null;$.dteReqDueDate=null;$.lblReqTitle2=null;$.lblReqDesc2=null;$.dteReqDate=null;$.txtReqTitle2=null;$.lblReqFile=null;$.fPanReqFile=null;$.lblReqEmp=null;$.lblConYn=null;$.rdoConYn=null;$.lblConDueDate=null;$.dteConDueDate=null;$.lblConSuType=null;$.rdoConSuType=null;$.lblConDesc=null;$.lblConFile=null;$.fPanConFile=null;$.btnWfReqView=null;$.btnReqClose=null;$.btnWfConView=null;$.btnWfTransView=null;$.btnTrans=null;$.btnConClose=null;$.cmbTrans=null;$.cmbReqDept=null;$.cmbReqEmp=null;$.lblReqDate=null;$.htmLineStep=null;$.lblHelp1=null;$.cmbIng=null;$.lblTransEmp=null;$.btnTransClose=null;$.lblTerm=null;$.dteDateFr=null;$.dteDateTo=null;$.btnMyOnlyClose=null;$.chkMyOnly=null;$.wbeReqDesc=null;$.wbeConDesc=null;$.chkQAissue=null;function createJSON_S_Wf(workType,processType,statusType,wfDocId){var reason="";var json=createExecuteParamInfo("P_crmWFGeneralProc_S",[workType,wfDocId,"#UserID#",processType,statusType,reason]);return json}function saveWF(workType,processType,statusType,wfDocId){var json=createJSON_S_Wf(workType,processType,statusType,wfDocId);var ds=callExecuteSync(["req",json],"S");if(ds){if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){MessageBoxShow("저장 도중 오류가 발생 하였습니다.");return false}init();searchList()}}function createJSON_Q(workType){var wfDocId=(workType=="Q1"?"":$.varWfDocId);var json=createExecuteParamInfo("P_crmWFRequest_Q",[workType,wfDocId||"",$.dteDateFr.getValue()||"",$.dteDateTo.getValue()||"",$.cmbDept.getValue()||"",$.cmbEmp.getValue()||"",$.cmbReqType.getValue()||"",$.cmbIng.getValue()||"",$.txtReqTitle.getValue()||""]);return json}function searchList(){var json=createJSON_Q("Q1");callQuery(["req",json],"Q_LIST",$)}function searchData(){var json=createJSON_Q("Q2");callQuery(["req",json],"Q_DETAIL",$)}function createJSON_S(workType){var reqDept=($.varProcess=="10"?"#DeptCode#":$.cmbReqDept.getValue());var reqEmp=($.varProcess=="10"?"#UserID#":$.cmbReqEmp.getValue());if($.varProcess>="30"){var conSuType=$.varConSuType}else{var conSuType=($.chkMyOnly.getValue()=="Y"?"80":$.rdoConSuType.getValue())}var json=createExecuteParamInfo("P_crmWFRequest_S",[workType,"#UserID#",$.varWfDocId||"",$.dteReqDate.getValue()||"",reqDept||"",reqEmp||"",$.dteReqDueDate.getValue()||"",$.txtReqTitle2.getValue()||"",$.wbeReqDesc.getValue()||"",$.rdoConYn.getValue()||"",$.varConWfDocId||"",$.cmbConDept.getValue()||"",$.cmbConEmp.getValue()||"",$.dteConDueDate.getValue()||"",$.wbeConDesc.getValue()||"",conSuType||"",$.varTransWfDocId||"",$.cmbTrans.getValue()||"",$.varProcess,$.chkQAissue.getValue()||"N"]);return json}function saveRequest(workType){if($.varProcess=="00"){$.varProcess="10"}var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],"S");if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){MessageBoxShow("저장 도중 오류가 발생 하였습니다.");return false}searchList()}function initConditions(){$.dteDateFr.setValue(getCalcMonth($.varToday,-5));$.dteDateTo.setValue($.varToday);$.cmbDept.setValue(g_main.session.obj.DeptCode);$.cmbEmp.setValue(g_main.session.obj.UserID)}function init(){$.varWfDocId="";$.isMyReqDoc=false;$.isMyConDoc=false;$.varProcess="00";$.lineStep.render("");initBtns();initControls()}function initControls(){$.panRequest.setEnable(false);$.panConf.setEnable(false);$.cmbTrans.setVisible(false);$.cmbTrans.setAllowBlank(true);$.lblTransEmp.setVisible(false);$.fPanReqFile.clear();$.fPanConFile.clear();$.fPanReqFile.setMode("R");$.fPanConFile.setMode("R");$.chkMyOnly.setVisible(false);$.chkQAissue.setVisible(false);if($.isMyOnlyDoc&&g_main.session.obj.SystemDeveloper=="Y"){$.chkMyOnly.setVisible(true)}if(g_main.session.getValue("DeptCode")=="E150"||g_main.session.getValue("EmpCode")=="ka110192"){$.chkQAissue.setVisible(true)}if($.varProcess=="00"){$.panRequest.clear();$.panRequest.setEnable(true);$.dteReqDate.setEnable(false);$.panConf.clear();$.fPanReqFile.setMode("U");if(g_main.session.obj.SystemDeveloper=="Y"){$.chkMyOnly.setVisible(true)}else{$.chkMyOnly.setVisible(false)}}else{if($.varProcess=="10"){if($.varProcessIng=="ING"){}else{if($.isMyConDoc){$.panConf.setEnable(true);$.cmbReqDept.setEnable(false);$.cmbReqEmp.setEnable(false);$.fPanConFile.setMode("U");if($.chkMyOnly.getValue()=="Y"){var ds=getSystemTeam($.cmbConEmp.getValue());setComboBind([$.cmbTrans],ds);$.lblTransEmp.setVisible(true);$.cmbTrans.setVisible(true);$.btnTrans.setVisible(true);$.rdoConSuType.setEnable(false)}}}}else{if($.varProcess=="30"){if($.isMyConDoc){}}else{if($.varProcess=="50"){}else{if($.varProcess=="70"){if($.rdoConSuType.getValue()=="60"||$.rdoConSuType.getValue()=="70"){var ds=getSystemTeam($.cmbConEmp.getValue());setComboBind([$.cmbTrans],ds);if($.isMyConDoc){$.cmbTrans.setAllowBlank(false,"이관자");$.cmbTrans.setEnable(true);$.cmbTrans.setVisible(true);$.lblTransEmp.setVisible(true)}}}else{if($.varProcess=="80"||$.varProcess=="85"){$.lblTransEmp.setVisible(true);$.cmbTrans.setVisible(true)}else{if($.varProcess=="90"){$.lblTransEmp.setVisible(true);$.cmbTrans.setVisible(true)}}}}}}}}function getSystemTeam(confEmpId){var ds=bizComponentData2($,"Q4","L_CRM0052"," and dept_code = 'A120' and employee_id <> '"+confEmpId+"'");return ds}function initBtns(){$.panRequest.disableButton("all");$.panConf.disableButton("all");$.btnWfReqView.setEnable(false);$.btnReqClose.setVisible(false);$.btnWfConView.setEnable(false);$.btnWfTransView.setVisible(false);$.btnConClose.setVisible(false);$.btnTrans.setVisible(false);$.btnTransClose.setVisible(false);$.btnMyOnlyClose.setVisible(false);$.panRequest.enableButton(["btnNew"]);if(($.isMyReqDoc||g_main.session.obj.SystemDeveloper=="Y")&&$.varProcess>="10"){$.btnWfReqView.setEnable(true)}if($.isMyConDoc||g_main.session.obj.SystemDeveloper=="Y"){if($.varProcess>="20"&&!$.isMyOnlyDoc){$.btnWfConView.setEnable(true)}}if($.varProcess=="00"){$.panRequest.enableButton(["btnSubmit"])}else{if($.varProcess=="10"){if($.varProcessIng=="ING"){if($.isMyReqDoc){$.panRequest.enableButton(["btnCancel"])}}else{if($.isMyReqDoc){$.panRequest.enableButton(["btnCancel"])}if($.isMyConDoc){if($.chkMyOnly.getValue()=="Y"){$.btnMyOnlyClose.setVisible(true)}else{$.panConf.enableButton(["btnSubmit"])}}}}else{if($.varProcess=="15"){if($.isMyReqDoc){$.panRequest.enableButton(["btnCancel"])}}else{if($.varProcess=="20"){if($.varProcessIng=="ING"){if($.isMyConDoc){$.panConf.enableButton(["btnCancel"])}}}else{if($.varProcess=="30"){if($.isMyConDoc){$.btnConClose.setVisible(true);$.panConf.enableButton(["btnCancel"])}}else{if($.varProcess=="40"){if($.isMyReqDoc){$.btnReqClose.setVisible(true)}}else{if($.varProcess=="50"){}else{if($.varProcess=="70"){if($.rdoConSuType.getValue()=="60"||$.rdoConSuType.getValue()=="70"){if($.isMyConDoc){$.btnTrans.setVisible(true)}}}else{if($.varProcess=="80"){$.btnWfTransView.setVisible(true)}else{if($.varProcess=="85"){if($.isMyTransDoc){$.btnTransClose.setVisible(true)}$.btnWfTransView.setVisible(true)}else{if($.varProcess=="90"){$.btnWfTransView.setVisible(true)}}}}}}}}}}}}function saveWFDocument(workType,docType,wfLine){if($.varProcess=="00"){var ds=commWFDocument(workType,docType,"업무협조 요청서",$.varBusinessId,$.varOriginWfDocId,wfLine,$.fPanReqFile.getFileList(),null,null,$.varWfDocId);if(ds&&ds.returnStr!=""){$.varWfDocId=ds.returnStr;log("saveWFDocument() -> $.varWfDocId : "+$.varWfDocId)}}else{if($.varProcess=="10"){var ds=commWFDocument(workType,docType,"업무협조 확인서",$.varBusinessId,$.varOriginWfDocId,wfLine,$.fPanConFile.getFileList(),null,null,$.varConWfDocId);if(ds&&ds.returnStr!=""){$.varConWfDocId=ds.returnStr;log("saveWFDocument() -> $.varConWfDocId : "+$.varConWfDocId);$.varProcess="20"}}else{if($.varProcess=="70"){var ds=commWFDocument(workType,docType,"업무협조 이관 요청서",$.varBusinessId,$.varOriginWfDocId,wfLine,$.fPanConFile.getFileList(),null,null,$.varTransWfDocId);if(ds&&ds.returnStr!=""){$.varTransWfDocId=ds.returnStr;log("saveWFDocument() -> $.varTransWfDocId : "+$.varTransWfDocId);$.varProcess="80"}}}}if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){log(ds);MessageBoxShow("문서 저장 도중 오류가 발생 하였습니다.");return false}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,970);$.panMain.setText("");$.panMain.setBottomLine(true);$.panLeft=new FingerPanel(host,"panLeft",0,0,390,970);$.panLeft.setText("");$.panLeft.setBottomLine(true);$.panRight=new FingerPanel(host,"panRight",400,0,800,970);$.panRight.setText("");$.panRight.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,390,180);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,185,390,765);$.panList.setText("요청내역");$.panList.setBottomLine(true);$.panProcess=new FingerPanel(host,"panProcess",0,0,800,70);$.panProcess.setText("");$.panProcess.setBottomLine(true);$.panRequest=new FingerPanel(host,"panRequest",0,75,800,415);$.panRequest.setText("협조요청");$.panRequest.setBottomLine(true);$.panConf=new FingerPanel(host,"panConf",0,500,800,450);$.panConf.setText("협조확인");$.panConf.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,5,70,20);$.lblYear.setText("조회기간");$.lblDept=new FingerLabel(host,"lblDept",0,40,70,20);$.lblDept.setText("부서");$.cmbDept=new FingerComboBox(host,"cmbDept",75,40,150,20);$.lblEmp=new FingerLabel(host,"lblEmp",226,40,55,20);$.lblEmp.setText("담당자");$.cmbEmp=new FingerComboBox(host,"cmbEmp",285,40,90,20);$.cmbReqType=new FingerComboBox(host,"cmbReqType",75,75,170,20);$.lblReqType=new FingerLabel(host,"lblReqType",0,75,70,20);$.lblReqType.setText("요청구분");$.lblReqTitle=new FingerLabel(host,"lblReqTitle",0,110,70,20);$.lblReqTitle.setText("업무제목");$.txtReqTitle=new FingerEdit(host,"txtReqTitle",75,110,300,20);$.btnSearch=new FingerButton(host,"btnSearch",315,145,80,20);$.btnSearch.setText("조회");$.grdList=new FingerDataGrid(host,"grdList",0,0,390,720);$.cmbConDept=new FingerComboBox(host,"cmbConDept",105,10,175,20);$.lblConEmp=new FingerLabel(host,"lblConEmp",0,10,100,20);$.lblConEmp.setText("협의자");$.cmbConEmp=new FingerComboBox(host,"cmbConEmp",290,10,100,20);$.lblReqDueDate=new FingerLabel(host,"lblReqDueDate",245,45,80,20);$.lblReqDueDate.setText("요청마감일");$.dteReqDueDate=new FingerDateEdit(host,"dteReqDueDate",330,47,120,20);$.lblReqTitle2=new FingerLabel(host,"lblReqTitle2",0,80,100,20);$.lblReqTitle2.setText("요청 업무제목");$.lblReqDesc2=new FingerLabel(host,"lblReqDesc2",0,115,100,20);$.lblReqDesc2.setText("요청 업무내용");$.dteReqDate=new FingerDateEdit(host,"dteReqDate",105,47,120,20);$.txtReqTitle2=new FingerEdit(host,"txtReqTitle2",105,85,680,20);$.lblReqFile=new FingerLabel(host,"lblReqFile",0,305,100,20);$.lblReqFile.setText("첨부파일");$.fPanReqFile=new FingerFilePanel(host,"fPanReqFile",105,305,680,55);$.lblReqEmp=new FingerLabel(host,"lblReqEmp",0,10,100,20);$.lblReqEmp.setText("요청자");$.lblConYn=new FingerLabel(host,"lblConYn",0,41,100,20);$.lblConYn.setText("협조여부");$.rdoConYn=new FingerRadioBox(host,"rdoConYn",105,40,300,20);$.lblConDueDate=new FingerLabel(host,"lblConDueDate",0,70,100,20);$.lblConDueDate.setText("처리예정일");$.dteConDueDate=new FingerDateEdit(host,"dteConDueDate",105,72,120,20);$.lblConSuType=new FingerLabel(host,"lblConSuType",0,101,100,20);$.lblConSuType.setText("제공형태");$.rdoConSuType=new FingerRadioBox(host,"rdoConSuType",105,100,350,20);$.lblConDesc=new FingerLabel(host,"lblConDesc",0,130,100,20);$.lblConDesc.setText("협조 내용");$.lblConFile=new FingerLabel(host,"lblConFile",0,340,100,20);$.lblConFile.setText("첨부파일");$.fPanConFile=new FingerFilePanel(host,"fPanConFile",105,340,680,55);$.btnWfReqView=new FingerButton(host,"btnWfReqView",710,10,100,20);$.btnWfReqView.setText("기안확인");$.btnReqClose=new FingerButton(host,"btnReqClose",710,45,100,20);$.btnReqClose.setText("결과확인");$.btnWfConView=new FingerButton(host,"btnWfConView",710,10,100,20);$.btnWfConView.setText("기안확인");$.btnWfTransView=new FingerButton(host,"btnWfTransView",600,10,120,20);$.btnWfTransView.setText("이관 기안확인");$.btnTrans=new FingerButton(host,"btnTrans",480,75,100,20);$.btnTrans.setText("이관요청");$.btnConClose=new FingerButton(host,"btnConClose",620,10,100,20);$.btnConClose.setText("처리완료");$.cmbTrans=new FingerComboBox(host,"cmbTrans",370,75,100,20);$.cmbReqDept=new FingerComboBox(host,"cmbReqDept",105,10,175,20);$.cmbReqEmp=new FingerComboBox(host,"cmbReqEmp",290,10,100,20);$.lblReqDate=new FingerLabel(host,"lblReqDate",0,45,100,20);$.lblReqDate.setText("요청일");$.htmLineStep=new FingerHTMLView(host,"htmLineStep",22,10,770,50);$.lblHelp1=new FingerLabel(host,"lblHelp1",280,40,250,20);$.lblHelp1.setText("(* 협조불가능시 [취소]로 처리)");$.cmbIng=new FingerComboBox(host,"cmbIng",250,75,125,20);$.lblTransEmp=new FingerLabel(host,"lblTransEmp",305,75,60,20);$.lblTransEmp.setText("이관자");$.btnTransClose=new FingerButton(host,"btnTransClose",480,75,100,20);$.btnTransClose.setText("이관완료");$.lblTerm=new FingerLabel(host,"lblTerm",187,5,20,20);$.lblTerm.setText("~");$.dteDateFr=new FingerDateEdit(host,"dteDateFr",75,5,110,20);$.dteDateTo=new FingerDateEdit(host,"dteDateTo",215,5,110,20);$.btnMyOnlyClose=new FingerButton(host,"btnMyOnlyClose",410,11,120,20);$.btnMyOnlyClose.setText("즉시처리완료");$.chkMyOnly=new FingerCheckBox(host,"chkMyOnly",405,12,220,20);$.chkMyOnly.setText("시스템자체변경");$.wbeReqDesc=new FingerWebEditor(host,"wbeReqDesc",105,120,675,170);$.wbeConDesc=new FingerWebEditor(host,"wbeConDesc",105,135,675,190);$.chkQAissue=new FingerCheckBox(host,"chkQAissue",520,12,160,20);$.chkQAissue.setText("QA업무 관련여부");$.varToday=getToday();$.lblHelp1.setAlign("left");$.lineStep=new CustomStepLine($,$.htmLineStep,"wfRequest");$.lineStep.init();$.wbeReqDesc.setBorder(true);$.wbeConDesc.setBorder(true);$.dteDateFr.setDateFormat("yyyymm");$.dteDateFr.setAllowBlank(false,"조회기간(From)");$.dteDateTo.setDateFormat("yyyymm");$.dteDateTo.setAllowBlank(false,"조회기간(To)");$.dteReqDate.setDefaultValue($.varToday);$.dteReqDueDate.setAllowBlank(false,"요청마감일");$.cmbDept.setEmptyRow(true);$.cmbEmp.setEmptyRow(true);$.cmbTrans.setEmptyRow(true);$.cmbConDept.setEmptyRow(true);$.cmbReqDept.setEmptyRow(true);$.cmbConDept.setAllowBlank(false,"협의부서");$.cmbConEmp.setAllowBlank(false,"협의자");$.txtReqTitle2.setAllowBlank(false,"요청제목");$.wbeReqDesc.setAllowBlank(false,"요청내용");$.rdoConYn.setAllowBlank(false,"협조여부");$.dteConDueDate.setAllowBlank(false,"처리예정일");$.rdoConSuType.setAllowBlank(false,"제공형태");$.wbeConDesc.setAllowBlank(false,"협조내용");$.cmbReqType.setEmptyRow(true,"요청함 / 요청받음");var ds=[{sub_code:"10",code_name:"요청함"},{sub_code:"20",code_name:"요청받음"}];setComboBind([$.cmbReqType],ds,false);$.cmbIng.setEmptyRow(true,"전체");var ds=[{sub_code:"10",code_name:"진행중"},{sub_code:"20",code_name:"완료"},{sub_code:"30",code_name:"취소"}];setComboBind([$.cmbIng],ds,false);$.rdoConYn.addButtons([{sub_code:"Y",code_name:"협조 가능"},{sub_code:"N",code_name:"협조 불가능"}]);$.rdoConYn.setValue("01");$.panQuery.setBorder(true);$.panProcess.setBorder(true);$.panRequest.addButtons(["btnCancel","btnSubmit","btnNew"]);$.panConf.addButtons(["btnCancel","btnSubmit"]);$.grdList.setColumns([new FingerDataGridColumn("wf_doc_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("req_title",200,"left","string","요청제목"),new FingerDataGridColumn("curr_process",87,"center","string","단계"),new FingerDataGridColumn("req_due_date",87,"center","string","요청마감일",{format:"s_ymd"}),new FingerDataGridColumn("con_due_date",87,"center","string","처리예정일",{format:"s_ymd"}),new FingerDataGridColumn("req_user",100,"left","string","요청자"),new FingerDataGridColumn("con_user",100,"left","string","협조자")]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panLeft);$.panMain.add($.panRight);$.panLeft.add($.panQuery);$.panLeft.add($.panList);$.panRight.add($.panConf);$.panRight.add($.panRequest);$.panRight.add($.panProcess);$.panQuery.add($.lblYear);$.panQuery.add($.lblDept);$.panQuery.add($.cmbDept);$.panQuery.add($.lblEmp);$.panQuery.add($.cmbEmp);$.panQuery.add($.cmbReqType);$.panQuery.add($.lblReqType);$.panQuery.add($.lblReqTitle);$.panQuery.add($.txtReqTitle);$.panQuery.add($.btnSearch);$.panQuery.add($.cmbIng);$.panQuery.add($.lblTerm);$.panQuery.add($.dteDateFr);$.panQuery.add($.dteDateTo);$.panList.add($.grdList);$.panProcess.add($.htmLineStep);$.panRequest.add($.lblReqDesc2);$.panRequest.add($.lblReqTitle2);$.panRequest.add($.dteReqDueDate);$.panRequest.add($.lblReqDueDate);$.panRequest.add($.cmbConEmp);$.panRequest.add($.lblConEmp);$.panRequest.add($.cmbConDept);$.panRequest.add($.dteReqDate);$.panRequest.add($.txtReqTitle2);$.panRequest.add($.lblReqFile);$.panRequest.add($.fPanReqFile);$.panRequest.add($.btnWfReqView);$.panRequest.add($.btnReqClose);$.panRequest.add($.lblReqDate);$.panRequest.add($.chkMyOnly);$.panRequest.add($.wbeReqDesc);$.panRequest.add($.chkQAissue);$.panConf.add($.lblReqEmp);$.panConf.add($.lblConYn);$.panConf.add($.rdoConYn);$.panConf.add($.lblConDueDate);$.panConf.add($.dteConDueDate);$.panConf.add($.lblConSuType);$.panConf.add($.rdoConSuType);$.panConf.add($.lblConDesc);$.panConf.add($.lblConFile);$.panConf.add($.fPanConFile);$.panConf.add($.btnWfConView);$.panConf.add($.btnWfTransView);$.panConf.add($.btnTrans);$.panConf.add($.btnConClose);$.panConf.add($.cmbTrans);$.panConf.add($.cmbReqDept);$.panConf.add($.cmbReqEmp);$.panConf.add($.lblHelp1);$.panConf.add($.lblTransEmp);$.panConf.add($.btnTransClose);$.panConf.add($.btnMyOnlyClose);$.panConf.add($.wbeConDesc);init();var ds=commWFDocumentQ("Q3","","","crmWFRequest");$.varBusinessId=ds.get(0,0,"business_id");$.varWFType=ds.get(0,0,"wf_type");$.varBusinessTitle=ds.get(0,0,"business_title");$.cmbDept.setColumn("dept_code","dept_name");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbConDept.setColumn("dept_code","dept_name");$.cmbConEmp.setColumn("employee_id","emp_name");$.cmbReqDept.setColumn("dept_code","dept_name");$.cmbReqEmp.setColumn("employee_id","emp_name");$.cmbTrans.setColumn("employee_id","emp_name");$.cmbDept.setColumnConfig("DEPT");$.cmbConDept.setColumnConfig("DEPT");$.cmbReqDept.setColumnConfig("DEPT");$.cmbEmp.setColumnConfig("EMP");$.cmbConEmp.setColumnConfig("EMP");$.cmbReqEmp.setColumnConfig("EMP");$.cmbTrans.setColumnConfig("EMP");var ds=commCodeData2($,"Q","#DEPT_LIST#");setComboBind([$.cmbDept],ds);setComboBind([$.cmbConDept],ds);setComboBind([$.cmbReqDept],ds);var ds=commCodeData2($,"Q","#EMP_LIST#","A120");setComboBind([$.cmbTrans],ds);var ds=bizComponentData2($,"Q1","L_CRM0269|L_CRM0270");$.grdList.setColumnDropDownList("curr_process",ds.resultList[0]);if(g_main.session.obj.SystemDeveloper=="Y"){$.lblConDesc.setProperty(0,155,100,20);$.wbeConDesc.setProperty(105,160,675,165)}var tmpDs=ds.resultList[1];tmpDs=tmpDs.filter(function(el,idx){if(el.sub_code=="80"){return false}if(g_main.session.obj.SystemDeveloper!="Y"){return(el.extra_field1!="SYSTEM")}else{return true}});if(g_isFcs){tmpDs[2].margin=90}else{tmpDs[2].margin=100}$.rdoConSuType.addButtons(tmpDs);initConditions();searchList()};$.callback=function(type,ds){if(type=="Q_LIST"){setDataGrid([$.grdList],ds);if($.varWfDocId){$.grdList.selectRow($.grdList.getGridRowIndex("wf_doc_id",$.varWfDocId))}}else{if(type=="Q_DETAIL"){$.panRequest.clear();$.panConf.clear();var data=ds.resultList[0][0];$.isMyReqDoc=(g_main.session.obj.UserID==data.req_employee_id);$.isMyConDoc=(g_main.session.obj.UserID==data.con_employee_id);$.isMyTransDoc=(g_main.session.obj.UserID==data.trans_employee_id);$.isMyOnlyDoc=($.isMyReqDoc&&$.isMyConDoc);$.cmbConDept.setValue(data.con_dept_code);$.cmbConEmp.setValue(data.con_employee_id);$.dteReqDate.setValue(data.req_date);$.dteReqDueDate.setValue(data.req_due_date);$.txtReqTitle2.setValue(data.req_title);$.wbeReqDesc.setValue(data.req_desc);$.cmbReqDept.setValue(data.req_dept_code);$.cmbReqEmp.setValue(data.req_employee_id);$.dteConDueDate.setValue(data.con_due_date);$.rdoConYn.setValue(data.con_yn);$.wbeConDesc.setValue(data.con_desc);$.cmbTrans.setValue(data.trans_employee_id);$.chkQAissue.setValue(data.qa_yn);$.varConSuType=data.con_su_type;$.varConSystemYn=data.con_system_yn;$.varProcess=data.curr_process;$.varProcessIng=data.process_ing;$.varWfDocId=data.wf_doc_id;$.varConWfDocId=data.con_wf_doc_id;$.varTransWfDocId=data.trans_wf_doc_id;log("callback -> $.varProcess : "+$.varProcess+"("+$.varProcessIng+"), 제공형태: "+data.con_su_type);if(data.con_su_type=="80"){$.chkMyOnly.setValue("Y")}else{$.chkMyOnly.setValue("N");$.rdoConSuType.setValue(data.con_su_type)}if(data.con_su_type=="60"||data.con_su_type=="70"||($.varProcess>="70"&&data.con_su_type=="80")){$.lineStep.render("SYSTEM")}else{$.lineStep.render("")}$.lineStep.update($.varProcess,$.varProcessIng);initBtns();initControls();var fReqList=ds.resultList[1];var fConList=ds.resultList[2];if(fReqList&&fReqList.length){$.fPanReqFile.addFiles(fReqList)}if(fConList&&fConList.length){$.fPanConFile.addFiles(fConList)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList()}else{if(id=="btnWfReqView"){var param=[];param.wf_doc_id=$.varWfDocId;g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if(id=="btnWfConView"){var param=[];param.wf_doc_id=$.varConWfDocId;g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if(id=="btnWfTransView"){var param=[];param.wf_doc_id=$.varTransWfDocId;g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if(id=="btnMyOnlyClose"){if(!$.rdoConYn.getValue()){MessageBoxShow("협조여부 은(는) 필수입력 항목 입니다.");return}if(!$.dteConDueDate.getValue()){MessageBoxShow("처리예정일 은(는) 필수입력 항목 입니다.");return}confirmBoxShow("처리완료 하시겠습니까?",function(){if(g_main.msgShare==true){$.varProcess="50";saveRequest("N")}})}else{if(id=="btnConClose"){if($.varProcess!="30"){MessageBoxShow("진행단계가 [업무진행]일때만 가능합니다.");return}if($.rdoConSuType.getValue()==""){MessageBoxShow("제공형태를 지정해 주시기 바랍니다.");return}confirmBoxShow("처리완료 하시겠습니까?",function(){if(g_main.msgShare==true){$.varProcess="40";saveRequest("N")}})}else{if(id=="btnReqClose"){if($.varProcess!="40"){MessageBoxShow("진행단계가 [전달/검수]일때만 가능합니다.");return}confirmBoxShow("처리완료 하시겠습니까?",function(){if(g_main.msgShare==true){if($.varConSuType=="60"||$.varConSuType=="70"){$.varProcess="70"}else{$.varProcess="50"}saveRequest("N")}})}else{if(id=="btnTrans"){if($.chkMyOnly.getValue()!="Y"&&$.varProcess!="70"){MessageBoxShow("진행단계가 [전달/검수] (이관)일때만 가능합니다.");return}if(!$.rdoConYn.getValue()){MessageBoxShow("협조여부 은(는) 필수입력 항목 입니다.");return}if(!$.dteConDueDate.getValue()){MessageBoxShow("처리예정일 은(는) 필수입력 항목 입니다.");return}if(!$.cmbTrans.getValue()){MessageBoxShow("이관요청 대상자를 지정해 주시기 바랍니다.");return}confirmBoxShow("이관요청 하시겠습니까?",function(){if(g_main.msgShare==true){if($.chkMyOnly.getValue()=="Y"||$.varConSuType=="80"){$.varProcess="70"}var param={wf_doc_id:$.varTransWfDocId,wf_form_id:"crmWFRequest"};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}})}else{if(id=="btnTransClose"){if($.varProcess!="85"){MessageBoxShow("진행단계가 [이관진행]일때만 가능합니다.");return}confirmBoxShow("이관완료 하시겠습니까?",function(){if(g_main.msgShare==true){$.varProcess="90";saveRequest("N")}})}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){if(id=="chkMyOnly"){if(value=="Y"){$.cmbConDept.setValue(g_main.session.obj.DeptCode);$.cmbConEmp.setValue(g_main.session.obj.UserID)}else{$.cmbConDept.setValue("");$.cmbConEmp.setValue("")}}};$.fingercombobox_change=function(id,value){if(id=="cmbDept"){$.cmbEmp.clear();if(value==""){$.cmbEmp.setEnable(false);return}$.cmbEmp.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbEmp],ds)}else{if(id=="cmbConDept"){$.cmbConEmp.clear();if(value==""){$.cmbConEmp.setEnable(false);return}$.cmbConEmp.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbConEmp],ds)}else{if(id=="cmbReqDept"){$.cmbReqEmp.clear();if(value==""){$.cmbReqEmp.setEnable(false);return}$.cmbReqEmp.setEnable(true);var ds=commCodeData2($,"Q","#EMP_LIST#",value);setComboBind([$.cmbReqEmp],ds)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.varWfDocId=$.grdList.getValue(rId,"wf_doc_id");searchData()}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtReqTitle")&&value=="13"){searchList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panRequest"){if(btnId=="btnNew"){$.varWfDocId="";init()}else{if(btnId=="btnSubmit"){var isValid=$.panRequest.validateControls();if(!isValid){return}if($.chkMyOnly.getValue()=="Y"){if(g_main.session.obj.UserID!=$.cmbConEmp.getValue()){MessageBoxShow("시스템자체변경은 협조자가 본인일때만 가능합니다.");return}}if($.chkMyOnly.getValue()=="N"){if(g_main.session.obj.UserID==$.cmbConEmp.getValue()){MessageBoxShow("협조자는 본인이 될 수 없습니다. <br/>(* 시스템자체변경 체크시 가능)");return}}var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFRequest"};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if(btnId=="btnCancel"){var confirmMsg="취소 하시겠습니까?";if($.varProcessIng=="END"){confirmMsg="결재완료된 기안입니다. 취소 하시겠습니까?"}confirmBoxShow(confirmMsg,function(){if(g_main.msgShare==true){saveWF("N","60","60",$.varWfDocId)}})}}}}if(panelId=="panConf"){if(btnId=="btnSubmit"){var isValid=$.panConf.validateControls();if(!isValid){return}var param={wf_doc_id:$.varConWfDocId,wf_form_id:"crmWFRequest"};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if(btnId=="btnCancel"){var confirmMsg="취소 하시겠습니까?";if($.varProcess=="20"){confirmMsg="협조기안이 진행 중인 건입니다. 취소 하시겠습니까?"}else{if($.varProcess=="30"){confirmMsg="협조기안이 결재완료된 건입니다. 취소 하시겠습니까?"}}confirmBoxShow(confirmMsg,function(){if(g_main.msgShare==true){if($.varProcess=="20"||$.varProcess=="30"){saveRequest("CANCEL_BK");saveWF("N","60","60",$.varConWfDocId)}else{saveRequest("CANCEL")}}})}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if(popResult.isCancel){if($.varProcess=="00"){$.varWfDocId=popResult.wf_doc_id}else{if($.varProcess=="10"){$.varConWfDocId=popResult.wf_doc_id}else{if($.varProcess=="70"){$.varTransWfDocId=popResult.wf_doc_id}}}}else{if(saveWFDocument("","Y",popResult)){saveRequest("N")}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){if(id=="rdoConYn"){if(value=="Y"){$.panConf.disableButton(["btnCancel"]);$.dteConDueDate.setEnable(true);$.rdoConSuType.setEnable(true);if("Y"!=$.chkMyOnly.getValue()){$.panConf.enableButton(["btnSubmit"])}}else{if("Y"==$.chkMyOnly.getValue()){}else{$.panConf.disableButton(["btnSubmit"]);$.panConf.enableButton(["btnCancel"]);$.dteConDueDate.setEnable(false);$.rdoConSuType.setEnable(false)}}}else{if(id=="rdoConSuType"){initBtns()}}};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){if(id=="fPanReqFile"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];$.fPanReqFile.addFiles(fileList)})}else{if(id=="fPanConFile"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];$.fPanConFile.addFiles(fileList)})}}};$.fingerfilepanel_download_click=function(id,fileId,fileName){var fi=$[id].getFileObj(fileId);g_fileBrowser.download((fi.server_path+fi.server_fname),fi.local_fname)};$.fingerfilepanel_delete_click=function(id,fileId,fileName){if(id=="fPanReqFile"){confirmBoxShow("삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.fPanReqFile.removeFile(fileId)}})}else{if(id=="fPanConFile"){confirmBoxShow("삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.fPanConFile.removeFile(fileId)}})}}};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>