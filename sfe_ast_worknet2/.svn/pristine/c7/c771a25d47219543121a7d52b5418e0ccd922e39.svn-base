<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.lblDept=null;$.lblEmp=null;$.lblEduName=null;$.lblEduDate=null;$.lblEduWay=null;$.lblEduType=null;$.bteDept=null;$.bteEmp=null;$.txtEduName=null;$.dteStart=null;$.dteEnd=null;$.cmbEduMethod=null;$.cmbEduType=null;$.lblWave=null;$.btnDownLoad=null;$.btnUpLoad=null;$.grdList=null;$.btnSearch=null;$.lbl_edu_pass_yn=null;$.cmb_edu_pass_yn=null;$.varRowId="";function createJson_Q(workType){var json=createExecuteParamInfo("HR.dbo.P_HRI2200_Q",[workType,$.bteDept.getValue()||"",$.bteEmp.getValue()||"",$.txtEduName.getText()||"",$.cmbEduMethod.getValue()||"",$.dteStart.getValue()||"",$.dteEnd.getValue()||"",$.cmbEduType.getValue()||"",$.cmb_edu_pass_yn.getValue()||""]);return json}function createJSON_S(workType){var json="";if(workType==""){var changedRows=$.grdList.getChangedRows();if(changedRows.length<1){return}var rows=[];for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,changedRows[i].seq||"",changedRows[i].dept_code||"",changedRows[i].emp_code||"",changedRows[i].edu_name||"",changedRows[i].edu_method||"","",changedRows[i].edu_type||"",unmask(changedRows[i].edu_start_date).substr(0,8)||"",unmask(changedRows[i].edu_end_date).substr(0,8)||"",changedRows[i].edu_time||0,changedRows[i].edu_pass_yn||"",changedRows[i].memo||""])}json=createExecuteParamInfo("HR.dbo.P_HRI2200_S",rows)}else{if(workType=="D"){var rId=$.grdList.getSelectedRowIdx();json=createExecuteParamInfo("HR.dbo.P_HRI2200_S",[workType,$.grdList.getValue(rId,"seq"),"","","","","","","","",0,"",""])}}return json}function searchList(){if(!$.panQuery.validateControls()){return}if(Number($.dteStart.getValue())>Number($.dteEnd.getValue())){MessageBoxShow("시작일은 종료일보다 빨라야 합니다.");return}var json=createJson_Q("Q");callQuery(["req",json],"Q",$)}function saveList(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"||ds.errorCode=="MSG0003"){searchList()}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,110);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,120,1200,640);$.panList.setText("교육사항 목록");$.panList.setBottomLine(true);$.lblDept=new FingerLabel(host,"lblDept",0,10,100,20);$.lblDept.setText("부서");$.lblEmp=new FingerLabel(host,"lblEmp",280,10,100,20);$.lblEmp.setText("사원");$.lblEduName=new FingerLabel(host,"lblEduName",0,40,100,20);$.lblEduName.setText("교육과정명");$.lblEduDate=new FingerLabel(host,"lblEduDate",310,40,70,20);$.lblEduDate.setText("교육기간");$.lblEduWay=new FingerLabel(host,"lblEduWay",0,70,100,20);$.lblEduWay.setText("교육방법");$.lblEduType=new FingerLabel(host,"lblEduType",310,70,70,20);$.lblEduType.setText("교육구분");$.bteDept=new FingerButtonEdit(host,"bteDept",105,10,140,20);$.bteDept.setText("");$.bteEmp=new FingerButtonEdit(host,"bteEmp",385,10,140,20);$.bteEmp.setText("");$.txtEduName=new FingerEdit(host,"txtEduName",105,40,143,20);$.dteStart=new FingerDateEdit(host,"dteStart",385,40,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",510,40,100,20);$.cmbEduMethod=new FingerComboBox(host,"cmbEduMethod",105,70,148,20);$.cmbEduType=new FingerComboBox(host,"cmbEduType",385,70,148,20);$.lblWave=new FingerLabel(host,"lblWave",485,40,20,20);$.lblWave.setText("~");$.btnDownLoad=new FingerButton(host,"btnDownLoad",870,75,140,20);$.btnDownLoad.setText("양식 다운로드");$.btnUpLoad=new FingerButton(host,"btnUpLoad",995,75,140,20);$.btnUpLoad.setText("교육사항 업로드");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,600);$.btnSearch=new FingerButton(host,"btnSearch",1120,75,80,20);$.btnSearch.setText("조회");$.lbl_edu_pass_yn=new FingerLabel(host,"lbl_edu_pass_yn",540,70,100,20);$.lbl_edu_pass_yn.setText("수강여부");$.cmb_edu_pass_yn=new FingerComboBox(host,"cmb_edu_pass_yn",645,70,148,20);$.panQuery.setBorder(true);$.panList.addButton("btnDelete","삭제");$.panList.addButton("btnSave","수정");$.panList.addButton("btnNew","신규");$.panList.setButtonAction("btnDelete","delete");$.panList.setButtonAction("btnSave","save");$.panList.setButtonAction("btnNew","new");$.grdList.colMap=$.grdList.setColumns([new FingerDataGridColumn("seq",99,"left","int","순번"),new FingerDataGridColumn("dept_code",99,"left","string","부서ID"),new FingerDataGridColumn("dept_name",120,"left","string","부서",{readonly:true}),new FingerDataGridColumn("emp_code",90,"left","string","사원ID"),new FingerDataGridColumn("emp_full_name",80,"left","string","사원",{readonly:true}),new FingerDataGridColumn("edu_name",220,"left","string","교육과정명"),new FingerDataGridColumn("edu_method",99,"left","string","교육방법"),new FingerDataGridColumn("edu_type",90,"left","string","교육구분"),new FingerDataGridColumn("edu_start_date",90,"center","date","교육시작일",{format:"ymd"}),new FingerDataGridColumn("edu_end_date",90,"center","date","교육종료일",{format:"ymd"}),new FingerDataGridColumn("edu_time",99,"center","string","교육시간(분)"),new FingerDataGridColumn("edu_pass_yn",75,"center","string","수강여부"),new FingerDataGridColumn("memo",250,"left","string","비고")]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setEditable(true);$.grdList.setBorder(false);$.grdList.setColumnHidden(["seq","dept_code","emp_code"],true);$.dteStart.setValue(getCalcMonth(getToday(""),-1).substr(0,6)+"01");$.dteEnd.setValue(getToday(""));$.cmbEduMethod.setEmptyRow(true);$.cmbEduType.setEmptyRow(true);$.dteStart.setAllowBlank(false,"교육시작일");$.dteEnd.setAllowBlank(false,"교육종료일");$.cmb_edu_pass_yn.addItem("Y","예");$.cmb_edu_pass_yn.addItem("N","아니오");$.bteEmp.setDirectSearch("#EMP#",function(ds){if(ds&&ds.resultList&&ds.resultList[0]){var list=ds.resultList[0];if(list.length==1){$.bteEmp.setValue(list[0]["value"]);$.bteEmp.setText(list[0]["text"]);$.bteDept.setValue(list[0]["dept_code"]);$.bteDept.setText(list[0]["dept_name"])}else{$.fingerbuttonedit_click("bteEmp")}}});$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panQuery.add($.lblDept);$.panQuery.add($.lblEmp);$.panQuery.add($.lblEduName);$.panQuery.add($.lblEduDate);$.panQuery.add($.lblEduWay);$.panQuery.add($.lblEduType);$.panQuery.add($.bteDept);$.panQuery.add($.bteEmp);$.panQuery.add($.txtEduName);$.panQuery.add($.dteStart);$.panQuery.add($.dteEnd);$.panQuery.add($.cmbEduMethod);$.panQuery.add($.cmbEduType);$.panQuery.add($.lblWave);$.panQuery.add($.btnDownLoad);$.panQuery.add($.btnUpLoad);$.panQuery.add($.btnSearch);$.panQuery.add($.lbl_edu_pass_yn);$.panQuery.add($.cmb_edu_pass_yn);$.panList.add($.grdList);var ds=bizComponentData2($,"Q1","L_HRI049|L_HRI050");setComboBind([$.cmbEduMethod,$.cmbEduType],ds);$.grdList.setColumnDropDownList("edu_method",ds.resultList[0]);$.grdList.setColumnDropDownList("edu_type",ds.resultList[1]);$.grdList.setColumnDropDownList("edu_pass_yn",[{sub_code:"Y",code_name:"예"},{sub_code:"N",code_name:"아니요"}]);searchList()};$.callback=function(type,ds){if(type=="Q"){for(var i=0;i<ds.resultList[0].length;i++){ds.resultList[0][i].edu_start_date=extFormat(ds.resultList[0][i].edu_start_date,"yyyyMMdd");ds.resultList[0][i].edu_end_date=extFormat(ds.resultList[0][i].edu_end_date,"yyyyMMdd")}setDataGrid([$.grdList],ds);$.varExcelTemplate=ds.resultList[1]}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList()}else{if(id=="btnDownLoad"){var column=[{headertext:"부서ID",datatype:"string",datafield:"dept_code",ishidden:false,width:"150px"},{headertext:"부서명",datatype:"string",datafield:"dept_name",ishidden:false,width:"150px"},{headertext:"사원ID",datatype:"string",datafield:"emp_code",width:"120px"},{headertext:"사원명",datatype:"string",datafield:"emp_full_name",width:"120px"},{headertext:"교육과정명",datatype:"string",datafield:"edu_name",ishidden:false,width:"250px"},{headertext:"교육방법",datatype:"string",datafield:"edu_method",ishidden:false,width:"100px"},{headertext:"교육구분",datatype:"string",datafield:"edu_type",ishidden:false,width:"100px"},{headertext:"교육시작일",datatype:"date",format:"xxxx,xx,xx",datafield:"edu_start_date",ishidden:false,width:"120px"},{headertext:"교육종료일",datatype:"date",format:"xxxx,xx,xx",datafield:"edu_end_date",ishidden:false,width:"120px"},{headertext:"교육시간(분)",datatype:"number",datafield:"edu_time",ishidden:false,width:"120px"},{headertext:"수강여부",datatype:"string",datafield:"edu_pass_yn",ishidden:false,width:"100px"},{headertext:"비고",datatype:"string",datafield:"memo",ishidden:false,width:"300px"}];var header={dept_code:"AST",dept_name:"아스텔라스팀",emp_code:"ka1234556",emp_full_name:"홍길동",edu_name:"PV New Staff Training",edu_method:"1: e-learning<br style='mso-data-placement: same-cell'>2: face to face<br style='mso-data-placement: same-cell'>3: mock call<br style='mso-data-placement: same-cell'>4: email<br style='mso-data-placement: same-cell'>5: self-training",edu_type:"1: 전사<br style='mso-data-placement: same-cell'>2: 신규<br style='mso-data-placement: same-cell'>3: 부서별교육",edu_start_date:"2016-09-01",edu_end_date:"2016-09-03",edu_time:"60",edu_pass_yn:"Y: 예<br style='mso-data-placement: same-cell'>N: 아니요",memo:""};if($.varExcelTemplate){$.varExcelTemplate.unshift(header);excelDown($.varExcelTemplate,column,"PV교육사항관리")}else{MessageBoxShow("데이터가 없습니다.");return}}else{if(id=="btnUpLoad"){$.popUpCallId="btnUpLoad";var param={};param.placeHolder="1열부터 순서대로\n\n부서ID, 부서명, 사원ID, 사원명, 교육과정명, 교육구분, 교육시작일, 교육종료일, 교육시간(분), 수강여부, 비고\n\n모든 데이터는 코드값으로 입력하셔야 합니다.";param.cId=["dept_code","dept_name","emp_code","emp_full_name","edu_name","edu_method","edu_type","edu_start_date","edu_end_date","edu_time","edu_pass_yn","memo"];g_main.openPopup("popPaste.html","popPaste","엑셀자료삽입",600,355,"","",param,"","")}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){if(id=="bteDept"){$.popUpCallId=id;var param={dept_name:$.bteDept.getText()||""};g_main.openPopup("popDept.html","popDept","부서팝업",350,600,"","",param,"","")}else{if(id=="bteEmp"){$.popUpCallId=id;var param={emp_name:$.bteEmp.getText()||""};g_main.openPopup("popEmp.html","popEmp","사원팝업",750,500,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){if(cInd=="emp_full_name"||cInd=="dept_name"){$.varRowId=rId;$.popUpCallId="grdList";var param={emp_name:$.bteEmp.getText()||""};g_main.openPopup("popEmp.html","popEmp","사원팝업",750,500,"","",param,"","")}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){if(id=="grdList"){if(cInd.id=="emp_code"||cInd.id=="emp_full_name"){$.varRowId=rId;$.popUpCallId="grdList";var param={employee_id:"",emp_name:cInd.value||"",p3:"",p4:"",p5:""};g_main.openPopup("popEmp.html","popEmp","사원팝업",750,500,"","",param,"","")}}};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnNew"){$.grdList.addRow({edu_start_date:getToday("-"),edu_end_date:getToday("-")})}else{if(btnId=="btnSave"){confirmBoxShow("저장하시시겠습니까?",function(){if(g_main.msgShare==true){saveList("")}})}else{if(btnId=="btnDelete"){var rId=$.grdList.getSelectedRowIdx();if(rId<0){return}if($.grdList.getRowStatus(rId)=="U"){confirmBoxShow("삭제 하시겠습니까?",function(){if(g_main.msgShare==true){saveList("D");$.grdList.deleteRow(rId)}})}else{$.grdList.deleteRow(rId)}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popDept"){if($.popUpCallId=="bteDept"){$.bteDept.setText(popResult.dept_name);$.bteDept.setValue(popResult.dept_code)}}else{if(id=="popEmp"){if($.popUpCallId=="bteEmp"){$.bteEmp.setText(popResult.emp_name);$.bteEmp.setValue(popResult.employee_id)}else{if($.popUpCallId=="grdList"){$.grdList.setValue($.varRowId,"dept_code",popResult.dept_code);$.grdList.setValue($.varRowId,"dept_name",popResult.dept_name);$.grdList.setValue($.varRowId,"emp_code",popResult.employee_id);$.grdList.setValue($.varRowId,"emp_full_name",popResult.emp_name)}}}else{if(id=="popPaste"){if($.popUpCallId=="btnUpLoad"){$.grdList.addRows(popResult.paste)}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>