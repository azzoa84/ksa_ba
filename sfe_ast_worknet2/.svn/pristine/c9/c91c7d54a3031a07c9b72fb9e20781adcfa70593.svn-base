<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panBase=null;$.panFile=null;$.grdFile=null;$.panConfirm=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.btnReportYnSave=null;$.btnSeminarCancel=null;$.memCPDescr=null;$.lblCpId=null;$.txtCpId=null;$.lblStatus=null;$.cmbStatus=null;$.lblAppDate=null;$.dteAppDate=null;$.lblEmp=null;$.cmbEmp=null;$.lblPm=null;$.cmbEmpPm=null;$.lblNoticeNo=null;$.txtNoticeNo=null;$.lblProductCode=null;$.cmbProductCode=null;$.lblCpConductOrg=null;$.txtCpConductOrg=null;$.lblConfirmNo=null;$.txtConfirmNo=null;$.lblCpSymposium=null;$.txtCpSymposium=null;$.lblCpDate=null;$.dteStartDate=null;$.lblEx1=null;$.dteEndDate=null;$.lblSubmitDate=null;$.dteSubmitStartDate=null;$.lblEx2=null;$.dteSubmitEndDate=null;$.lblNotedItems=null;$.memNotedItems=null;$.lblCpTotalAmt=null;$.speCpTotalAmt=null;$.lblEx3=null;$.lblCpDonationDate=null;$.dteCpDonationDate=null;$.lblBoothQty=null;$.txtBoothQty=null;$.lblBoothAmt=null;$.speBoothAmt=null;$.lblEx4=null;$.lblEx5=null;$.lblAdDesc=null;$.txtAdDesc=null;$.lblAdAmt=null;$.speAdAmt=null;$.lblEx6=null;$.lblBanner=null;$.txtBanner=null;$.lblSympoYn=null;$.chkSatelliteYn=null;$.lblCpPlace=null;$.txtCpPlace=null;$.lblReportYn=null;$.chkReportYN=null;$.lblApprovalYn=null;$.chkApprovalYN=null;$.btnReviewApproveYN=null;$.btnMAConfirm=null;$.btnMACancel=null;$.cpDocNo="";$.beforeCpId="";$.beforeCpCode="";function fnEnabelSet(bo){if(bo){$.panBase.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"])}else{$.panBase.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.cmbProductCode.setEnable(bo);$.txtCpSymposium.setReadOnly(!bo);$.txtConfirmNo.setReadOnly(!bo);$.txtCpConductOrg.setReadOnly(!bo);$.txtCpPlace.setReadOnly(!bo);$.dteStartDate.setEnable(bo);$.dteEndDate.setEnable(bo);$.speCpTotalAmt.setEnable(bo)}function closeSharePopUp(share){share.cp_descr=$.memCPDescr.getValue();g_popupStack.setData(share);g_popupStack.close()}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txtCpId.getValue(),"Y","#UserID#"]);return json}function saveReportYN(workType){var json=createJSON_S(workType);callQuery(["req",json],workType,$)}function createJSON_S2(workType){if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()<0){MessageBoxShow("국제학술대회 확인서, 규약심의 캡쳐화면, Sponsorship 안내문, 계약서는 필수 첨부파일입니다.");return false}else{var bFileOK=false;var bFileOK2=false;var bFileOK3=false;for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"local_fname")==""){MessageBoxShow("파일명은(는) 필수 항목입니다.");return false}if($.grdFile.getValue(i,"file_type")=="017"){bFileOK=true}else{if($.grdFile.getValue(i,"file_type")=="020"){bFileOK2=true}else{if($.grdFile.getValue(i,"file_type")=="046"){bFileOK3=true}}}}if(!bFileOK||!bFileOK2||!bFileOK3){MessageBoxShow("국제학술대회 확인서, 규약심의 캡쳐화면, Sponsorship 안내문, 계약서는 필수 첨부파일입니다.");return false}}}var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if(workType=="N"||workType=="U"){if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=i;strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}}var json=createExecuteParamInfo("P_crmCPInterSymposiumBefore_S",[workType,$.txtCpId.getValue(),$.cpDocNo,$.cmbEmp.getValue(),"#DeptCode#",$.cmbEmpPm.getValue(),$.txtNoticeNo.getValue(),$.cmbProductCode.getValue(),$.txtCpConductOrg.getValue(),$.txtConfirmNo.getValue(),$.txtCpSymposium.getValue(),$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.txtCpPlace.getValue(),$.dteCpDonationDate.getValue(),$.dteSubmitStartDate.getValue(),$.dteSubmitEndDate.getValue(),$.memNotedItems.getValue(),$.speCpTotalAmt.getValue(),$.txtBoothQty.getValue(),$.speBoothAmt.getValue(),$.txtAdDesc.getValue(),$.speAdAmt.getValue(),$.txtBanner.getValue(),$.chkSatelliteYn.getValue(),$.dteAppDate.getValue(),"CP25","#UserID#",strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname]);return json}function saveCpSymposiumAfter(workType){if(!validateControls([$.dteAppDate,$.cmbEmp,$.txtNoticeNo,$.txtCpConductOrg,$.txtConfirmNo,$.txtCpSymposium,$.dteStartDate,$.dteEndDate,$.dteSubmitStartDate,$.dteSubmitEndDate,$.speCpTotalAmt,$.txtCpPlace])){return}if(workType!="D"){workType=$.txtCpId.getValue()==""?"N":"U"}if(g_main.session.getValue("DeptCode")==g_main.session.getValue("CPDeptCode")){var json=createJSON_S2(workType);if(json){callQuery(["req",json],workType,$)}}else{if(Number($.dteStartDate.getValue())>Number($.dteEndDate.getValue())){MessageBoxShow("시작일은 종료일보다 빨라야 합니다.");return}var json=createJSON_S2(workType);if(json){callQuery(["req",json],workType,$)}}}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,810);$.panMain.setText("");$.panMain.setBottomLine(true);$.panBase=new FingerPanel(host,"panBase",0,0,1200,465);$.panBase.setText("국제학술대회 개최, 운영지원 - 사전");$.panBase.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,475,1200,205);$.panFile.setText("첨부서류");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,160);$.panConfirm=new FingerPanel(host,"panConfirm",0,695,1200,110);$.panConfirm.setText("");$.panConfirm.setBottomLine(true);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,45);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,55,120,45);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",890,5,90,95);$.btnMemoSave.setText("메모저장");$.btnReportYnSave=new FingerButton(host,"btnReportYnSave",975,5,120,20);$.btnReportYnSave.setText("협회신고완료");$.btnSeminarCancel=new FingerButton(host,"btnSeminarCancel",975,75,120,20);$.btnSeminarCancel.setText("개최취소");$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",120,700,750,90);$.lblCpId=new FingerLabel(host,"lblCpId",10,10,100,20);$.lblCpId.setText("문서번호");$.txtCpId=new FingerEdit(host,"txtCpId",115,10,140,20);$.lblStatus=new FingerLabel(host,"lblStatus",825,40,100,20);$.lblStatus.setText("승인여부");$.cmbStatus=new FingerComboBox(host,"cmbStatus",930,40,140,20);$.lblAppDate=new FingerLabel(host,"lblAppDate",825,70,100,20);$.lblAppDate.setText("승인요청일");$.dteAppDate=new FingerDateEdit(host,"dteAppDate",930,70,140,20);$.lblEmp=new FingerLabel(host,"lblEmp",405,10,100,20);$.lblEmp.setText("담당자");$.cmbEmp=new FingerComboBox(host,"cmbEmp",510,10,140,20);$.lblPm=new FingerLabel(host,"lblPm",825,10,100,20);$.lblPm.setText("PM");$.cmbEmpPm=new FingerComboBox(host,"cmbEmpPm",930,10,140,20);$.lblNoticeNo=new FingerLabel(host,"lblNoticeNo",10,40,100,20);$.lblNoticeNo.setText("심의번호");$.txtNoticeNo=new FingerEdit(host,"txtNoticeNo",115,40,295,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",405,40,100,20);$.lblProductCode.setText("품목");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",510,40,140,20);$.lblCpConductOrg=new FingerLabel(host,"lblCpConductOrg",10,70,100,20);$.lblCpConductOrg.setText("주최단체");$.txtCpConductOrg=new FingerEdit(host,"txtCpConductOrg",115,70,295,20);$.lblConfirmNo=new FingerLabel(host,"lblConfirmNo",405,70,100,20);$.lblConfirmNo.setText("확인번호");$.txtConfirmNo=new FingerEdit(host,"txtConfirmNo",510,70,295,20);$.lblCpSymposium=new FingerLabel(host,"lblCpSymposium",10,100,100,20);$.lblCpSymposium.setText("학술대회명");$.txtCpSymposium=new FingerEdit(host,"txtCpSymposium",115,100,690,20);$.lblCpDate=new FingerLabel(host,"lblCpDate",10,130,100,20);$.lblCpDate.setText("개최기간");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",115,130,140,20);$.lblEx1=new FingerLabel(host,"lblEx1",250,130,20,20);$.lblEx1.setText("~");$.dteEndDate=new FingerDateEdit(host,"dteEndDate",270,130,140,20);$.lblSubmitDate=new FingerLabel(host,"lblSubmitDate",405,130,100,20);$.lblSubmitDate.setText("신청기간");$.dteSubmitStartDate=new FingerDateEdit(host,"dteSubmitStartDate",510,130,140,20);$.lblEx2=new FingerLabel(host,"lblEx2",645,130,20,20);$.lblEx2.setText("~");$.dteSubmitEndDate=new FingerDateEdit(host,"dteSubmitEndDate",665,130,140,20);$.lblNotedItems=new FingerLabel(host,"lblNotedItems",0,160,110,20);$.lblNotedItems.setText("신청사 참고사항");$.memNotedItems=new FingerMemoEdit(host,"memNotedItems",115,160,685,55);$.lblCpTotalAmt=new FingerLabel(host,"lblCpTotalAmt",10,225,100,20);$.lblCpTotalAmt.setText("총지원금액");$.speCpTotalAmt=new FingerSpinEdit(host,"speCpTotalAmt",115,225,140,20);$.lblEx3=new FingerLabel(host,"lblEx3",250,225,20,20);$.lblEx3.setText("원");$.lblCpDonationDate=new FingerLabel(host,"lblCpDonationDate",405,225,100,20);$.lblCpDonationDate.setText("기부일자");$.dteCpDonationDate=new FingerDateEdit(host,"dteCpDonationDate",510,225,140,20);$.lblBoothQty=new FingerLabel(host,"lblBoothQty",10,255,100,20);$.lblBoothQty.setText("부스개수");$.txtBoothQty=new FingerEdit(host,"txtBoothQty",115,255,140,20);$.lblBoothAmt=new FingerLabel(host,"lblBoothAmt",405,255,100,20);$.lblBoothAmt.setText("부스비용");$.speBoothAmt=new FingerSpinEdit(host,"speBoothAmt",510,255,140,20);$.lblEx4=new FingerLabel(host,"lblEx4",250,255,20,20);$.lblEx4.setText("개");$.lblEx5=new FingerLabel(host,"lblEx5",645,255,20,20);$.lblEx5.setText("원");$.lblAdDesc=new FingerLabel(host,"lblAdDesc",10,285,100,20);$.lblAdDesc.setText("광고내역");$.txtAdDesc=new FingerEdit(host,"txtAdDesc",115,285,295,20);$.lblAdAmt=new FingerLabel(host,"lblAdAmt",405,285,100,20);$.lblAdAmt.setText("광고금액");$.speAdAmt=new FingerSpinEdit(host,"speAdAmt",510,285,140,20);$.lblEx6=new FingerLabel(host,"lblEx6",645,285,20,20);$.lblEx6.setText("원");$.lblBanner=new FingerLabel(host,"lblBanner",10,315,100,20);$.lblBanner.setText("홈페이지배너");$.txtBanner=new FingerEdit(host,"txtBanner",115,315,295,20);$.lblSympoYn=new FingerLabel(host,"lblSympoYn",405,315,100,20);$.lblSympoYn.setText("심포지움");$.chkSatelliteYn=new FingerCheckBox(host,"chkSatelliteYn",505,317,140,20);$.chkSatelliteYn.setText("Satellite");$.lblCpPlace=new FingerLabel(host,"lblCpPlace",10,345,100,20);$.lblCpPlace.setText("개최장소");$.txtCpPlace=new FingerEdit(host,"txtCpPlace",115,345,295,20);$.lblReportYn=new FingerLabel(host,"lblReportYn",825,100,100,20);$.lblReportYn.setText("협회신고여부");$.chkReportYN=new FingerCheckBox(host,"chkReportYN",930,103,140,20);$.chkReportYN.setText("협회신고");$.lblApprovalYn=new FingerLabel(host,"lblApprovalYn",825,130,100,20);$.lblApprovalYn.setText("접수완료여부");$.chkApprovalYN=new FingerCheckBox(host,"chkApprovalYN",930,133,140,20);$.chkApprovalYN.setText("접수완료");$.btnReviewApproveYN=new FingerButton(host,"btnReviewApproveYN",975,40,120,20);$.btnReviewApproveYN.setText("협회접수완료");$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1090,5,120,45);$.btnMAConfirm.setText("MA승인");$.btnMACancel=new FingerButton(host,"btnMACancel",1090,55,120,45);$.btnMACancel.setText("MA승인취소");$.dteAppDate.setEnable(false);$.dteAppDate.setAllowBlank(false,"승인요청일");$.cmbEmp.setAllowBlank(false,"담당자");$.txtNoticeNo.setAllowBlank(false,"심의번호");$.txtCpConductOrg.setAllowBlank(false,"주최단체");$.txtConfirmNo.setAllowBlank(false,"확인번호");$.txtCpSymposium.setAllowBlank(false,"학술대회명");$.dteStartDate.setAllowBlank(false,"개최기간");$.dteEndDate.setAllowBlank(false,"개최기간");$.dteSubmitStartDate.setAllowBlank(false,"신청기간");$.dteSubmitEndDate.setAllowBlank(false,"신청기간");$.speCpTotalAmt.setAllowBlank(false,"총지원금액");$.txtCpPlace.setAllowBlank(false,"개최장소");$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);$.dteAppDate.setValue(getToday());$.grdFile.colIdx=$.grdFile.setColumns([new FingerDataGridColumn("cp_id",50,"left","string","CP아이디",{hidden:true}),new FingerDataGridColumn("seq",100,"left","string","일렬번호",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("server_path",215,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",500,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.panBase.addButton("btnDelete","삭제");$.panBase.addButton("btnSave","저장");$.panBase.addButton("btnNew","신규");$.panBase.setButtonAction("btnNew","new");$.panBase.setButtonAction("btnSave","save");$.panBase.setButtonAction("btnDelete","delete");$.panFile.addButtons(["btnDelete","btnAdd"]);$.cmbEmp.setEmptyRow(true);$.cmbEmpPm.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbProductCode.setEmptyRow(true);$.cmbEmp.setEnable(false);$.txtCpId.setReadOnly(true);$.chkReportYN.setEnable(false);$.chkApprovalYN.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panBase);$.panMain.add($.panFile);$.panMain.add($.panConfirm);$.panMain.add($.memCPDescr);$.panBase.add($.lblCpId);$.panBase.add($.txtCpId);$.panBase.add($.lblStatus);$.panBase.add($.cmbStatus);$.panBase.add($.lblAppDate);$.panBase.add($.dteAppDate);$.panBase.add($.lblEmp);$.panBase.add($.cmbEmp);$.panBase.add($.lblPm);$.panBase.add($.cmbEmpPm);$.panBase.add($.lblNoticeNo);$.panBase.add($.txtNoticeNo);$.panBase.add($.lblProductCode);$.panBase.add($.cmbProductCode);$.panBase.add($.lblCpConductOrg);$.panBase.add($.txtCpConductOrg);$.panBase.add($.lblConfirmNo);$.panBase.add($.txtConfirmNo);$.panBase.add($.lblCpSymposium);$.panBase.add($.txtCpSymposium);$.panBase.add($.lblCpDate);$.panBase.add($.dteStartDate);$.panBase.add($.lblEx1);$.panBase.add($.dteEndDate);$.panBase.add($.lblSubmitDate);$.panBase.add($.dteSubmitStartDate);$.panBase.add($.lblEx2);$.panBase.add($.dteSubmitEndDate);$.panBase.add($.lblNotedItems);$.panBase.add($.memNotedItems);$.panBase.add($.lblCpTotalAmt);$.panBase.add($.speCpTotalAmt);$.panBase.add($.lblEx3);$.panBase.add($.lblCpDonationDate);$.panBase.add($.dteCpDonationDate);$.panBase.add($.lblBoothQty);$.panBase.add($.txtBoothQty);$.panBase.add($.lblBoothAmt);$.panBase.add($.speBoothAmt);$.panBase.add($.lblEx4);$.panBase.add($.lblEx5);$.panBase.add($.lblAdDesc);$.panBase.add($.txtAdDesc);$.panBase.add($.lblAdAmt);$.panBase.add($.speAdAmt);$.panBase.add($.lblEx6);$.panBase.add($.lblBanner);$.panBase.add($.txtBanner);$.panBase.add($.lblSympoYn);$.panBase.add($.chkSatelliteYn);$.panBase.add($.lblCpPlace);$.panBase.add($.txtCpPlace);$.panBase.add($.lblReportYn);$.panBase.add($.chkReportYN);$.panBase.add($.lblApprovalYn);$.panBase.add($.chkApprovalYN);$.panFile.add($.grdFile);$.panConfirm.add($.btnSeminarCancel);$.panConfirm.add($.btnReportYnSave);$.panConfirm.add($.btnMemoSave);$.panConfirm.add($.btnCancel);$.panConfirm.add($.btnConfirm);$.panConfirm.add($.btnReviewApproveYN);$.panConfirm.add($.btnMAConfirm);$.panConfirm.add($.btnMACancel);relocateChildIndexInPanel([$.panBase]);$.txtBanner.setPlaceholder("배너 광고가 있는 경우 내역을 입력 해 주세요.");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbEmpPm.setColumn("employee_id","emp_name");$.cmbProductCode.setColumn("product_code","product_name");var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM192|L_CRM0111|L_CRM0084");setComboBind([$.cmbEmp,$.cmbEmpPm,$.cmbStatus,$.cmbProductCode],ds);var strQuery=" and extra_field1 LIKE '%' + 'CP25' + '%'";var ds=bizComponentData2($,"Q4","L_CRM0110",strQuery);$.grdFile.setColumnDropDownList("file_type",ds.resultList[0],null,true);$.cmbEmp.setValue(g_main.session.getValue("UserID"));if($.p_argument&&$.p_argument.length>0){$.cmbStatus.setEnable(false);var rs=$.p_argument[0][0];if(rs.CallType){$.strCallType=rs.CallType}$.cmbStatus.setValue(rs.cp_status);$.memCPDescr.setValue(rs.cp_descr);$.bAllReport=rs.AllReport;$.bMyReport=rs.MyReport;$.bConfirm=rs.Confirm;if(!$.bConfirm){$.panConfirm.setVisible(false);$.memCPDescr.setReadOnly(true)}else{$.panConfirm.setVisible(true);$.memCPDescr.setReadOnly(false)}if(rs.save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnabelSet(false)}if($.strCallType=="BUCall"){$.panBase.disableButton(["btnSave","btnDelete","btnNew"]);$.panConfirm.setVisible(false)}$.txtCpId.setValue(rs.cp_id);$.cmbStatus.setValue(rs.cp_status);$.dteAppDate.setValue(rs.app_date);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbEmpPm.setValue(rs.cp_emp_pm);$.txtNoticeNo.setValue(rs.notice_no);$.cmbProductCode.setValue(rs.product_code);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtConfirmNo.setValue(rs.confirm_no);$.txtCpSymposium.setValue(rs.cp_symposium);$.dteStartDate.setValue(rs.cp_start_date);$.dteEndDate.setValue(rs.cp_end_date);$.dteSubmitStartDate.setValue(rs.submit_start_date);$.dteSubmitEndDate.setValue(rs.submit_end_date);$.memNotedItems.setValue(rs.noted_items);$.speCpTotalAmt.setValue(rs.cp_total_amt);$.dteCpDonationDate.setValue(rs.cp_donation_date);$.txtBoothQty.setValue(rs.booth_qty);$.speBoothAmt.setValue(rs.booth_amt);$.txtAdDesc.setValue(rs.ad_desc);$.speAdAmt.setValue(rs.ad_amt);$.txtBanner.setValue(rs.banner);$.chkSatelliteYn.setValue(rs.satellite_yn);$.txtCpPlace.setValue(rs.cp_place);$.cpDocNo=rs.cp_doc_no;$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;setDataGrid([$.grdFile],$.p_argument[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn);$.chkApprovalYN.setValue(rs.approve_yn);if($.cmbStatus.getValue()=="10"){$.btnConfirm.setEnable(true);$.btnCancel.setEnable(false);if(!$.bSave){$.panBase.disableButton(["btnDelete"])}}else{if($.cmbStatus.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panBase.disableButton(["btnDelete"]);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnMemoSave.setVisible(false);$.btnReportYnSave.setVisible(false);$.btnSeminarCancel.setVisible(false);$.btnReviewApproveYN.setVisible(false);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}}else{$.panConfirm.setVisible(false);$.memCPDescr.setVisible(false);$.cmbStatus.setEnable(false);$.cmbStatus.setValue("10")}};$.callback=function(type,ds){if(type=="D"){if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.")}var share={save_mode:"DEL"};closeSharePopUp(share)}else{if(type=="N"||type=="U"){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(type=="N"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txtCpId.setValue(id[0]);$.cpDocNo=id[1]}MessageBoxShow("정상적으로 저장 되었습니다.")}}else{MessageBoxShow("정상적으로 수정 되었습니다.")}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){var share={};if(id=="btnConfirm"){share.save_mode="CONFIRM";closeSharePopUp(share)}else{if(id=="btnCancel"){share.save_mode="CANCEL";closeSharePopUp(share)}else{if(id=="btnMemoSave"){share.save_mode="MEMO";closeSharePopUp(share)}else{if(id=="btnMAConfirm"){share.save_mode="MACONFIRM";closeSharePopUp(share)}else{if(id=="btnMACancel"){share.save_mode="MACANCEL";closeSharePopUp(share)}else{if(id=="btnReportYnSave"){if($.chkReportYN.getValue()=="N"){confirmBoxShow("협회신고완료 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("REPORT");$.chkReportYN.setValue("Y")}})}else{if($.chkReportYN.getValue()=="Y"){confirmBoxShow("협회신고완료 취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("NOREPORT");$.chkReportYN.setValue("N")}})}}}else{if(id=="btnSeminarCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("CANCEL")}})}else{if(id=="btnReviewApproveYN"){confirmBoxShow("협회접수완료 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveReportYN("APPROVE")}})}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panBase"){if(btnId=="btnSave"){saveCpSymposiumAfter()}else{if(btnId=="btnDelete"){if($.txtCpId.getValue()==""){return}confirmBoxShow("["+$.txtCpId.getValue()+"] 국제학술대회 개최.운영 지원(사전)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCpSymposiumAfter("D")}})}else{if(btnId=="btnNew"){$.panBase.clear();$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteAppDate.setValue(getToday());$.grdFile.clear()}else{if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={cp_type:"CP25"};g_main.openPopup("popCPDonationBf.html","popCPDonationBf","",0,0,"","",param,"","")}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){fileList[i].file_type="";fileList[i].seq=seq+i;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPDonationBf"){if($.popUpCallId=="btnLoad"){if(popResult[0][0].before_cp_id){var rs=popResult[0][0];$.beforeCpId=rs.before_cp_id;$.beforeCpCode=rs.before_cp_code;$.beforeCpDocNo=rs.before_cp_doc_no;$.cmbEmp.setValue(rs.cp_emp_id);$.cmbCpEmpPm.setValue(rs.cp_emp_pm);$.txtNoticeNo.setValue(rs.notice_no);$.cmbProductCode.setValue(rs.product_code);$.cmbStatus.setValue(rs.cp_status);$.txtCpSymposium.setValue(rs.cp_symposium);$.dteAppDate.setValue(rs.app_date);$.txtCpConductOrg.setValue(rs.cp_conduct_org);$.txtCpDonEmp.setValue(rs.cp_don_emp);$.txtCpDonTel.setValue(rs.cp_don_tel);$.txtCpDonEmail.setValue(rs.cp_don_email);$.dteStart.setValue(rs.cp_start_date);$.dteEnd.setValue(rs.cp_end_date);$.dteNoticeTerm.setValue(rs.limit_date);$.speCpDonationAmt.setValue(rs.cp_donation_amt);$.dteCpDonationDate.setValue(rs.cp_donation_date);$.speCpVoteAmt.setValue(rs.cp_vote_amt);$.txtCpPlace.setValue(rs.cp_place);setDataGrid([$.grdFile],popResult[1],true);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn)}else{$.beforeCpId="";$.beforeCpCode="";$.beforeCpDocNo="";$.panBase.clear();$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.cmbStatus.setValue("10");$.dteAppDate.setValue(getToday());$.grdFile.clear();$.memCPDescr.setValue("");$.chkReportYN.setValue("")}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>