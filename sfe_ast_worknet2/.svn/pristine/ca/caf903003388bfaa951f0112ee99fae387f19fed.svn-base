<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.panApprList=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.lblTitle=null;$.txtTitle=null;$.btnModLine=null;$.btnSubmit=null;$.btnTmpSave=null;$.htmlApprList=null;$.lblDeptName=null;$.lblEmpName=null;$.lblStartDate=null;$.lblEndDate=null;$.lblVacDate=null;$.lblVacType=null;$.lblVacDesc=null;$.lblEmPhone=null;$.lblEmPlace=null;$.txtDeptName=null;$.txtEmpName=null;$.dteStartDate=null;$.dteEndDate=null;$.txtVacDay=null;$.rdolVacType=null;$.memVacDesc=null;$.txtEmPhone=null;$.txtEmPlace=null;$.btnFileAdd=null;$.btnFileDelete=null;$.btnDocAdd=null;$.btnDocDelete=null;$.btnCreLine=null;$.ediTest=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFSickLeave"]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmWFVacationReq_S",[workType,$.wfDocId,$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.txtVacDay.getValue(),$.rdolVacType.getValue(),$.memVacDesc.getValue(),$.txtEmPhone.getValue(),$.txtEmPlace.getValue(),"#DeptCode#","#UserID#","",""]);return json}function searchWFDocument(workType){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function saveWFVacation(workType){if(!validateControls([$.dteStartDate,$.dteEndDate,$.memVacDesc,$.txtEmPhone])){return}else{if($.dteStartDate.getValue()>$.dteEndDate.getValue()){MessageBoxShow("시작일이 종료일보다 늦습니다. 다시 선택해주세요.");return}else{if(workType=="btnSubmit"){saveWFDocument("","Y")}else{if(workType=="btnTmpSave"){saveWFDocument("","N")}}var json=createJSON_S("N");callQuery(["req",json],"N",$)}}}function saveWFDocument(workType,docType){$.wfEmployeeId="";$.wfLineYn="";$.refEmployeeId="";$.refLineYn="";$.rcvEmployeeId="";$.rcvLineYn="";$.serverPath="";$.serverFname="";$.localFname="";$.relWfDocId="";var ds=commWFDocumentS(workType==""?"N":workType,"",$.txtTitle.getValue(),"","","#UserID#",docType,$.businessId,"","#UserID#","","","","","","","","","","","","","","");if(ds==null||ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){return false}if(ds.returnStr!=""){$.wfDocId=ds.returnStr}return true}function getToday(){var date=new Date();var year=date.getFullYear();var month=date.getMonth()+1;var day=date.getDate();if((""+month).length==1){month="0"+month}if((""+day).length==1){day="0"+day}return""+year+month+day}function dateChange(){var today=new Date();var dateString=$.dteEndDate.getText();var dateString2=$.dteStartDate.getText();var dateArray=dateString.split("-");var dateArray2=dateString2.split("-");var dateObj=new Date(dateArray[0],Number(dateArray[1])-1,dateArray[2]);var dateObj2=new Date(dateArray2[0],Number(dateArray2[1])-1,dateArray2[2]);var betweenDay=(dateObj.getTime()-dateObj2.getTime())/1000/60/60/24;$.txtVacDay.setValue(String.format("{0}일",(betweenDay+1).toString()))}String.format=function(){var theString=arguments[0];for(var i=1;i<arguments.length;i++){var regEx=new RegExp("\\{"+(i-1)+"\\}","gm");theString=theString.replace(regEx,arguments[i])}return theString};$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1105);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine();$.panApprList=new FingerPanel(host,"panApprList",0,65,1200,120);$.panApprList.setText("");$.panApprList.setBottomLine(true);$.panWFMain=new FingerPanel(host,"panWFMain",0,195,1200,310);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,515,1200,300);$.panWFDetail.setText("기안상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,825,440,280);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,825,750,280);$.panDoc.setText("기결문서");$.panDoc.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",120,15,500,20);$.btnModLine=new FingerButton(host,"btnModLine",775,15,120,20);$.btnModLine.setText("결재라인추가");$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.htmlApprList=new FingerHTMLView(host,"htmlApprList",0,0,1200,120);$.lblDeptName=new FingerLabel(host,"lblDeptName",0,10,100,20);$.lblDeptName.setText("소속부서");$.lblEmpName=new FingerLabel(host,"lblEmpName",235,10,100,20);$.lblEmpName.setText("신청인");$.lblStartDate=new FingerLabel(host,"lblStartDate",0,40,100,20);$.lblStartDate.setText("시작일");$.lblEndDate=new FingerLabel(host,"lblEndDate",235,40,100,20);$.lblEndDate.setText("종료일");$.lblVacDate=new FingerLabel(host,"lblVacDate",480,40,100,20);$.lblVacDate.setText("기간(일)");$.lblVacType=new FingerLabel(host,"lblVacType",0,70,100,20);$.lblVacType.setText("신청구분");$.lblVacDesc=new FingerLabel(host,"lblVacDesc",0,100,100,20);$.lblVacDesc.setText("사유");$.lblEmPhone=new FingerLabel(host,"lblEmPhone",0,180,100,20);$.lblEmPhone.setText("비상연락처");$.lblEmPlace=new FingerLabel(host,"lblEmPlace",235,180,100,20);$.lblEmPlace.setText("장소");$.txtDeptName=new FingerEdit(host,"txtDeptName",105,10,140,20);$.txtEmpName=new FingerEdit(host,"txtEmpName",340,10,140,20);$.dteStartDate=new FingerDateEdit(host,"dteStartDate",105,40,140,20);$.dteEndDate=new FingerDateEdit(host,"dteEndDate",340,40,140,20);$.txtVacDay=new FingerEdit(host,"txtVacDay",585,40,140,20);$.rdolVacType=new FingerRadioBox(host,"rdolVacType",105,70,140,25);$.memVacDesc=new FingerMemoEdit(host,"memVacDesc",105,100,615,70);$.txtEmPhone=new FingerEdit(host,"txtEmPhone",105,180,140,20);$.txtEmPlace=new FingerEdit(host,"txtEmPlace",340,180,385,20);$.btnFileAdd=new FingerButton(host,"btnFileAdd",295,-37.5,80,20);$.btnFileAdd.setText("파일추가");$.btnFileDelete=new FingerButton(host,"btnFileDelete",360,-37.5,80,20);$.btnFileDelete.setText("파일삭제");$.btnDocAdd=new FingerButton(host,"btnDocAdd",605,-37.5,80,20);$.btnDocAdd.setText("문서추가");$.btnDocDelete=new FingerButton(host,"btnDocDelete",670,-37.5,80,20);$.btnDocDelete.setText("문서삭제");$.btnCreLine=new FingerButton(host,"btnCreLine",885,15,120,20);$.btnCreLine.setText("결재라인생성");$.ediTest=new FingerWebEditor(host,"ediTest",0,10,1200,250);$.panTitle.setBorder(true);$.panApprList.setBorder(true);$.dteStartDate.setAllowBlank(false,"시작일");$.dteEndDate.setAllowBlank(false,"종료일");$.memVacDesc.setAllowBlank(false,"사유");$.txtEmPhone.setAllowBlank(false,"비상연락처");$.rdolVacType.addButtons([{sub_code:"80",code_name:"병가"}]);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panApprList);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panTitle.add($.btnTmpSave);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnModLine);$.panTitle.add($.txtTitle);$.panTitle.add($.lblTitle);$.panTitle.add($.btnCreLine);$.panApprList.add($.htmlApprList);$.panWFMain.add($.lblEmPlace);$.panWFMain.add($.lblEmPhone);$.panWFMain.add($.lblVacDesc);$.panWFMain.add($.lblVacType);$.panWFMain.add($.lblVacDate);$.panWFMain.add($.lblEndDate);$.panWFMain.add($.lblStartDate);$.panWFMain.add($.lblEmpName);$.panWFMain.add($.lblDeptName);$.panWFMain.add($.txtDeptName);$.panWFMain.add($.txtEmpName);$.panWFMain.add($.dteStartDate);$.panWFMain.add($.dteEndDate);$.panWFMain.add($.txtVacDay);$.panWFMain.add($.rdolVacType);$.panWFMain.add($.memVacDesc);$.panWFMain.add($.txtEmPhone);$.panWFMain.add($.txtEmPlace);$.panWFDetail.add($.ediTest);$.panFile.add($.btnFileAdd);$.panFile.add($.btnFileDelete);$.panDoc.add($.btnDocAdd);$.panDoc.add($.btnDocDelete);searchWFDocument();$.dteStartDate.setValue(getToday());$.dteEndDate.setValue(getToday());dateChange();$.rdolVacType.setValue("80");$.txtDeptName.setValue(g_main.session.getValue("DeptName"));$.txtEmpName.setValue(g_main.session.getValue("UserName"));$.txtDeptName.setReadOnly(true);$.txtEmpName.setReadOnly(true);$.txtVacDay.setReadOnly(true);$.wfDocId=""};$.callback=function(type,ds){if(type=="Q3"){$.businessId=ds.resultList[0][0].business_id;$.wfType=ds.resultList[0][0].wf_type;$.txtTitle.setValue(ds.resultList[0][0].business_title)}else{if(type=="N"){searchWFDocument();$.dteStartDate.setValue(getToday());$.dteEndDate.setValue(getToday());dateChange();$.rdolVacType.setValue("80");$.txtDeptName.setValue(g_main.session.getValue("DeptName"));$.txtEmpName.setValue(g_main.session.getValue("UserName"));$.memVacDesc.setValue("");$.txtEmPhone.setValue("");$.txtEmPlace.setValue("")}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSubmit"){saveWFVacation(id)}else{if(id=="btnTmpSave"){saveWFVacation(id)}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStartDate"){dateChange()}else{if(id=="dteEndDate"){dateChange()}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>