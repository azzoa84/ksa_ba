<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panInfo1=null;$.panInfo2=null;$.panTab=null;$.tabMain=null;$.panTab1=null;$.panTab2=null;$.panTab3=null;$.panTab4=null;$.panTab5=null;$.lblYear=null;$.lblEvalName=null;$.lblGroup=null;$.lblDept=null;$.lblEmp=null;$.lblDutyCode=null;$.cmbYear=null;$.cmbEvalName=null;$.txtPeriod=null;$.cmbGroup=null;$.txtDept=null;$.bteDept=null;$.txtEmp=null;$.bteEmp=null;$.cmbDutyCode=null;$.btnSearch=null;$.lblLabel1=null;$.grdInfo2=null;$.grdList1_1=null;$.grdList1_2=null;$.grdList2_1=null;$.grdList2_2=null;$.grdList3=null;$.grdList4_1=null;$.grdList4_2=null;$.grdList5=null;$.btnSave=null;$.panInfo3=null;$.grdInfo3=null;$.memoFinalComment=null;$.lblFinalComment=null;$.lblInfo3=null;$.lblInfo3_1=null;$.lblInfo3_2=null;$.lblNotice=null;$.varDeptCode="";$.varEmpId="";$.varEvalGroupCode="";$.varEvaluatedEmp="";$.varEvalGroupNum="";$.varSGradeNum="";$.varAGradeNum="";$.varBGradeNum="";$.varCGradeNum="";$.varDGradeNum="";function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRE4260_Q",[workType,$.cmbYear.getValue(),$.cmbEvalName.getValue(),workType=="KPI_LIST"||workType=="COMP_LIST"||workType=="TOTAL"?$.varEvalGroupCode:$.cmbGroup.getValue(),$.txtEmp.getValue(),workType=="KPI_DETAIL"||workType=="COMP_DETAIL"?$.varEvaluatedEmp:""]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("HR..P_HRE4260_GradeChart_Q",[workType,$.cmbYear.getValue(),$.varEvalGroupCode,$.varEvalGroupNum]);return json}function createJSON_S(workType){var json="";var cRow=$.grdList1_1.getAllRows();if(cRow.length<1){return false}var rows=[];for(var i in cRow){rows.push([workType,$.cmbYear.getValue(),cRow[i].evaluated_emp,cRow[i].eval_kpi_period1_score1,cRow[i].eval_kpi_period2_score1,cRow[i].eval_kpi_score1,cRow[i].eval_kpi_score2,cRow[i].eval_kpi_comment,"#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRE4260_KPI_S",rows);return json}function createJSON_S2(workType){var json="";var cRow=$.grdList2_1.getAllRows();if(cRow.length<1){return false}var rows=[];for(var i in cRow){rows.push([workType,$.cmbYear.getValue(),cRow[i].evaluated_emp,cRow[i].eval_kbi_score1,cRow[i].eval_kbi_score2,cRow[i].eval_kbi_comment||"","#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRE4260_Comp_S",rows);return json}function createJSON_S3(workType){var json="";var cRow=$.grdList2_2.getAllRows();if(cRow.length<1){return false}var rows=[];for(var i in cRow){rows.push([workType,$.cmbYear.getValue(),cRow[i].evaluated_emp,cRow[i].comp_code,cRow[i].competency_2nd_grade,"#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRE4260_CompDetail_S",rows);return json}function createJSON_S4(workType){var json="";var cRow=$.grdList3.getAllRows();if(cRow.length<1){return false}var rows=[];for(var i in cRow){rows.push([workType,$.cmbYear.getValue(),$.txtEmp.getValue(),cRow[i].evaluated_emp,cRow[i].new_kpi_grade,cRow[i].new_total_grade,$.memoFinalComment.getText(),"#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRE4260_TOTAL_S",rows);return json}function searchData(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function searchGradeChart(workType){var json=createJSON_Q2(workType);callQuery(["req",json],workType,$)}function saveKPI(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$)}}function saveComp(workType){var json=createJSON_S2(workType);if(json){var ds=callExecuteSync(["req",json],workType,$)}}function saveCompDetail(workType){var json=createJSON_S3(workType);if(json){var ds=callExecuteSync(["req",json],workType,$)}}function saveTotal(workType){var json=createJSON_S4(workType);if(json){var ds=callExecuteSync(["req",json],workType,$)}}function gridClear(){$.grdInfo2.setData("");$.grdInfo3.setData("");$.grdList1_1.setData("");$.grdList1_2.setData("");$.grdList2_1.setData("");$.grdList2_2.setData("");$.grdList3.setData("")}function setReadOnly(){var row1=$.grdList1_1.getAllRows();var row2=$.grdList2_1.getAllRows();var row3=$.grdList2_2.getAllRows();var row4=$.grdList3.getAllRows();$.btnSave.setEnable(false)}function setGrade(){var row1=$.grdInfo3.getAllRows();for(var i in row1){if(row1[i].basic_info=="기본 인원(명)"){$.varSGradeNum=Number(row1[i].s_info);$.varAGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info);$.varBGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info);$.varCGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info)+Number(row1[i].c_info);$.varDGradeNum=Number(row1[i].total_info)}}var row2=$.grdList3.getAllRows();for(var j in row2){if(Number(row2[j].kpi_rank)<=$.varSGradeNum){$.grdList3.setValue(j,"org_kpi_grade","S")}else{if(Number(row2[j].kpi_rank)<=$.varAGradeNum){$.grdList3.setValue(j,"org_kpi_grade","A")}else{if(Number(row2[j].kpi_rank)<=$.varBGradeNum){$.grdList3.setValue(j,"org_kpi_grade","B")}else{if(Number(row2[j].kpi_rank)<=$.varCGradeNum){$.grdList3.setValue(j,"org_kpi_grade","C")}else{if(Number(row2[j].kpi_rank)<=$.varDGradeNum){$.grdList3.setValue(j,"org_kpi_grade","D")}}}}}if(Number(row2[j].total_rank)<=$.varSGradeNum){$.grdList3.setValue(j,"org_total_grade","S")}else{if(Number(row2[j].total_rank)<=$.varAGradeNum){$.grdList3.setValue(j,"org_total_grade","A")}else{if(Number(row2[j].total_rank)<=$.varBGradeNum){$.grdList3.setValue(j,"org_total_grade","B")}else{if(Number(row2[j].total_rank)<=$.varCGradeNum){$.grdList3.setValue(j,"org_total_grade","C")}else{if(Number(row2[j].total_rank)<=$.varDGradeNum){$.grdList3.setValue(j,"org_total_grade","D")}}}}}}}function setGrade2(){var row1=$.grdInfo3.getAllRows();for(var i in row1){if(row1[i].basic_info=="기본 인원(명)"){$.varSGradeNum=Number(row1[i].s_info);$.varAGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info);$.varBGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info);$.varCGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info)+Number(row1[i].c_info);$.varDGradeNum=Number(row1[i].total_info)}}var row2=$.grdList3.getAllRows();for(var j in row2){if(Number(row2[j].total_rank)<=$.varSGradeNum){$.grdList3.setValue(j,"new_total_grade","S")}else{if(Number(row2[j].total_rank)<=$.varAGradeNum){$.grdList3.setValue(j,"new_total_grade","A")}else{if(Number(row2[j].total_rank)<=$.varBGradeNum){$.grdList3.setValue(j,"new_total_grade","B")}else{if(Number(row2[j].total_rank)<=$.varCGradeNum){$.grdList3.setValue(j,"new_total_grade","C")}else{if(Number(row2[j].total_rank)<=$.varDGradeNum){$.grdList3.setValue(j,"new_total_grade","D")}}}}}}}function setGrade3(){var row1=$.grdInfo3.getAllRows();for(var i in row1){if(row1[i].basic_info=="기본 인원(명)"){$.varSGradeNum=Number(row1[i].s_info);$.varAGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info);$.varBGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info);$.varCGradeNum=Number(row1[i].s_info)+Number(row1[i].a_info)+Number(row1[i].b_info)+Number(row1[i].c_info);$.varDGradeNum=Number(row1[i].total_info)}}var row2=$.grdList3.getAllRows();for(var j in row2){if(Number(row2[j].kpi_rank)<=$.varSGradeNum){$.grdList3.setValue(j,"new_kpi_grade","S")}else{if(Number(row2[j].kpi_rank)<=$.varAGradeNum){$.grdList3.setValue(j,"new_kpi_grade","A")}else{if(Number(row2[j].kpi_rank)<=$.varBGradeNum){$.grdList3.setValue(j,"new_kpi_grade","B")}else{if(Number(row2[j].kpi_rank)<=$.varCGradeNum){$.grdList3.setValue(j,"new_kpi_grade","C")}else{if(Number(row2[j].kpi_rank)<=$.varDGradeNum){$.grdList3.setValue(j,"new_kpi_grade","D")}}}}}}}function checkScoreBuffer1(){var rowComp=$.grdList2_1.getAllRows();var ScoreBuffer=true;for(var i in rowComp){if(Number(rowComp[i].eval_kbi_score2)>(Number(rowComp[i].eval_kbi_score1)+0.5)){MessageBoxShow("평가 점수 변경 한도를 초과하였습니다.");ScoreBuffer=false}}return ScoreBuffer}function checkScoreBuffer2(){var rowComp=$.grdList1_1.getAllRows();var ScoreBuffer=true;for(var i in rowComp){if(Number(rowComp[i].eval_kpi_score2)>(Number(rowComp[i].eval_kpi_score1)+Number(rowComp[i].eval_kpi_special_score)+0.5)){MessageBoxShow("평가 점수 변경 한도를 초과하였습니다.");ScoreBuffer=false}}return ScoreBuffer}function checkGradeBuffer(){var rowTotal=$.grdList3.getAllRows();var GradeBuffer=true;var gradeAvg=0;var count=0;var goodAvg=5;for(var i in rowTotal){if(rowTotal[i].new_kpi_grade=="S"){gradeAvg+=10}else{if(rowTotal[i].new_kpi_grade=="A"){gradeAvg+=8}else{if(rowTotal[i].new_kpi_grade=="B+"){gradeAvg+=6}else{if(rowTotal[i].new_kpi_grade=="B"){gradeAvg+=5}else{if(rowTotal[i].new_kpi_grade=="B-"){gradeAvg+=4}else{if(rowTotal[i].new_kpi_grade=="C"){gradeAvg+=2}else{if(rowTotal[i].new_kpi_grade=="D"){gradeAvg+=0}else{gradeAvg+=5}}}}}}}count++}log(gradeAvg/count);if((gradeAvg/count)!=goodAvg){MessageBoxShow("KPI 등급 분포 한도를 초과하였습니다.");GradeBuffer=false}return GradeBuffer}function checkGradeBuffer2(){var rowTotal=$.grdList3.getAllRows();var GradeBuffer2=true;var gradeAvg2=0;var count2=0;var goodAvg2=5;for(var i in rowTotal){if(rowTotal[i].new_total_grade=="S"){gradeAvg2+=10}else{if(rowTotal[i].new_total_grade=="A"){gradeAvg2+=8}else{if(rowTotal[i].new_total_grade=="B+"){gradeAvg2+=6}else{if(rowTotal[i].new_total_grade=="B"){gradeAvg2+=5}else{if(rowTotal[i].new_total_grade=="B-"){gradeAvg2+=4}else{if(rowTotal[i].new_total_grade=="C"){gradeAvg2+=2}else{if(rowTotal[i].new_total_grade=="D"){gradeAvg2+=0}else{gradeAvg2+=5}}}}}}}count2++}log(gradeAvg2/count2);if((gradeAvg2/count2)!=goodAvg2){MessageBoxShow("종합 등급 분포 한도를 초과하였습니다.");GradeBuffer2=false}return GradeBuffer2}function setGradeRate(){var Scount=0;var Acount=0;var Bcount=0;var Ccount=0;var Dcount=0;var rowTotal=$.grdList3.getAllRows();for(var i in rowTotal){if(rowTotal[i].new_kpi_grade=="S"){Scount+=1}else{if(rowTotal[i].new_kpi_grade=="A"){Acount+=1}else{if(rowTotal[i].new_kpi_grade=="B+"){Bcount+=1}else{if(rowTotal[i].new_kpi_grade=="B"){Bcount+=1}else{if(rowTotal[i].new_kpi_grade=="B-"){Bcount+=1}else{if(rowTotal[i].new_kpi_grade=="C"){Ccount+=1}else{if(rowTotal[i].new_kpi_grade=="D"){Dcount+=1}else{}}}}}}}}$.grdInfo3.setValue(2,"s_info",Scount);$.grdInfo3.setValue(2,"a_info",Acount);$.grdInfo3.setValue(2,"b_info",Bcount);$.grdInfo3.setValue(2,"c_info",Ccount);$.grdInfo3.setValue(2,"d_info",Dcount)}function setTieColor(){var ColorList=["BlueViolet","DarkOrange","Orchid","DeepSkyBlue","SaddleBrown","Tomato","RoyalBlue","OrangeRed"];var TieCount=0;for(var i=0;i<$.grdList3.getRowCount();i++){if($.grdList3.getValue(i,"eval_kpi_score2")==$.grdList3.getValue(i+1,"eval_kpi_score2")){$.grdList3.setCellStyle(i,"eval_kpi_score2",{color:ColorList[TieCount]});$.grdList3.setCellStyle(i+1,"eval_kpi_score2",{color:ColorList[TieCount]});TieCount++}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1135);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panInfo1=new FingerPanel(host,"panInfo1",0,55,360,180);$.panInfo1.setText("평가자 정보");$.panInfo1.setBottomLine(true);$.panInfo2=new FingerPanel(host,"panInfo2",360,55,350,180);$.panInfo2.setText("평가현황 정보");$.panInfo2.setBottomLine(true);$.panTab=new FingerPanel(host,"panTab",0,245,1200,880);$.panTab.setText("2차 평가 내역");$.panTab.setBottomLine(true);$.tabMain=new FingerTab(host,"tabMain",0,0,1200,830);$.panTab1=new FingerPanel(host,"panTab1",0,0,1200,800);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,1200,800);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.panTab3=new FingerPanel(host,"panTab3",0,0,1200,800);$.panTab3.setText("");$.panTab3.setBottomLine(true);$.panTab4=new FingerPanel(host,"panTab4",0,0,0,0);$.panTab4.setText("");$.panTab4.setBottomLine(true);$.panTab5=new FingerPanel(host,"panTab5",0,0,0,0);$.panTab5.setText("");$.panTab5.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,15,100,20);$.lblYear.setText("평가년도");$.lblEvalName=new FingerLabel(host,"lblEvalName",230,15,100,20);$.lblEvalName.setText("평가명");$.lblGroup=new FingerLabel(host,"lblGroup",620,15,100,20);$.lblGroup.setText("평가그룹");$.lblDept=new FingerLabel(host,"lblDept",0,10,75,20);$.lblDept.setText("부서");$.lblEmp=new FingerLabel(host,"lblEmp",0,40,75,20);$.lblEmp.setText("이름");$.lblDutyCode=new FingerLabel(host,"lblDutyCode",0,70,75,20);$.lblDutyCode.setText("직책");$.cmbYear=new FingerComboBox(host,"cmbYear",105,15,140,20);$.cmbEvalName=new FingerComboBox(host,"cmbEvalName",335,15,140,20);$.txtPeriod=new FingerEdit(host,"txtPeriod",485,15,140,20);$.cmbGroup=new FingerComboBox(host,"cmbGroup",725,15,140,20);$.txtDept=new FingerEdit(host,"txtDept",80,10,80,20);$.bteDept=new FingerButtonEdit(host,"bteDept",165,10,140,20);$.bteDept.setText("");$.txtEmp=new FingerEdit(host,"txtEmp",80,40,80,20);$.bteEmp=new FingerButtonEdit(host,"bteEmp",165,40,140,20);$.bteEmp.setText("");$.cmbDutyCode=new FingerComboBox(host,"cmbDutyCode",80,70,225,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.lblLabel1=new FingerLabel(host,"lblLabel1",35,100,280,20);$.lblLabel1.setText("* 1차평가점에서 0.5 범위 내에서만 조정 가능");$.grdInfo2=new FingerDataGrid(host,"grdInfo2",0,0,350,135);$.grdList1_1=new FingerDataGrid(host,"grdList1_1",0,0,1200,240);$.grdList1_2=new FingerDataGrid(host,"grdList1_2",0,250,1200,550);$.grdList2_1=new FingerDataGrid(host,"grdList2_1",0,0,1200,220);$.grdList2_2=new FingerDataGrid(host,"grdList2_2",0,230,1200,570);$.grdList3=new FingerDataGrid(host,"grdList3",0,0,940,800);$.grdList4_1=new FingerDataGrid(host,"grdList4_1",0,0,0,0);$.grdList4_2=new FingerDataGrid(host,"grdList4_2",0,270,0,0);$.grdList5=new FingerDataGrid(host,"grdList5",0,0,0,0);$.btnSave=new FingerButton(host,"btnSave",1110,-15,90,30);$.btnSave.setText("저장");$.panInfo3=new FingerPanel(host,"panInfo3",715,55,485,180);$.panInfo3.setText("그룹 별 등급 분포율");$.panInfo3.setBottomLine(true);$.grdInfo3=new FingerDataGrid(host,"grdInfo3",0,0,480,135);$.memoFinalComment=new FingerMemoEdit(host,"memoFinalComment",940,45,250,755);$.lblFinalComment=new FingerLabel(host,"lblFinalComment",1000,10,120,20);$.lblFinalComment.setText("Issue 제안 사항");$.lblInfo3=new FingerLabel(host,"lblInfo3",700,-50,120,20);$.lblInfo3.setText("B (+)(-) 등급 기준 :");$.lblInfo3_1=new FingerLabel(host,"lblInfo3_1",815,-50,305,20);$.lblInfo3_1.setText("KPI등급에 한하여, B등급자 내 (+)(-)를 부여 할 수 있다.");$.lblInfo3_2=new FingerLabel(host,"lblInfo3_2",805,-30,230,20);$.lblInfo3_2.setText("단, (+) 인원과 (-) 인원은 동일해야 한다.");$.lblNotice=new FingerLabel(host,"lblNotice",475,-5,600,20);$.lblNotice.setText("*역량 2차평가점수 조정이 필요한 대상자는 하단의 Competency 항목 상 점수를 수정하여 주시기 바랍니다.");$.panQuery.setBorder(true);$.panInfo2.setBorder(false);$.panTab.setBorder(false);$.panInfo1.setBorder(false);$.panInfo3.setBorder(false);$.grdInfo2.setColumns([new FingerDataGridColumn("eval_group_code",200,"left","string","상대평가 그룹"),new FingerDataGridColumn("total_emp",120,"left","string","총 인원"),new FingerDataGridColumn("kpi_comfirm_info",99,"left","string","역량확인 / 미확인",{hidden:true}),new FingerDataGridColumn("kbi_confirm_info",99,"right","string","역량확인 / 미확인",{hidden:true})]);$.grdInfo2.init();$.grdInfo3.setColumns([new FingerDataGridColumn("basic_info",100,"center","string","등급",{readonly:true}),new FingerDataGridColumn("s_info",50,"center","string","S",{readonly:true}),new FingerDataGridColumn("a_info",50,"center","string","A",{readonly:true}),new FingerDataGridColumn("b_info",100,"center","string","B+ / B / B-",{readonly:true}),new FingerDataGridColumn("c_info",50,"center","string","C",{readonly:true}),new FingerDataGridColumn("d_info",50,"center","string","D",{readonly:true}),new FingerDataGridColumn("total_info",70,"center","string","TOTAL",{readonly:true})]);$.grdInfo3.init();$.grdList1_1.setColumns([new FingerDataGridColumn("dept_code",99,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",150,"left","string","부서명",{readonly:true}),new FingerDataGridColumn("evaluated_emp",100,"left","string","사번",{readonly:true}),new FingerDataGridColumn("emp_name",120,"left","string","이름",{readonly:true}),new FingerDataGridColumn("difficult_yn",99,"left","string","난이도",{hidden:true}),new FingerDataGridColumn("eval_kpi_period1_score1",100,"right","string","상반기평점",{readonly:true}),new FingerDataGridColumn("eval_kpi_period2_score1",100,"right","string","하반기평점",{readonly:true}),new FingerDataGridColumn("eval_kpi_score1",100,"right","string","1차평가평점",{readonly:true}),new FingerDataGridColumn("eval_kpi_special_score",100,"right","string","특별평점",{readonly:true}),new FingerDataGridColumn("eval_kpi_score2",100,"right","int","2차평가평점"),new FingerDataGridColumn("eval_kpi_up_down",80,"center","string","조정",{readonly:true}),new FingerDataGridColumn("eval_kpi_comment",130,"left","string","KPI의견"),new FingerDataGridColumn("job_rank",100,"left","string","직급",{readonly:true}),new FingerDataGridColumn("position_code",99,"left","string","호칭",{hidden:true}),new FingerDataGridColumn("duty_code",99,"left","string","직책",{hidden:true}),new FingerDataGridColumn("job_code",99,"left","string","직무",{hidden:true})]);$.grdList1_1.init({eventCellReadOnly:true});$.grdList1_1.setEditable(true);$.grdList1_2.setColumns([new FingerDataGridColumn("eval_month",130,"left","string","평가명",{multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("eval_date",80,"center","string","평가기준일",{verticalMiddle:true}),new FingerDataGridColumn("kpi_type",70,"center","string","성과구분",{verticalMiddle:true}),new FingerDataGridColumn("kpi_code",99,"left","string","KPI코드",{hidden:true}),new FingerDataGridColumn("kpi_name",95,"center","string","KPI",{multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("kpi_csf",95,"center","string","핵심실행과제",{multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("weighted_rate",55,"center","string","가중치",{verticalMiddle:true}),new FingerDataGridColumn("kpi_target",135,"center","string","목표",{verticalMiddle:true}),new FingerDataGridColumn("kpi_self_grade",70,"center","string","자기평가",{verticalMiddle:true}),new FingerDataGridColumn("kpi_grade1",70,"center","string","1차 평가",{verticalMiddle:true}),new FingerDataGridColumn("kpi_1st_comment",250,"left","multi_line_edit","1차 평가 의견"),new FingerDataGridColumn("kpi_mid_report",250,"left","multi_line_edit","현재까지 진행사항(중간면담)"),new FingerDataGridColumn("kpi_mid_action_plan",250,"left","multi_line_edit","본인의 향후 Action Plan(중간면담)"),new FingerDataGridColumn("kpi_mid_request",250,"left","multi_line_edit","제안(요청)사항(중간면담)"),new FingerDataGridColumn("kpi_mid_feedback",250,"left","multi_line_edit","상사 feedback(중간면담)"),new FingerDataGridColumn("kpi_achieve_rate",99,"left","string","달성사항",{hidden:true}),new FingerDataGridColumn("kpi_progress_rate",99,"left","string","중간진척율(%)",{hidden:true})]);$.grdList1_2.init({scroll:"xy",leftSplit:8,rowHeight:150});$.grdList2_1.setColumns([new FingerDataGridColumn("dept_code",99,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",150,"left","string","부서명",{readonly:true}),new FingerDataGridColumn("evaluated_emp",100,"left","string","사번",{readonly:true}),new FingerDataGridColumn("emp_name",120,"left","string","이름",{readonly:true}),new FingerDataGridColumn("eval_kbi_score1",130,"right","string","1차평가 평점",{readonly:true}),new FingerDataGridColumn("eval_kbi_score2",130,"right","string","2차평가 평점",{readonly:true}),new FingerDataGridColumn("eval_kbi_up_down",80,"center","string","조정",{readonly:true}),new FingerDataGridColumn("eval_kbi_comment",350,"left","string","KBI의견"),new FingerDataGridColumn("position_code",99,"left","string","호칭",{hidden:true}),new FingerDataGridColumn("job_rank",120,"left","string","직급",{readonly:true}),new FingerDataGridColumn("duty_code",99,"left","string","직책",{hidden:true}),new FingerDataGridColumn("job_code",99,"left","string","직무",{hidden:true}),new FingerDataGridColumn("difficult_yn",99,"left","string","난이도",{hidden:true}),new FingerDataGridColumn("eval_kbi_leader_score1",99,"left","string","리더역량평점",{hidden:true}),new FingerDataGridColumn("eval_kbi_core_score1",99,"left","string","핵심역량평점",{hidden:true}),new FingerDataGridColumn("eval_kbi_work_score1",99,"left","string","직무역량평점",{hidden:true}),new FingerDataGridColumn("eval_kbi_coef_score2",99,"left","string","계수",{hidden:true})]);$.grdList2_1.init({eventCellReadOnly:true});$.grdList2_1.setEditable(true);$.grdList2_2.setColumns([new FingerDataGridColumn("evaluated_emp",100,"left","string","사번",{readonly:true,hidden:true}),new FingerDataGridColumn("comp_name",150,"center","string","Competency 항목",{readonly:true,multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("comp_code",99,"left","string","Competency Code",{hidden:true}),new FingerDataGridColumn("competency_level",90,"center","string","Level",{readonly:true,verticalMiddle:true}),new FingerDataGridColumn("competency_2nd_grade",100,"center","string","2차 평가점수",{verticalMiddle:true}),new FingerDataGridColumn("competency_1st_grade",100,"center","string","1차 평가점수",{readonly:true,verticalMiddle:true}),new FingerDataGridColumn("competency_1st_comment",250,"left","multi_line_edit","1차 평가의견",{readonly:true}),new FingerDataGridColumn("self_review_4q",250,"left","multi_line_edit","4Q 본인 review",{readonly:true}),new FingerDataGridColumn("feedback_4q",240,"left","multi_line_edit","4Q 팀소장 Feedback",{readonly:true})]);$.grdList2_2.init({scroll:"xy",rowHeight:250});$.grdList2_2.setEditable(true);$.grdList3.setColumns([new FingerDataGridColumn("dept_code",99,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",130,"center","string","부서명",{readonly:true}),new FingerDataGridColumn("evaluated_emp",80,"center","string","사번",{readonly:true}),new FingerDataGridColumn("emp_name",80,"center","string","이름",{readonly:true}),new FingerDataGridColumn("eval_kpi_score2",90,"center","string","업적2차<br>평가평점",{readonly:true}),new FingerDataGridColumn("eval_kbi_score2",90,"center","string","역량2차<br>평가평점",{readonly:true}),new FingerDataGridColumn("eval_total_score",90,"center","string","종합평점",{readonly:true}),new FingerDataGridColumn("kpi_rank",100,"left","string","KPI 순위",{hidden:true}),new FingerDataGridColumn("total_rank",100,"left","string","전체 순위",{hidden:true}),new FingerDataGridColumn("org_kpi_grade",90,"center","string","기준<br>KPI 등급",{readonly:true}),new FingerDataGridColumn("org_total_grade",90,"center","string","기준<br>종합 등급",{readonly:true}),new FingerDataGridColumn("new_kpi_grade",90,"center","string","조정<br>KPI 등급"),new FingerDataGridColumn("new_total_grade",90,"center","string","조정<br>종합 등급"),new FingerDataGridColumn("eval_total_confirm_yn",100,"center","checkbox","종합평가확정",{hidden:true}),new FingerDataGridColumn("eval_total_comment",150,"left","string","2차평가 종합의견",{hidden:true}),new FingerDataGridColumn("eval_kpi_comment",150,"left","string","KPI의견",{readonly:true,hidden:true}),new FingerDataGridColumn("eval_kbi_comment",150,"left","string","KBI의견",{readonly:true,hidden:true}),new FingerDataGridColumn("position_code",99,"left","string","호칭",{hidden:true}),new FingerDataGridColumn("job_rank",180,"left","string","직급",{hidden:true}),new FingerDataGridColumn("duty_code",99,"left","string","직책",{hidden:true}),new FingerDataGridColumn("job_code",99,"left","string","직무",{hidden:true})]);$.grdList3.init({scroll:"xy",headerRowHeight:40});$.grdList3.setEditable(true);$.tabMain.addTab([{text:"업적평가",body:$.panTab1,width:150},{text:"역량평가",body:$.panTab2,width:150},{text:"종합평가",body:$.panTab3,width:150},]);$.cmbYear.setAllowBlank(false,"평가년도");$.cmbEvalName.setAllowBlank(false,"평가명");$.txtPeriod.setReadOnly(true);$.txtDept.setReadOnly(true);$.txtEmp.setReadOnly(true);$.cmbDutyCode.setEnable(false);if(g_main.session.obj.HREvaluateRole!="ADMIN"){$.bteDept.setEnable(false);$.bteEmp.setEnable(false)}$.btnSave.setClass("btn_save");$.btnSave.setEnable(true);setReadOnly();$.bteEmp.setDirectSearch("#EMP#",function(ds){if(ds&&ds.resultList&&ds.resultList[0]){var list=ds.resultList[0];if(list.length==1){$.varEmpId=list[0]["value"];$.txtEmp.setText(list[0]["value"]);$.bteEmp.setText(list[0]["text"]);$.varDeptCode=list[0]["dept_code"];$.txtDept.setText(list[0]["dept_code"]);$.bteDept.setText(list[0]["dept_name"]);if($.cmbYear.getValue()!=""&&$.cmbEvalName.getValue()!=""&&$.varEmpId!=""&&$.varDeptCode!=""){gridClear();if($.txtEmp.getValue()=="ka001035"){searchData("GROUP_LIST1")}else{if($.txtEmp.getValue()=="ka941005"){searchData("GROUP_LIST2")}else{searchData("GROUP_LIST")}}}}else{$.fingerbuttonedit_click("bteEmp")}}});$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panInfo1);$.panMain.add($.panInfo2);$.panMain.add($.panTab);$.panMain.add($.panInfo3);$.panQuery.add($.lblYear);$.panQuery.add($.lblEvalName);$.panQuery.add($.lblGroup);$.panQuery.add($.cmbYear);$.panQuery.add($.cmbEvalName);$.panQuery.add($.txtPeriod);$.panQuery.add($.cmbGroup);$.panQuery.add($.btnSearch);$.panInfo1.add($.lblDept);$.panInfo1.add($.lblEmp);$.panInfo1.add($.lblDutyCode);$.panInfo1.add($.txtDept);$.panInfo1.add($.bteDept);$.panInfo1.add($.txtEmp);$.panInfo1.add($.bteEmp);$.panInfo1.add($.cmbDutyCode);$.panInfo1.add($.lblLabel1);$.panInfo2.add($.grdInfo2);$.panTab.add($.tabMain);$.panTab.add($.btnSave);$.panTab.add($.lblNotice);$.panTab.add($.lblInfo3);$.panTab.add($.lblInfo3_2);$.panTab.add($.lblInfo3_1);$.panTab1.add($.grdList1_1);$.panTab1.add($.grdList1_2);$.panTab2.add($.grdList2_2);$.panTab2.add($.grdList2_1);$.panTab3.add($.grdList3);$.panTab3.add($.memoFinalComment);$.panTab3.add($.lblFinalComment);$.panTab4.add($.grdList4_2);$.panTab4.add($.grdList4_1);$.panTab5.add($.grdList5);$.panInfo3.add($.grdInfo3);$.cmbYear.setEmptyRow(true);$.cmbEvalName.setEmptyRow(true);$.cmbGroup.setEmptyRow(true);$.cmbDutyCode.setEmptyRow(true);$.cmbYear.setColumn("eval_year","eval_year1");$.cmbEvalName.setColumn("eval_month","eval_name");$.cmbGroup.setColumn("eval_group_code","eval_group_name");var ds=bizComponentData2($,"Q1","L_HRE010_2|L_HRE009|L_HRE014|L_HRI003");setComboBind([$.cmbYear,$.cmbEvalName,$.cmbGroup,$.cmbDutyCode],ds);$.cmbYear.setValue(getToday("").substr(0,4));var session=g_main.session.obj;$.txtDept.setValue(session.DeptCode);$.bteDept.setText(session.DeptName);$.txtEmp.setValue(session.UserID);$.bteEmp.setText(session.UserName);$.cmbDutyCode.setValue(session.DutyCode);var ds=bizComponentData2($,"Q1","L_HRI005|L_HRI002|L_HRI003|L_HRI006|L_HRE0090_2|L_HRE007|L_HRE008|L_HRE032|L_HRE014|L_HRE037");$.grdList1_1.setColumnDropDownList("job_rank",ds.resultList[0]);$.grdList1_1.setColumnDropDownList("position_code",ds.resultList[1]);$.grdList1_1.setColumnDropDownList("duty_code",ds.resultList[2]);$.grdList1_1.setColumnDropDownList("job_code",ds.resultList[3]);$.grdList1_2.setColumnDropDownList("eval_month",ds.resultList[4],{key:"eval_month",name:"eval_name"});$.grdList1_2.setColumnDropDownList("kpi_type",ds.resultList[5]);$.grdList1_2.setColumnDropDownList("kpi_self_grade",ds.resultList[6]);$.grdList1_2.setColumnDropDownList("kpi_grade1",ds.resultList[6]);$.grdList2_1.setColumnDropDownList("job_rank",ds.resultList[0]);$.grdList2_1.setColumnDropDownList("position_code",ds.resultList[1]);$.grdList2_1.setColumnDropDownList("duty_code",ds.resultList[2]);$.grdList2_1.setColumnDropDownList("job_code",ds.resultList[3]);$.grdList2_2.setColumnDropDownList("competency_2nd_grade",ds.resultList[7]);$.grdList3.setColumnDropDownList("job_rank",ds.resultList[0]);$.grdList3.setColumnDropDownList("position_code",ds.resultList[1]);$.grdList3.setColumnDropDownList("duty_code",ds.resultList[2]);$.grdList3.setColumnDropDownList("job_code",ds.resultList[3]);$.grdList3.setColumnDropDownList("org_kpi_grade",ds.resultList[9]);$.grdList3.setColumnDropDownList("org_total_grade",ds.resultList[9]);$.grdList3.setColumnDropDownList("new_kpi_grade",ds.resultList[9]);$.grdList3.setColumnDropDownList("new_total_grade",ds.resultList[9]);$.grdInfo2.setColumnDropDownList("eval_group_code",ds.resultList[8],{key:"eval_group_code",name:"eval_group_name"})};$.callback=function(type,ds){if(type=="PERIOD"){if(ds.resultList[0].length>0){$.txtPeriod.setValue(ds.resultList[0][0].eval_period)}else{$.txtPeriod.setValue("")}}else{if(type=="GROUP_LIST"){setDataGrid([$.grdInfo2],ds);$.grdInfo2.selectRow(0)}else{if(type=="GROUP_LIST1"){setDataGrid([$.grdInfo2],ds);$.grdInfo2.selectRow(0)}else{if(type=="GROUP_LIST2"){setDataGrid([$.grdInfo2],ds);$.grdInfo2.selectRow(0)}else{if(type=="KPI_LIST"){setDataGrid([$.grdList1_1],ds);$.grdList1_1.selectRow(0);searchData("KPI_DETAIL")}else{if(type=="COMP_LIST"){setDataGrid([$.grdList2_1],ds);$.grdList2_1.selectRow(0);searchData("COMP_DETAIL")}else{if(type=="TOTAL"){setDataGrid([$.grdList3],ds);if(ds.resultList[0][0].new_kpi_grade==""){setGrade3()}if(ds.resultList[0][0].new_total_grade==""){setGrade2()}setGrade();setGradeRate();setTieColor();$.memoFinalComment.setText(ds.resultList[0][0].eval_total_comment);var aRow=$.grdList3.getAllRows();for(var i in aRow){if(g_main.session.obj.DeptCode.substr(0,1)=="S"||g_main.session.obj.DeptCode.substr(0,1)=="T"){aRow[i].new_kpi_grade_readonly=false}else{aRow[i].new_kpi_grade_readonly=false}}$.grdList3.selectRow(0);setReadOnly()}else{if(type=="KPI_DETAIL"){$.grdList1_2.setData("");setDataGrid([$.grdList1_2],ds)}else{if(type=="COMP_DETAIL"){setDataGrid([$.grdList2_2],ds)}else{if(type=="CHART"){setDataGrid([$.grdInfo3],ds)}}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!validateControls([$.cmbYear,$.cmbEvalName])){return}if($.txtEmp.getValue()=="ka001035"){searchData("GROUP_LIST1")}else{if($.txtEmp.getValue()=="ka941004"){searchData("GROUP_LIST2")}else{searchData("GROUP_LIST")}}}else{if(id=="btnSave"){$.grdList1_1.editStop();$.grdList2_1.editStop();$.grdList2_2.editStop();$.grdList3.editStop();if(checkScoreBuffer1()&&checkScoreBuffer2()&&checkGradeBuffer()&&checkGradeBuffer2()){saveKPI("S");saveComp("S");saveCompDetail("S");saveTotal("S");searchData("GROUP_LIST");$.btnSave.setEnable(false)}else{return}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmp"){param={emp_name:$.bteEmp.getText()};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}else{if(id=="bteDept"){var param={dept_name:$.bteDept.getText()||""};g_main.openPopup("popDept.html","popDept","",0,0,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbYear"){$.cmbEvalName.clear();$.cmbGroup.clear();var ds=bizComponentData2($,"Q4","L_HRE0090_2","where eval_year = '"+value+"' AND eval_period = '2'");setComboBind([$.cmbEvalName],ds);var ds=bizComponentData2($,"Q4","L_HRE014"," and eval_year = '"+value+"'");setComboBind([$.cmbGroup],ds);if($.cmbYear.getValue()==""||$.cmbEvalName.getValue()==""){return}}else{if(id=="cmbEvalName"){if($.cmbYear.getValue()==""||$.cmbEvalName.getValue()==""){return}searchData("PERIOD");if($.txtEmp.getValue()=="ka001035"){searchData("GROUP_LIST1")}else{if($.txtEmp.getValue()=="ka941005"){searchData("GROUP_LIST2")}else{searchData("GROUP_LIST")}}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdInfo2"){$.varEvalGroupCode=$.grdInfo2.getValue(rId,"eval_group_code");$.varEvalGroupNum=$.grdInfo2.getValue(rId,"total_emp");searchData("KPI_LIST");searchData("COMP_LIST");searchData("TOTAL");searchGradeChart("CHART")}else{if(id=="grdList1_1"){$.varEvaluatedEmp=$.grdList1_1.getValue(rId,"evaluated_emp");searchData("KPI_DETAIL");var aRow=$.grdList1_1.getAllRows();if(g_main.session.obj.DeptCode.substr(0,1)=="S"||g_main.session.obj.DeptCode.substr(0,1)=="T"){for(var i in aRow){aRow[i].eval_kpi_score2_readonly=true}}else{for(var i in aRow){aRow[i].eval_kpi_score2_readonly=false}}setReadOnly()}else{if(id=="grdList2_1"){$.varEvaluatedEmp=$.grdList2_1.getValue(rId,"evaluated_emp");searchData("COMP_DETAIL")}}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList1_1"){$.btnSave.setEnable(true);if(cInd=="eval_kpi_score2"){$.btnSave.setEnable(true);var score1=$.grdList1_1.getValue(rId,"eval_kpi_score1");var score2=$.grdList1_1.getValue(rId,"eval_kpi_score2");if(score1<score2){$.grdList1_1.setValue(rId,"eval_kpi_up_down","UP")}else{if(score1==score2){$.grdList1_1.setValue(rId,"eval_kpi_up_down","SAME")}else{$.grdList1_1.setValue(rId,"eval_kpi_up_down","DOWN")}}}}else{if(id=="grdList2_1"){$.btnSave.setEnable(true);if(cInd=="eval_kbi_score2"){$.btnSave.setEnable(true);var score1=$.grdList2_1.getValue(rId,"eval_kbi_score1");var score2=$.grdList2_1.getValue(rId,"eval_kbi_score2");if(score1<score2){$.grdList2_1.setValue(rId,"eval_kbi_up_down","UP")}else{if(score1==score2){$.grdList2_1.setValue(rId,"eval_kbi_up_down","SAME")}else{$.grdList2_1.setValue(rId,"eval_kbi_up_down","DOWN")}}}}else{if(id=="grdList2_2"){if(cInd=="competency_2nd_grade"){var cRow=$.grdList2_2.getAllRows();var score=0;for(var i in cRow){score+=Number(cRow[i].competency_2nd_grade)}$.grdList2_1.setValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_score2",Math.round((score/7)*100)/100);var score1=$.grdList2_1.getValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_score1");var score2=$.grdList2_1.getValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_score2");if(score1<score2){$.grdList2_1.setValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_up_down","UP")}else{if(score1==score2){$.grdList2_1.setValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_up_down","SAME")}else{$.grdList2_1.setValue($.grdList2_1.getSelectedRowIdx(),"eval_kbi_up_down","DOWN")}}$.grdList2_2.editStop();saveCompDetail("S");$.btnSave.setEnable(true)}}else{if(id=="grdList3"){$.btnSave.setEnable(true);if(cInd=="new_kpi_grade"){setGradeRate()}}}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmp"){if(popResult.employee_id){$.varEmpId=popResult.employee_id;$.txtEmp.setValue(popResult.employee_id);$.bteEmp.setText(popResult.emp_name);$.varDeptCode=popResult.dept_code;$.txtDept.setValue(popResult.dept_code);$.bteDept.setText(popResult.dept_name);if($.cmbYear.getValue()!=""&&$.cmbEvalName.getValue()!=""&&$.varEmpId!=""&&$.varDeptCode!=""){gridClear();if($.txtEmp.getValue()=="ka001035"){searchData("GROUP_LIST1")}else{if($.txtEmp.getValue()=="ka941005"){searchData("GROUP_LIST2")}else{searchData("GROUP_LIST")}}}}}}else{if(id=="popDept"){if($.popUpCallId=="bteDept"){if(popResult.dept_code){$.varDeptCode=popResult.dept_code;$.txtDept.setValue(popResult.dept_code);$.bteDept.setText(popResult.dept_name);$.varEmpId="";$.txtDept.setValue();$.bteEmp.setText("")}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>