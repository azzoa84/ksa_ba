<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panAppr=null;$.panView=null;$.tabView=null;$.panViewer1=null;$.panViewer2=null;$.grdList=null;$.btnOK=null;$.btnCancel=null;$.btnWrite=null;$.btnDel=null;$.btnDraftCancel=null;$.btnApprCancel=null;$.btnAbitrary=null;$.btnBeforeHand=null;$.btnBudgetCancel=null;$.htmView1=null;$.htmView2=null;$.panViewer3=null;$.panViewer4=null;$.panViewer5=null;$.htmView3=null;$.htmView4=null;$.htmView5=null;$.btnSearch=null;$.btnPrint=null;$.btnCP_Click=null;$.panReason=null;$.grdReason=null;$.panBudget=null;$.lblHalfAmt=null;$.lblUseAmt=null;$.lblAvalAmt=null;$.lblHoldAmt=null;$.lblAdvanceAmt=null;$.speHalfAmt=null;$.speUseAmt=null;$.speAvalAmt=null;$.speHoldAmt=null;$.speAdvanceAmt=null;$.panViewer6=null;$.panViewer7=null;$.panViewer8=null;$.panViewer9=null;$.panViewer10=null;$.panViewer11=null;$.panViewer12=null;$.htmView6=null;$.htmView7=null;$.htmView8=null;$.htmView9=null;$.htmView10=null;$.htmView11=null;$.htmView12=null;$.rs;$.rs_cp;$.iLevel=0;$.strwf_doc_id_sub="";$.strwork_type="N";$.strBusinessID="";$.strwf_doc_id_B1="";$.strreason="";$.strpassword="";$.varCPId="";$.varCPCode="";$.varFormId="";$.varFormHeightSize=900;$.varFormWidthSize=1200;$.cp_id="";$.cp_code="";$.cp_name="";$.varStatusType="";$.varReason="";$.varSapPrint=false;$.strCancelWFYN="";$.ucTemp="";$.drList=[];$.wfResult="";$.WFDocatch="";$.strWriteText1="문서작성";$.strWriteText2="재상신";$.strAccCode_00="53140100",$.strAccCode_10="53140200",$.strAccCode_20="53140100",$.strAccCode_30="53140300",$.strAccCode_40="53140400",$.strAccCode_50="53140100",$.strAccCode_60="53140900";$.strAccName_00="接待費-Card",$.strAccName_10="接待費-現金",$.strAccName_20="接待費-Card",$.strAccName_30="接待費-稅金計算書",$.strAccName_40="接待費-計算書",$.strAccName_50="接待費-Card";$.strAccName="";function createJSON_Q(workType,wf_doc_id){var json=createExecuteParamInfo("P_crmWFGeneralProc_Q",[workType,workType=="Q"?"":(wf_doc_id||$.strwf_doc_id_sub),$.sessionUserId,"KOR"]);return json}function createJSON_Q1(workType,wf_doc_id){var json=createExecuteParamInfo("P_crmWFGeneralProc_Q1",[workType,workType=="Q"?"":(wf_doc_id||$.strwf_doc_id_sub),$.sessionUserId,"KOR"]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.cp_code]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.cp_id])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.cp_id,"#UserID#"])}return json}function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmBudgetUseCHK_S",[workType,$.strwf_doc_id_sub||"",(workType=="Q"?0:$.arResult[0]),(workType=="Q"?0:$.arResult[1])]);return json}function createJSON_Q4(workType,strAccCode){var json=createExecuteParamInfo("P_crmAPP_ExistERPChk_Q",[workType,strAccCode]);return json}function createJSON_S(workType,processType,statusType){var json=createExecuteParamInfo("P_crmWFGeneralProc_S",[workType,$.varWFDocId,"#UserID#",processType,statusType,$.varReason]);return json}function createJSON_S1(workType,wfDocId){var json=createExecuteParamInfo("P_crmBudgetAssignAllow_S",[workType,"","","",0,"",0,0,"","","","","D",wfDocId,"#UserID#"]);return json}function saveWF(workType,processType,statusType,searchYn){var json=createJSON_S(workType,processType,statusType);var ds=callExecuteSync(["req",json],"S");if(ds){if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){MessageBoxShow("저장 도중 오류가 발생 하였습니다.");return false}else{if(!searchYn||searchYn!="N"){if(processType=="60"||processType=="40"||processType=="50"||processType=="70"){var rId=$.grdList.getSelectedRowIdx();var rData=$.grdList.getValue(rId);if(rData.business_id=="BP00000010"){var jsonTmp=createJSON_S1("U_CNT",rData.wf_doc_id);var dsTmp=callExecuteSync(["req",jsonTmp],"S");if(dsTmp==null||dsTmp.errorCode.substr(0,1)=="P"||dsTmp.errorCode.substr(0,1)=="E"){MessageBoxShow("전용회수 변경중 오류가 발생하였습니다.")}}}searchList("Q")}}}}function initControls(){$.sessionUserId=g_main.session.getValue("UserID")}function btnControls(wf_status){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnBudgetCancel.setVisible(false);$.btnPrint.setVisible(false);$.btnCP_Click.setVisible(false);$.cp_id="";$.cp_code="";switch(wf_status){case"init":break;case"10":case"20":$.btnOK.setVisible(true);$.btnCancel.setVisible(true);break;case"60":$.btnWrite.setVisible(true);$.btnDel.setVisible(true);break}}function searchList(workType){var json=createJSON_Q(workType);$.workType=workType;callQuery(["req",json],"APPR_LIST",$)}function searchList1(workType){var json=createJSON_Q1(workType);$.workType=workType;callQuery(["req",json],"APPR_LIST1",$)}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}function b1oJournalVouchers(workType){var json=createJSON_Q3(workType);callExecute(["req",json],"BUDGET_"+workType,$)}function searchAPP_ExistERPChk(strAccCode){var bResult=false;var json=createJSON_Q4("Q",strAccCode);var ds=callQuerySync(["req",json],"Q");if(!ds){return false}if(ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.resultList.length>0){bResult=true}}return bResult}function selectDoc(workType,wf_doc_id){var json=createJSON_Q(workType,wf_doc_id);callQuery(["req",json],"WF_DOC",$)}function queryClick(){if(g_main.session.obj.SalesEmpYN=="N"){searchList("Q")}else{searchList1("Q")}}function fnAccConverter(strSourceAcc,strType){var strAcc="";$.strAccName="";if(strSourceAcc==$.strAccCode_00){switch(strType){case"10":strAcc=$.strAccCode_10;$.strAccName=$.strAccName_10;break;case"20":strAcc=$.strAccCode_20;$.strAccName=$.strAccName_20;break;case"30":strAcc=$.strAccCode_30;$.strAccName=$.strAccName_30;break;case"40":strAcc=$.strAccCode_40;$.strAccName=$.strAccName_40;break;case"50":strAcc=$.strAccCode_50;$.strAccName=$.strAccName_50;break;default:strAcc=strSourceAcc;break}}else{strAcc=strSourceAcc}return strAcc}function xmlDataValidateP1(source){return xmlDataValidateP2(source,-1)}function xmlDataValidateP2(source,iLength){var strValue="";strValue=source.replace("&"," ").replace("<"," ").replace(">"," ").replace("'","").replace("/"," ");if(iLength>0){if(strValue.Length>iLength){strValue=strValue.substring(0,iLength)}}return strValue}function convertObjArrToStrArr(objData){var strReturn=[];for(var i=0;i<objData.length;i++){strReturn[i]=objData[i]}return strReturn}function SFormat(){var theString=arguments[0];for(var i=1;i<arguments.length;i++){var regEx=new RegExp("\\{"+(i-1)+"\\}","gm");theString=theString.replace(regEx,arguments[i])}return theString}function fnSetLang(){if(navigator.language.indexOf("JPN")>=0){$.panAppr.setText("決裁リスト");$.panView.setText("決裁詳細")}}function ChangeVisibleButton(){var rId=$.grdList.getSelectedRowIdx();if($.grdList.getValue(rId,"ParentKeyID")=="10"||$.grdList.getValue(rId,"ParentKeyID")=="20"){if($.wfResult.pre_employee_id==g_main.session.obj.UserID){$.btnBeforeHand.setVisible(true);$.btnOK.setVisible(false)}else{$.btnBeforeHand.setVisible(false);$.btnOK.setVisible(true)}$.btnCancel.setVisible(true);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="40"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="50"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(true);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="60"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);if($.strBusinessID=="BP00000008"||$.strBusinessID=="BP00000015"||$.strBusinessID=="BP00000016"){$.btnWrite.setVisible(false)}else{$.btnWrite.setVisible(true)}$.btnDel.setVisible(true);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="70"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);if($.grdList.getValue(rId,"html_yn")=="Y"||$.grdList.getValue(rId,"cancel_wf_doc_id")!=""){$.btnDraftCancel.setVisible(false)}else{$.btnDraftCancel.setVisible(true)}$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="80"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);if($.strBusinessID=="BP00000033"||$.strBusinessID=="BP00000034"||$.strBusinessID=="BP00000008"||$.strBusinessID=="BP00000015"||$.strBusinessID=="BP00000016"){$.btnWrite.setVisible(false)}else{$.btnWrite.setVisible(true)}$.btnWrite.setText($.strWriteText2);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}else{if($.grdList.getValue(rId,"ParentKeyID")=="90"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false);var BPList=["BP00000021","BP00000022","BP00000023","BP00000024","BP00000025","BP00000027","BP00000028","BP00000029","BP00000017"];for(var i in BPList){if($.WFDocatch==""&&$.strCancelWFYN=="N"&&BPList[i]==$.strBusinessID){$.btnBudgetCancel.setVisible(true);break}else{$.btnBudgetCancel.setVisible(false)}}}else{if($.grdList.getValue(rId,"ParentKeyID")=="91"){$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);if($.strBusinessID=="BP00000017"){$.btnBudgetCancel.setVisible(false)}else{$.btnBudgetCancel.setVisible(true)}if($.strBusinessID=="BP00000027"&&g_main.session.obj.SalesEmpYN=="Y"){$.btnPrint.setVisible(false)}else{$.btnPrint.setVisible(true)}}else{$.btnOK.setVisible(false);$.btnCancel.setVisible(false);$.btnWrite.setVisible(false);$.btnDel.setVisible(false);$.btnAbitrary.setVisible(false);$.btnBeforeHand.setVisible(false);$.btnDraftCancel.setVisible(false);$.btnApprCancel.setVisible(false);$.btnBudgetCancel.setVisible(false)}}}}}}}}}function printWfDoc(){setTimeout(function(){var html=$.wfDocView1.getPrintHtml();printHtml(html)},500)}function clearWfDoc(){$.wfDocView1.init();$.tabView.setActiveTab(0);$.tabView.hideTab(1);$.tabView.hideTab(2);$.tabView.hideTab(3);$.tabView.hideTab(4)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1260);$.panMain.setText("");$.panMain.setBottomLine(true);$.panAppr=new FingerPanel(host,"panAppr",0,0,365,1250);$.panAppr.setText("결재 리스트");$.panAppr.setBottomLine(true);$.panView=new FingerPanel(host,"panView",380,0,820,1255);$.panView.setText("결재 상세");$.panView.setBottomLine(true);$.tabView=new FingerTab(host,"tabView",0,0,820,1210);$.panViewer1=new FingerPanel(host,"panViewer1",0,0,820,1150);$.panViewer1.setText("");$.panViewer1.setBottomLine(true);$.panViewer2=new FingerPanel(host,"panViewer2",0,0,820,1200);$.panViewer2.setText("");$.panViewer2.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,365,1205);$.btnOK=new FingerButton(host,"btnOK",655,-37.5,100,20);$.btnOK.setText("결재");$.btnCancel=new FingerButton(host,"btnCancel",570,-37.5,100,20);$.btnCancel.setText("반려");$.btnWrite=new FingerButton(host,"btnWrite",655,-37.5,100,20);$.btnWrite.setText("문서작성");$.btnDel=new FingerButton(host,"btnDel",570,-37.5,100,20);$.btnDel.setText("삭제");$.btnDraftCancel=new FingerButton(host,"btnDraftCancel",655,-37.5,100,20);$.btnDraftCancel.setText("기안취소");$.btnApprCancel=new FingerButton(host,"btnApprCancel",655,-37.5,100,20);$.btnApprCancel.setText("결재취소");$.btnAbitrary=new FingerButton(host,"btnAbitrary",485,-37.5,100,20);$.btnAbitrary.setText("전결");$.btnBeforeHand=new FingerButton(host,"btnBeforeHand",655,-37.5,100,20);$.btnBeforeHand.setText("선결");$.btnBudgetCancel=new FingerButton(host,"btnBudgetCancel",655,-37.5,100,20);$.btnBudgetCancel.setText("취소기안");$.htmView1=new FingerHTMLView(host,"htmView1",0,0,820,1175);$.htmView2=new FingerHTMLView(host,"htmView2",0,0,820,1170);$.panViewer3=new FingerPanel(host,"panViewer3",0,0,820,1200);$.panViewer3.setText("");$.panViewer3.setBottomLine(true);$.panViewer4=new FingerPanel(host,"panViewer4",0,0,820,1200);$.panViewer4.setText("");$.panViewer4.setBottomLine(true);$.panViewer5=new FingerPanel(host,"panViewer5",0,0,820,1200);$.panViewer5.setText("");$.panViewer5.setBottomLine(true);$.htmView3=new FingerHTMLView(host,"htmView3",0,0,820,1170);$.htmView4=new FingerHTMLView(host,"htmView4",0,0,820,1170);$.htmView5=new FingerHTMLView(host,"htmView5",0,0,820,1170);$.btnSearch=new FingerButton(host,"btnSearch",300,-37.5,80,20);$.btnSearch.setText("조회");$.btnPrint=new FingerButton(host,"btnPrint",740,-37.5,100,20);$.btnPrint.setText("출력");$.btnCP_Click=new FingerButton(host,"btnCP_Click",130,-37.5,100,20);$.btnCP_Click.setText("CP 확인");$.panReason=new FingerPanel(host,"panReason",380,1010,820,240);$.panReason.setText("");$.panReason.setBottomLine(true);$.grdReason=new FingerDataGrid(host,"grdReason",0,0,820,240);$.panBudget=new FingerPanel(host,"panBudget",0,675,365,115);$.panBudget.setText("");$.panBudget.setBottomLine(true);$.lblHalfAmt=new FingerLabel(host,"lblHalfAmt",5,15,50,20);$.lblHalfAmt.setText("배정");$.lblUseAmt=new FingerLabel(host,"lblUseAmt",5,45,50,20);$.lblUseAmt.setText("사용");$.lblAvalAmt=new FingerLabel(host,"lblAvalAmt",170,40,50,20);$.lblAvalAmt.setText("가용");$.lblHoldAmt=new FingerLabel(host,"lblHoldAmt",5,75,50,20);$.lblHoldAmt.setText("HOLD");$.lblAdvanceAmt=new FingerLabel(host,"lblAdvanceAmt",170,70,50,20);$.lblAdvanceAmt.setText("가불");$.speHalfAmt=new FingerSpinEdit(host,"speHalfAmt",60,15,100,20);$.speUseAmt=new FingerSpinEdit(host,"speUseAmt",60,45,100,20);$.speAvalAmt=new FingerSpinEdit(host,"speAvalAmt",225,40,100,20);$.speHoldAmt=new FingerSpinEdit(host,"speHoldAmt",60,75,100,20);$.speAdvanceAmt=new FingerSpinEdit(host,"speAdvanceAmt",225,70,100,20);$.panViewer6=new FingerPanel(host,"panViewer6",0,0,820,1200);$.panViewer6.setText("");$.panViewer6.setBottomLine(true);$.panViewer7=new FingerPanel(host,"panViewer7",0,0,820,1200);$.panViewer7.setText("");$.panViewer7.setBottomLine(true);$.panViewer8=new FingerPanel(host,"panViewer8",0,0,820,1200);$.panViewer8.setText("");$.panViewer8.setBottomLine(true);$.panViewer9=new FingerPanel(host,"panViewer9",0,0,820,1200);$.panViewer9.setText("");$.panViewer9.setBottomLine(true);$.panViewer10=new FingerPanel(host,"panViewer10",0,0,820,1200);$.panViewer10.setText("");$.panViewer10.setBottomLine(true);$.panViewer11=new FingerPanel(host,"panViewer11",0,0,820,1200);$.panViewer11.setText("");$.panViewer11.setBottomLine(true);$.panViewer12=new FingerPanel(host,"panViewer12",0,0,820,1200);$.panViewer12.setText("");$.panViewer12.setBottomLine(true);$.htmView6=new FingerHTMLView(host,"htmView6",0,0,820,1170);$.htmView7=new FingerHTMLView(host,"htmView7",0,0,820,1170);$.htmView8=new FingerHTMLView(host,"htmView8",0,0,820,1170);$.htmView9=new FingerHTMLView(host,"htmView9",0,0,820,1170);$.htmView10=new FingerHTMLView(host,"htmView10",0,0,820,1170);$.htmView11=new FingerHTMLView(host,"htmView11",0,0,50,1170);$.htmView12=new FingerHTMLView(host,"htmView12",0,0,820,1170);btnControls("init");$.speHalfAmt.setEnable(false);$.speUseAmt.setEnable(false);$.speAvalAmt.setEnable(false);$.speHoldAmt.setEnable(false);$.speAdvanceAmt.setEnable(false);$.panView.setBorder(false);$.panBudget.setBorder(true);$.panReason.setVisible(false);$.panBudget.setVisible(false);$.wfDocView1=new CustomWfDocument($,$.htmView1);$.wfDocView2=new CustomWfDocument($,$.htmView2);$.wfDocView3=new CustomWfDocument($,$.htmView3);$.wfDocView4=new CustomWfDocument($,$.htmView4);$.wfDocView5=new CustomWfDocument($,$.htmView5);$.wfDocView6=new CustomWfDocument($,$.htmView6);$.wfDocView7=new CustomWfDocument($,$.htmView7);$.wfDocView8=new CustomWfDocument($,$.htmView8);$.wfDocView9=new CustomWfDocument($,$.htmView9);$.wfDocView10=new CustomWfDocument($,$.htmView10);$.wfDocView11=new CustomWfDocument($,$.htmView11);$.wfDocView12=new CustomWfDocument($,$.htmView12);$.funcRefDocClick=function(event){$.tabView.setActiveTab(event.data.tab_index)};$.grdListMap=$.grdList.setColumns([new FingerDataGridColumn("employee_id",0,"left","text","",{hidden:true}),new FingerDataGridColumn("doc_title",230,"left","text","문서제목",{template:"wf_tree"}),new FingerDataGridColumn("emp_name",80,"left","text","기안자"),new FingerDataGridColumn("withdraw_yn",80,"left","text","회계처리여부"),new FingerDataGridColumn("wf_doc_id",120,"left","text","문서ID"),new FingerDataGridColumn("wf_time",80,"left","string","기안일",{format:"s_ymd"}),new FingerDataGridColumn("update_time",80,"left","string","결재일",{format:"s_ymd"}),new FingerDataGridColumn("cancel_wf_doc_id",0,"left","text","취소기안",{hidden:true})]);$.grdList.init({scroll:"xy",view:"treetable",treeKey:{id:"KeyID",parent:"ParentKeyID"}});$.grdReason.setColumns([new FingerDataGridColumn("approval_kind",100,"left","text","구분"),new FingerDataGridColumn("employee_id",99,"left","text","사원코드",{hidden:true}),new FingerDataGridColumn("cur_process",200,"left","text","결재라인"),new FingerDataGridColumn("emp_name",120,"left","text","처리자"),new FingerDataGridColumn("reason",380,"left","text","사유")]);$.grdReason.init();$.grdReason.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panAppr);$.panMain.add($.panView);$.panMain.add($.panReason);$.panMain.add($.panBudget);$.panAppr.add($.grdList);$.panAppr.add($.btnSearch);$.panView.add($.tabView);$.panView.add($.btnOK);$.panView.add($.btnCancel);$.panView.add($.btnDel);$.panView.add($.btnDraftCancel);$.panView.add($.btnApprCancel);$.panView.add($.btnAbitrary);$.panView.add($.btnBeforeHand);$.panView.add($.btnBudgetCancel);$.panView.add($.btnPrint);$.panView.add($.btnCP_Click);$.panView.add($.btnWrite);$.panViewer1.add($.htmView1);$.panViewer2.add($.htmView2);$.panViewer3.add($.htmView3);$.panViewer4.add($.htmView4);$.panViewer5.add($.htmView5);$.panReason.add($.grdReason);$.panBudget.add($.lblHalfAmt);$.panBudget.add($.lblUseAmt);$.panBudget.add($.lblAvalAmt);$.panBudget.add($.lblHoldAmt);$.panBudget.add($.lblAdvanceAmt);$.panBudget.add($.speHalfAmt);$.panBudget.add($.speUseAmt);$.panBudget.add($.speAvalAmt);$.panBudget.add($.speHoldAmt);$.panBudget.add($.speAdvanceAmt);$.panViewer6.add($.htmView6);$.panViewer7.add($.htmView7);$.panViewer8.add($.htmView8);$.panViewer9.add($.htmView9);$.panViewer10.add($.htmView10);$.panViewer11.add($.htmView11);$.panViewer12.add($.htmView12);if($.args){var args=$.args;$.varWfDocId=args.wf_doc_id}$.startAfterChain=true;$.tabView.addTab([{text:"기안내용",body:$.panViewer1,width:200},{text:"",body:$.panViewer2,width:200},{text:"",body:$.panViewer3,width:200},{text:"",body:$.panViewer4,width:200},{text:"",body:$.panViewer5,width:200},{text:"",body:$.panViewer6,width:200},{text:"",body:$.panViewer7,width:200},{text:"",body:$.panViewer8,width:200},{text:"",body:$.panViewer9,width:200},{text:"",body:$.panViewer10,width:200},{text:"",body:$.panViewer11,width:200},{text:"",body:$.panViewer12,width:200}]);$.tabView.hideTab(1);$.tabView.hideTab(2);$.tabView.hideTab(3);$.tabView.hideTab(4);$.tabView.hideTab(5);$.tabView.hideTab(6);$.tabView.hideTab(7);$.tabView.hideTab(8);$.tabView.hideTab(9);$.tabView.hideTab(10);$.tabView.hideTab(11);initControls();queryClick();var ds=bizComponentData2($,"Q1","L_CRM0006|L_CRM0017");$.grdReason.setColumnDropDownList("approval_kind",ds.resultList[0]);$.grdReason.setColumnDropDownList("cur_process",ds.resultList[1])};$.callback=function(type,ds){if(type=="APPR_LIST"){if($.workType=="Q"){convertJavaDateToJs(ds.resultList);setDataGrid([$.grdList],ds);$.grdList.openNode(2);$.htmView1.setHTML("");if($.varWfDocId){$.grdList.selectRow($.grdList.getGridRowIndex("wf_doc_id",$.varWfDocId))}for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"doc_title").indexOf("[반려]")>-1){$.grdList.setCellStyle(i,"doc_title",{color:"#FF9100"})}}}else{if($.workType=="Q1"){if(ds.resultList[0].length<=0){return false}if(ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}else{if(ds.resultList[0].length>0){$.strBusinessID="";$.strwf_doc_id_B1="";if(ds.resultList[0][0].business_id){$.strBusinessID=ds.resultList[0][0].business_id}$.strBusinessID=ds.resultList[0][0].wf_doc_id;$.strCancelWFYN=ds.resultList[0][0].cancel_wf_yn}}}else{if($.workType=="Q2"){log(ds)}else{if($.workType=="Q3"){setDataGrid([$.grdReason],ds)}else{if($.workType=="Q4"){if(ds.resultList[0].length>0){$.speHalfAmt.setValue(ds.resultList[0][0].half_amt);$.speUseAmt.setValue(ds.resultList[0][0].use_amt);$.speAvalAmt.setValue(ds.resultList[0][0].aval_amt);$.speHoldAmt.setValue(ds.resultList[0][0].hold_amt);$.speAdvanceAmt.setValue(ds.resultList[0][0].advance_amt)}else{$.speHalfAmt.setValue(0);$.speUseAmt.setValue(0);$.speAvalAmt.setValue(0);$.speHoldAmt.setValue(0);$.speAdvanceAmt.setValue(0)}}}}}}}else{if(type=="APPR_LIST1"){if($.workType=="Q"){convertJavaDateToJs(ds.resultList);setDataGrid([$.grdList],ds);$.grdList.openNode(2);if($.varWfDocId){$.grdList.selectRow($.grdList.getGridRowIndex("wf_doc_id",$.varWfDocId))}}}else{if(type=="BUDGET_Q"){if(ds){var rs1=overrideBracket(ds.resultList[0][0]);var rs2=overrideBracket(ds.resultList[1]);if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br> (분개장번호: "+ds.errorMsg+")");return}else{if(ds.errorCode=="MSG0001"){var bB1Exist=false;var bJournalExist=false;if(ds.resultList.length>=2&&ds.resultList[0].length>0){if(ds.resultList[0][0]["B1Exist"]=="Y"){bB1Exist=true}if(ds.resultList[0][0]["B1JournalExist"]=="Y"){bJournalExist=true}}if(bJournalExist){MessageBoxShow("분개장문서가 전기처리 되었습니다.");return}if(bB1Exist){printWfDoc();return}if($.strBusinessID=="BP00000017"){var bNoVat=false,struse_type=ds.resultList[0][0]["use_type"],stremployee_id=ds.resultList[0][0]["employee_id"],strfor_dept_name=ds.resultList[0][0]["for_dept_name"],strfor_emp_name=ds.resultList[0][0]["for_emp_name"],strAcctName=ds.resultList[0][0]["AcctName"],strcp_code=ds.resultList[0][0]["cp_code"],strbudget_name_for=ds.resultList[0][0]["budget_name_for"],struse_remark=xmlDataValidateP2(ds.resultList[0][0]["use_remark"],30),strsales_dept_yn=ds.resultList[0][0]["sales_dept_yn"],strmarketing_dept_yn=ds.resultList[0][0]["marketing_dept_yn"],strbudget_acctype=ds.resultList[0][0]["budget_acctype"];var U_USERID=stremployee_id,U_USERNAME=strfor_emp_name,U_DEPTCODE=ds.resultList[0][0]["use_dept_code"],U_DEPTNAME=strfor_dept_name,U_Drftnum=$.strwf_doc_id_sub;var iUseAmt=0,iVatAmt=0,iNoVatAmt=0;var strCurrDate=getToday("");var alLine_ID=[],alAccountCode=[],alDebit=[],alCredit=[],alShortName=[],alLineMemo=[],alReferenceDate1=[],alReference2=[],alTaxDate=[],alU_TAXDT=[],alBaseSum=[],alTaxGroup=[],alVatAmount=[],alCostingCode=[],alU_CardNo=[],alU_ApprNo=[],alU_VatRegN=[],alU_VatBP=[],alU_VatBpNM=[],alU_UserName=[],alU_VatBPNM1=[],alU_ItemGroup=[],alU_PayMe=[],alU_BankCode=[],alU_Account=[],alU_AcctName=[],alU_CARDCD=[],alU_CARDNM=[],alU_SAUPNO=[],alU_SUPAMT=[],alU_VAT=[];var strMemo_orgin="",strMemo="",strSAccCd="",strMAccCd="",strPromoCode="",strPromoName="",strLineMemo="";if(struse_remark==""||strbudget_acctype=="90"){strMemo_orgin=SFormat("{0} {1}-{2}",strbudget_name_for,strfor_dept_name,strfor_emp_name)}else{strMemo_orgin=struse_remark}var strVatBP="",strPRCPCLS2="10";iUseAmt=Number(ds.resultList[0][0]["use_amt"]);iVatAmt=Number(ds.resultList[0][0]["tax_amt"]);iNoVatAmt=Number(ds.resultList[0][0]["nodeduction_amt"]);strMAccCd=fnAccConverter(ds.resultList[0][0]["account_code"],strPRCPCLS2);strPromoCode=ds.resultList[0][0]["promo_code"];strPromoName=ds.resultList[0][0]["promo_name"];strMemo=strMemo_orgin;strLineMemo=strMemo;alLine_ID.push(1);alAccountCode.push(strMAccCd);alDebit.push(iUseAmt+iVatAmt);alCredit.push("");alShortName.push("");alLineMemo.push(strLineMemo);alReferenceDate1.push(getToday(""));alReference2.push(getToday(""));alTaxDate.push(getToday(""));alU_TAXDT.push(getToday(""));alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push(U_USERNAME);alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("");var bShotNameYN=false;var strU_VatRegN="",strU_VatBP="",strU_VatBPNM1="";var strU_CardNo="",strU_ApprNo="",strU_VatBPNM="";var strU_PayMe="",strU_BankCode="",strU_Account="",strU_AcctName="";strSAccCd=stremployee_id;bShotNameYN=true;strU_PayMe=ds.resultList[0][0]["pay_me"];if(strU_PayMe=="Y"){strU_BankCode=xmlDataValidateP1(ds.resultList[0][0]["bank"]);strU_Account=xmlDataValidateP1(ds.resultList[0][0]["account"]);strU_AcctName=xmlDataValidateP1(ds.resultList[0][0]["acct_name"])}else{strU_BankCode=xmlDataValidateP1(ds.resultList[0][0]["bank"]);strU_Account=xmlDataValidateP1(ds.resultList[0][0]["account"]);strU_AcctName=xmlDataValidateP1(ds.resultList[0][0]["acct_name"])}if(bShotNameYN){alAccountCode.push("");alShortName.push(strSAccCd)}else{alAccountCode.push(strSAccCd);alShortName.push("")}alLine_ID.push(2);alDebit.push("");alCredit.push(iUseAmt+iVatAmt);alLineMemo.push(strLineMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strCurrDate);alTaxDate.push(strCurrDate);alU_TAXDT.push(strCurrDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push(strU_CardNo);alU_ApprNo.push(strU_ApprNo);alU_VatRegN.push(strU_VatRegN);alU_VatBP.push(strU_VatBP);alU_VatBpNM.push(strU_VatBPNM);alU_UserName.push(U_USERNAME);alU_VatBPNM1.push(strU_VatBPNM1);alU_ItemGroup.push("");alU_PayMe.push(strU_PayMe);alU_BankCode.push(strU_BankCode);alU_Account.push(strU_Account);alU_AcctName.push(strU_AcctName);alU_CARDCD.push(strU_VatBP);alU_CARDNM.push(strU_VatBPNM1);alU_SAUPNO.push(strU_VatRegN);alU_SUPAMT.push("");alU_VAT.push("");if(strSAccCd==""){MessageBoxShow("전표처리중 상대계정에 에러가 발생하였습니다.");return}else{if(!searchAPP_ExistERPChk(strSAccCd)){if(bShotNameYN){MessageBoxShow("ERP : Not Exist (ShortName)")}else{MessageBoxShow("ERP : Not Exist (AccountCode)")}return}}var sarLine_ID=alLine_ID,sarAccountCode=alAccountCode,sarDebit=alDebit,sarCredit=alCredit,sarShortName=alShortName,sarLineMemo=alLineMemo,sarReferenceDate1=alReferenceDate1,sarReference2=alReference2,sarTaxDate=alTaxDate,sarU_TAXDT=alU_TAXDT,sarBaseSum=alBaseSum,sarTaxGroup=alTaxGroup,sarVatAmount=alVatAmount,sarCostingCode=alCostingCode,sarU_CardNo=alU_CardNo,sarU_ApprNo=alU_ApprNo,sarU_VatRegN=alU_VatRegN,sarU_VatBP=alU_VatBP,sarU_VatBpNM=alU_VatBpNM,sarU_UserName=alU_UserName,sarU_VatBPNM1=alU_VatBPNM1,sarU_ItemGroup=alU_ItemGroup,sarU_PayMe=alU_PayMe,sarU_BankCode=alU_BankCode,sarU_Account=alU_Account,sarU_AcctName=alU_AcctName,sarU_CARDCD=alU_CARDCD,sarU_CARDNM=alU_CARDNM,sarU_SAUPNO=alU_SAUPNO,sarU_SUPAMT=alU_SUPAMT,sarU_VAT=alU_VAT;var json=createExecuteParamInfo("oJournalVouchers_S",[stremployee_id||"","",strCurrDate,strMemo,strCurrDate,strCurrDate,strCurrDate,bNoVat?"Y":"N",U_USERID,U_USERNAME,U_DEPTCODE,U_DEPTNAME,U_Drftnum,sarLine_ID,sarAccountCode,sarDebit,sarCredit,sarShortName,sarLineMemo,sarReferenceDate1,sarReference2,sarTaxDate,sarU_TAXDT,sarBaseSum,sarTaxGroup,sarVatAmount,sarCostingCode,sarU_CardNo,sarU_ApprNo,sarU_VatRegN,sarU_VatBP,sarU_VatBpNM,sarU_UserName,sarU_VatBPNM1,sarU_ItemGroup,sarU_PayMe,sarU_BankCode,sarU_Account,sarU_AcctName,sarU_CARDCD,sarU_CARDNM,sarU_SAUPNO,sarU_SUPAMT,sarU_VAT]);log(3);var ds2=callSBO(["req",json],"Q_SAP",$,true);console.log(ds2);if(ds2.result.indexOf("Error")>=0){MessageBoxShow(ds2.result);return}$.arResult=ds2.result.split("\t");var json=createJSON_Q3("U");var ds3=callExecuteSync(["req",json],"U",$);console.log(ds3);if(ds3){if(ds3.errorCode.substr(0,1)=="P"||ds3.errorCode.substr(0,1)=="E"){MessageBoxShow("문서번호: "+$.varWFDocId+"<br>"+ds3.errorCode+"</br>"+ds3.errorMsg);return}else{$.varSapPrint=true;clearWfDoc();selectDoc("Q1",$.varWFDocId)}}}else{var rs1=ds.resultList[0][0];var rs2=ds.resultList[1];var iRowCnt=rs2.length;var iPMoney=0;var iPCard=0;var bAllEqual=false;var bNoVat=false;var strPRCPCLS="",struse_type=rs1.use_type,stremployee_id=rs1.employee_id,strfor_dept_name=rs1.for_dept_name,strfor_emp_name=rs1.for_emp_name,strAcctName=rs1.AcctName,strcp_code=rs1.cp_code,strbudget_name_for=rs1.budget_name_for,struse_remark=rs1.use_remark,strsales_dept_yn=rs1.sales_dept_yn,strmarketing_dept_yn=rs1.marketing_dept_yn,strbudget_acctype=rs1.budget_acctype,strpay_me=rs1.pay_me,strplan_check=rs1.plan_check,strU_CardNo="",U_USERID=stremployee_id,U_USERNAME=strfor_emp_name,U_DEPTCODE=rs1.use_dept_code,U_DEPTNAME=strfor_dept_name,U_Drftnum=$.strwf_doc_id_sub,iTotalUseAmt=0,iTotalVatAmt=0,iTotalNoVatAmt=0,iUseAmt=0,iVatAmt=0,iNoVatAmt=0,iTotalPlanAmt=rs1.plan_amt,iPlanDiffAmt=rs1.plan_diff_amt;for(var i in rs2){if(rs2[i].receipt_type=="10"){iPMoney++}else{if(rs2[i].receipt_type=="20"){iPCard++}}iTotalUseAmt+=rs2[i].use_amt;iTotalVatAmt+=rs2[i].tax_amt;iTotalNoVatAmt+=rs2[i].nodeduction_amt;if(!bNoVat&&rs2[i].nodeduction_amt!=0){bNoVat=true}}var strCurrDate=getToday("");var alLine_ID=[],alAccountCode=[],alDebit=[],alCredit=[],alShortName=[],alLineMemo=[],alReferenceDate1=[],alReference2=[],alTaxDate=[],alU_TAXDT=[],alBaseSum=[],alTaxGroup=[],alVatAmount=[],alCostingCode=[],alU_CardNo=[],alU_ApprNo=[],alU_VatRegN=[],alU_VatBP=[],alU_VatBpNM=[],alU_UserName=[],alU_VatBPNM1=[],alU_ItemGroup=[],alU_PayMe=[],alU_BankCode=[],alU_Account=[],alU_AcctName=[],alU_CARDCD=[],alU_CARDNM=[],alU_SAUPNO=[],alU_SUPAMT=[],alU_VAT=[];var strMemo_orgin="",strMemo="",strSAccCd="",strMAccCd="",strPromoCode="",strLineMemo="",strUseDate="",strDeptCode="",strTaxGrp="";var iLine_ID=0;if(struse_remark==""||strbudget_acctype=="90"){strMemo_orgin=strbudget_name_for+" "+strfor_dept_name+"-"+strfor_emp_name}else{strMemo_orgin=struse_remark}var sarLineMemo_tmp=[];for(var i in rs2){var strVatBP="";var strPRCPCLS2=rs2[i].receipt_type;iUseAmt=rs2[i].use_amt;iVatAmt=rs2[i].tax_amt;iNoVatAmt=rs2[i].nodeduction_amt;if($.strAccCode_00==rs1.account_code){bAllEqual=false}if($.strAccCode_60==rs1.account_code){bAllEqual=false}if("Y"==rs1.grape_yn){bAllEqual=false}strMAccCd=fnAccConverter(rs1.account_code,strPRCPCLS2);strPromoCode=rs1.promo_code;strPromoName=rs1.promo_name;strMemo=strMemo_orgin;strLineMemo=strMemo;strUseDate=rs2[i].use_date;strDeptCode=rs2[i].dept_code||"";sarLineMemo_tmp.push(strLineMemo);if(strMAccCd==""){MessageBoxShow("회계계정 부분에서 에러가 발생하였습니다.");return}if(bAllEqual){if(i==rs2.length-1){alLine_ID.push(iLine_ID++);alAccountCode.push(strMAccCd);alDebit.push(iTotalUseAmt);alCredit.push("");alShortName.push("");alLineMemo.push(strLineMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");if(bNoVat){alTaxGroup.push("X4");alVatAmount.push("")}else{alTaxGroup.push("");alVatAmount.push("")}alCostingCode.push(strDeptCode);alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push(U_USERNAME);alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("")}}else{alLine_ID.push(iLine_ID++);alAccountCode.push(strMAccCd);alDebit.push(iUseAmt);alCredit.push("");alShortName.push("");alLineMemo.push(strLineMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");if(bNoVat&&iNoVatAmt!=0){alTaxGroup.push("X4");alVatAmount.push("")}else{if(bNoVat&&iVatAmt!=0){switch(strPRCPCLS2){case"30":strTaxGrp="V2";break;case"40":strTaxGrp="V0";break;case"50":strTaxGrp="V5";break;default:strTaxGrp="";break}alTaxGroup.push(strTaxGrp);alVatAmount.push("")}else{alTaxGroup.push("");alVatAmount.push("")}}alCostingCode.push(strDeptCode);alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push(U_USERNAME);alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("")}if(!bNoVat&&strPRCPCLS2=="40"){strSAccCd="11113100";strVatBP=rs2[i].account_comp_code;alLine_ID.push(iLine_ID++);alAccountCode.push(strSAccCd);alDebit.push(0);alCredit.push("");alShortName.push("");alLineMemo.push(strLineMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push(iUseAmt);alTaxGroup.push("V0");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push(strVatBP);alU_VatBpNM.push("");alU_UserName.push("");alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("")}strVatBP=rs2[i].account_comp_code;if(!bNoVat&&iVatAmt!=0){strSAccCd="11113100";switch(strPRCPCLS2){case"30":strTaxGrp="V2";break;case"40":strTaxGrp="V0";break;case"50":strTaxGrp="V5";break;default:strTaxGrp="";break}alLine_ID.push(iLine_ID++);alAccountCode.push(strSAccCd);alDebit.push(iVatAmt);alCredit.push("");alShortName.push("");alLineMemo.push(strLineMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push(iUseAmt);alTaxGroup.push(strTaxGrp);alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push(strVatBP);alU_VatBpNM.push("");alU_UserName.push("");alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push(strVatBP);alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push(iUseAmt);alU_VAT.push(iVatAmt)}}var bShotNameYN=false;iUseAmt=0;iVatAmt=0;iNoVatAmt=0;var strU_VatRegN="";var strU_VatBP="";var strU_VatBPNM1="";var strU_CardNo="";var strU_ApprNo="";var strU_VatBPNM="";var strU_PayMe="";var strU_BankCode="";var strU_Account="";var strU_AcctName="";for(var k in rs2){strPRCPCLS=rs2[k].receipt_type;strUseDate=rs2[k].use_date;if(struse_type=="40"){strSAccCd="11109200"}else{if(strPRCPCLS=="10"){strSAccCd=rs2[k].deposit_emp_code;bShotNameYN=true}else{if(strPRCPCLS=="20"||strPRCPCLS=="50"){strSAccCd=rs2[k].deposit_emp_code;if(strSAccCd.indexOf("ka")>=0||strSAccCd.indexOf("ypc")>=0||strSAccCd.indexOf("YPC")>=0||strSAccCd.indexOf("AP")>=0){strSAccCd=strSAccCd+"(card)"}bShotNameYN=true}else{strSAccCd=rs2[k].account_comp_code;bShotNameYN=true}}}iUseAmt=rs2[k].use_amt;iVatAmt=rs2[k].tax_amt;iNoVatAmt=rs2[k].nodeduction_amt;strU_VatBP=rs2[k].account_comp_code;strU_VatBPNM1=rs2[k].VatBPNM1;strU_VatRegN=rs2[k].VatRegN;strU_CardNo=rs2[k].CARDNO;if(strU_CardNo.length>=16){if(strU_CardNo.indexOf("-")<0){strU_CardNo=strU_CardNo.substr(0,4)+"-"+strU_CardNo.substr(4,4)+"-"+strU_CardNo.substr(8,4)+"-"+strU_CardNo.substr(12,4)}}strU_ApprNo=rs2[k].APPRNO;strU_VatBPNM=rs2[k].VENKNM;strU_PayMe=rs2[k].pay_me;if(strU_PayMe=="Y"){strU_BankCode=rs2[k].bank;strU_Account=rs2[k].account;strU_AcctName=rs2[k].acct_name}else{strU_BankCode=rs2[k].bank;strU_Account=rs2[k].account;strU_AcctName=rs2[k].acct_name}if(strPRCPCLS=="10"||strPRCPCLS=="20"){if(bShotNameYN){alAccountCode.push("");alShortName.push(strSAccCd)}else{alAccountCode.push(strSAccCd);alShortName.push("")}alLine_ID.push(iLine_ID++);alDebit.push("");if(strPRCPCLS=="10"&&rs2[k].earner_yn=="Y"){alCredit.push(rs2[k].earner_amt)}else{alCredit.push(iUseAmt)}alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push(strU_CardNo);alU_ApprNo.push(strU_ApprNo);alU_VatRegN.push(strU_VatRegN);alU_VatBP.push(strU_VatBP);alU_VatBpNM.push(strU_VatBPNM);alU_UserName.push(U_USERNAME);alU_VatBPNM1.push(strU_VatBPNM1);alU_ItemGroup.push("");alU_PayMe.push(strU_PayMe);alU_BankCode.push(strU_BankCode);alU_Account.push(strU_Account);alU_AcctName.push(strU_AcctName);alU_CARDCD.push(strU_VatBP);alU_CARDNM.push(strU_VatBPNM1);alU_SAUPNO.push(strU_VatRegN);alU_SUPAMT.push("");alU_VAT.push("");if(strPRCPCLS=="10"&&rs2[k].earner_yn=="Y"){strSAccCd="21051000";alAccountCode.push(strSAccCd);alShortName.push("");alLine_ID.push(iLine_ID++);alDebit.push("");alCredit.push(rs2[k].earner_income_tax);alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push("");alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("");strSAccCd="21052000";alAccountCode.push(strSAccCd);alShortName.push("");alLine_ID.push(iLine_ID++);alDebit.push("");alCredit.push(rs2[k].earner_residence_tax);alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push("");alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("")}if(strSAccCd==""){MessageBoxShow("전표처리중 상대계정에 에러가 발생하였습니다.");return}else{if(!searchAPP_ExistERPChk(strSAccCd)){if(bShotNameYN){MessageBoxShow("ERP : Not Exist (ShortName)")}else{MessageBoxShow("ERP : Not Exist (AccountCode)")}return}}}else{if(iVatAmt!=0){iUseAmt+=iVatAmt;if(bShotNameYN){alAccountCode.push("");alShortName.push(strSAccCd)}else{alAccountCode.push(strSAccCd);alShortName.push("")}alLine_ID.push(iLine_ID++);alDebit.push("");alCredit.push(iUseAmt);alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push(strU_CardNo);alU_ApprNo.push(strU_ApprNo);alU_VatRegN.push(strU_VatRegN);alU_VatBP.push(strU_VatBP);alU_VatBpNM.push(strU_VatBPNM);alU_UserName.push(U_USERNAME);alU_VatBPNM1.push(strU_VatBPNM1);alU_ItemGroup.push("");alU_PayMe.push(strU_PayMe);alU_BankCode.push(strU_BankCode);alU_Account.push(strU_Account);alU_AcctName.push(strU_AcctName);alU_CARDCD.push(strU_VatBP);alU_CARDNM.push(strU_VatBPNM1);alU_SAUPNO.push(strU_VatRegN);alU_SUPAMT.push("");alU_VAT.push("")}else{if(bNoVat){iUseAmt+=iNoVatAmt;alLine_ID.push(iLine_ID++);alAccountCode.push("");alDebit.push("");alCredit.push(iUseAmt);alShortName.push(strSAccCd);alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push(strU_CardNo);alU_ApprNo.push(strU_ApprNo);alU_VatRegN.push(strU_VatRegN);alU_VatBP.push(strU_VatBP);alU_VatBpNM.push(strU_VatBPNM);alU_UserName.push(U_USERNAME);alU_VatBPNM1.push(strU_VatBPNM1);alU_ItemGroup.push("");alU_PayMe.push(strU_PayMe);alU_BankCode.push(strU_BankCode);alU_Account.push(strU_Account);alU_AcctName.push(strU_AcctName);alU_CARDCD.push(strU_VatBPNM1);alU_CARDNM.push(strU_VatBP);alU_SAUPNO.push(strU_VatRegN);alU_SUPAMT.push("");alU_VAT.push("")}else{if(bShotNameYN){alAccountCode.push("");alShortName.push(strSAccCd)}else{alAccountCode.push(strSAccCd);alShortName.push("")}alLine_ID.push(iLine_ID++);alDebit.push("");alCredit.push(iUseAmt);alLineMemo.push(sarLineMemo_tmp[k]);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push(strU_CardNo);alU_ApprNo.push(strU_ApprNo);alU_VatRegN.push(strU_VatRegN);alU_VatBP.push(strU_VatBP);alU_VatBpNM.push(strU_VatBPNM);alU_UserName.push(U_USERNAME);alU_VatBPNM1.push(strU_VatBPNM1);alU_ItemGroup.push("");alU_PayMe.push(strU_PayMe);alU_BankCode.push(strU_BankCode);alU_Account.push(strU_Account);alU_AcctName.push(strU_AcctName);alU_CARDCD.push(strU_VatBP);alU_CARDNM.push(strU_VatBPNM1);alU_SAUPNO.push(strU_VatRegN);alU_SUPAMT.push("");alU_VAT.push("")}}if(strSAccCd==""){MessageBoxShow("전표처리중 상대계정에 에러가 발생하였습니다.");return}else{if(!searchAPP_ExistERPChk(strSAccCd)){if(bShotNameYN){MessageBoxShow("ERP : Not Exist (ShortName)")}else{MessageBoxShow("ERP : Not Exist (AccountCode)")}return}}}bShotNameYN=false;if(struse_type=="40"){k=999}}if(struse_type=="40"&&iPlanDiffAmt!=0){strSaccCd="11107100";alAccountCode.push(strSAccCd);alShortName.push("");alLine_ID.push(iLine_ID++);alDebit.push(iPlanDiffAmt);alCredit.push("");alLineMemo.push(strMemo);alReferenceDate1.push(strCurrDate);alReference2.push(strUseDate);alTaxDate.push(strUseDate);alU_TAXDT.push(strUseDate);alBaseSum.push("");alTaxGroup.push("");alVatAmount.push("");alCostingCode.push("");alU_CardNo.push("");alU_ApprNo.push("");alU_VatRegN.push("");alU_VatBP.push("");alU_VatBpNM.push("");alU_UserName.push("");alU_VatBPNM1.push("");alU_ItemGroup.push("");alU_PayMe.push("N");alU_BankCode.push("");alU_Account.push("");alU_AcctName.push("");alU_CARDCD.push("");alU_CARDNM.push("");alU_SAUPNO.push("");alU_SUPAMT.push("");alU_VAT.push("")}var sarLine_ID=alLine_ID,sarAccountCode=alAccountCode,sarDebit=alDebit,sarCredit=alCredit,sarShortName=alShortName,sarLineMemo=alLineMemo,sarReferenceDate1=alReferenceDate1,sarReference2=alReference2,sarTaxDate=alTaxDate,sarU_TAXDT=alU_TAXDT,sarBaseSum=alBaseSum,sarTaxGroup=alTaxGroup,sarVatAmount=alVatAmount,sarCostingCode=alCostingCode,sarU_CardNo=alU_CardNo,sarU_ApprNo=alU_ApprNo,sarU_VatRegN=alU_VatRegN,sarU_VatBP=alU_VatBP,sarU_VatBpNM=alU_VatBpNM,sarU_UserName=alU_UserName,sarU_VatBPNM1=alU_VatBPNM1,sarU_ItemGroup=alU_ItemGroup,sarU_PayMe=alU_PayMe,sarU_BankCode=alU_BankCode,sarU_Account=alU_Account,sarU_AcctName=alU_AcctName,sarU_CARDCD=alU_CARDCD,sarU_CARDNM=alU_CARDNM,sarU_SAUPNO=alU_SAUPNO,sarU_SUPAMT=alU_SUPAMT,sarU_VAT=alU_VAT;var json=createExecuteParamInfo("oJournalVouchers_S",[stremployee_id||"","",strCurrDate,strMemo,strCurrDate,strCurrDate,strCurrDate,bNoVat?"Y":"N",U_USERID,U_USERNAME,U_DEPTCODE,U_DEPTNAME,U_Drftnum,sarLine_ID,sarAccountCode,sarDebit,sarCredit,sarShortName,sarLineMemo,sarReferenceDate1,sarReference2,sarTaxDate,sarU_TAXDT,sarBaseSum,sarTaxGroup,sarVatAmount,sarCostingCode,sarU_CardNo,sarU_ApprNo,sarU_VatRegN,sarU_VatBP,sarU_VatBpNM,sarU_UserName,sarU_VatBPNM1,sarU_ItemGroup,sarU_PayMe,sarU_BankCode,sarU_Account,sarU_AcctName,sarU_CARDCD,sarU_CARDNM,sarU_SAUPNO,sarU_SUPAMT,sarU_VAT]);log(4);var ds2=callSBO(["req",json],"Q_SAP",$,true);console.log(ds2);if(ds2.result.indexOf("Error")>=0){MessageBoxShow(ds2.result);return}$.arResult=ds2.result.split("\t");var json=createJSON_Q3("U");var ds3=callExecuteSync(["req",json],"U",$);console.log(ds3);if(ds3){if(ds3.errorCode.substr(0,1)=="P"||ds3.errorCode.substr(0,1)=="E"){MessageBoxShow("문서번호: "+$.varWFDocId+"<br>"+ds3.errorCode+"</br>"+ds3.errorMsg);return}else{$.varSapPrint=true;clearWfDoc();selectDoc("Q1",$.varWFDocId)}}}}else{if(ds.errorCode=="MSG0004"){printWfDoc()}else{if(ds.errorCode=="MSG0006"){$.msg="조회된 자료가 없습니다.";$.stryyyy=$.dte_ymdyyyy.getValue();saveHRB6300_S1("")}}}}}}else{if(type=="WF_DOC"){if(ds.resultList){if(ds.resultList[0].length<=0){return false}if(ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}else{$.strBusinessID="";$.strwf_doc_id_B1="";if(ds.resultList[0][0].business_id){$.strBusinessID=ds.resultList[0][0].business_id}$.strwf_doc_id_sub=ds.resultList[0][0].wf_doc_id;$.strCancelWFYN=ds.resultList[0][0].cancel_wf_yn}convertJavaDateToJs(ds.resultList,"default_day");var wfResult=$.wfDocView1.load(ds.resultList);var rData=$.grdList.getValue($.grdList.getSelectedRowIdx());$.wfResult=ds.resultList[0][0];$.btnPrint.setVisible(true);var relWf=wfResult.relWf;if(relWf&&relWf.length){for(var i=0;i<relWf.length;i++){var refTab=(i+1);var refDoc=relWf[i];$.tabView.showTab(refTab);$.tabView.setTabText(refTab,refDoc.doc_title);var json=createJSON_Q("Q1",refDoc.rel_wf_doc_id);callQuery(["req",json],("WF_DOC_REL"+refTab),$)}}if(rData.parentKeyID=="10"&&$.wfResult.employee_id==g_main.session.obj.UserID&&$.wfResult.last_process_yn=="N"){$.btnAbitrary.setVisible(true)}else{$.btnAbitrary.setVisible(false)}if($.wfResult.reason_yn=="Y"){$.panView.setProperty(380,0,820,1000);$.tabView.setProperty(0,0,850,950);$.panReason.setVisible(true);searchList("Q3",$.varWFDocId)}else{$.panView.setProperty(380,0,820,1250);$.tabView.setProperty(0,0,850,1200);$.panReason.setVisible(false)}if($.wfResult.budget_yn=="Y"){$.panAppr.setProperty(0,0,365,660);$.grdList.setSize(365,615);$.panBudget.setVisible(true);searchList("Q4",$.varWFDocId)}else{$.panAppr.setProperty(0,0,365,1250);$.grdList.setSize(365,1205);$.panBudget.setVisible(false)}if(rData.cp_id!=""&&rData.cp_code!=""){$.btnCP_Click.setVisible(true)}else{$.btnCP_Click.setVisible(false)}var workType="U";if(rData.ParentKeyID=="10"){saveWF(workType,"10","10","N")}else{if(rData.ParentKeyID=="20"){saveWF(workType,"10","20","N")}else{if(rData.ParentKeyID=="30"){saveWF(workType,"10","30","N")}else{if(rData.ParentKeyID=="52"){saveWF(workType,"10","52","N")}}}}ChangeVisibleButton();if(ds.resultList[0][0].BatchNum!=0&&ds.resultList[0][0].BatchNum!=""&&ds.resultList[0][0].BatchNum!="0 ★"){$.btnBudgetCancel.setVisible(false)}var len=ds.resultList.length;var apprLine=(len>1?ds.resultList[1]:null);var confLine=(len>2?ds.resultList[2]:null);var isApprCheck=false;for(var i=0;i<apprLine.length;i++){if(apprLine[i].wf_confirm_time){isApprCheck=true;break}}for(var i=0;i<confLine.length;i++){if(confLine[i].ref_confirm_time){isApprCheck=true;break}}if(isApprCheck){$.btnDraftCancel.setVisible(false)}if($.varSapPrint){printWfDoc();$.varSapPrint=false}}}else{if(type.indexOf("WF_DOC_REL")>-1){var refIdx=Number(type.substr(10,2));var refTab=$[("wfDocView"+(refIdx+1))];refTab.init();if(ds.resultList){convertJavaDateToJs(ds.resultList,"default_day");var wfResult=refTab.load(ds.resultList)}}else{if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="";param[0][0].Confirm=false;param[0][0].AllReport=true;param[0][0].MyReport=true;param[0][0].cp_descr=param.cp_desc;param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}}}}}}};$.update=function(args){if($.startAfterChain){$.startAfterChain=false}else{if(args){$.varWfDocId=args.wf_doc_id;queryClick()}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSearch"){queryClick()}else{if(id=="btnWrite"){if($.varWFDocId){var json=createJSON_Q("Q2",$.varWFDocId);var ds=callQuerySync(["req",json],"WF_DOC");if(ds.returnStr){var param=ds.resultList;console.log(param);g_main.openModelWithBusiness(ds.returnStr,param,true,true)}}}else{if(id=="btnDel"){if(!$.varCurrRowId){return}$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if("60"==$.varStatusType){confirmBoxShow("해당 결재문서를 삭제하시겠습니까?",function(){if(g_main.msgShare){$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","60",$.varStatusType)}})}}else{if(id=="btnPrint"){var rId=$.grdList.getSelectedRowIdx();if($.strBusinessID=="BP00000021"||$.strBusinessID=="BP00000022"||$.strBusinessID=="BP00000023"||$.strBusinessID=="BP00000024"||$.strBusinessID=="BP00000025"||$.strBusinessID=="BP00000027"||$.strBusinessID=="BP00000028"||$.strBusinessID=="BP00000029"||$.strBusinessID=="BP00000017"){if($.strBusinessID=="BP00000027"&&g_main.session.obj.SalesEmpYN=="Y"){MessageBoxShow("crmWFGeneralProc_010");return}if($.grdList.getValue(rId,"ParentKeyID")=="90"){printWfDoc();return}if($.grdList.getValue(rId,"cancel_wf_doc_id")!=""||$.grdList.getValue(rId,"wf_status")=="10"){printWfDoc()}else{b1oJournalVouchers("Q")}}else{printWfDoc()}}else{if(id=="btnOK"){if(!$.varCurrRowId){return}$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if(g_main.session.obj.Auto_PassWord&&g_main.session.obj.Auto_PassWord=="Y"){$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","10",$.varStatusType)}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}else{if(id=="btnCancel"){if(!$.varCurrRowId){return}confirmBoxShow("해당 결재문서를 반려하시겠습니까?",function(){if(g_main.msgShare){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if(g_main.session.obj.Auto_PassWord&&g_main.session.obj.Auto_PassWord=="Y"){var param={reason_type:"80"};g_main.openPopup("popWFReasonSub.html","popWFReasonSub","",0,0,"","",param,"","")}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}})}else{if(id=="btnCP_Click"){searchCPInfo("FORM")}else{if(id=="btnAbitrary"){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if($.varStatusType=="10"){confirmBoxShow("해당 결재문서를 전결하시겠습니까?",function(){if(g_main.msgShare){var param={reason_type:"30"};g_main.openPopup("popWFReasonSub.html","popWFReasonSub","",0,0,"","",param,"","")}})}}else{if(id=="btnBeforeHand"){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if($.varStatusType=="40"){confirmBoxShow("해당 결재문서를 선결하시겠습니까?",function(){if(g_main.msgShare){var param={reason_type:"20"};g_main.openPopup("popWFReasonSub.html","popWFReasonSub","",0,0,"","",param,"","")}})}}else{if(id=="btnDraftCancel"){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if($.varStatusType=="70"){if(g_main.session.obj.Auto_PassWord&&g_main.session.obj.Auto_PassWord=="Y"){$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","40",$.varStatusType)}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}}else{if(id=="btnApprCancel"){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if($.varStatusType=="50"){if(g_main.session.obj.Auto_PassWord&&g_main.session.obj.Auto_PassWord=="Y"){$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","50",$.varStatusType)}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}}else{if(id=="btnBudgetCancel"){$.varStatusType=$.grdList.getValue($.varCurrRowId,"ParentKeyID");if($.varStatusType=="90"||$.varStatusType=="91"){if(g_main.session.obj.Auto_PassWord&&g_main.session.obj.Auto_PassWord=="Y"){$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","70",$.varStatusType)}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}}}}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.wfDocView1.init();$.tabView.setActiveTab(0);$.tabView.hideTab(1);$.tabView.hideTab(2);$.tabView.hideTab(3);$.tabView.hideTab(4);$.tabView.hideTab(5);$.tabView.hideTab(6);$.tabView.hideTab(7);$.tabView.hideTab(8);$.tabView.hideTab(9);$.tabView.hideTab(10);$.tabView.hideTab(11);var rData=$.grdList.getValue(rId);$.varCurrRowId=rId;$.varWFDocId=rData.wf_doc_id;$.varCPId="";$.varCPCode="";$.varReason="";btnControls(rData.wf_status);$.cp_id=rData.cp_id;$.cp_code=rData.cp_code;if($.cp_id!=""&&$.cp_code!=""){$.btnCP_Click.setVisible(true)}else{$.btnCP_Click.setVisible(false)}$.strwork_type="U";$.strwf_doc_id_sub=rData.wf_doc_id;if($.varWFDocId){selectDoc("Q1",$.varWFDocId)}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popWFPassword"){if($.popUpCallId=="btnOK"){if(!popResult.result){return}$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","10",$.varStatusType)}else{if($.popUpCallId=="btnCancel"){if(!popResult.result){return}var param={reason_type:"80"};g_main.openPopup("popWFReasonSub.html","popWFReasonSub","",0,0,"","",param,"","")}else{if($.popUpCallId=="btnDraftCancel"){if(!popResult.result){return}saveWF("N","40",$.varStatusType)}else{if($.popUpCallId=="btnApprCancel"){if(!popResult.result){return}saveWF("N","50",$.varStatusType)}else{if($.popUpCallId=="btnBudgetCancel"){if(!popResult.result){return}saveWF("N","70",$.varStatusType)}}}}}}else{if(id=="popWFReasonSub"){if($.popUpCallId=="btnCancel"){$.varReason=popResult.result;$.varWfDocId=$.grdList.nextRowData($.varCurrRowId)["wf_doc_id"];saveWF("N","80",$.varStatusType)}else{if($.popUpCallId=="btnAbitrary"){if(!popResult.resut){return}saveWF("N","30",$.varStatusType)}else{if($.popUpCallId=="btnBeforeHand"){if(!popResult.resut){return}saveWF("N","20",$.varStatusType)}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){if(id=="tabView"){if(tabid=="0"){$.btnPrint.setVisible(true);return}$.btnPrint.setVisible(false);$.iLevel=1;searchList("Q1")}};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>