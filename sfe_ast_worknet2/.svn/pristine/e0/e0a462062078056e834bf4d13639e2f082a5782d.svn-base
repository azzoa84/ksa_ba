<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.cmbDept=null;$.cmbYDiv=null;$.grdFile=null;$.ediDetail=null;$.grdList2=null;$.grdDoc=null;$.grdList1=null;$.businessId="";$.varWFDocId="";$.varWFType="";$.varOriginWfDocId="";$.combo_name="";function searchWFDocument(workType){if(workType=="Q3"){var json=createJSON_Q3("Q3");callQuery(["req",json],"Q3",$)}}$.isSearch=false;function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFBgtAssignNew"]);return json}function searchList(workType){log("searchList --> "+workType);var json=createJSON_Q(workType);if(workType=="Q1"){var ds=callQuerySync(["req",json],workType)}else{if(workType=="Q"){callQuery(["req",json],workType,$)}}}function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFBgtAssignNew_Q",[workType,$.cmbYDiv.getValue().substring(0,4),$.cmbYDiv.getValue().substring(4,5),"",$.cmbDept.getValue()]);return json}function saveWFBgtAssignNew(workType){var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],workType,$);log(ds);var bResult=true;if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);bResult=false}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);bResult=false}}}else{bResult=false}return bResult}function createJSON_S(workType){var rows=[];if($.cmbYDiv.getValue().substring(4,5)=="1"){log("1");for(var i=0;i<$.grdList1.getRowCount();i++){rows.push([workType,$.varWfDocId,$.cmbYDiv.getValue().substring(0,4),$.cmbYDiv.getValue().substring(4,5),$.grdList1.getValue(i,"dept_code"),$.grdList1.getValue(i,"budget_code"),$.grdList1.getValue(i,"product_code")=="*"?"":$.grdList1.getValue(i,"product_code"),Number($.grdList1.getValue(i,"budget_year_amt")),Number($.grdList1.getValue(i,"budget_year_amt")),Number($.grdList1.getValue(i,"first_amt")),Number($.grdList1.getValue(i,"first_amt")),0,0,0,0,Number($.grdList1.getValue(i,"first_amt")),Number($.grdList1.getValue(i,"first_amt")),0,0,0,"",0,Number($.grdList1.getValue(i,"second_amt")),Number($.grdList1.getValue(i,"second_amt")),0,Number($.grdList1.getValue(i,"second_amt"))])}}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){for(var j=0;j<$.grdList2.getRowCount();j++){rows.push([workType,$.varWfDocId,$.cmbYDiv.getValue().substring(0,4),$.cmbYDiv.getValue().substring(4,5),$.grdList2.getValue(j,"dept_code"),$.grdList2.getValue(j,"budget_code"),$.grdList2.getValue(j,"product_code")=="*"?"":$.grdList2.getValue(j,"product_code"),Number($.grdList2.getValue(j,"year_base_amt")),Number($.grdList2.getValue(j,"year_amt"))||0,Number($.grdList2.getValue(j,"first_base_amt")),Number($.grdList2.getValue(j,"first_amt")),Number($.grdList2.getValue(j,"first_redirect_amt")),Number($.grdList2.getValue(j,"first_add_amt")),Number($.grdList2.getValue(j,"first_chg_amt")),Number($.grdList2.getValue(j,"first_use_amt")),Number($.grdList2.getValue(j,"first_balance_amt")),Number($.grdList2.getValue(j,"first_aval_amt")),Number($.grdList2.getValue(j,"first_plan_amt")),Number($.grdList2.getValue(j,"first_advance_amt")),Number($.grdList2.getValue(j,"second_forward_amt")),$.grdList2.getValue(j,"forward_reason")||"",Number($.grdList2.getValue(j,"second_advance_amt")),Number($.grdList2.getValue(j,"second_base_amt")),Number($.grdList2.getValue(j,"second_amt")),Number($.grdList2.getValue(j,"second_add_amt")),Number($.grdList2.getValue(j,"second_assign_amt"))])}}}log(rows);var json=createExecuteParamInfo("P_crmWFBudgetAssignD_S",rows);return json}function checkValidation(){if(!validateControls([$.txtTitle,$.cmbDept])){return false}if($.cmbYDiv.getValue().substring(4,5)=="1"){if($.grdList1.getRowCount()<1){MessageBoxShow("상신할 예산 항목이 없습니다.");return false}}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){if($.grdList2.getRowCount()<1){MessageBoxShow("상신할 예산 항목이 없습니다.");return false}}}return true}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.businessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.ediDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function moveWFGeneralProc(){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}function saveWF(workType,processType,statusType,doc_id){var json=createJSON_S1("N","60","60",doc_id);callQuery(["req",json],workType,$)}function createJSON_S1(workType,processType,statusType,doc_id){var reason="";var json=createExecuteParamInfo("P_crmWFGeneralProc_S",[workType,doc_id,"#UserID#",processType,statusType,reason]);return json}function cmbYDiv_change(){if($.cmbYDiv.getValue()==""){return}else{if($.cmbYDiv.getValue().substring(4,5)=="1"){$.grdList1.setVisible(true);$.grdList2.setVisible(false)}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){$.grdList1.setVisible(false);$.grdList2.setVisible(true)}}}$.combo_name="cmbYDiv"}function cmbDept_change(){$.combo_name="cmbDept";if($.isSearch){searchList("Q")}}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1210);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine();$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,545);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,625,1200,285);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,920,440,280);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,920,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.cmbDept=new FingerComboBox(host,"cmbDept",745,75,140,20);$.cmbYDiv=new FingerComboBox(host,"cmbYDiv",890,75,140,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,235);$.ediDetail=new FingerWebEditor(host,"ediDetail",0,0,1200,210);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,500);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,235);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,1200,500);$.panWFMain.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.panTitle.setBorder(true);$.cmbDept.setEmptyRow(true);$.cmbYDiv.setEmptyRow(true);$.cmbYDiv.setReadOnly(true);$.cmbDept.setColumn("dept_code","dept_name");$.cmbDept.setAllowBlank(false,"부서");$.btnTmpSave.setEnable(false);$.cmbYDiv.setValue("20191");$.txtTitle.setAllowBlank(false,"문서제목");$.cmbDept.setAllowBlank(false,"부서");$.cmbYDiv.setAllowBlank(false,"년/반기");$.grdList1.setColumns([new FingerDataGridColumn("assign_status",100,"left","string","배정상태",{readonly:true}),new FingerDataGridColumn("dept_code",100,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",100,"left","string","부서",{readonly:true}),new FingerDataGridColumn("budget_code",100,"left","string","예산항목코드",{hidden:true}),new FingerDataGridColumn("budget_name",290,"left","string","예산항목",{readonly:true,footer:"총계:"}),new FingerDataGridColumn("ucoa_name",200,"left","string","ucoa코드",{readonly:true}),new FingerDataGridColumn("prod_budget_yn",0,"center","string","품목예산여부",{hidden:true}),new FingerDataGridColumn("product_code",100,"left","string","품목코드",{hidden:true}),new FingerDataGridColumn("product_name",100,"left","string","품목",{readonly:true}),new FingerDataGridColumn("budget_year_amt",130,"right","int","연예산",{format:"int",footer:{content:"summColumn"}},{readonly:true}),new FingerDataGridColumn("first_amt",130,"right","int","상반기예산",{format:"int",footer:{content:"summColumn"}},{readonly:true}),new FingerDataGridColumn("second_amt",130,"right","int","하반기예산",{readonly:true,format:"int",footer:{content:"summColumn"}},{readonly:true})]);$.grdList1.init({panel:$.panWFMain,scroll:"xy",footer:true,edit:true,isFilter:false,nonExcel:true});$.grdList1.setBorder(false);$.grdList1.setEditable(true);$.grdList2.setColumns([new FingerDataGridColumn("assign_status",100,"left","string",[{text:"",colspan:5},"배정상태"],{readonly:true}),new FingerDataGridColumn("dept_name",100,"left","string",["","부서"],{readonly:true}),new FingerDataGridColumn("budget_name",200,"left","string",["","예산항목"],{readonly:true,footer:"총계:"}),new FingerDataGridColumn("not_over_yn",100,"center","checkbox",["","이월불가"],{readonly:true}),new FingerDataGridColumn("product_name",100,"left","string",["","품목"],{readonly:true}),new FingerDataGridColumn("prod_budget_yn",100,"center","string","품목예산여부",{hidden:true}),new FingerDataGridColumn("budget_code",100,"left","string",["","예산항목코드"],{hidden:true}),new FingerDataGridColumn("product_code",100,"left","string",["","품목코드"],{hidden:true}),new FingerDataGridColumn("year_base_amt",130,"right","string",[{text:"상반기",colspan:11},"년예산"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_base_amt",100,"right","string",["","기초"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_amt",130,"right","string",["","전용후"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_redirect_amt",100,"right","string",["","전용"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_add_amt",100,"right","string",["","추가"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_chg_amt",100,"right","string",["","변경"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_use_amt",100,"right","string",["","사용"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_balance_amt",100,"right","string",["","잔액"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_aval_amt",100,"right","string",["","가용"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_plan_amt",100,"right","string",["","HOLD"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("first_advance_amt",100,"right","string",["","가불"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("second_forward_amt",100,"right","string",[{text:"하반기",colspan:7},{text:"이월",css:"col_edit"}],{format:"int",footer:{content:"summColumn"}}),new FingerDataGridColumn("forward_reason",200,"left","string",["",{text:"사유",css:"col_edit"}]),new FingerDataGridColumn("second_advance_amt",100,"right","string",["","가불이월"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("second_base_amt",100,"right","string",["","기초"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("second_amt",100,"right","string",["","전용후"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("second_add_amt",100,"right","string",["",{text:"추가기초",css:"col_edit"}],{hidden:true,format:"int",footer:{content:"summColumn"}}),new FingerDataGridColumn("second_assign_amt",130,"right","string",["","배정"],{format:"int",footer:{content:"summColumn"},readonly:true}),new FingerDataGridColumn("dept_code",100,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("year_amt",120,"right","string","전용후 년예산",{format:"int",footer:{content:"summColumn"},hidden:true})]);$.grdList2.init({panel:$.panWFMain,scroll:"xy",footer:true,leftSplit:5,edit:true,isFilter:false,nonExcel:true});$.grdList2.setBorder(false);$.grdList2.setEditable(true);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.cmbDept);$.panMain.add($.cmbYDiv);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.grdList2);$.panWFMain.add($.grdList1);$.panWFDetail.add($.ediDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);var ds=bizComponentData2($,"Q1","L_CRM0008");$.cmbYDiv.setColumn("half_code","half_name");setComboBind([$.cmbYDiv],ds);$.cmbYDiv.addItem("20192","2019년");$.cmbYDiv.setValue("20192");var session=g_main.session.obj;if(session.DeptCode=="A110"||session.DeptCode=="A120"||session.DeptCode=="U100"){$.cmbDept.setVisible(true);$.cmbDept.setEnable(true)}else{$.cmbDept.setVisible(false);$.cmbDept.setEnable(false)}var ds1;if(session.DeptCode=="U100"){ds1=bizComponentData2($,"Q4","L_CRM0051"," and dept_code in ('U100','U130')")}else{ds1=bizComponentData2($,"Q1","L_CRM0051")}setComboBind([$.cmbDept],ds1);$.isSearch=true;$.cmbDept.setValue(session.DeptCode);if($.cmbYDiv.getValue().substring(4,5)=="1"){$.grdList1.setVisible(true);$.grdList2.setVisible(false)}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){$.grdList1.setVisible(false);$.grdList2.setVisible(true)}}searchWFDocument("Q3")};$.callback=function(type,ds){if(type=="Q3"){$.businessId=ds.resultList[0][0].business_id;$.wfType=ds.resultList[0][0].wf_type;$.txtTitle.setValue("["+g_main.session.getValue("DeptName")+"] "+ds.resultList[0][0].business_title);$.combo_name="no"}else{if(type=="Q"){if(ds){if($.cmbYDiv.getValue().substring(4,5)=="1"){if(ds.resultList[0].length>0){convertJavaDateToJs(ds.resultList)}setDataGrid([$.grdList1],ds)}if($.cmbYDiv.getValue().substring(4,5)=="2"){if(ds.resultList[0].length>0){convertJavaDateToJs(ds.resultList)}setDataGrid([$.grdList2],ds)}if($.combo_name=="cmbYDiv"){$.combo_name="";if($.cmbYDiv.getValue()==""){return}var strstatus="";if($.cmbYDiv.getValue().substring(4,5)=="1"){if($.grdList1.getRowCount()<=0){return}strstatus=$.grdList1.getValue(0,"assign_status")}if($.cmbYDiv.getValue().substring(4,5)=="2"){if($.grdList2.getRowCount()<=0){return}strstatus=$.grdList2.getValue(0,"assign_status")}if(strstatus=="배정마감"||strstatus=="배정중"){$.panWFMain.disableButton(["btnDelete","btnAdd"])}else{$.panWFMain.enableButton(["btnDelete","btnAdd"])}}else{if($.combo_name=="cmbDept"){$.combo_name="";var strstatus="";if($.grdList1.getRowCount()>0){if($.grdList1.getValue(0,"assign_status")=="배정중"){$.grdList1.setEditable(false)}else{$.grdList1.setEditable(true)}strstatus=$.grdList1.getValue(0,"assign_status")}if($.grdList2.getRowCount()>0){if($.grdList2.getValue(0,"assign_status")=="배정"){$.grdList2.setEditable(false)}else{$.grdList2.setEditable(true)}strstatus=$.grdList2.getValue(0,"assign_status")}if(strstatus=="배정마감"||strstatus=="배정중"){$.panWFMain.disableButton(["btnDelete","btnAdd"])}else{$.panWFMain.enableButton(["btnDelete","btnAdd"])}}else{if($.combo_name=="no"){$.combo_name="";if($.grdList1.getRowCount()>0&&$.cmbYDiv.getValue().substring(4,5)=="1"){if($.grdList1.getValue(0,"assign_status")!=""){if(g_main.session.obj.DeptCode=="A120"||g_main.session.obj.DeptCode=="U100"||g_main.session.obj.DeptCode=="E120"){return}$.grdList1.setEditable(false);$.btnSubmit.setEnable(false);$.btnTmpSave.setEnable(false);$.cmbDept.setEnable(false);$.cmbYDiv.setEnable(false);$.panWFMain.disableButton(["btnDelete","btnAdd"])}}else{if($.grdList2.getRowCount()>0&&$.cmbYDiv.getValue().substring(4,5)=="2"){if($.grdList2.getValue(0,"assign_status")!=""){if(g_main.session.obj.DeptCode=="A120"||g_main.session.obj.DeptCode=="U100"||g_main.session.obj.DeptCode=="E120"){return}$.grdList2.setEditable(false);$.btnSubmit.setEnable(false);$.btnTmpSave.setEnable(false);$.cmbDept.setEnable(false);$.cmbYDiv.setEnable(false);$.panWFMain.disableButton(["btnDelete","btnAdd"])}}}}}}}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.ediDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);if($.cmbYDiv.getValue().substring(4,5)=="1"){setDataGrid([$.grdList1],args[6],true);$.grdList1.selectRow(0);$.saveType=true;for(var i=0;i<$.grdList1.getRowCount();i++){$.obj.push($.grdList1.getValue(i,"target_req_amt"));$.obj1.push($.grdList1.getValue(i,"change_remark"))}$.rowCount=$.grdList1.getRowCount()}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){setDataGrid([$.grdList2],args[6],true);$.grdList2.selectRow(0);$.saveType=true;for(var i=0;i<$.grdList2.getRowCount();i++){$.obj.push($.grdList2.getValue(i,"target_req_amt"));$.obj1.push($.grdList2.getValue(i,"change_remark"))}$.rowCount=$.grdList2.getRowCount()}}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if($.cmbYDiv.getValue().substring(4,5)=="1"){if(checkValidation()===false){return}for(var i=0;i<$.grdList1.getRowCount();i++){if(Number($.grdList1.getValue(i,"budget_year_amt"))<0){MessageBoxShow("연 예산 금액이 0 미만인 예산항목이 있습니다.");return}}}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){if(checkValidation()===false){return}for(var i=0;i<$.grdList2.getRowCount();i++){if(Number($.grdList2.getValue(i,"second_forward_amt"))!=0&&$.grdList2.getValue(i,"forward_reason").trim()==""){MessageBoxShow("이월 금액이 있는 경우 사유를 입력하여 주시기 바랍니다.");return}}}}var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFBgtAssignNew",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if(id=="btnTmpSave"){if(checkValidation()===false){return}if(saveWFDocument("","N")&&saveWFBgtAssignNew("N")){moveWFGeneralProc()}else{removeWFDocument($.varWfDocId)}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){var strstatus="";if(id=="cmbYDiv"){cmbYDiv_change()}else{if(id=="cmbDept"){cmbDept_change()}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList1"||id=="grdList2"){if(cInd=="product_name"){if($.cmbYDiv.getValue().substring(4,5)=="1"){var rid=$.grdList1.getSelectedRowIdx();if($.grdList1.getValue(rId,"product_name")!="*"){var param={product_code:$.grdList1.getValue(rId,"product_code")||""};$.popUpCallId="Grid1";g_main.openPopup("popProductList.html","popProductList","",0,0,"","",param,"","")}}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){var rid=$.grdList2.getSelectedRowIdx();if($.grdList2.getValue(rId,"product_name")!="*"){var param={product_code:$.grdList2.getValue(rId,"product_code")||""};$.popUpCallId="Grid2";g_main.openPopup("popProductList.html","popProductList","",0,0,"","",param,"","")}}}}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList1"){if(cInd=="budget_year_amt"||cInd=="first_amt"){if(Number($.grdList1.getValue(rId,cInd))<0){$.grdList1.setValue(rId,cInd,0)}if(Number($.grdList1.getValue(rId,"budget_year_amt"))<Number($.grdList1.getValue(rId,"first_amt"))){$.grdList1.setValue(rId,"first_amt",$.grdList1.getValue(rId,"budget_year_amt"))}$.grdList1.setValue(rId,"second_amt",(Number($.grdList1.getValue(rId,"budget_year_amt"))-Number($.grdList1.getValue(rId,"first_amt"))))}else{if(cInd=="product_name"){if($.grdList1.getValue(rId,"prod_budget_yn")=="N"&&grdList1.getValue("product_name")=="*"){$.grdList1.setValue(rId,"product_code","*");$.grdList1.setValue(rId,"product_name","*");return}}}}else{if(id=="grdList2"){if(cInd=="second_forward_amt"){if($.grdList2.getValue(rId,"not_over_yn")=="Y"&&Number($.grdList2.getValue(rId,"second_forward_amt"))>0){$.grdList2.setValue(rId,cInd,0)}if(Number($.grdList2.getValue(rId,"first_aval_amt"))<Number($.grdList2.getValue(rId,"second_forward_amt"))){$.grdList2.setValue(rId,cInd,$.grdList2.getValue(rId,"first_aval_amt"))}$.grdList2.setValue(rId,"second_assign_amt",(Number($.grdList2.getValue(rId,"second_forward_amt"))+Number($.grdList2.getValue(rId,"second_advance_amt")+$.grdList2.getValue(rId,"second_amt")+$.grdList2.getValue(rId,"second_add_amt"))))}else{if(cInd=="second_add_amt"){$.grdList2.setValue(rId,"second_assign_amt",(Number($.grdList2.getValue(rId,"second_forward_amt"))+Number($.grdList2.getValue(rId,"second_advance_amt"))+Number($.grdList2.getValue(rId,"second_amt"))+Number($.grdList2.getValue(rId,"second_add_amt"))-Number($.grdList2.getValue(rId,"first_chg_amt"))));$.grdList2.setValue(rId,"second_assign_amt",(Number($.grdList2.getValue(rId,"second_forward_amt"))+Number($.grdList2.getValue(rId,"second_advance_amt"))+Number($.grdList2.getValue(rId,"second_amt"))+Number($.grdList2.getValue(rId,"second_add_amt"))))}}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panWFMain"){if(btnId=="btnAdd"){$.popUpCallId="budgetList";var param={};g_main.openPopup("popBudgetList.html","popBudgetList","품목",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){if($.cmbYDiv.getValue().substring(4,5)=="1"){var rId=($.grdList1.getRowCount()-2);if($.grdList1.getRowCount()<1){MessageBoxShow(" 삭제할 예산항목이 없습니다.");return}$.grdList1.deleteRow($.grdList1.getSelectedRowIdx());$.grdList1.selectRow(rId)}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){var rId=($.grdList2.getRowCount()-2);if($.grdList2.getRowCount()<1){MessageBoxShow(" 삭제할 예산항목이 없습니다.");return}$.grdList2.deleteRow($.grdList2.getSelectedRowIdx());$.grdList2.selectRow(rId)}}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",1100,735,"","",param,"","")}else{if(id=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popBudgetList"){if($.popUpCallId=="budgetList"){if($.cmbYDiv.getValue().substring(4,5)=="1"){var idx=$.grdList1.getRowId(0);for(var i=0;i<popResult.length;i++){$.grdList1.addRow({budget_code:popResult[i].budget_code,budget_name:popResult[i].budget_name,prod_budget_yn:popResult[i].prod_budget_yn,dept_code:$.cmbDept.getValue(),dept_name:$.cmbDept.getText(),ucoa_name:popResult[i].ucoa_name,product_code:(popResult[i].prod_budget_yn=="N")?"*":"",product_name:(popResult[i].prod_budget_yn=="N")?"*":"",budget_year_amt:0,first_amt:0,second_amt:0,},$.grdList1.getRowCount())}}else{if($.cmbYDiv.getValue().substring(4,5)=="2"){var idx=$.grdList2.getRowId(0);for(var i=0;i<popResult.length;i++){$.grdList2.addRow({budget_code:popResult[i].budget_code,budget_name:popResult[i].budget_name,prod_budget_yn:popResult[i].prod_budget_yn,dept_code:$.cmbDept.getValue(),dept_name:$.cmbDept.getText(),product_code:(popResult[i].prod_budget_yn=="N")?"*":"",product_name:(popResult[i].prod_budget_yn=="N")?"*":"",year_base_amt:0,first_base_amt:0,first_amt:0,first_redirect_amt:0,first_add_amt:0,first_chg_amt:0,first_use_amt:0,first_balance_amt:0,first_aval_amt:0,first_plan_amt:0,first_advance_amt:0,second_forward_amt:0,forward_reason:"",second_advance_amt:0,second_base_amt:0,second_amt:0,second_add_amt:0,second_assign_amt:0},$.grdList2.getRowCount())}}}}}else{if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWfDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)&&saveWFBgtAssignNew("N")){moveWFGeneralProc()}else{removeWFDocument($.varWfDocId)}}}}else{if(id=="crmWFEndDocSub"){var rows=[];for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}else{if(id=="popProductList"){if($.popUpCallId=="Grid1"){var rId=$.grdList1.getSelectedRowIdx();$.grdList1.setValue(rId,"product_code",popResult.product_code);$.grdList1.setValue(rId,"product_name",popResult.product_name)}else{if($.popUpCallId=="Grid2"){var rId=$.grdList2.getSelectedRowIdx();$.grdList2.setValue(rId,"product_code",popResult.product_code);$.grdList2.setValue(rId,"product_name",popResult.product_name)}}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>