<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.lblYear=null;$.dteYear=null;$.lblHalf=null;$.cmbHalf=null;$.lblPlanType=null;$.cmbPlanType=null;$.lblEmp=null;$.cmbDept=null;$.cmbEmp=null;$.lblProduct=null;$.cmbProduct=null;$.lblBudget=null;$.cmbBudget=null;$.lblPromoType=null;$.cmbPromoType=null;$.btnSearch=null;$.panList=null;$.grdList=null;$.panAdd=null;$.lblWfDocId=null;$.txtWfDocId=null;$.lblWfSeq=null;$.txtWfSeq=null;$.lblDeptName=null;$.txtDeptName=null;$.lblEmpId=null;$.txtEmpName=null;$.txtEmployeeId=null;$.lblCompanyList=null;$.txtCompanyList=null;$.lblLocation=null;$.txtLocation=null;$.lblChgEmp=null;$.txtChgDeptName=null;$.txtChgEmployeeId=null;$.bteChgEmpName=null;$.txtChgDeptCode=null;$.txtProductCode=null;$.btnSave=null;$.txtDeptCode=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmBudgetTransfer_Q",[workType,$.dteYear.getValue(),$.cmbHalf.getValue()||"",$.cmbDept.getValue()||"",$.cmbEmp.getValue()||"",$.cmbProduct.getValue()||"",$.cmbBudget.getValue()||"",$.cmbPlanType.getValue()||"",$.cmbPromoType.getValue()||""]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmBudgetTransfer_S",[workType,$.grdList.getValue($.grdList.getSelectedRowIdx(),"base_yyyy")||"",$.grdList.getValue($.grdList.getSelectedRowIdx(),"base_half")||"",$.txtChgDeptCode.getValue(),$.txtChgEmployeeId.getValue(),$.txtProductCode.getValue(),$.txtWfDocId.getValue(),$.txtWfSeq.getValue()]);return json}function searchList(){if(!validateControls([$.dteYear])){return}var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function saveBudgetTransfer(){if(!$.grdList.getSelectedRowIdx()){return}if($.txtChgDeptCode.getValue()==""||$.txtChgEmployeeId.getValue()==""||$.bteChgEmpName.getText()==""){MessageBoxShow("인수인계 담당자를 입력해야 합니다.");return}confirmBoxShow("인수인계 처리하시겠습니까?",function(){if(g_main.msgShare==true){var json=createJSON_S("N");callExecute(["req",json],"N",$)}})}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,665);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,110);$.panQuery.setText("");$.panQuery.setBottomLine();$.lblYear=new FingerLabel(host,"lblYear",0,10,100,20);$.lblYear.setText("년도");$.dteYear=new FingerDateEdit(host,"dteYear",105,10,140,20);$.lblHalf=new FingerLabel(host,"lblHalf",225,10,100,20);$.lblHalf.setText("반기");$.cmbHalf=new FingerComboBox(host,"cmbHalf",330,10,140,20);$.lblPlanType=new FingerLabel(host,"lblPlanType",475,10,100,20);$.lblPlanType.setText("계획구분");$.cmbPlanType=new FingerComboBox(host,"cmbPlanType",580,10,140,20);$.lblEmp=new FingerLabel(host,"lblEmp",0,40,100,20);$.lblEmp.setText("부서/담당자");$.cmbDept=new FingerComboBox(host,"cmbDept",105,40,220,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",330,40,140,20);$.lblProduct=new FingerLabel(host,"lblProduct",475,40,100,20);$.lblProduct.setText("품목");$.cmbProduct=new FingerComboBox(host,"cmbProduct",580,40,140,20);$.lblBudget=new FingerLabel(host,"lblBudget",0,70,100,20);$.lblBudget.setText("예산항목");$.cmbBudget=new FingerComboBox(host,"cmbBudget",105,70,365,20);$.lblPromoType=new FingerLabel(host,"lblPromoType",475,70,100,20);$.lblPromoType.setText("판촉항목");$.cmbPromoType=new FingerComboBox(host,"cmbPromoType",580,70,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,75,80,20);$.btnSearch.setText("조회");$.panList=new FingerPanel(host,"panList",0,120,1200,410);$.panList.setText("예산계획내역");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,365);$.panAdd=new FingerPanel(host,"panAdd",0,545,1200,110);$.panAdd.setText("");$.panAdd.setBottomLine(true);$.lblWfDocId=new FingerLabel(host,"lblWfDocId",0,10,105,20);$.lblWfDocId.setText("결재문서아이디");$.txtWfDocId=new FingerEdit(host,"txtWfDocId",110,10,140,20);$.lblWfSeq=new FingerLabel(host,"lblWfSeq",255,10,100,20);$.lblWfSeq.setText("결재순번");$.txtWfSeq=new FingerEdit(host,"txtWfSeq",360,10,140,20);$.lblDeptName=new FingerLabel(host,"lblDeptName",480,10,100,20);$.lblDeptName.setText("부서");$.txtDeptName=new FingerEdit(host,"txtDeptName",585,10,140,20);$.lblEmpId=new FingerLabel(host,"lblEmpId",705,10,100,20);$.lblEmpId.setText("사원");$.txtEmpName=new FingerEdit(host,"txtEmpName",810,10,140,20);$.txtEmployeeId=new FingerEdit(host,"txtEmployeeId",955,10,140,20);$.lblCompanyList=new FingerLabel(host,"lblCompanyList",0,40,100,20);$.lblCompanyList.setText("거래처");$.txtCompanyList=new FingerEdit(host,"txtCompanyList",110,40,390,20);$.lblLocation=new FingerLabel(host,"lblLocation",480,40,100,20);$.lblLocation.setText("지역");$.txtLocation=new FingerEdit(host,"txtLocation",585,40,365,20);$.lblChgEmp=new FingerLabel(host,"lblChgEmp",0,70,100,20);$.lblChgEmp.setText("담당자변경");$.txtChgDeptName=new FingerEdit(host,"txtChgDeptName",110,70,125,20);$.txtChgEmployeeId=new FingerEdit(host,"txtChgEmployeeId",240,70,125,20);$.bteChgEmpName=new FingerButtonEdit(host,"bteChgEmpName",370,70,130,20);$.bteChgEmpName.setText("");$.txtChgDeptCode=new FingerEdit(host,"txtChgDeptCode",510,70,140,20);$.txtProductCode=new FingerEdit(host,"txtProductCode",655,70,140,20);$.btnSave=new FingerButton(host,"btnSave",1060,75,140,20);$.btnSave.setText("인수인계 반영");$.txtDeptCode=new FingerEdit(host,"txtDeptCode",1100,10,75,20);$.panQuery.setBorder(true);$.panAdd.setBorder(true);$.dteYear.setDateFormat("yyyy");$.dteYear.setAllowBlank(false,"년도");$.cmbHalf.setEmptyRow(true);$.cmbPlanType.setEmptyRow(true);$.cmbDept.setEmptyRow(true);$.cmbEmp.setEmptyRow(true);$.cmbProduct.setEmptyRow(true);$.cmbBudget.setEmptyRow(true);$.cmbPromoType.setEmptyRow(true);$.txtEmployeeId.setVisible(false);$.txtChgDeptCode.setVisible(false);$.txtProductCode.setVisible(false);$.txtDeptCode.setVisible(false);$.txtChgDeptName.setReadOnly(true);$.txtChgEmployeeId.setReadOnly(true);$.bteChgEmpName.setReadOnly(true);$.txtWfDocId.setReadOnly(true);$.txtWfSeq.setReadOnly(true);$.txtDeptName.setReadOnly(true);$.txtEmpName.setReadOnly(true);$.txtCompanyList.setReadOnly(true);$.txtLocation.setReadOnly(true);$.txtChgDeptName.setAllowBlank(false,"담당자변경");$.txtChgEmployeeId.setAllowBlank(false,"담당자변경");$.bteChgEmpName.setAllowBlank(false,"담당자변경");$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("base_yyyy",60,"left","string","년도"),new FingerDataGridColumn("base_half",60,"left","string","반기"),new FingerDataGridColumn("plan_month",60,"left","string","월"),new FingerDataGridColumn("dept_code",90,"left","string","부서코드",{hidden:true}),new FingerDataGridColumn("dept_name",100,"left","string","부서"),new FingerDataGridColumn("budget_code",150,"left","string","예산항목코드",{hidden:true}),new FingerDataGridColumn("budget_name",160,"left","string","예산항목"),new FingerDataGridColumn("product_code",150,"left","string","품목코드",{hidden:true}),new FingerDataGridColumn("product_name",100,"left","string","품목"),new FingerDataGridColumn("plan_seq",80,"right","string","계획순번",{format:"int"}),new FingerDataGridColumn("employee_id",100,"left","string","사원번호"),new FingerDataGridColumn("emp_name",100,"left","string","사원명"),new FingerDataGridColumn("use_type",60,"left","string","구분"),new FingerDataGridColumn("promo_code",100,"left","string","판촉항목코드",{hidden:true}),new FingerDataGridColumn("promo_name",150,"left","string","판촉항목"),new FingerDataGridColumn("company_id_list",100,"left","string","거래처코드리스트",{hidden:true}),new FingerDataGridColumn("company_name_list",150,"left","string","거래처"),new FingerDataGridColumn("sidogu_code_list",100,"left","string","시도구코드리스트",{hidden:true}),new FingerDataGridColumn("sidogu_name_list",150,"left","string","시도구"),new FingerDataGridColumn("plan_amt",100,"right","string","계획",{format:"int"}),new FingerDataGridColumn("use_amt",100,"right","string","사용",{format:"int"}),new FingerDataGridColumn("hold_amt",100,"right","string","HOLD",{format:"int"}),new FingerDataGridColumn("aval_amt",100,"right","string","가용",{format:"int"}),new FingerDataGridColumn("plan_status",100,"left","string","상태"),new FingerDataGridColumn("wf_doc_id",100,"left","string","결재문서아이디",{hidden:true}),new FingerDataGridColumn("wf_seq",100,"left","string","결재순번",{hidden:true})]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setEditable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.btnSearch);$.panMain.add($.panList);$.panMain.add($.panAdd);$.panQuery.add($.lblYear);$.panQuery.add($.dteYear);$.panQuery.add($.lblHalf);$.panQuery.add($.cmbHalf);$.panQuery.add($.lblPlanType);$.panQuery.add($.cmbPlanType);$.panQuery.add($.lblEmp);$.panQuery.add($.cmbDept);$.panQuery.add($.cmbEmp);$.panQuery.add($.lblProduct);$.panQuery.add($.cmbProduct);$.panQuery.add($.lblBudget);$.panQuery.add($.cmbBudget);$.panQuery.add($.lblPromoType);$.panQuery.add($.cmbPromoType);$.panList.add($.grdList);$.panAdd.add($.btnSave);$.panAdd.add($.txtProductCode);$.panAdd.add($.txtChgDeptCode);$.panAdd.add($.bteChgEmpName);$.panAdd.add($.txtChgEmployeeId);$.panAdd.add($.txtChgDeptName);$.panAdd.add($.lblChgEmp);$.panAdd.add($.txtLocation);$.panAdd.add($.lblLocation);$.panAdd.add($.txtCompanyList);$.panAdd.add($.lblCompanyList);$.panAdd.add($.txtEmployeeId);$.panAdd.add($.txtEmpName);$.panAdd.add($.lblEmpId);$.panAdd.add($.txtDeptName);$.panAdd.add($.lblDeptName);$.panAdd.add($.txtWfSeq);$.panAdd.add($.lblWfSeq);$.panAdd.add($.txtWfDocId);$.panAdd.add($.lblWfDocId);$.panAdd.add($.txtDeptCode);relocateChildIndexInPanel([$.panQuery,$.panAdd]);$.dteYear.setValue(getToday());var ds=bizComponentData2($,"Q2","L_CRM0070");setComboBind([$.cmbHalf],ds);$.cmbProduct.setColumn("product_code","product_name");$.cmbBudget.setColumn("budget_code","budget_name");$.cmbPromoType.setColumn("promo_code","promo_name");var ds2=bizComponentData2($,"Q1","L_CRM0034|L_CRM0059|L_CRM0039|L_CRM0072");setComboBind([$.cmbPlanType,$.cmbProduct,$.cmbBudget,$.cmbPromoType],ds2);var strQuery=" and (dept_code >= 'F200') and delete_yn <> 'Y'";$.cmbDept.setColumn("dept_code","dept_name");var ds3=bizComponentData2($,"Q4","L_CRM0051",strQuery);setComboBind([$.cmbDept],ds3)};$.callback=function(type,ds){if(type=="Q"){log("1");setDataGrid([$.grdList],ds);if(ds.resultList[0].length<=0){$.grdList.setDisplayPanelRowCount("0")}else{$.grdList.selectRow(0)}}else{if(type=="N"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}searchList()}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList()}else{if(id=="btnSave"){saveBudgetTransfer()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteChgEmpName"){var param={employee_id:$.txtChgEmployeeId.getValue()||"",emp_name:$.bteChgEmpName.getText()||""};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDept"){$.cmbEmp.clear();var strQuery=" and dept_code = '"+$.cmbDept.getValue()+"'and delete_yn <> 'Y'";$.cmbEmp.setColumn("employee_id","emp_name");var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery);setComboBind([$.cmbEmp],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.txtWfDocId.setValue($.grdList.getValue(rId,"wf_doc_id"));$.txtWfSeq.setValue($.grdList.getValue(rId,"wf_seq"));$.txtDeptName.setValue($.grdList.getValue(rId,"dept_name"));$.txtDeptCode.setValue($.grdList.getValue(rId,"dept_code"));$.txtEmpName.setValue($.grdList.getValue(rId,"emp_name"));$.txtEmployeeId.setValue($.grdList.getValue(rId,"employee_id"));$.txtCompanyList.setValue($.grdList.getValue(rId,"company_name_list"));$.txtLocation.setValue($.grdList.getValue(rId,"sidogu_name_list"));$.txtProductCode.setValue($.grdList.getValue(rId,"product_code"))}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteChgEmpName"){if(!popResult.employee_id){$.txtChgDeptName.setValue("");$.txtChgEmployeeId.setValue("");$.bteChgEmpName.setText("");$.txtChgDeptCode.setValue("")}else{log(popResult);$.txtChgDeptName.setValue(popResult.dept_name);$.txtChgEmployeeId.setValue(popResult.employee_id);$.bteChgEmpName.setText(popResult.emp_name);$.txtChgDeptCode.setValue(popResult.dept_code)}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>