<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.lbl_ex1=null;$.cmb_dept=null;$.cmb_emp=null;$.lbl_pro_code=null;$.cmb_product=null;$.rd_view=null;$.btnSearch=null;$.btnHelp=null;$.lbl_ex2=null;$.grdList=null;$.grdList2=null;function QueryClick(){var rd_view=$.rd_view.getValue();if($.rd_view.getValue()=="1"){$.grdList2.setVisible(false);$.grdList.setVisible(true);fnQRY_P_crmSSAT_MRCL_Q("Q",rd_view)}else{if($.rd_view.getValue()=="2"){$.grdList.setVisible(false);$.grdList2.setVisible(true);var p_code="P04";fnQRY_P_crmSSAT_MRCL2_Q("Q",rd_view)}}}function fnQRY_P_crmSSAT_MRCL_Q(workType,rd_view){var json=createJSON_Q("Q",rd_view);callQuery(["req",json],"Q",$)}function fnQRY_P_crmSSAT_MRCL2_Q(workType,rd_view){var json=createJSON_Q("Q",rd_view);callQuery(["req",json],"Q1",$)}function createJSON_Q(workType,rd_view){var json=createExecuteParamInfo("P_crmSSAT_MRCL_Q",[workType,$.cmb_dept.getValue()||"",$.cmb_emp.getValue()||"",$.cmb_product.getValue()||"",rd_view]);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,710);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,85);$.panQuery.setText("");$.panQuery.setBottomLine();$.panList=new FingerPanel(host,"panList",0,90,1200,610);$.panList.setText("개업의점유율");$.panList.setBottomLine(true);$.lbl_ex1=new FingerLabel(host,"lbl_ex1",0,15,100,20);$.lbl_ex1.setText("부서/담당자");$.cmb_dept=new FingerComboBox(host,"cmb_dept",105,15,140,20);$.cmb_emp=new FingerComboBox(host,"cmb_emp",250,15,140,20);$.lbl_pro_code=new FingerLabel(host,"lbl_pro_code",395,15,100,20);$.lbl_pro_code.setText("품목그룹");$.cmb_product=new FingerComboBox(host,"cmb_product",500,15,140,20);$.rd_view=new FingerRadioBox(host,"rd_view",650,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.btnHelp=new FingerButton(host,"btnHelp",1025,15,110,20);$.btnHelp.setText("자료이용안내");$.lbl_ex2=new FingerLabel(host,"lbl_ex2",0,45,1010,20);$.lbl_ex2.setText("* 수량조회의 경우 나제아 OD와 주사, 프로그랍주사와 Cap., 아드바그랍이 분리됩니다. 금액의 경우는 나제아와 프로그랍으로 Group처리됩니다. (수량조회시 품목선택필수)");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,565);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,565);$.panQuery.setBorder(true);$.btnHelp.setVisible(false);$.cmb_dept.setEmptyRow(true);$.cmb_emp.setEmptyRow(true);$.cmb_product.setEmptyRow(true);$.rd_view.addButtons([{sub_code:"1",code_name:"금액"},{sub_code:"2",code_name:"수량"}]);$.rd_view.setValue("1");$.rd_view.setEnable(false);$.cmb_emp.setEnable(false);$.cmb_emp.setColumn("employee_id","emp_name");$.grdList2.setVisible(false);$.grdList.setColumns([new FingerDataGridColumn("dept_name",80,"left","string","부서"),new FingerDataGridColumn("emp_name",60,"left","string","담당자"),new FingerDataGridColumn("sidogu_name",100,"left","string","중지역"),new FingerDataGridColumn("company_name",120,"left","string","병원"),new FingerDataGridColumn("sa_mon",90,"right","string","당월",{format:"int"}),new FingerDataGridColumn("sa_hlf",90,"right","string","당기",{format:"int"}),new FingerDataGridColumn("sa_bef",100,"right","string","전년동기",{format:"int"}),new FingerDataGridColumn("sa_up",100,"right","string","성장률",{format:"number"}),new FingerDataGridColumn("sa_monb",100,"right","string","당월Share",{format:"number"}),new FingerDataGridColumn("sa_hlfb",100,"right","string","당기Share",{format:"number"}),new FingerDataGridColumn("sa_hlfbs",120,"right","string","당기누적Share",{format:"number"}),new FingerDataGridColumn("sa_befb",120,"right","string","전년동기Share",{format:"number"})]);$.grdList.init({panel:$.panList,scroll:"xy",nonExcel:false,isFilter:true});$.grdList2.setColumns([new FingerDataGridColumn("product_name",80,"left","string","품목"),new FingerDataGridColumn("dept_name",60,"left","string","부서"),new FingerDataGridColumn("emp_name",60,"left","string","담당자"),new FingerDataGridColumn("sidogu_name",100,"left","string","중지역"),new FingerDataGridColumn("company_name",100,"left","string","병원"),new FingerDataGridColumn("sa_mon",90,"right","string","당월",{format:"int"}),new FingerDataGridColumn("sa_hlf",90,"right","string","당기",{format:"int"}),new FingerDataGridColumn("sa_bef",90,"right","string","전년동기",{format:"int"}),new FingerDataGridColumn("sa_up",90,"right","string","성장률",{format:"number"}),new FingerDataGridColumn("sa_monb",100,"right","string","당월Share",{format:"number"}),new FingerDataGridColumn("sa_hlfb",100,"right","string","당기Share",{format:"number"}),new FingerDataGridColumn("sa_hlfbs",110,"right","string","당기누적Share",{format:"number"}),new FingerDataGridColumn("sa_befb",110,"right","string","전년동기Share",{format:"number"})]);$.grdList2.init({panel:$.panList,scroll:"xy",nonExcel:true,isFilter:false});$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panQuery.add($.lbl_ex1);$.panQuery.add($.cmb_dept);$.panQuery.add($.cmb_emp);$.panQuery.add($.lbl_pro_code);$.panQuery.add($.cmb_product);$.panQuery.add($.rd_view);$.panQuery.add($.btnSearch);$.panQuery.add($.btnHelp);$.panQuery.add($.lbl_ex2);$.panList.add($.grdList);$.panList.add($.grdList2);var strQuery=" and dept_code like '%' + 'S3' + '%' or dept_code like '%' + 'S030' + '%'";var ds=bizComponentData2($,"Q4","L_CRM195",strQuery);$.cmb_dept.setColumn("dept_code","dept_name");setComboBind([$.cmb_dept],ds);var ds=bizComponentData2($,"Q2","L_CRM227");$.cmb_product.setColumn("sub_code","code_name");setComboBind([$.cmb_product],ds);if(g_main.session.obj.DeptCode.substring(0,1)=="S3"){if(g_main.session.obj.DeptCode.substring(2,4)=="00"||g_main.session.obj.DeptCode.substring(2,4)=="90"){return}$.cmb_dept.setValue(g_main.session.obj.DeptCode);if(g_main.session.obj.DutyCode=="08"){return}$.cmb_emp.setValue(g_main.session.obj.EmpCode)}};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdList],ds)}else{if(type=="Q1"){setDataGrid([$.grdList2],ds)}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){QueryClick()}else{if(id=="btnHelp"){g_fileBrowser.download(getServerFileUrl("/SSAT/5.pdf"))}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmb_product"){if($.cmb_product.getValue()==null||$.cmb_product.getValue()==""){$.rd_view.setValue("1");$.rd_view.setEnable(false)}else{$.rd_view.setEnable(true)}}else{if(id=="cmb_dept"){if($.cmb_dept.getValue()==null||$.cmb_dept.getValue()==""){$.cmb_emp.setValue("");$.cmb_emp.setEnable(false)}else{$.cmb_emp.setEnable(true);$.cmb_emp.clear();var strQuery=" where deptcode ='"+$.cmb_dept.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0104",strQuery);setComboBind([$.cmb_emp],ds)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>