<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList1=null;$.panList2=null;$.panQuery=null;$.grdList1=null;$.cmbSite_code=null;$.lblsite_code=null;$.lbldept_code=null;$.txtdept_code=null;$.lbldept_name=null;$.txtdept_name=null;$.labelEx1=null;$.ymdToday_date=null;$.labelEx2=null;$.cmbstandard=null;$.lblsite_code1=null;$.cmbsite_code1=null;$.lbldept_code1=null;$.lbldept_name1=null;$.txtdept_name1=null;$.lbldept_name_eng=null;$.txtdept_name_eng=null;$.lbldept_name_for=null;$.txtdept_name_for=null;$.lblparent_dept=null;$.txtparent_dept=null;$.txtparent_dept_name=null;$.lbldept_leader=null;$.txtdept_leader=null;$.txtdept_leader_name=null;$.chksales_dept_yn=null;$.chkmarketing_dept_yn=null;$.lblstart_date=null;$.ymdstart_date=null;$.lblend_date=null;$.ymdend_date=null;$.lbljob_affiliation=null;$.cmbmaypole_code=null;$.lblmemo=null;$.txtmemo=null;$.txtdept_code1=null;$.btnSearch=null;$.lbldept_code2=null;$.txtdept_code2=null;function QueryClick(){fnQRY_P_ORG2000_Q("Q")}function fnQRY_P_ORG2000_Q(workType){var json=createJSON_Q(workType);callQuery(["req",json],"Q_TREE",$)}function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_ORG2000_Q",[workType,$.cmbSite_code.getValue(),$.txtdept_code.getValue()||"",$.txtdept_name.getValue()||"",workType=="TOTAL"?"":$.ymdToday_date.getValue()]);return json}function fnSET_P_ORG2000_S(workType){var json=createJSON_S(workType);callExecute(["req",json],"U",$)}function createJSON_S(workType){var json=createExecuteParamInfo("HR..P_ORG2000_S",[workType,$.txtdept_code1.getValue()||"",$.txtdept_code2.getValue()||"",$.txtdept_name1.getValue()||"",$.txtdept_name_eng.getValue()||"",$.txtdept_name_for.getValue()||"",$.cmbsite_code1.getValue()||"",$.txtparent_dept.getValue()||"",$.txtdept_leader.getValue()||"",$.chksales_dept_yn.getValue()||"",$.chkmarketing_dept_yn.getValue()||"",$.ymdstart_date.getValue()||"",$.ymdend_date.getValue()||"",$.cmbmaypole_code.getValue()||"",$.txtmemo.getValue()||"",g_main.session.obj.EmpCode,"#HostInfo#"]);return json}function getObjectDate(objDate){var year=parseInt(objDate.year)+1900;var month=parseInt(objDate.month)+1;var date=objDate.date;if(parseInt(month)<10){month="0"+month}if(parseInt(date)<10){date="0"+date}return year+""+month+""+date}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,725);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList1=new FingerPanel(host,"panList1",0,0,700,700);$.panList1.setText("부서리스트정보");$.panList1.setBottomLine(true);$.panList2=new FingerPanel(host,"panList2",710,0,490,700);$.panList2.setText("부서기본정보");$.panList2.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,700,110);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,115,700,540);$.cmbSite_code=new FingerComboBox(host,"cmbSite_code",105,15,185,20);$.lblsite_code=new FingerLabel(host,"lblsite_code",0,15,100,20);$.lblsite_code.setText("사업장");$.lbldept_code=new FingerLabel(host,"lbldept_code",0,45,100,20);$.lbldept_code.setText("부서코드");$.txtdept_code=new FingerEdit(host,"txtdept_code",105,45,155,20);$.lbldept_name=new FingerLabel(host,"lbldept_name",265,45,100,20);$.lbldept_name.setText("부서명");$.txtdept_name=new FingerEdit(host,"txtdept_name",370,45,150,20);$.labelEx1=new FingerLabel(host,"labelEx1",0,75,100,20);$.labelEx1.setText("현재일자");$.ymdToday_date=new FingerDateEdit(host,"ymdToday_date",105,75,155,20);$.labelEx2=new FingerLabel(host,"labelEx2",265,75,100,20);$.labelEx2.setText("검색기준");$.cmbstandard=new FingerComboBox(host,"cmbstandard",370,75,150,20);$.lblsite_code1=new FingerLabel(host,"lblsite_code1",0,15,100,20);$.lblsite_code1.setText("사업장");$.cmbsite_code1=new FingerComboBox(host,"cmbsite_code1",105,15,140,20);$.lbldept_code1=new FingerLabel(host,"lbldept_code1",0,45,100,20);$.lbldept_code1.setText("부서코드(EC)");$.lbldept_name1=new FingerLabel(host,"lbldept_name1",0,75,100,20);$.lbldept_name1.setText("부서명");$.txtdept_name1=new FingerEdit(host,"txtdept_name1",105,75,370,20);$.lbldept_name_eng=new FingerLabel(host,"lbldept_name_eng",0,105,100,20);$.lbldept_name_eng.setText("부서명(영문)");$.txtdept_name_eng=new FingerEdit(host,"txtdept_name_eng",105,105,370,20);$.lbldept_name_for=new FingerLabel(host,"lbldept_name_for",0,135,100,20);$.lbldept_name_for.setText("부서명(한문)");$.txtdept_name_for=new FingerEdit(host,"txtdept_name_for",105,135,370,20);$.lblparent_dept=new FingerLabel(host,"lblparent_dept",0,165,100,20);$.lblparent_dept.setText("상위부서");$.txtparent_dept=new FingerEdit(host,"txtparent_dept",105,165,140,20);$.txtparent_dept_name=new FingerButtonEdit(host,"txtparent_dept_name",250,165,225,20);$.txtparent_dept_name.setText("");$.lbldept_leader=new FingerLabel(host,"lbldept_leader",0,195,100,20);$.lbldept_leader.setText("부서장");$.txtdept_leader=new FingerEdit(host,"txtdept_leader",105,195,140,20);$.txtdept_leader_name=new FingerButtonEdit(host,"txtdept_leader_name",250,195,225,20);$.txtdept_leader_name.setText("");$.chksales_dept_yn=new FingerCheckBox(host,"chksales_dept_yn",105,225,140,20);$.chksales_dept_yn.setText("영업부서");$.chkmarketing_dept_yn=new FingerCheckBox(host,"chkmarketing_dept_yn",250,225,140,20);$.chkmarketing_dept_yn.setText("마케팅부서");$.lblstart_date=new FingerLabel(host,"lblstart_date",0,250,100,20);$.lblstart_date.setText("적용시작일");$.ymdstart_date=new FingerDateEdit(host,"ymdstart_date",105,250,130,20);$.lblend_date=new FingerLabel(host,"lblend_date",245,250,95,20);$.lblend_date.setText("적용종료일");$.ymdend_date=new FingerDateEdit(host,"ymdend_date",345,250,130,20);$.lbljob_affiliation=new FingerLabel(host,"lbljob_affiliation",0,280,100,20);$.lbljob_affiliation.setText("Maypole Code");$.cmbmaypole_code=new FingerComboBox(host,"cmbmaypole_code",105,280,370,20);$.lblmemo=new FingerLabel(host,"lblmemo",0,310,100,270);$.lblmemo.setText("비고");$.txtmemo=new FingerMemoEdit(host,"txtmemo",105,310,365,265);$.txtdept_code1=new FingerEdit(host,"txtdept_code1",105,45,140,20);$.btnSearch=new FingerButton(host,"btnSearch",620,75,80,20);$.btnSearch.setText("조회");$.lbldept_code2=new FingerLabel(host,"lbldept_code2",230,45,100,20);$.lbldept_code2.setText("부서코드");$.txtdept_code2=new FingerEdit(host,"txtdept_code2",335,45,140,20);var beditMode=true;$.panList2.addButtons(["btnSave"]);$.cmbstandard.setEmptyRow(true);$.cmbsite_code1.setEmptyRow(true);$.cmbmaypole_code.setEmptyRow(true);$.cmbSite_code.setAllowBlank(false,"사업장");$.cmbsite_code1.setAllowBlank(false,"사업장");$.txtdept_code1.setAllowBlank(false,"부서코드");$.txtdept_name1.setAllowBlank(false,"부서명");$.cmbmaypole_code.setAllowBlank(false,"Maypole Code");$.txtdept_code1.setEnable(false);$.ymdstart_date.setEnable(false);$.ymdend_date.setEnable(false);$.grdList1.setColumns([new FingerDataGridColumn("KeyID",50,"left","string","키ID",{hidden:true}),new FingerDataGridColumn("dept_name",300,"left","string","부서명",{template:"tree"}),new FingerDataGridColumn("dept_code",80,"left","string","부서코드"),new FingerDataGridColumn("dept_code_ec",130,"left","string","부서코드(EC)"),new FingerDataGridColumn("start_date",90,"left","string","적용시작일",{format:"s_ymd"}),new FingerDataGridColumn("end_date",90,"left","string","적용종료일",{format:"s_ymd"}),new FingerDataGridColumn("site_code",90,"left","string","사업장코드",{hidden:true}),new FingerDataGridColumn("dept_name_eng",90,"left","string","부서명영문",{hidden:true}),new FingerDataGridColumn("dept_name_for",90,"left","string","부서명한문",{hidden:true}),new FingerDataGridColumn("parent_dept",90,"left","string","상위부서코드",{hidden:true}),new FingerDataGridColumn("parent_dept_name",90,"left","string","상위부서이름",{hidden:true}),new FingerDataGridColumn("dept_leader",90,"left","string","부서장코드",{hidden:true}),new FingerDataGridColumn("dept_leader_name",90,"left","string","부서장이름",{hidden:true}),new FingerDataGridColumn("sales_dept_yn",90,"left","string","영업부서여부",{hidden:true}),new FingerDataGridColumn("marketing_dept_yn",90,"left","string","마케팅부서여부",{hidden:true}),new FingerDataGridColumn("memo",90,"left","string","비고",{hidden:true}),new FingerDataGridColumn("maypole_code",90,"left","string","Maypole_code",{hidden:true})]);$.grdList1.init({view:"treetable",scroll:"xy",treeKey:{id:"KeyID",parent:"ParentKeyID"}});$.grdList1.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList1);$.panMain.add($.panList2);$.panList1.add($.panQuery);$.panList1.add($.grdList1);$.panList2.add($.lblsite_code1);$.panList2.add($.cmbsite_code1);$.panList2.add($.lbldept_code1);$.panList2.add($.lbldept_name1);$.panList2.add($.txtdept_name1);$.panList2.add($.lbldept_name_eng);$.panList2.add($.txtdept_name_eng);$.panList2.add($.lbldept_name_for);$.panList2.add($.txtdept_name_for);$.panList2.add($.lblparent_dept);$.panList2.add($.txtparent_dept);$.panList2.add($.txtparent_dept_name);$.panList2.add($.lbldept_leader);$.panList2.add($.txtdept_leader);$.panList2.add($.txtdept_leader_name);$.panList2.add($.chksales_dept_yn);$.panList2.add($.chkmarketing_dept_yn);$.panList2.add($.lblstart_date);$.panList2.add($.ymdstart_date);$.panList2.add($.lblend_date);$.panList2.add($.ymdend_date);$.panList2.add($.lbljob_affiliation);$.panList2.add($.cmbmaypole_code);$.panList2.add($.lblmemo);$.panList2.add($.txtmemo);$.panList2.add($.txtdept_code1);$.panList2.add($.lbldept_code2);$.panList2.add($.txtdept_code2);$.panQuery.add($.cmbSite_code);$.panQuery.add($.lblsite_code);$.panQuery.add($.lbldept_code);$.panQuery.add($.txtdept_code);$.panQuery.add($.lbldept_name);$.panQuery.add($.txtdept_name);$.panQuery.add($.labelEx1);$.panQuery.add($.ymdToday_date);$.panQuery.add($.labelEx2);$.panQuery.add($.cmbstandard);$.panQuery.add($.btnSearch);beditMode=false;var ds=bizComponentData2($,"Q1","L_ORG001|L_ORG008|L_ORG001|L_HRI048");$.cmbSite_code.setColumn("site_code","site_name");$.cmbstandard.setColumn("sub_code","code_name");$.cmbsite_code1.setColumn("site_code","site_name");$.cmbmaypole_code.setColumn("sub_code","code_name");setComboBind([$.cmbSite_code,$.cmbstandard,$.cmbsite_code1,$.cmbmaypole_code],ds);$.cmbSite_code.setValue(g_main.session.obj.SiteCode);$.ymdToday_date.setValue(getToday(""));$.cmbstandard.setValue("01");QueryClick();beditMode=true};$.callback=function(type,ds){if(type=="Q_TREE"){for(var i=0;i<ds.resultList[0].length;i++){if(ds.resultList[0][i].start_date!=""){ds.resultList[0][i].start_date=getObjectDate(ds.resultList[0][i].start_date)}if(ds.resultList[0][i].end_date!=""){ds.resultList[0][i].end_date=getObjectDate(ds.resultList[0][i].end_date)}}$.grdList1.openNode("ROOT");setDataGrid([$.grdList1],ds);$.grdList1.openNode("all");var rIdx=0;if($.strFocusNode){rIdx=$.grdList1.getGridRowIndex("dept_code",$.strFocusNode)}$.strFocusNode="";$.grdList1.selectRow(rIdx)}else{if(type=="U"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 수정되었습니다.");QueryClick()}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){$.strFocusNode="";QueryClick()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="txtparent_dept_name"){var param={dept_name:$.txtparent_dept_name.getText()||"",};g_main.openPopup("popDept.html","popDept","",0,0,"","",param,"","")}else{if(id=="txtdept_leader_name"){var param={emp_name:$.txtdept_leader_name.getText()||"",};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbstandard"){if(!beditMode){return}if($.cmbstandard.getValue()==""){return}if($.cmbstandard.getValue()=="01"){fnQRY_P_ORG2000_Q("TOTAL")}else{fnQRY_P_ORG2000_Q("Q")}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList1"){$.strFocusNode="";var rId=$.grdList1.getSelectedRowIdx();var a=$.grdList1.getValue(rId,"start_date");var b=$.grdList1.getValue(rId,"end_date");startDate=extFormat(a,"yyyyMMdd");startDate=getFormatDate(startDate,"yyyyMMdd");endDate=extFormat(b,"yyyyMMdd");endDate=getFormatDate(endDate,"yyyyMMdd");$.cmbsite_code1.setValue($.grdList1.getValue(rId,"site_code"));$.txtdept_code1.setValue($.grdList1.getValue(rId,"dept_code_ec"));$.txtdept_code2.setValue($.grdList1.getValue(rId,"dept_code"));$.txtdept_name1.setValue($.grdList1.getValue(rId,"dept_name"));$.txtdept_name_eng.setValue($.grdList1.getValue(rId,"dept_name_eng"));$.txtdept_name_for.setValue($.grdList1.getValue(rId,"dept_name_for"));$.txtparent_dept.setValue($.grdList1.getValue(rId,"parent_dept"));$.txtparent_dept_name.setText($.grdList1.getValue(rId,"parent_dept_name"));$.txtdept_leader.setValue($.grdList1.getValue(rId,"dept_leader"));$.txtdept_leader_name.setText($.grdList1.getValue(rId,"dept_leader_name"));$.chksales_dept_yn.setValue($.grdList1.getValue(rId,"sales_dept_yn"));$.chkmarketing_dept_yn.setValue($.grdList1.getValue(rId,"marketing_dept_yn"));$.ymdstart_date.setValue(startDate);$.ymdend_date.setValue(endDate);$.cmbmaypole_code.setValue($.grdList1.getValue(rId,"maypole_code"));$.txtmemo.setValue($.grdList1.getValue(rId,"memo"))}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(btnId=="btnSave"){confirmBoxShow($.txtdept_name1.getValue()+" 정보를 수정하시겠습니까?",function(){if(g_main.msgShare==true){var rId=$.grdList1.getSelectedRowIdx();$.strFocusNode=$.grdList1.getValue(rId,"dept_code");fnSET_P_ORG2000_S("U")}})}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popDept"){if($.popUpCallId=="txtparent_dept_name"){$.txtparent_dept.setValue(popResult.dept_name);$.txtparent_dept_name.setText(popResult.dept_code)}}else{if(id=="popEmp"){if($.popUpCallId=="txtdept_leader_name"){$.txtdept_leader.setValue(popResult.employee_id);$.txtdept_leader_name.setText(popResult.emp_name)}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>