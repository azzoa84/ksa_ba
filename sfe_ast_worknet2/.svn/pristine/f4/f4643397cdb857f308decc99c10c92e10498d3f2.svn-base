<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFMain=null;$.lblDeptName=null;$.lblEmpName=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.btnFileAdd=null;$.btnFileDelete=null;$.btnDocAdd=null;$.btnDocDelete=null;$.txtDept=null;$.txtEmp=null;$.ediDetail=null;$.panContent=null;$.grdList=null;$.htmlHelp=null;$.grdFile=null;$.grdDoc=null;$.rdoVacType=null;$.lblVacType=null;$.panMyVacation=null;$.lblTotYch=null;$.lblUseYch=null;$.lblSumYch=null;$.speTotYch=null;$.speUseYch=null;$.speSumYch=null;$.htmlTotalTime=null;$.type="";$.varTotalTime=0;$.varActualTotalTime=0;$.varAvalTime=0;$.varDayTotal=0;$.session=g_main.session.obj;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFVacationEvent"]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmMyVacation_Q",[workType,"#UserID#"]);return json}function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmWFOverTimeCalc_Q",[workType,"#UserID#"]);return json}function createJSON_S(workType){var eventDate="";var workHour="";var vacType="";for(var i=0;i<$.grdList.getRowCount();i++){eventDate+=$.grdList.getValue(i,"event_date").replace(/-/gi,"").substr(0,8)+"|";workHour+=$.grdList.getValue(i,"work_hour")+"|";vacType+=$.grdList.getValue(i,"vac_type")+"|"}if($.grdList.getRowCount()>0){eventDate=eventDate.substring(0,eventDate.length-1);workHour=workHour.substring(0,workHour.length-1);vacType=vacType.substring(0,vacType.length-1)}var json=createExecuteParamInfo("P_crmWFVacationEvent_S",[workType,$.wfDocId,0,$.grdList.getValue(0,"total_time"),$.grdList.getValue(0,"actual_total_time"),$.grdList.getValue(0,"aval_time"),eventDate,workHour,vacType]);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("P_crmWFVacationReq_S",[workType,$.wfDocId,"","","",$.rdoVacType.getValue(),"","","","#DeptCode#","#UserID#",""]);return json}function searchWFDocument(workType){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function searchMyVacation(workType){var json=createJSON_Q2("Q");callQuery(["req",json],"Q",$)}function saveVacationEvent(popResult){if($.type=="Submit"){saveWFDocument("","Y",popResult)}else{if($.type=="Tmp"){saveWFDocument("","N")}}var json=createJSON_S2("N");var ds=callExecuteSync(["req",json],"N",$);if(ds){saveVacation()}}function saveVacation(){var json=createJSON_S("N");callExecute(["req",json],"SAVE",$)}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.businessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.ediDetail,$.wfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.wfDocId=ds.returnStr}return true}function dateChange(){var today=new Date();var dateString=$.dteEndDate.getText();var dateString2=$.dteStartDate.getText();var dateArray=dateString.split("-");var dateArray2=dateString2.split("-");var dateObj=new Date(dateArray[0],Number(dateArray[1])-1,dateArray[2]);var dateObj2=new Date(dateArray2[0],Number(dateArray2[1])-1,dateArray2[2]);var betweenDay=(dateObj.getTime()-dateObj2.getTime())/1000/60/60/24;$.txtVacDay.setValue(String.format("{0}일",(betweenDay+1).toString()))}String.format=function(){var theString=arguments[0];for(var i=1;i<arguments.length;i++){var regEx=new RegExp("\\{"+(i-1)+"\\}","gm");theString=theString.replace(regEx,arguments[i])}return theString};function newClick(){$.grdFile.clear();$.grdDoc.clear();$.ediDetail.setClear();$.grdList.clear()}function gridValidator(){if(arguments.length<2){return false}var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}function searchOverTime(workType){var json=createJSON_Q3(workType);var ds=callQuerySync(["req",json],$);if(ds&&ds.resultList[0]){$.varTotalTime=ds.resultList[0][0].total_time;$.varActualTotalTime=ds.resultList[0][0].actual_total_time||0;$.varAvalTime=ds.resultList[0][0].aval_time||0;setGridAddRow()}}function getVacTypeTime(value){var time=0;if(value=="10"){time=8}else{if(value=="70"){time=4}}return time}function avalTimeToDay(value){var day=0;if(value%8==4||value%8==5||value%8==6||value%8==7){day=Math.floor(value/8)+0.5}else{day=Math.floor(value/8)}return day}function chkVacationEvent(){if(Number($.varAvalTime)<Number($.varDayTotal)){MessageBoxShow("신청시간이 잔여시간을 초과합니다.");return false}if(!gridValidator($.grdList,"event_date","vac_type")){return false}return true}function setGridAddRow(){$.grdList.addRow({total_time:$.varTotalTime,total_time_str:$.varTotalTime+"시간",actual_total_time_str:$.varActualTotalTime+"시간("+avalTimeToDay($.varActualTotalTime)+"일)",actual_total_time:$.varActualTotalTime,aval_time_str:$.varAvalTime+"시간("+avalTimeToDay($.varAvalTime)+"일)",aval_time:$.varAvalTime})}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1375);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,295);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.lblDeptName=new FingerLabel(host,"lblDeptName",0,10,100,20);$.lblDeptName.setText("부서");$.lblEmpName=new FingerLabel(host,"lblEmpName",0,40,100,20);$.lblEmpName.setText("사원");$.panWFDetail=new FingerPanel(host,"panWFDetail",0,680,1200,385);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,1075,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,1075,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.btnFileAdd=new FingerButton(host,"btnFileAdd",215,-37.5,120,20);$.btnFileAdd.setText("파일추가");$.btnFileDelete=new FingerButton(host,"btnFileDelete",320,-37.5,120,20);$.btnFileDelete.setText("파일삭제");$.btnDocAdd=new FingerButton(host,"btnDocAdd",525,-37.5,120,20);$.btnDocAdd.setText("문서추가");$.btnDocDelete=new FingerButton(host,"btnDocDelete",630,-37.5,120,20);$.btnDocDelete.setText("문서삭제");$.txtDept=new FingerEdit(host,"txtDept",105,10,140,20);$.txtEmp=new FingerEdit(host,"txtEmp",105,40,140,20);$.ediDetail=new FingerWebEditor(host,"ediDetail",0,0,1200,310);$.panContent=new FingerPanel(host,"panContent",0,370,1200,300);$.panContent.setText("보상휴가 신청");$.panContent.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,255);$.htmlHelp=new FingerHTMLView(host,"htmlHelp",432,10,565,230);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,235);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,235);$.rdoVacType=new FingerRadioBox(host,"rdoVacType",105,70,350,20);$.lblVacType=new FingerLabel(host,"lblVacType",0,70,100,20);$.lblVacType.setText("보상휴가구분");$.panMyVacation=new FingerPanel(host,"panMyVacation",1010,0,180,235);$.panMyVacation.setText("잔여휴가");$.panMyVacation.setBottomLine(true);$.lblTotYch=new FingerLabel(host,"lblTotYch",0,20,80,20);$.lblTotYch.setText("총일수");$.lblUseYch=new FingerLabel(host,"lblUseYch",0,50,80,20);$.lblUseYch.setText("사용일수");$.lblSumYch=new FingerLabel(host,"lblSumYch",0,80,80,20);$.lblSumYch.setText("잔여일수");$.speTotYch=new FingerSpinEdit(host,"speTotYch",85,20,80,20);$.speUseYch=new FingerSpinEdit(host,"speUseYch",85,50,80,20);$.speSumYch=new FingerSpinEdit(host,"speSumYch",85,80,80,20);$.htmlTotalTime=new FingerHTMLView(host,"htmlTotalTime",795,385,210,20);$.panTitle.setBorder(true);$.panContent.addButtons(["btnDelete","btnAdd"]);$.txtTitle.setAllowBlank(false,"문서제목");$.htmlTotalTime.setHTML("* 보상휴가 신청 일수 : "+$.varDayTotal+"일");$.htmlTotalTime.setStyle("text-align","right");$.rdoVacType.addButtons([{sub_code:"96",code_name:"일반보상휴가",margin:50},{sub_code:"97",code_name:"마이너스연차차감 (1~3월)",margin:50}]);$.rdoVacType.setValue("96");$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("total_time_str",195,"right","string",{text:"",css:"multi_h_line"},{readonly:true}),new FingerDataGridColumn("actual_total_time_str",195,"right","string","* 사용가능 총 시간(일)",{readonly:true}),new FingerDataGridColumn("aval_time_str",195,"right","string","잔여 시간(일)",{readonly:true}),new FingerDataGridColumn("event_date",200,"left","date","신청 일자",{format:"ymd"}),new FingerDataGridColumn("vac_type",398,"left","string","보상휴가 신청(연차/반차)"),new FingerDataGridColumn("work_hour",0,"left","string","신청시간",{hidden:true}),new FingerDataGridColumn("actual_total_time",0,"right","string","* 사용가능 총 시간(일)",{hidden:true}),new FingerDataGridColumn("aval_time",0,"right","string","잔여 시간",{hidden:true}),new FingerDataGridColumn("total_time",0,"right","string","",{hidden:true})]);$.grdList.init({headerRowHeight:42});$.grdList.setBorder(false);$.grdList.setEditable(true);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.btnFileAdd.setVisible(false);$.btnFileDelete.setVisible(false);$.btnDocAdd.setVisible(false);$.btnDocDelete.setVisible(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panContent);$.panMain.add($.htmlTotalTime);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.lblDeptName);$.panWFMain.add($.lblEmpName);$.panWFMain.add($.txtDept);$.panWFMain.add($.txtEmp);$.panWFMain.add($.htmlHelp);$.panWFMain.add($.rdoVacType);$.panWFMain.add($.lblVacType);$.panWFMain.add($.panMyVacation);$.panWFDetail.add($.ediDetail);$.panFile.add($.btnFileAdd);$.panFile.add($.btnFileDelete);$.panFile.add($.grdFile);$.panDoc.add($.btnDocAdd);$.panDoc.add($.btnDocDelete);$.panDoc.add($.grdDoc);$.panContent.add($.grdList);$.panMyVacation.add($.lblTotYch);$.panMyVacation.add($.lblUseYch);$.panMyVacation.add($.lblSumYch);$.panMyVacation.add($.speTotYch);$.panMyVacation.add($.speUseYch);$.panMyVacation.add($.speSumYch);if($.session.SalesEmpYN=="Y"){$.grdList.setColumnText("total_time_str","행사참석(이동)<br>총 시간")}else{$.grdList.setColumnText("total_time_str","연장/휴일(이동)<br>/야간근로 총 시간")}relocateChildIndexInPanel([$.panWFMain]);var ds=bizComponentData2($,"Q1","R_CRM0013");var comboList=[];for(var i=0;i<ds.resultList[0].length;i++){var rowData=ds.resultList[0][i];if(rowData.time_item_code=="10"||rowData.time_item_code=="70"){comboList.push({sub_code:rowData.time_item_code,code_name:rowData.time_item_name})}}$.grdList.setColumnDropDownList("vac_type",comboList);searchWFDocument();searchMyVacation();searchOverTime("Q");$.txtDept.setValue(g_main.session.getValue("DeptName"));$.txtEmp.setValue(g_main.session.getValue("UserName"));$.wfDocId="";$.txtDept.setReadOnly(true);$.txtEmp.setReadOnly(true);$.speTotYch.setReadOnly(true);$.speUseYch.setReadOnly(true);$.speSumYch.setReadOnly(true);$.htmlHelp.setHTML('<div style="margin-left:10px;"><br/>보상 휴가 및 연장 근무 신청시 작성요령<br/><br/>취업규칙 제 30조,31조에 의거 업무상 필요한 경우 직원의 동의를 얻어 1주 12시간 내에<br/>취업규칙 제 28조 1 근로시간을 초과한 연장근로 또는 심아(22시~6시)에 시간외 근무<br/>및 휴일근무를 실시할 수 있습니다.<br/><br/>1. 학회, 행사 등의 이유로 연장 또는 심야 근무를 하게 될 경우, <br/>ㅤ사전에 연장근무계획 및 승인서 또는 행사참석계획 및 승인서를 반드시 기안하시기 바랍니다.<br/><br/>2. 연장하여 근무한 부분에 대해서는 보상휴가 또는 연장근무수당을 선택하여 신청할 수 있습니다.<br/>ㅤ보상휴가는 해당 회계기준년도 이내에 사용할 수 있으며 <br/>ㅤ연장근무계획 및 승인서 또는 행사참석계획 및 승인서를 반드시 첨부하시기 바랍니다.<br/><br/>&nbsp;&nbsp;&nbsp;* 계획시간 : 행사참석 계획 및 승인서 상 작성한 업무시간<br/>&nbsp;&nbsp;&nbsp;* 계획시간과 실제 근무시간이 다를 경우, 사유를 반드시 입력해주시기 바랍니다.<br/><br/></div>');$.htmlHelp.setBorder(true);$.htmlHelp.setStyleClass("information")};$.callback=function(type,ds){if(type=="Q3"){$.businessId=ds.resultList[0][0].business_id;$.wfType=ds.resultList[0][0].wf_type;$.txtTitle.setValue(ds.resultList[0][0].business_title)}else{if(type=="Q"){$.speTotYch.setValue(ds.resultList[0][0].U_TOTYCH);$.speUseYch.setValue(ds.resultList[0][0].U_USEYCH);$.speSumYch.setValue(ds.resultList[0][0].U_SUMYCH)}else{if(type=="SAVE"){var param={wf_doc_id:$.wfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];console.log(args);if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.wfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.ediDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var data=args[7];for(var i in data){data[i].total_time_str=data[i].total_time+"시간";data[i].actual_total_time_str=data[i].actual_total_time+"시간("+avalTimeToDay(data[i].actual_total_time)+"일)";data[i].aval_time_str=data[i].aval_time+"시간("+avalTimeToDay(data[i].aval_time)+"일)";data[i].event_date=extFormat(data[i].event_date,"yyyyMMdd");$.varDayTotal+=Number(data[i].work_hour)}$.grdList.clear();setDataGrid([$.grdList],data,true);$.htmlTotalTime.setHTML("* 보상휴가 신청 일수 : "+avalTimeToDay($.varDayTotal)+"일")}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if($.grdList.getRowCount()<1){return}if(!chkVacationEvent()){return}if($.rdoVacType.getValue()=="97"){if($.speSumYch.getValue()>="0"){MessageBoxShow("잔여연차가 마이너스인 경우에만 마이너스연차차감 기안이 가능합니다.");return}for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"event_date").substr(5,2)>"03"){MessageBoxShow("마이너스연차차감은 1~3월에만 신청 가능합니다.");return}}}$.type="Submit";var param={wf_doc_id:$.wfDocId,wf_form_id:"crmWFVacationEvent"};g_main.openPopup("popModAppr.html","popModAppr","결재라인 지정",0,0,"","",param,"","")}else{if(id=="btnTmpSave"){if($.grdList.getRowCount()<1){return}if(!chkVacationEvent()){return}$.type="Tmp";saveVacationEvent("")}else{if(id=="btnDocAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(id=="btnDocDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}else{if(id=="btnFileAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getSSSSValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(id=="btnFileDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="event_date"){if(!nValue){return}var value=getFormatDate(nValue,"yyyyMMdd").substring(0,8);var curretDate=getToday("");if(Number(value)>Number(curretDate)){MessageBoxShow("현재일 이후 날짜를 입력하실수 없습니다. 다시 입력해 주십시요.");$.grdList.setValue(rId,cInd,oValue);return}var data=$.grdList.getAllRows();var selectRowIndex=$.grdList.getGridIndexById(rId)-1;for(var i=0;i<data.length;i++){if(i!=selectRowIndex){if(data[i].event_date&&getFormatDate(data[i].event_date,"yyyyMMdd")==value){MessageBoxShow("신청일자는 중복될 수 없습니다.");$.grdList.setValue(rId,cInd,oValue||"");return}}}}else{if(cInd=="vac_type"){var dayValue=0;if(!nValue){dayValue=-getVacTypeTime(oValue)}else{dayValue=getVacTypeTime(nValue)}var oldDayValue=getVacTypeTime(oValue);var nowDayValue=getVacTypeTime(nValue);$.grdList.setValue(rId,"work_hour",dayValue);$.varDayTotal+=nowDayValue-oldDayValue;$.htmlTotalTime.setHTML("* 보상휴가 신청 일수 : "+avalTimeToDay($.varDayTotal)+"일")}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panDoc"){if(btnId=="btnAdd"){$.popUpCallId="btnDocAdd";var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getSSSSValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId="panContent"){if(btnId=="btnAdd"){setGridAddRow()}else{if(btnId=="btnDelete"){var rId=$.grdList.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 내역을 선택해 주시기 바랍니다.");return}log($.varDayTotal);$.varDayTotal=$.varDayTotal-Number($.grdList.getValue(rId,"work_hour")||0);$.htmlTotalTime.setHTML("* 보상휴가 신청 일수 : "+avalTimeToDay($.varDayTotal)+"일");$.grdList.deleteRow($.grdList.getSelectedRowIdx())}else{if(btnId=="btnNew"){newClick()}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.wfDocId=popResult.wf_doc_id}else{saveVacationEvent(popResult)}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){if(id=="rdoVacType"){if($.rdoVacType.getValue()=="97"){}else{if($.rdoVacType.getValue()=="96"){}}}};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>