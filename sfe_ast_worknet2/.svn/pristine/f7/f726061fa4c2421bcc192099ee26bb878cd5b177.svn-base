<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panExecutiveDate=null;$.panMeetingDate=null;$.grdMeetingDate=null;$.panExecutiveMeeting=null;$.lblDeptEmp=null;$.lblContent=null;$.lblTask=null;$.cmbDept=null;$.cmbEmp=null;$.memContent=null;$.memTask=null;$.grdExecutiveMeeting=null;$.btnExcel=null;$.dteMeetingDate=null;$.btnPrint=null;$.btnDateNew=null;$.btnDateSave=null;$.btnDateDelete=null;$.hvwTest=null;$.panList=null;$.lblContent2=null;$.lblContent3=null;$.memContent2=null;$.memContent3=null;$.lblTime=null;$.lblTime2=null;$.lblTime3=null;$.edtTime=null;$.edtTime2=null;$.lblMin=null;$.lblMin2=null;function createJSON_Q(workType){var meeting_id="";if(workType=="Q"){meeting_id=""}else{if(workType=="CONTENT"){meeting_id=$.meeting_id}}var json=createExecuteParamInfo("P_crmExecutiveMeeting_Q",[workType,meeting_id]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmExecutiveMeetingSchedule_S",[workType,$.meeting_id,$.dteMeetingDate.getValue(),"#UserID#"]);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("P_crmExecutiveMeeting_S",[workType,$.meeting_id,$.executive_id,$.cmbDept.getValue(),$.cmbEmp.getValue(),$.memContent.getValue(),$.edtTime.getValue(),$.memContent2.getValue(),$.edtTime2.getValue(),$.memContent3.getValue()]);return json}function searchExecutiveMeeting(meetingId){if(meetingId==""){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}else{if(meetingId=="CONTENT"){var json=createJSON_Q("CONTENT");callQuery(["req",json],"CONTENT",$)}}}function saveMeetingDate(workType){if(workType=="N"){var json=createJSON_S("N");callQuery(["req",json],"N",$)}else{if(workType=="U"){var json=createJSON_S("U");callQuery(["req",json],"U",$)}else{if(workType=="D"){var json=createJSON_S("D");callQuery(["req",json],"D",$)}}}}createJSON_S2;function saveExecutiveMeeting(workType){if(workType=="N"){var json=createJSON_S2("N");callQuery(["req",json],"N_EM",$)}else{if(workType=="U"){var json=createJSON_S2("U");callQuery(["req",json],"U_EM",$)}else{if(workType=="D"){var json=createJSON_S2("D");callQuery(["req",json],"D_EM",$)}}}}function printReportCallback(){}function printReport(){var outHtml="";outHtml=outHtml.concat("<table width='990px' border='0'>");outHtml=outHtml.concat("<tr>");outHtml=outHtml.concat("<td align='center'>");outHtml=outHtml.concat("<font style='font-weight:bold;'>");outHtml=outHtml.concat("<h2>");outHtml=outHtml.concat("간부회의록("+$.dteMeetingDate.getText()+")");outHtml=outHtml.concat("</h1>");outHtml=outHtml.concat("</font>");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("</tr>");outHtml=outHtml.concat("<tr height='50px'>");outHtml=outHtml.concat("</tr>");outHtml=outHtml.concat("</table>");outHtml=outHtml.concat("<table width='990px' border='1' cellspacing='0'>");outHtml=outHtml.concat("<tr>");outHtml=outHtml.concat("<td width='10%' align='center'>");outHtml=outHtml.concat("Dept.");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td width='8%' align='center'>");outHtml=outHtml.concat("Name");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td colspan='2' width='12%' align='center'>");outHtml=outHtml.concat("Category");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td width='60%' align='center'>");outHtml=outHtml.concat("Contents");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td width='10%' align='center'>");outHtml=outHtml.concat("Time<br>(min)");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("</tr>");for(var i=0;i<$.grdExecutiveMeeting.getRowCount();i++){var content2=$.grdExecutiveMeeting.getValue(i,"content2");var content3=$.grdExecutiveMeeting.getValue(i,"content3");var a_rowspan=(content2?1:0)+(content3?1:0);var b_rowspan=(content2?1:0);var is_informa=(content2?true:false);var is_onlyMin=(content3?true:false);var is_empty=(is_informa==false&&is_onlyMin==false);if(is_empty){continue}outHtml=outHtml.concat("<tr>");outHtml=outHtml.concat("<td rowspan='"+a_rowspan+"' align='center'>");outHtml=outHtml.concat($.grdExecutiveMeeting.getValue(i,"dept_name"));outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td rowspan='"+a_rowspan+"' align='center'>");outHtml=outHtml.concat($.grdExecutiveMeeting.getValue(i,"emp_name"));outHtml=outHtml.concat("</td>");if(is_informa){outHtml=outHtml.concat("<td colspan='2' align='center'>");outHtml=outHtml.concat("Presentation");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td width='75%'>");outHtml=outHtml.concat(content2);outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td align='center'>");outHtml=outHtml.concat($.grdExecutiveMeeting.getValue(i,"time2"));outHtml=outHtml.concat("</td>")}else{if(is_onlyMin){outHtml=outHtml.concat("<td colspan='2' align='center'>");outHtml=outHtml.concat("Only Minutes");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td>");outHtml=outHtml.concat(content3);outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td align='center'>");outHtml=outHtml.concat("-");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("</tr>");continue}}outHtml=outHtml.concat("</tr>");if(is_informa&&is_onlyMin){outHtml=outHtml.concat("<tr>");outHtml=outHtml.concat("<td colspan='2' align='center'>");outHtml=outHtml.concat("Only Minutes");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td>");outHtml=outHtml.concat(content3);outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("<td align='center'>");outHtml=outHtml.concat("-");outHtml=outHtml.concat("</td>");outHtml=outHtml.concat("</tr>")}}outHtml=outHtml.concat("</table>");printHtml(outHtml,null,printReportCallback)}function enableSaveButton(){if(g_main.session.getValue("SystemDeveloper")=="Y"||g_main.session.getValue("UserID")=="ka080084"||g_main.session.getValue("UserID")=="ka080069"){$.panExecutiveMeeting.enableButton(["btnSave"])}else{if(g_main.session.getValue("UserID")==$.cmbEmp.getValue()){$.panExecutiveMeeting.enableButton(["btnSave"])}else{$.panExecutiveMeeting.disableButton(["btnSave"])}}}function exportToExcel(){var column=[{headertext:"부서",datatype:"string",datafield:"dept_name",ishidden:false},{headertext:"이름",datatype:"string",datafield:"emp_name"},{headertext:"Decision-Making",datatype:"string",datafield:"content",ishidden:false},{headertext:"Time(min)",datatype:"string",datafield:"time",ishidden:false},{headertext:"Information Sharing",datatype:"string",datafield:"content2",ishidden:false},{headertext:"Time(min)",datatype:"string",datafield:"time2",ishidden:false},{headertext:"Only Minutes",datatype:"string",datafield:"content3",ishidden:false}];excelDown($.grdExecutiveMeeting.getExcelRows(),column,"간부회의록")}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,760);$.panMain.setText("");$.panMain.setBottomLine(true);$.panExecutiveDate=new FingerPanel(host,"panExecutiveDate",0,0,220,535);$.panExecutiveDate.setText("간부회의");$.panExecutiveDate.setBottomLine(true);$.panMeetingDate=new FingerPanel(host,"panMeetingDate",0,540,220,215);$.panMeetingDate.setText("회의일자조정");$.panMeetingDate.setBottomLine(true);$.grdMeetingDate=new FingerDataGrid(host,"grdMeetingDate",0,0,220,490);$.panExecutiveMeeting=new FingerPanel(host,"panExecutiveMeeting",230,0,970,350);$.panExecutiveMeeting.setText("보고내용작성");$.panExecutiveMeeting.setBottomLine(false);$.lblDeptEmp=new FingerLabel(host,"lblDeptEmp",35,10,100,20);$.lblDeptEmp.setText("부서/담당자");$.lblContent=new FingerLabel(host,"lblContent",25,65,110,20);$.lblContent.setText("Decision-Making (의사결정)");$.lblTask=new FingerLabel(host,"lblTask",30,280,100,20);$.lblTask.setText("비고(협의요청 제안사항)");$.cmbDept=new FingerComboBox(host,"cmbDept",145,10,200,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",350,10,140,20);$.memContent=new FingerMemoEdit(host,"memContent",145,40,685,80);$.memTask=new FingerMemoEdit(host,"memTask",145,300,770,15);$.grdExecutiveMeeting=new FingerDataGrid(host,"grdExecutiveMeeting",0,0,970,360);$.btnExcel=new FingerButton(host,"btnExcel",810,250,120,20);$.btnExcel.setText("엑셀내보내기");$.dteMeetingDate=new FingerDateEdit(host,"dteMeetingDate",50,90,115,20);$.btnPrint=new FingerButton(host,"btnPrint",740,250,80,20);$.btnPrint.setText("출력");$.btnDateNew=new FingerButton(host,"btnDateNew",10,35,80,20);$.btnDateNew.setText("신규");$.btnDateSave=new FingerButton(host,"btnDateSave",80,35,80,20);$.btnDateSave.setText("저장");$.btnDateDelete=new FingerButton(host,"btnDateDelete",150,35,80,20);$.btnDateDelete.setText("삭제");$.hvwTest=new FingerHTMLView(host,"hvwTest",130,5,50,20);$.panList=new FingerPanel(host,"panList",230,350,970,405);$.panList.setText("보고내용");$.panList.setBottomLine(true);$.lblContent2=new FingerLabel(host,"lblContent2",10,95,120,20);$.lblContent2.setText("Presentation<br>(의사결정/정보공유)");$.lblContent3=new FingerLabel(host,"lblContent3",35,225,95,20);$.lblContent3.setText("Only Minutes (회의록공유)");$.memContent2=new FingerMemoEdit(host,"memContent2",145,45,685,140);$.memContent3=new FingerMemoEdit(host,"memContent3",145,200,685,90);$.lblTime=new FingerLabel(host,"lblTime",845,60,100,20);$.lblTime.setText("Presentation");$.lblTime2=new FingerLabel(host,"lblTime2",825,90,100,20);$.lblTime2.setText("Time(min)");$.lblTime3=new FingerLabel(host,"lblTime3",845,240,100,20);$.lblTime3.setText("Presentation");$.edtTime=new FingerEdit(host,"edtTime",870,80,40,15);$.edtTime2=new FingerEdit(host,"edtTime2",870,120,40,15);$.lblMin=new FingerLabel(host,"lblMin",845,85,100,20);$.lblMin.setText("min");$.lblMin2=new FingerLabel(host,"lblMin2",845,120,100,20);$.lblMin2.setText("");$.panExecutiveMeeting.addButton("btnDelete","삭제");$.panExecutiveMeeting.addButton("btnSave","저장");$.panExecutiveMeeting.addButton("btnNew","신규");$.panExecutiveMeeting.setButtonAction("btnNew","new");$.panExecutiveMeeting.setButtonAction("btnSave","save");$.panExecutiveMeeting.setButtonAction("btnDelete","delete");$.panList.addButton("btnExcelDown","엑셀다운로드");$.panList.addButton("btnPrint","출력");$.panList.setButtonAction("btnExcelDown","excel_down");$.panList.setButtonAction("btnPrint","print");$.lblTask.setVisible(false);$.memTask.setVisible(false);$.lblTime3.setVisible(false);$.lblContent.setVisible(false);$.memContent.setVisible(false);$.lblTime.setVisible(false);$.edtTime.setVisible(false);$.lblMin.setVisible(false);$.grdMeetingDate.colIdx=$.grdMeetingDate.setColumns([new FingerDataGridColumn("meeting_id",0,"left","string",""),new FingerDataGridColumn("meeting_date",220,"center","string","회의일자",{format:"s_ymd"})]);$.grdMeetingDate.init();$.grdMeetingDate.setColumnHidden(["meeting_id"],true);$.grdMeetingDate.setBorder(false);$.grdExecutiveMeeting.colIdx=$.grdExecutiveMeeting.setColumns([new FingerDataGridColumn("executive_id",0,"left","string",""),new FingerDataGridColumn("dept_code",0,"left","string",""),new FingerDataGridColumn("dept_name",95,"center","string","부서"),new FingerDataGridColumn("employee_id",0,"left","string",""),new FingerDataGridColumn("emp_name",70,"center","string","이름"),new FingerDataGridColumn("content",500,"left","string","Decision-Making",{hidden:true}),new FingerDataGridColumn("content2",500,"left","string","Presentation",{adjustRowHeight:true}),new FingerDataGridColumn("content3",500,"left","string","Only Minutes",{adjustRowHeight:true}),new FingerDataGridColumn("time",30,"left","string","Min",{hidden:true}),new FingerDataGridColumn("time2",30,"left","string","Min",{hidden:true})]);$.grdExecutiveMeeting.init({scroll:"xy"});$.grdExecutiveMeeting.setColumnHidden(["executive_id","dept_code","employee_id"],true);$.grdExecutiveMeeting.setBorder(false);$.hvwTest.setVisible(true);$.btnExcel.setVisible(false);$.btnPrint.setVisible(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panExecutiveDate);$.panMain.add($.panMeetingDate);$.panMain.add($.panExecutiveMeeting);$.panMain.add($.panList);$.panExecutiveDate.add($.grdMeetingDate);$.panMeetingDate.add($.dteMeetingDate);$.panMeetingDate.add($.btnDateNew);$.panMeetingDate.add($.btnDateSave);$.panMeetingDate.add($.btnDateDelete);$.panExecutiveMeeting.add($.lblDeptEmp);$.panExecutiveMeeting.add($.lblContent);$.panExecutiveMeeting.add($.lblTask);$.panExecutiveMeeting.add($.cmbDept);$.panExecutiveMeeting.add($.cmbEmp);$.panExecutiveMeeting.add($.memContent);$.panExecutiveMeeting.add($.memTask);$.panExecutiveMeeting.add($.btnExcel);$.panExecutiveMeeting.add($.btnPrint);$.panExecutiveMeeting.add($.lblContent2);$.panExecutiveMeeting.add($.lblContent3);$.panExecutiveMeeting.add($.memContent2);$.panExecutiveMeeting.add($.memContent3);$.panExecutiveMeeting.add($.lblTime);$.panExecutiveMeeting.add($.lblTime2);$.panExecutiveMeeting.add($.lblTime3);$.panExecutiveMeeting.add($.edtTime);$.panExecutiveMeeting.add($.edtTime2);$.panExecutiveMeeting.add($.lblMin);$.panExecutiveMeeting.add($.lblMin2);$.panList.add($.grdExecutiveMeeting);searchExecutiveMeeting("");var ds=bizComponentData2($,"Q1","L_CRM0051");$.cmbDept.setColumn("dept_code","dept_name");setComboBind([$.cmbDept],ds);var ds2=bizComponentData2($,"Q1","L_CRM0104");$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds2);$.cmbDept.setValue("");$.cmbEmp.setValue("");if(g_main.session.getValue("UserID")=="ka080084"||g_main.session.getValue("UserID")=="ka080069"||g_main.session.getValue("SystemDeveloper")=="Y"){$.panMeetingDate.setVisible(true);$.cmbDept.setReadOnly(false);$.cmbEmp.setReadOnly(false);$.memTask.setReadOnly(false)}else{if(g_main.session.getValue("UserID")=="ka080069"){$.panMeetingDate.setVisible(false);$.cmbDept.setReadOnly(false);$.cmbEmp.setReadOnly(false);$.memTask.setReadOnly(false)}else{$.panMeetingDate.setVisible(false);$.cmbDept.setReadOnly(true);$.cmbEmp.setReadOnly(true);$.memTask.setReadOnly(true)}}};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdMeetingDate],ds);$.grdMeetingDate.selectRow(0)}else{if(type=="CONTENT"){setDataGrid([$.grdExecutiveMeeting],ds);$.grdExecutiveMeeting.selectRow(0)}else{if(type=="N"||type=="U"||type=="D"){searchExecutiveMeeting("")}else{if(type=="N_EM"||type=="U_EM"||type=="D_EM"){searchExecutiveMeeting("CONTENT");$.cmbDept.setValue("");$.cmbEmp.setValue("");$.memContent.setValue("");$.edtTime.setValue("");$.memContent2.setValue("");$.edtTime2.setValue("");$.memContent3.setValue("");$.executive_id=""}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPrint"){printReport()}else{if(id=="btnExcel"){exportToExcel()}else{if(id=="btnDateNew"){$.meeting_id="";$.dteMeetingDate.setValue("")}else{if(id=="btnDateSave"){if($.dteMeetingDate.getText()==""){return}if($.meeting_id==""){saveMeetingDate("N")}else{if($.meeting_id!=""){saveMeetingDate("U")}}}else{if(id=="btnDateDelete"){saveMeetingDate("D")}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDept"){var strQuery=" and dept_code = '"+$.cmbDept.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmp.clear();$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdMeetingDate"){$.meeting_id=$.grdMeetingDate.getValue(rId,"meeting_id");$.dteMeetingDate.setValue($.grdMeetingDate.getValue(rId,"meeting_date"));$.cmbDept.setValue("");$.cmbEmp.setValue("");$.memContent.setValue("");$.memTask.setValue("");$.executive_id="";searchExecutiveMeeting("CONTENT")}else{if(id=="grdExecutiveMeeting"){$.executive_id=$.grdExecutiveMeeting.getValue(rId,"executive_id");$.cmbDept.setValue($.grdExecutiveMeeting.getValue(rId,"dept_code"));var ds=bizComponentData2($,"Q3","L_CRM0052",$.cmbDept.getValue(),"","");$.cmbEmp.clear();$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds);var curr_emp_id=$.grdExecutiveMeeting.getValue(rId,"employee_id");$.cmbEmp.setValue(curr_emp_id);var contents=$.grdExecutiveMeeting.getValue(rId,"content");if(contents){contents=contents.replace(/<br>/g,"\n")}$.memContent.setValue(contents);var contents2=$.grdExecutiveMeeting.getValue(rId,"content2");if(contents2){contents2=contents2.replace(/<br>/g,"\n")}$.memContent2.setValue(contents2);var contents3=$.grdExecutiveMeeting.getValue(rId,"content3");if(contents3){contents3=contents3.replace(/<br>/g,"\n")}$.memContent3.setValue(contents3);$.edtTime.setValue($.grdExecutiveMeeting.getValue(rId,"time"));$.edtTime2.setValue($.grdExecutiveMeeting.getValue(rId,"time2"));enableSaveButton()}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panExecutiveMeeting"){if(btnId=="btnNew"){$.cmbDept.setValue(g_main.session.getValue("DeptCode"));var ds=bizComponentData2($,"Q3","L_CRM0052",$.cmbDept.getValue(),"","");$.cmbEmp.clear();$.cmbEmp.setColumn("employee_id","emp_name");setComboBind([$.cmbEmp],ds);$.cmbEmp.setValue(g_main.session.getValue("UserID"));$.memContent.setValue("");$.memContent2.setValue("");$.memContent3.setValue("");$.edtTime.setValue("");$.edtTime2.setValue("");$.executive_id="";enableSaveButton()}else{if(btnId=="btnSave"){if($.memContent.getValue()!=""&&$.edtTime.getValue()==""){MessageBoxShow("Presentation 시간을 입력해 주시기 바랍니다.");$.edtTime.setFocus();return}if($.memContent2.getValue()!=""&&$.edtTime2.getValue()==""){MessageBoxShow("Presentation 시간을 입력해 주시기 바랍니다.");$.edtTime2.setFocus();return}if($.executive_id==""){saveExecutiveMeeting("N")}else{if($.executive_id!=""){saveExecutiveMeeting("U")}}}else{if(btnId=="btnDelete"){if($.executive_id==""){MessageBoxShow("삭제할 내용이 존재하지 않습니다.")}else{confirmBoxShow("회의내용을 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveExecutiveMeeting("D")}})}}}}}else{if(panelId=="panList"){if(btnId=="btnExcelDown"){exportToExcel()}else{if(btnId=="btnPrint"){printReport()}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>