<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panInfo=null;$.panList=null;$.panBottom=null;$.lblCPNo=null;$.lblEmp=null;$.lblPM=null;$.lblProduct=null;$.lblCPDate=null;$.lblPlace=null;$.lblTheme=null;$.lblContact=null;$.lblContactCnt=null;$.lblCompany=null;$.lblSupport=null;$.lblSupportAmt=null;$.lblGiftBuy=null;$.lblTarget=null;$.lblLectYn=null;$.lblReportDate=null;$.lblAcademy=null;$.txtCPNo=null;$.cmbEmp=null;$.cmbPM=null;$.cmbProduct=null;$.dteStart=null;$.dteEnd=null;$.txtPlace=null;$.cmbTheme=null;$.speContact=null;$.speCompany=null;$.speSupport=null;$.cmbGiftBuy=null;$.memTarget=null;$.chkAreaModified=null;$.chkDateModified=null;$.rdoLectYn=null;$.dteReport=null;$.rdoAcademy=null;$.cmbStatus=null;$.lblCompanyCnt=null;$.lblWave=null;$.lblLabel1=null;$.lblLabel2=null;$.lblLabel3=null;$.lblLabel4=null;$.grdList=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.btnLimitFree=null;$.btnAreaMod=null;$.btnDateMod=null;$.btnReportYN=null;$.btnSeminarCancel=null;$.memMemo=null;$.chkReportYn=null;$.btnMAConfirm=null;$.btnMACancel=null;$.rdoPrivateRoomYN=null;$.lblPrivateRoomYN=null;$.lblLabel5=null;$.lblAgencyYN=null;$.rdoAgencyYN=null;$.lblTeamLeader=null;$.comTeamLeader=null;$.varCPId="";$.varCPCode="";$.varWFDocId="";$.varCPDocNo="";$.varModify="";$.varLeaderId="";$.varPopupNo=true;function createJSON_S(workType){var aRow=$.grdList.getAllRows();var contactId="",companyId="",supportDesc="",supportAmt="",cpFoodYn="",cpGiftYn="",cpStayYn="",cpTransYn="",cpLectureYn="";for(var i in aRow){contactId+=(contactId?"|":"")+aRow[i].contact_id;companyId+=(companyId?"|":"")+aRow[i].company_id;supportDesc+=(supportDesc?"|":"")+aRow[i].support_desc||"|";supportAmt+=(supportAmt?"|":"")+aRow[i].support_amt;cpFoodYn+=(cpFoodYn?"|":"")+(aRow[i].cp_food_yn=="Y"||aRow[i].cp_food_yn==true?"Y":"N");cpGiftYn+=(cpGiftYn?"|":"")+(aRow[i].cp_gift_yn=="Y"||aRow[i].cp_gift_yn==true?"Y":"N");cpStayYn+=(cpStayYn?"|":"")+(aRow[i].cp_stay_yn=="Y"||aRow[i].cp_stay_yn==true?"Y":"N");cpTransYn+=(cpTransYn?"|":"")+(aRow[i].cp_trans_yn=="Y"||aRow[i].cp_trans_yn==true?"Y":"N");cpLectureYn+=(cpLectureYn?"|":"")+(aRow[i].cp_lecture_yn=="Y"||aRow[i].cp_lecture_yn==true?"Y":"N")}var json=createExecuteParamInfo("P_crmCPSeminarBefore_S",[workType,$.varCPId,$.varCPDocNo,"#DeptCode#",$.cmbEmp.getValue(),$.cmbPM.getValue(),$.comTeamLeader.getValue(),$.dteStart.getValue(),$.dteEnd.getValue(),$.txtPlace.getValue(),$.speContact.getValue(),$.speCompany.getValue(),$.speSupport.getValue(),$.dteReport.getValue(),$.memTarget.getValue(),$.cmbProduct.getValue(),$.rdoAcademy.getValue(),$.cmbTheme.getValue(),"CP01",$.varWFDocId,"#UserID#",$.rdoLectYn.getValue(),$.cmbGiftBuy.getValue(),$.rdoPrivateRoomYN.getValue(),$.rdoAgencyYN.getValue(),"Y",contactId,companyId,supportDesc||"",supportAmt||0,cpFoodYn,cpGiftYn,cpStayYn,cpTransYn,cpLectureYn]);return json}function createJSON_S2(workType){var chkValue="";if(workType=="REPORT"||workType=="REPORT"){chkValue=$.chkReportYn.getValue()}else{if(workType=="DATE"){chkValue=$.chkDateModified.getValue()}else{if(workType=="AREA"){chkValue=$.chkAreaModified.getValue()}else{if(workType=="LimitFree"){chkValue=""}}}}log(chkValue);var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.varCPId,chkValue,"#UserID#"]);return json}function saveSeminarBefore(workType){if(workType=="N1"||workType=="N2"||workType=="U1"||workType=="U2"||workType=="NT"||workType=="UT"){if($.grdList.getRowCount()<=0){MessageBoxShow("참석자가 없습니다.");return}for(var i=0;i<$.grdList.getRowCount();i++){for(var j=i+1;j<$.grdList.getRowCount();j++){if($.grdList.getValue(i,"contact_id")==$.grdList.getValue(j,"contact_id")){MessageBoxShow("중복입력 된 고객이 있습니다. 확인하시기 바랍니다.");return}}if($.grdList.getValue(i,"cp_food_yn")=="N"&&$.grdList.getValue(i,"cp_trans_yn")=="N"&&Number($.grdList.getValue(i,"support_amt"))>0){MessageBoxShow("지원항목 - 식음료, 교통비 중 하나는 선택되어야 합니다.");return}}}var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);if(ds){if(workType=="N1"||workType=="N2"||workType=="NT"){var rStr=ds.returnStr.split("|");$.varCPId=rStr[0];$.varCPDocNo=rStr[1];$.txtCPNo.setValue(rStr[0]);MessageBoxShow("정상적으로 등록되었습니다.");return}else{if(workType=="D"){MessageBoxShow("정상적으로 삭제되었습니다.");$.varCPId="";$.varCPCode="";clearInfo()}else{if(workType=="DOC"){if(ds.resultList[0].length>0){MessageBoxShow("중복된 문서번호가 있습니다.");return false}else{return true}}else{if(workType=="U1"||workType=="U2"||workType=="UT"){MessageBoxShow("정상적으로 저장되었습니다.");return}}}}}}}function saveExtraFunction(workType){var json=createJSON_S2(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);log("---");log(ds);if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0004"){MessageBoxShow("정상적으로 저장되었습니다.")}}}}}function setControlEnable(bo){if(bo){$.panList.enableButton(["btnNew","btnDelete","btnSave"])}else{$.panList.disableButton(["btnNew","btnDelete","btnSave"])}$.cmbEmp.setEnable(bo);$.cmbPM.setEnable(bo);$.cmbProduct.setEnable(bo);$.dteStart.setEnable(bo);$.dteEnd.setEnable(bo);$.txtPlace.setReadOnly(!bo);$.cmbTheme.setEnable(bo);$.memTarget.setReadOnly(!bo);$.speContact.setReadOnly(!bo);$.speCompany.setReadOnly(!bo);$.speSupport.setReadOnly(!bo);$.cmbGiftBuy.setEnable(bo);$.dteReport.setEnable(bo);$.cmbStatus.setEnable(bo);$.rdoPrivateRoomYN.setEnable(bo);$.rdoAgencyYN.setEnable(bo);$.rdoAcademy.setEnable(bo);$.rdoLectYn.setEnable(bo);$.txtCPNo.setReadOnly(true);$.cmbEmp.setEnable(false);$.comTeamLeader.setEnable(false);$.dteReport.setEnable(false);$.cmbStatus.setEnable(false);$.speSupport.setEnable(false)}function setAllowBlank(){$.cmbEmp.setAllowBlank(false,"담당자");$.cmbProduct.setAllowBlank(false,"품목");$.dteStart.setAllowBlank(false,"계최시작일");$.dteEnd.setAllowBlank(false,"계최종료일");$.txtPlace.setAllowBlank(false,"개최지 및 주소");$.cmbTheme.setAllowBlank(false,"설명회테마");$.memTarget.setAllowBlank(false,"개최목적");$.speContact.setAllowBlank(false,"참가 인원수");$.speCompany.setAllowBlank(false,"참가 기관수");$.cmbGiftBuy.setAllowBlank(false,"기념품구매");$.dteReport.setAllowBlank(false,"등록일자");$.cmbStatus.setAllowBlank(false,"승인상태");$.rdoPrivateRoomYN.setAllowBlank(false,"단독룸 유무");$.rdoAgencyYN.setAllowBlank(false,"대행사 유무");$.comTeamLeader.setAllowBlank(false,"팀/소장")}function clearInfo(){$.panInfo.clear();$.varCPId="";$.grdList.setData("");$.chkAreaModified.setVisible(false);$.chkDateModified.setVisible(false);setControlEnable(true);setAllowBlank();$.comTeamLeader.setValue($.varLeaderId);$.cmbEmp.setValue(g_main.session.obj.UserID);$.dteReport.setValue(getToday(""));if(g_main.session.obj.SalesEmpYN=="Y"){$.cmbStatus.setValue("05")}else{$.cmbStatus.setValue("10")}$.rdoAgencyYN.setValue("N");$.rdoAcademy.setValue("N");$.rdoLectYn.setValue("N");if(g_main.session.obj.SalesEmpYN=="Y"){$.rdoAgencyYN.setEnable(false)}$.cmbGiftBuy.setValue("90");$.rdoPrivateRoomYN.setValue("Y")}function calcSupportAmt(){var aRow=$.grdList.getAllRows();var sum=0;for(var i in aRow){sum+=Number(aRow[i].support_amt)}$.speSupport.setValue(sum)}function calcContactCount(){var cnt=$.grdList.getAllRows().length;$.speContact.setValue(cnt)}function calc_date(start,end){if(!start||!end||start.length!=8||end.length!=8){return}var dt1=new Date(start.substr(0,4),(start.substr(4,2)-1),start.substr(6,2));var dt2=new Date(end.substr(0,4),(end.substr(4,2)-1),end.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);return btDay}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,780);$.panMain.setText("");$.panMain.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,0,1200,350);$.panInfo.setText("자사제품설명회 - 사전");$.panInfo.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,360,1200,300);$.panList.setText("자사제품설명회 참석자 - 사전");$.panList.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,670,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.lblCPNo=new FingerLabel(host,"lblCPNo",0,10,100,20);$.lblCPNo.setText("CP번호");$.lblEmp=new FingerLabel(host,"lblEmp",350,10,100,20);$.lblEmp.setText("담당자");$.lblPM=new FingerLabel(host,"lblPM",810,10,100,20);$.lblPM.setText("PM");$.lblProduct=new FingerLabel(host,"lblProduct",810,40,100,20);$.lblProduct.setText("품목");$.lblCPDate=new FingerLabel(host,"lblCPDate",0,40,100,20);$.lblCPDate.setText("개최일시");$.lblPlace=new FingerLabel(host,"lblPlace",350,40,100,20);$.lblPlace.setText("개최지 및 주소");$.lblTheme=new FingerLabel(host,"lblTheme",810,70,100,20);$.lblTheme.setText("설명회테마");$.lblContact=new FingerLabel(host,"lblContact",0,70,100,20);$.lblContact.setText("참가인원");$.lblContactCnt=new FingerLabel(host,"lblContactCnt",200,70,20,20);$.lblContactCnt.setText("명");$.lblCompany=new FingerLabel(host,"lblCompany",350,70,100,20);$.lblCompany.setText("참가기관");$.lblSupport=new FingerLabel(host,"lblSupport",595,70,100,20);$.lblSupport.setText("지원총액");$.lblSupportAmt=new FingerLabel(host,"lblSupportAmt",795,70,20,20);$.lblSupportAmt.setText("원");$.lblGiftBuy=new FingerLabel(host,"lblGiftBuy",810,100,100,20);$.lblGiftBuy.setText("기념품구매");$.lblTarget=new FingerLabel(host,"lblTarget",0,100,100,20);$.lblTarget.setText("개최목적");$.lblLectYn=new FingerLabel(host,"lblLectYn",595,130,100,20);$.lblLectYn.setText("HCP강연유무");$.lblReportDate=new FingerLabel(host,"lblReportDate",810,130,100,20);$.lblReportDate.setText("등록일자");$.lblAcademy=new FingerLabel(host,"lblAcademy",0,200,170,20);$.lblAcademy.setText("해당 기간 관련학회(모임 등)");$.txtCPNo=new FingerEdit(host,"txtCPNo",105,10,220,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",455,10,110,20);$.cmbPM=new FingerComboBox(host,"cmbPM",910,10,110,20);$.cmbProduct=new FingerComboBox(host,"cmbProduct",910,40,140,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,40,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",230,40,100,20);$.txtPlace=new FingerEdit(host,"txtPlace",455,40,355,20);$.cmbTheme=new FingerComboBox(host,"cmbTheme",910,70,270,20);$.speContact=new FingerSpinEdit(host,"speContact",105,70,100,20);$.speCompany=new FingerSpinEdit(host,"speCompany",455,70,110,20);$.speSupport=new FingerSpinEdit(host,"speSupport",700,70,100,20);$.cmbGiftBuy=new FingerComboBox(host,"cmbGiftBuy",910,100,140,20);$.memTarget=new FingerMemoEdit(host,"memTarget",105,100,470,80);$.chkAreaModified=new FingerCheckBox(host,"chkAreaModified",620,160,140,20);$.chkAreaModified.setText("개최지변경");$.chkDateModified=new FingerCheckBox(host,"chkDateModified",780,160,140,20);$.chkDateModified.setText("개최일자변경");$.rdoLectYn=new FingerRadioBox(host,"rdoLectYn",700,130,140,20);$.dteReport=new FingerDateEdit(host,"dteReport",910,130,140,20);$.rdoAcademy=new FingerRadioBox(host,"rdoAcademy",175,200,140,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",1040,260,140,20);$.lblCompanyCnt=new FingerLabel(host,"lblCompanyCnt",560,70,40,20);$.lblCompanyCnt.setText("기관");$.lblWave=new FingerLabel(host,"lblWave",205,40,20,20);$.lblWave.setText("~");$.lblLabel1=new FingerLabel(host,"lblLabel1",310,200,720,20);$.lblLabel1.setText("*약사법 및 공경규에 따라 학술대회 개최기간 중 개최되거나 보건의료전문가 모임을 지원하기 위한 제품설명회는 진행이 불가합니다.");$.lblLabel2=new FingerLabel(host,"lblLabel2",10,260,430,20);$.lblLabel2.setText("* 자사제품설명회 개최 10일전까지 신청서를 제출하여 주시기 바랍니다.");$.lblLabel3=new FingerLabel(host,"lblLabel3",450,260,230,20);$.lblLabel3.setText("현재 개최일로부터 0일 전입니다.");$.lblLabel4=new FingerLabel(host,"lblLabel4",720,260,260,20);$.lblLabel4.setText("등록일시 : ");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,250);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,45);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,55,120,45);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",775,5,120,45);$.btnMemoSave.setText("메모저장");$.btnLimitFree=new FingerButton(host,"btnLimitFree",775,55,120,45);$.btnLimitFree.setText("기한해제");$.btnAreaMod=new FingerButton(host,"btnAreaMod",880,5,120,45);$.btnAreaMod.setText("개최지변경");$.btnDateMod=new FingerButton(host,"btnDateMod",880,55,120,45);$.btnDateMod.setText("개최일자변경");$.btnReportYN=new FingerButton(host,"btnReportYN",990,5,120,25);$.btnReportYN.setText("신고상태저장");$.btnSeminarCancel=new FingerButton(host,"btnSeminarCancel",990,75,120,25);$.btnSeminarCancel.setText("개최취소");$.memMemo=new FingerMemoEdit(host,"memMemo",115,675,650,90);$.chkReportYn=new FingerCheckBox(host,"chkReportYn",990,40,105,25);$.chkReportYn.setText("협회신고");$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1100,5,120,45);$.btnMAConfirm.setText("MA승인");$.btnMACancel=new FingerButton(host,"btnMACancel",1100,55,120,45);$.btnMACancel.setText("MA승인취소");$.rdoPrivateRoomYN=new FingerRadioBox(host,"rdoPrivateRoomYN",175,230,140,20);$.lblPrivateRoomYN=new FingerLabel(host,"lblPrivateRoomYN",0,230,170,20);$.lblPrivateRoomYN.setText("개최지 내 단독룸 유무");$.lblLabel5=new FingerLabel(host,"lblLabel5",290,230,510,20);$.lblLabel5.setText("*해당 자사제품설명회에 참석하는 인원만 접근 가능한 독립 된 공간에서 진행되어야 합니다.");$.lblAgencyYN=new FingerLabel(host,"lblAgencyYN",595,100,100,20);$.lblAgencyYN.setText("대행사 유무");$.rdoAgencyYN=new FingerRadioBox(host,"rdoAgencyYN",700,100,135,20);$.lblTeamLeader=new FingerLabel(host,"lblTeamLeader",595,10,100,20);$.lblTeamLeader.setText("팀/소장");$.comTeamLeader=new FingerComboBox(host,"comTeamLeader",700,10,115,20);$.panInfo.addButtons(["btnDelete","btnTemp","btnSave","btnNew"]);$.panList.addButtons(["btnDelete","btnAdd"]);$.rdoLectYn.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoAcademy.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoPrivateRoomYN.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoAgencyYN.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.lblLabel1.setAlign("left");$.lblLabel2.setAlign("left");$.lblLabel3.setAlign("left");$.lblLabel4.setAlign("left");$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);$.grdList.setColumns([new FingerDataGridColumn("contact_id",99,"left","string","참석자ID",{readonly:true}),new FingerDataGridColumn("contact_name",100,"left","string","참석자",{readonly:true}),new FingerDataGridColumn("company_id",99,"left","string","소속ID",{readonly:true}),new FingerDataGridColumn("company_name",450,"left","string","소속",{readonly:true}),new FingerDataGridColumn("cp_food_yn",100,"center","checkbox","식음료"),new FingerDataGridColumn("cp_gift_yn",100,"center","checkbox","기념품",{readonly:true}),new FingerDataGridColumn("cp_stay_yn",100,"center","checkbox","숙박비",{hidden:true}),new FingerDataGridColumn("cp_trans_yn",100,"center","checkbox","교통비"),new FingerDataGridColumn("cp_lecture_yn",99,"center","checkbox","강연비",{hidden:true}),new FingerDataGridColumn("support_desc",99,"left","string","지원내역",{hidden:true}),new FingerDataGridColumn("support_amt",120,"right","string","지원금액",{format:"int"})]);$.grdList.init({panel:$.panList,isFilter:false});$.grdList.setEditable(true);$.grdList.setBorder(false);$.cmbTheme.setColumnConfig([{id:"theme_id",width:60},{id:"call_message",width:500},{id:"use_yn",width:30}]);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panInfo);$.panMain.add($.panList);$.panMain.add($.panBottom);$.panMain.add($.memMemo);$.panInfo.add($.lblCPNo);$.panInfo.add($.lblEmp);$.panInfo.add($.lblPM);$.panInfo.add($.lblProduct);$.panInfo.add($.lblCPDate);$.panInfo.add($.lblPlace);$.panInfo.add($.lblTheme);$.panInfo.add($.lblContact);$.panInfo.add($.lblContactCnt);$.panInfo.add($.lblCompany);$.panInfo.add($.lblSupport);$.panInfo.add($.lblSupportAmt);$.panInfo.add($.lblGiftBuy);$.panInfo.add($.lblTarget);$.panInfo.add($.lblLectYn);$.panInfo.add($.lblReportDate);$.panInfo.add($.lblAcademy);$.panInfo.add($.txtCPNo);$.panInfo.add($.cmbEmp);$.panInfo.add($.cmbPM);$.panInfo.add($.cmbProduct);$.panInfo.add($.dteStart);$.panInfo.add($.dteEnd);$.panInfo.add($.txtPlace);$.panInfo.add($.cmbTheme);$.panInfo.add($.speContact);$.panInfo.add($.speCompany);$.panInfo.add($.speSupport);$.panInfo.add($.cmbGiftBuy);$.panInfo.add($.memTarget);$.panInfo.add($.chkAreaModified);$.panInfo.add($.chkDateModified);$.panInfo.add($.rdoLectYn);$.panInfo.add($.dteReport);$.panInfo.add($.rdoAcademy);$.panInfo.add($.cmbStatus);$.panInfo.add($.lblCompanyCnt);$.panInfo.add($.lblWave);$.panInfo.add($.lblLabel1);$.panInfo.add($.lblLabel2);$.panInfo.add($.lblLabel3);$.panInfo.add($.lblLabel4);$.panInfo.add($.rdoPrivateRoomYN);$.panInfo.add($.lblPrivateRoomYN);$.panInfo.add($.lblLabel5);$.panInfo.add($.lblAgencyYN);$.panInfo.add($.rdoAgencyYN);$.panInfo.add($.lblTeamLeader);$.panInfo.add($.comTeamLeader);$.panList.add($.grdList);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnLimitFree);$.panBottom.add($.btnAreaMod);$.panBottom.add($.btnDateMod);$.panBottom.add($.btnReportYN);$.panBottom.add($.btnSeminarCancel);$.panBottom.add($.chkReportYn);$.panBottom.add($.btnMAConfirm);$.panBottom.add($.btnMACancel);relocateChildIndexInPanel([$.panInfo]);$.cmbEmp.setEmptyRow(true);$.cmbPM.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbProduct.setEmptyRow(true);$.cmbTheme.setEmptyRow(true);$.cmbEmp.setColumn("employee_id","emp_name");$.cmbPM.setColumn("employee_id","emp_name");$.cmbProduct.setColumn("product_code","product_name");$.cmbTheme.setColumn("theme_id","call_message");$.comTeamLeader.setColumn("line1empno","line1empname");var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM192|L_CRM0111|L_CRM0131|L_CRM0258");setComboBind([$.cmbEmp,$.cmbPM,$.cmbStatus,$.cmbProduct,$.cmbGiftBuy],ds);if(g_main.session.obj.UserID!="AKR-A00001"){var ds=bizComponentData2($,"Q3","L_CRM0108","","",g_main.session.obj.UserID);setComboBind([$.comTeamLeader],ds);$.varLeaderId=ds.resultList[0][0].line1empno}else{var ds=bizComponentData2($,"Q3","L_CRM0108","","","ka070051");setComboBind([$.comTeamLeader],ds);$.varLeaderId=ds.resultList[0][0].line1empno}clearInfo();$.panBottom.setVisible(false);$.memMemo.setReadOnly(true);if($.p_argument&&$.p_argument.length>0){var day=$.p_argument[0][0].create_time.day;$.varPopupNo=false;convertJavaDateToJs($.p_argument);var rs=$.p_argument[0][0];$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnLimitFree.setVisible(false);$.btnMemoSave.setVisible(false);$.btnAreaMod.setVisible(false);$.btnDateMod.setVisible(false);$.btnReportYN.setVisible(false);$.btnSeminarCancel.setVisible(false);$.chkReportYn.setVisible(false);var ds=bizComponentData2($,"Q3","L_CRM0108");setComboBind([$.comTeamLeader],ds);$.varCPId=rs.cp_id;$.varCPDocNo=rs.cp_doc_no;$.varPopupType="Y";$.varCPCode=rs.cp_code;$.varWFDocId=rs.wf_doc_id;$.varModify=rs.modify_yn;$.txtCPNo.setValue(rs.cp_id);$.cmbEmp.setValue(rs.cp_emp_id);$.comTeamLeader.setValue(rs.cp_team_leader);$.cmbPM.setValue(rs.cp_emp_pm);$.cmbStatus.setValue(rs.cp_status);$.cmbProduct.setValue(rs.product_code);if(rs.report_theme!=""){var ds=bizComponentData2($,"Q3","L_CRM0259","detail",rs.product_code);setComboBind([$.cmbTheme],ds);$.cmbTheme.setValue(rs.report_theme)}if(rs.Confirm){$.panBottom.setVisible(true);setControlEnable(true);$.memMemo.setReadOnly(false);$.chkAreaModified.setVisible(true);$.chkDateModified.setVisible(true);$.btnConfirm.setVisible(true);$.btnCancel.setVisible(true);$.btnLimitFree.setVisible(true);$.btnMemoSave.setVisible(true);$.btnAreaMod.setVisible(true);$.btnDateMod.setVisible(true);$.btnReportYN.setVisible(true);$.btnSeminarCancel.setVisible(true);$.chkReportYn.setVisible(true)}else{$.panBottom.setVisible(false);setControlEnable(false)}if(rs.save_yn!="Y"){setControlEnable(false);$.panInfo.disableButton(["btnSave","btnDelete","btnTemp"]);$.panList.disableButton(["btnAdd","btnDelete"])}else{if(g_main.session.obj.SalesEmpYN=="Y"&&rs.cp_status=="10"){setControlEnable(false);$.panInfo.disableButton(["btnSave","btnDelete","btnTemp"]);$.panList.disableButton(["btnAdd","btnDelete"])}else{setControlEnable(true)}}$.dteStart.setValue(rs.cp_start_date);$.dteEnd.setValue(rs.cp_end_date);$.txtPlace.setValue(rs.cp_place);$.speContact.setValue(rs.contact_cnt);$.speCompany.setValue(rs.company_cnt);$.speSupport.setValue(rs.support_total);$.cmbGiftBuy.setValue(rs.gift_buy);$.memTarget.setValue(rs.open_target);$.rdoLectYn.setValue(rs.lect_yn);$.dteReport.setValue(rs.report_date);$.rdoAcademy.setValue(rs.academy_yn);$.rdoPrivateRoomYN.setValue(rs.private_room_yn);$.rdoAgencyYN.setValue(rs.agency_yn);$.chkAreaModified.setValue(rs.area_modify_yn);$.chkDateModified.setValue(rs.date_modify_yn);$.memMemo.setValue(rs.cp_descr);$.chkReportYn.setValue(rs.report_yn);$.lblLabel4.setText("등록일시 : "+extFormat(rs.create_time,"yyyyMMddHHmm")+(day==0?"일":day==6?"토":""));$.lblLabel3.setText("현재 개최일로부터 "+getCompareDate(getToday(""),$.dteStart.getValue())+"일 전입니다.");if(rs.cp_status=="05"&&g_main.session.obj.UserID==$.comTeamLeader.getValue()){$.panBottom.setVisible(true);$.btnConfirm.setEnable(true);$.btnConfirm.setVisible(true)}else{if(rs.cp_status=="10"){if(g_main.session.obj.UserID==$.comTeamLeader.getValue()){$.panBottom.setVisible(true);$.btnCancel.setVisible(true);$.btnCancel.setEnable(true)}else{$.btnConfirm.setEnable(true)}}else{if(rs.cp_status=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panInfo.disableButton(["btnTemp"]);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}}if($.p_argument[1].length>0){setDataGrid([$.grdList],$.p_argument[1],true)}if(rs.CallType=="BUCall"){$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnMemoSave.setVisible(false);$.btnLimitFree.setVisible(false);$.btnAreaMod.setVisible(false);$.btnDateMod.setVisible(false);$.btnReportYN.setVisible(false);$.btnSeminarCancel.setVisible(false);$.chkReportYn.setVisible(false)}}else{$.comTeamLeader.setValue($.varLeaderId);$.memMemo.setVisible(false)}log(g_main.session.obj.SalesEmpYN)};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){if($.cmbStatus.getValue()=="05"){var share={save_mode:"CPCONFIRM",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if($.cmbStatus.getValue()=="10"){var share={save_mode:"CONFIRM",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}else{if(id=="btnCancel"){if($.cmbStatus.getValue()=="10"){var share={save_mode:"CANCEL",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if($.cmbStatus.getValue()=="90"){var share={save_mode:"CPCANCEL",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnLimitFree"){confirmBoxShow("입력 기한을 해제하시겠습니까?",function(){if(g_main.msgShare==true){if(saveExtraFunction("LimitFree")){MessageBoxShow("해제되었습니다.")}}})}else{if(id=="btnAreaMod"){saveExtraFunction("AREA")}else{if(id=="btnDateMod"){saveExtraFunction("DATE")}else{if(id=="btnReportYN"){saveExtraFunction("REPORT")}else{if(id=="btnSeminarCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveExtraFunction("CANCEL")}})}else{if(id=="btnMAConfirm"){var share={save_mode:"MACONFIRM",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMACancel"){var share={save_mode:"MACANCEL",cp_descr:$.memMemo.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbProduct"){$.cmbTheme.clear();if(value==""){return}var subQuery=" where theme_type = 'detail' and product_code ='"+$.cmbProduct.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0259",subQuery);setComboBind([$.cmbTheme],ds)}else{if(id=="cmbTheme"){if($.cmbTheme.getValue("use_yn")=="N"&&$.varPopupNo){MessageBoxShow("사용 중지 된 테마가 선택되었습니다.");$.cmbTheme.setValue("");return}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStart"){var endDay=$.dteStart.getValue();var tsDays=endDay;var dt1=new Date(getToday("").substr(0,4),(getToday("").substr(4,2)-1),getToday("").substr(6,2));var dt2=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);$.lblLabel3.setText("현재 개최일로부터 "+btDay+"일 전입니다.")}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="support_amt"){calcSupportAmt()}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){clearInfo()}else{if(btnId=="btnSave"){if(!validateControls([$.cmbEmp,$.cmbProduct,$.dteStart,$.dteEnd,$.comTeamLeader,$.txtPlace,$.cmbTheme,$.speContact,$.speCompany,$.speSupport,$.cmbGiftBuy,$.memTarget,$.dteReport,$.cmbStatus,$.rdoPrivateRoomYN,$.rdoAgencyYN,$.rdoLectYn,$.rdoAcademy])){return}if($.speCompany.getValue()<=0){MessageBoxShow("참가기관의 수를 정확히 입력하시기 바랍니다.");return}if($.speSupport.getValue()<=0){MessageBoxShow("지원금액이 올바르게 입력되지 않았습니다.");return}if($.varModify=="Y"){if(g_main.session.obj.SalesEmpYN=="Y"){saveSeminarBefore($.varCPId==""?"N1":"U1")}else{if(g_main.session.obj.SalesEmpYN=="N"){if(g_main.session.obj.DeptCode=="J120"){saveSeminarBefore($.varCPId==""?"N1":"U1")}else{saveSeminarBefore($.varCPId==""?"N2":"U2")}}}}else{var dt1=getToday("");var dt2=$.dteStart.getValue();var dt3=$.dteEnd.getValue();var dt4=calc_date(dt1,dt2);var dt5=calc_date(dt2,dt3);log(dt4);if(dt5<0){MessageBoxShow("지원기간을 올바르게 설정하시기 바랍니다.");return}if(dt4<10){MessageBoxShow("지원개시일로부터 10일 이전까지만 신청가능합니다.");return}if(g_main.session.obj.SalesEmpYN=="Y"){saveSeminarBefore($.varCPId==""?"N1":"U1")}else{if(g_main.session.obj.SalesEmpYN=="N"){if(g_main.session.obj.DeptCode=="J120"){saveSeminarBefore($.varCPId==""?"N1":"U1")}else{saveSeminarBefore($.varCPId==""?"N2":"U2")}}}}}else{if(btnId=="btnTemp"){if(!validateControls([$.cmbEmp,$.cmbProduct,$.dteStart,$.dteEnd,$.comTeamLeader,$.txtPlace,$.cmbTheme,$.speContact,$.speCompany,$.speSupport,$.cmbGiftBuy,$.memTarget,$.dteReport,$.cmbStatus,$.rdoPrivateRoomYN,$.rdoAgencyYN,$.rdoLectYn,$.rdoAcademy])){return}var dt1=getToday("");var dt2=$.dteStart.getValue();var dt3=$.dteEnd.getValue();var dt4=calc_date(dt1,dt2);var dt5=calc_date(dt2,dt3);log(dt4);if(dt5<0){MessageBoxShow("지원기간을 올바르게 설정하시기 바랍니다.");return}if(dt4<10){MessageBoxShow("지원개시일로부터 30일 이내에만 신청가능합니다.");return}saveSeminarBefore($.varCPId==""?"NT":"UT")}else{if(btnId=="btnDelete"){if($.varCPId==""){return}confirmBoxShow("["+$.txtCPNo.getValue()+"] 자사제품설명회 사전을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveSeminarBefore("D")}})}}}}}else{if(panelId=="panList"){if(btnId=="btnAdd"){$.popUpCallId="btnAdd";var param={contact_name:"",check_yn:"Y"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){$.grdList.deleteCurrentRow();calcSupportAmt();calcContactCount()}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="btnAdd"){var popRows=popResult.popRows;if($.grdList.getRowCount()>0){var aRow=$.grdList.getAllRows();for(var i in aRow){for(var j in popRows){if(aRow[i].contact_id==popRows[j].contact_id){MessageBoxShow("해당 참석자는 이미 추가되어 있습니다.");return}}}}for(var i in popRows){if(popRows[i].contact_id.substr(0,2)=="ka"){MessageBoxShow("자사직원 등록은 자사제품설명회(사후)에서만 가능합니다.");continue}$.grdList.addRow({contact_id:popRows[i].contact_id,contact_name:popRows[i].contact_name,company_id:popRows[i].company_id,company_name:popRows[i].company_name,cp_food_yn:"N",cp_gift_yn:"N",cp_stay_yn:"N",cp_trans_yn:"N",cp_lecture_yn:"N",support_desc:"",support_amt:0})}calcContactCount()}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>