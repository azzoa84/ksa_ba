<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.lblYyyymm=null;$.dteYyyymm=null;$.lblEmployee=null;$.bteEmployee=null;$.btnSearch=null;$.panWorkInfo=null;$.htmlWorkTime=null;$.htmlWorkExtend=null;$.panList=null;$.grdList=null;$.btnSave=null;$.btnSettings=null;$.htmlWorkApprovalTime=null;$.htmlHelpMsg=null;$.session=g_main.session.obj;$.varEmployeeId="";$.varDeptCode="";$.varRowId="";$.varAddWorkTime=4;$.varWorkingDay=0;$.stdNightTime="2200";$.varNowJucha="";$.varWorkTimeData={prescribedWorkingHour:0,realWorkingHour:0};$.varWorkExtend={weekWorkTime:0,groupTotal:0,total:0,holidayTime:0,nightWorkTime:0};$.varWorkApprovalTime={weekWorkTime:0,groupTotal:0,total:0,holidayTime:0,nightWorkTime:0};$.varFirst=true;$.varIsSave=false;$.varHtmlWorkTime='<table class="report-wk-tbl"> 						<colgroup> 							<col style="width:80px;"> 							<col style="width:60px;"> 							<col style="width:80px;"> 							<col style="width:60px;"> 						</colgroup> 						<tr> 							<th colspan="4" class="wk-header">#date#</th>						</tr> 						<tr> 							<th class="wk-title">총 근로시간</th>							<td class="wk-detail">#prescribedWorkingHour#</td>							<th class="wk-title">실 근무시간<br>합계</th>							<td class="wk-detail">#realWorkingHour#</td>						</tr> 					</table>';$.varHtmlWorkExtend='<table class="report-we-tbl"> 						<colgroup> 							<col style="width:30px;"> 							<col style="width:70px;"> 							<col style="width:30px;"> 							<col style="width:30px;"> 							<col style="width:40px;"> 						</colgroup> 						<tr> 							<th colspan="3" class="we-header1">연장/야간 실근무시간</th>							<th colspan="2" class="we-header1">Total</th>						</tr> 						<tr> 							<th rowspan="2" class="we-title">연장</th> 							<td class="we-detail" style="text-align: left;">　평일</td> 							<td class="we-detail">#weekWorkTime#</td> 							<td rowspan="2" class="we-detail">#groupTotal#</td> 							<td rowspan="3" class="we-focus">#total#</td> 						</tr> 						<tr> 							<td class="we-detail" style="text-align: left;">　휴일(이동시간)</td> 							<td class="we-detail">#holidayTime#</td> 						</tr> 						<tr> 							<th colspan="3" class="we-title" style="text-align: left;">　야간</th> 							<td class="we-detail">#nightWorkTime#</td> 						</tr> 					</table>';$.varHtmlWorkApprovalTime='<table class="report-we-tbl"> 								<colgroup> 									<col style="width:30px;"> 									<col style="width:70px;"> 									<col style="width:30px;"> 									<col style="width:30px;"> 									<col style="width:40px;"> 								</colgroup> 								<tr> 									<th colspan="3" class="we-header2">연장/야간 계획승인시간</th>									<th colspan="2" class="we-header2">Total</th>								</tr> 								<tr> 									<th rowspan="2" class="we-title">연장</th> 									<td class="we-detail" style="text-align: left;">　평일</td> 									<td class="we-detail">#weekWorkTime#</td> 									<td rowspan="2" class="we-detail">#groupTotal#</td> 									<td rowspan="3" class="we-focus">#total#</td> 								</tr> 								<tr> 									<td class="we-detail" style="text-align: left;">　휴일(이동시간)</td> 									<td class="we-detail">#holidayTime#</td> 								</tr> 								<tr> 									<th colspan="3" class="we-title" style="text-align: left;">　야간</th> 									<td class="we-detail">#nightWorkTime#</td> 								</tr> 							</table>';function initView(){$.dteYyyymm.setValue(getToday());$.bteEmployee.setText($.session.EmpName);$.varEmployeeId=$.session.UserID;$.varDeptCode=$.session.DeptCode;initData();setWorkInfo()}function initData(){$.varNowJucha=0;$.varWorkingDay=0;$.varWorkTimeData={prescribedWorkingHour:0,realWorkingHour:0};$.varWorkExtend={weekWorkTime:0,groupTotal:0,total:0,holidayTime:0,nightWorkTime:0};$.varWorkApprovalTime={weekWorkTime:0,groupTotal:0,total:0,holidayTime:0,nightWorkTime:0};var ds=bizComponentData2($,"Q1","L_HRT011");$.grdList.setColumnDropDownList("gubun",ds.resultList[0]);var str=$.dteYyyymm.getValue().substr(0,4)+"년 "+$.dteYyyymm.getValue().substr(4,2)+"월 월간업무계획서";$.grdList.setColumnText("group_title",str,0);setWorkInfo()}function setWorkInfo(){var htmlWorkTime=$.varHtmlWorkTime.replace("#prescribedWorkingHour#",$.varWorkTimeData.prescribedWorkingHour).replace("#realWorkingHour#",$.varWorkTimeData.realWorkingHour).replace("#date#",$.dteYyyymm.getValue().substr(0,4)+"년 "+$.dteYyyymm.getValue().substr(4,2)+"월");var htmlWorkExtend=$.varHtmlWorkExtend.replace("#weekWorkTime#",$.varWorkExtend.weekWorkTime).replace("#groupTotal#",$.varWorkExtend.groupTotal).replace("#total#",$.varWorkExtend.total).replace("#holidayTime#",$.varWorkExtend.holidayTime).replace("#nightWorkTime#",$.varWorkExtend.nightWorkTime);var htmlWorkApprovalTime=$.varHtmlWorkApprovalTime.replace("#weekWorkTime#",$.varWorkApprovalTime.weekWorkTime).replace("#groupTotal#",$.varWorkApprovalTime.groupTotal).replace("#total#",$.varWorkApprovalTime.total).replace("#holidayTime#",$.varWorkApprovalTime.holidayTime).replace("#nightWorkTime#",$.varWorkApprovalTime.nightWorkTime);$.htmlWorkTime.setHTML(htmlWorkTime);$.htmlWorkExtend.setHTML(htmlWorkExtend);$.htmlWorkApprovalTime.setHTML(htmlWorkApprovalTime)}function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_hrtMonthlyWorkPlan_Q",[workType,$.dteYyyymm.getValue(),$.varEmployeeId,"",$.varDeptCode]);return json}function createJSON_S(workType){var dt=$.grdList.getAllRows();var rows=[];for(var i in dt){if(dt[i].$level>1){rows.push([workType,$.dteYyyymm.getValue(),dt[i].yyyymmdd||"",dt[i].gubun||"",dt[i].work_start_time||"",dt[i].work_end_time||"",dt[i].vac_move_time||"",dt[i].ffday_yn||"",dt[i].work_desc||"",dt[i].modify_desc||"",$.varEmployeeId])}}var json=createExecuteParamInfo("HR..P_hrtMonthlyWorkPlan_S",rows);return json}function searchList(workType){if(!$.panTop.validateControls()){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveList(workType){if(!$.panTop.validateControls()){return}var json=createJSON_S(workType);callExecute(["req",json],"SAVE",$)}function sumRestnWorkTime(rId){var rowData=$.grdList.getValue(rId);if(rowData.work_start_time&&rowData.work_end_time){var totalWorkTime=calcDiffTime(rowData.work_start_time,rowData.work_end_time,rowData.gubun);var restHHMM=calcRestWorkTime(totalWorkTime);var strRestHHMM=changeHHMM(restHHMM,"");if(rowData.work_start_time<="1200"&&rowData.work_end_time>="1300"&&Number(strRestHHMM)==30){strRestHHMM="0100"}$.grdList.setValue(rId,"rest_time_sum",strRestHHMM);$.grdList.setValue(rId,"work_time_sum",calcDiffTime(strRestHHMM,totalWorkTime,""));compareWorkTime()}}function calcDiffTime(startTime,endTime,gubun,value){var str=(value?value:"");var startHH=0,startMM=0,endHH=0,endMM=0;var minus=false;if(startTime){startTime=startTime.toString();startHH=getWorkTimeHH(startTime);startMM=getWorkTimeMM(startTime)}if(endTime){endTime=endTime.toString();endHH=getWorkTimeHH(endTime);endMM=getWorkTimeMM(endTime)}var startSec=startHH*3600+startMM*60;var endSec=endHH*3600+endMM*60;var sec=0;if(startSec>endSec){sec=startSec-endSec;minus=true}else{sec=endSec-startSec}if(gubun=="WK3G"){if(startHH<12){sec+=$.varAddWorkTime*3600}else{sec+=($.varAddWorkTime+1)*3600}}return changeHHMM(sec,str,minus)}function calcRestWorkTime(totalWorkTime){var workHH=getWorkTimeHH(totalWorkTime);var restHHMM=Math.floor(Number(workHH)/4)*30*60;return restHHMM}function changeHHMM(sec,str,minus){var hours=Math.floor(sec/3600);var minutes=Math.floor((sec-(hours*3600))/60);if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}return(minus?"-":"")+(hours+str+minutes)}function changeStrHHMM(hhmm){var str="";if(hhmm){var HH=hhmm.substr(0,2);var MM=hhmm.substr(2,2);str=Number(HH)+"시간"}return str}function compareWorkTime(){var realWorkTotalSum=0,realWorkGroupSum=0,nightWorkTotalSum=0,weekGianWorkTime=0,vacGianWorkTime=0;nightGianWorkTime=0,vacExtendTime=0,vacMoveTime=0,vacGianMoveTime=0,junsaGianTime=0;var beforeJucha=1,juchaRowIndex=0,t=0;for(var i=0;i<$.grdList.getRowCount();i++){var rowData=$.grdList.getValue(i);if(beforeJucha!=rowData.jucha){var spTitle=$.grdList.getValue(juchaRowIndex,"group_title").split("(");var strTime=changeHHMM(realWorkGroupSum,"","").substr(0,2)+":"+changeHHMM(realWorkGroupSum,"","").substr(2,2);$.grdList.setValue(juchaRowIndex,"group_title",spTitle[0]+" ("+strTime+")");juchaRowIndex=i;realWorkGroupSum=0}if(rowData.$level>1){if(rowData.work_time_sum){var workTimeSum=rowData.work_time_sum;realWorkTotalSum+=Number(workTimeSum.substr(0,workTimeSum.length-2))*3600+Number(workTimeSum.substr(workTimeSum.length-2,2))*60;realWorkGroupSum+=Number(workTimeSum.substr(0,workTimeSum.length-2))*3600+Number(workTimeSum.substr(workTimeSum.length-2,2))*60;if(getWorkTimeHH(rowData.work_end_time)>=22){var diffNightTime=calcDiffTime($.stdNightTime,rowData.work_end_time);nightWorkTotalSum+=getWorkTimeHH(diffNightTime)}}if(rowData.gubun=="WK20"){t=calcRealWorkTime(rowData.work_start_time,rowData.work_end_time,"","","HH");vacExtendTime+=t;t=calcRealWorkTime("0000",rowData.vac_move_time,"","","MOVE");vacMoveTime+=t}if(rowData.week_wf_doc_id){t=calcRealWorkTime(rowData.week_start_date,rowData.week_end_date,"","","HH");weekGianWorkTime+=t}if(rowData.vac_wf_doc_id){t=calcRealWorkTime(rowData.vac_start_date,rowData.vac_end_date,"","","HH");vacGianWorkTime+=t}if(rowData.vac_move_wf_doc_id){t=calcRealWorkTime(rowData.vac_move_start_date,rowData.vac_move_end_date,"","","MOVE");vacGianMoveTime+=t}if(rowData.hol_wf_doc_id){t=calcRealWorkTime(rowData.hol_start_date,rowData.hol_end_date,"","","HH");junsaGianTime+=t}if(rowData.night_wf_doc_id){t=calcRealWorkTime(rowData.night_start_date,rowData.night_end_date,"","","HH");nightGianWorkTime+=t}}beforeJucha=rowData.jucha;if(i==$.grdList.getRowCount()-1){var spTitle=$.grdList.getValue(juchaRowIndex,"group_title").split("(");var strTime=changeHHMM(realWorkGroupSum,"","").substr(0,2)+":"+changeHHMM(realWorkGroupSum,"","").substr(2,2);$.grdList.setValue(juchaRowIndex,"group_title",spTitle[0]+" ("+strTime+")");juchaRowIndex=i;realWorkGroupSum=0}}$.varWorkTimeData.prescribedWorkingHour=$.varWorkingDay*8;var workingHour=changeHHMM(realWorkTotalSum,"");$.varWorkTimeData.realWorkingHour=getWorkTimeHH(workingHour);var total=$.varWorkTimeData.realWorkingHour-$.varWorkTimeData.prescribedWorkingHour;$.varWorkExtend.total=total;$.varWorkExtend.nightWorkTime=nightWorkTotalSum;var weekTotalWorkTime=total-nightWorkTotalSum;$.varWorkExtend.weekWorkTime=weekTotalWorkTime-vacExtendTime;$.varWorkExtend.weekWorkTime=Number($.varWorkExtend.weekWorkTime)<0?0:$.varWorkExtend.weekWorkTime;$.varWorkExtend.holidayTime=vacExtendTime+"("+vacMoveTime+")";$.varWorkExtend.groupTotal=$.varWorkExtend.weekWorkTime+vacExtendTime;$.varWorkApprovalTime.weekWorkTime=weekGianWorkTime;$.varWorkApprovalTime.holidayTime=vacGianWorkTime+"("+vacGianMoveTime+")";$.varWorkApprovalTime.groupTotal=weekGianWorkTime+vacGianWorkTime;$.varWorkApprovalTime.nightWorkTime=nightGianWorkTime;$.varWorkApprovalTime.total=weekGianWorkTime+vacGianWorkTime+nightGianWorkTime;setWorkInfo()}function calcRealWorkTime(startTime,endTime,gubun,value,type){var t=calcDiffTime(startTime,endTime,gubun,value);var restHHMM="";var realWorkTime="";if(type=="MOVE"){realWorkTime=t}else{restHHMM=calcRestWorkTime(t);realWorkTime=calcDiffTime(changeHHMM(restHHMM,""),t,"")}if(type=="HH"||type=="MOVE"){return getWorkTimeHH(realWorkTime)}else{if(type=="STR"){return changeStrHHMM(realWorkTime)}}}function getWorkTimeHH(num){return Number(num.substr(0,num.length-2))||0}function getWorkTimeMM(num){return Number(num.substr(num.length-2))||0}function chkWorkTime(){var bResult=true,coreTimeResult=true,modifyResult=true,iCount=0;var errIndexArr=[];var dt=$.grdList.getAllRows();var oriDt=$.grdList.getSaveColumns();var weekWorkTimeSum=0,nightWorkTimeSum=0;for(var i=0;i<dt.length;i++){var rowData=dt[i];$.grdList.setValue(i,"coreTime","");$.grdList.setValue(i,"coreTime","");if(rowData.gubun=="WK10"&&rowData.work_start_time&&rowData.work_end_time){if(rowData.work_start_time>"1000"||rowData.work_end_time<"1600"){$.grdList.setValue(i,"coreTime","ERR");$.grdList.setValue(i,"coreTime","ERR");bResult=false;coreTimeResult=false}}if(rowData.modifyError&&rowData.$level>1){if(rowData.leave_vac_type=="10"&&rowData.gubun=="WK3A"){}else{bResult=false;modifyResult=false;errIndexArr.push(i)}}if(rowData.week_wf_doc_id){var t=calcDiffTime(rowData.week_start_date,rowData.week_end_date,"","");weekWorkTimeSum+=getWorkTimeHH(t)}if(rowData.night_wf_doc_id){var t=calcDiffTime(rowData.night_start_date,rowData.night_end_date,"","");nightWorkTimeSum+=getWorkTimeHH(t)}}if(!coreTimeResult){MessageBoxShow("코어타임을 준수하여 시간을 입력하세요.<br>(코어타임 : 10:00~16:00)")}if(!modifyResult){for(var i=0;i<errIndexArr.length;i++){$.grdList.setValue(errIndexArr[i],"modifyError","ERR")}MessageBoxShow("수정사유를 먼저 입력하시기 바랍니다.")}if(Number($.varWorkExtend.weekWorkTime)<0){bResult=false;MessageBoxShow("실 근무시간의 합계는 총 근로시간 이상이여야 합니다.")}return bResult}function loadGian(param){g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}function compareModifyDesc(yyyymmdd,rId,cInd){var dt=$.grdList.getSaveColumns();var index=$.grdList.getGridRowIndex("yyyymmdd",yyyymmdd);var rowData=$.grdList.getValue(index);if(rowData.gubun!=dt[index].gubun){return false}if(rowData.gubun=="WK3G"){if(!dt[index].work_end_time){return true}}if(dt[index].work_start_time==rowData.work_start_time&&dt[index].work_end_time==rowData.work_end_time){return true}if(!dt[index].work_start_time&&!dt[index].work_end_time){return true}return false}function modifyErroStyle(a,b){var str="";if(b.modifyError&&b.modifyError=="ERR"){str={background:"#ff7b7b !important"}}return str}function coreTimeError(a,b){var str="";if(b.coreTime&&b.coreTime=="ERR"){str={background:"#ff7b7b !important"}}return str}function sendWorkPlanMail(infoObj){var dt=$.grdList.getAllRows();var oriDt=$.grdList.getSaveColumns();var iCount=0;var tag="* "+$.dteYyyymm.getValue().substr(0,4)+"년 "+$.dteYyyymm.getValue().substr(4,2)+"월 월간업무계획서가 변경되었습니다.<br><br>";tag+='<table style="width: 650px; border-collapse: collapse; border-spacing: 0; empty-cells:show;"> 				 <tr> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">일자</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">요일</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">F.F day</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">근무시작<br>시간</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">근무종료<br>시간</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">업무내용</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">휴게<br>시간합</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">근무<br>시간합</th> 					<th style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">수정사유</th> 				</tr> 					';for(var i=0;i<dt.length;i++){var rowData=dt[i];if(rowData.$level>1&&oriDt[i].work_start_time&&oriDt[i].work_end_time){if(oriDt[i].work_start_time!=rowData.work_start_time||oriDt[i].work_end_time!=rowData.work_end_time||oriDt[i].work_desc!=rowData.work_desc||oriDt[i].modify_desc!=rowData.modify_desc||oriDt[i].ffday_yn!=rowData.ffday_yn){tag+="<tr>";tag+=addTagTd(dt[i].yyyymmdd_str);tag+=addTagTd(dt[i].day);tag+=addTagTd(dt[i].ffday_yn);tag+=addTagTd(dt[i].work_start_time.substr(0,2)+":"+dt[i].work_start_time.substr(2,2));tag+=addTagTd(dt[i].work_end_time.substr(0,2)+":"+dt[i].work_end_time.substr(2,2));tag+=addTagTd(dt[i].work_desc);tag+=addTagTd(dt[i].rest_time_sum.substr(0,2)+":"+dt[i].rest_time_sum.substr(2,2));tag+=addTagTd(dt[i].work_time_sum.substr(0,2)+":"+dt[i].work_time_sum.substr(2,2));tag+=addTagTd(dt[i].modify_desc);tag+="</tr>";iCount++}}}tag+="</table>";iCount=0;if(iCount){var params={toAddr:infoObj.email_address,toAddrPs:infoObj.emp_name,subject:"[월간업무계획서] "+$.dteYyyymm.getValue().substr(0,4)+"년 "+$.dteYyyymm.getValue().substr(4,2)+"월 "+$.session.EmpName+" 수정내역",contents:tag};var rs=sendMail(params);if(rs&&rs.result){MessageBoxShow("정상적으로 저장되었습니다.")}else{MessageBoxShow("정상적으로 저장되었으나<br>메일을 발송하는 도중 오류가 발생 하였습니다.<br><br><br>네트워크를 확인 하시거나 <br>관리자에게 문의하여 주시기 바랍니다.")}searchList("Q")}else{MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q")}}function addTagTd(value){var str="";str+='<td style="border: 1px solid; height: 32px; vertical-align: middle; text-align: center;">';str+=value;str+="</td>";return str}function adjustGridCellStyle(arr,styleObj){for(var i=0;i<arr.length;i++){$.grdList.setCellStyle(i,arr[i],styleObj)}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1420);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,55);$.panTop.setText("");$.panTop.setBottomLine();$.lblYyyymm=new FingerLabel(host,"lblYyyymm",0,15,100,20);$.lblYyyymm.setText("연월");$.dteYyyymm=new FingerDateEdit(host,"dteYyyymm",105,15,140,20);$.lblEmployee=new FingerLabel(host,"lblEmployee",235,15,100,20);$.lblEmployee.setText("담당자");$.bteEmployee=new FingerButtonEdit(host,"bteEmployee",340,15,140,20);$.bteEmployee.setText("");$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panWorkInfo=new FingerPanel(host,"panWorkInfo",0,65,1200,145);$.panWorkInfo.setText("");$.panWorkInfo.setBottomLine(true);$.htmlWorkTime=new FingerHTMLView(host,"htmlWorkTime",0,0,280,130);$.htmlWorkExtend=new FingerHTMLView(host,"htmlWorkExtend",285,0,310,130);$.panList=new FingerPanel(host,"panList",0,215,1200,1195);$.panList.setText("월간업무계획서");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,1150);$.btnSave=new FingerButton(host,"btnSave",1040,-40,90,30);$.btnSave.setText("저장");$.btnSettings=new FingerButton(host,"btnSettings",887,-40,166,30);$.btnSettings.setText("출퇴근시간 일괄 설정");$.htmlWorkApprovalTime=new FingerHTMLView(host,"htmlWorkApprovalTime",888,0,310,130);$.htmlHelpMsg=new FingerHTMLView(host,"htmlHelpMsg",285,197,600,60);$.panTop.setBorder(true);$.panList.addButton("btnExcelDown","엑셀다운로드");$.panList.setButtonAction("btnExcelDown","excel_down");$.dteYyyymm.setDateFormat("yyyymm");$.dteYyyymm.setAllowBlank(false,"연월");$.btnSave.setClass("btn_save");$.grdList.setColumns([new FingerDataGridColumn("group_title",1,"center","string",[{text:"월간업무계획서",colspan:13},""],{readonly:true,template:"tree_type1",sort:null}),new FingerDataGridColumn("jucha_name",55,"center","string",["","해당<br>기간"],{readonly:true,rowSpan:true,verticalMiddle:true,sort:null}),new FingerDataGridColumn("gubun",100,"center","string",["","구분"],{readonly:true,sort:null}),new FingerDataGridColumn("yyyymmdd_str",55,"center","string",["","일자"],{readonly:true,sort:null}),new FingerDataGridColumn("day",45,"center","string",["","요일"],{readonly:true,sort:null}),new FingerDataGridColumn("ffday_yn",40,"center","checkbox",["","F.F<br>day"],{sort:null}),new FingerDataGridColumn("work_start_time",65,"right","string",["","근무<br>시작시간"],{format:"s_hmm",cssFormat:coreTimeError,sort:null}),new FingerDataGridColumn("work_end_time",65,"right","string",["","근무<br>종료시간"],{format:"s_hmm",cssFormat:coreTimeError,sort:null}),new FingerDataGridColumn("vac_move_time",72,"right","string",["","이동시간"],{format:"s_hmm",cssFormat:coreTimeError,sort:null}),new FingerDataGridColumn("work_desc",103,"left","popup",["",{text:"업무내용",colspan:1}],{sort:null}),new FingerDataGridColumn("rest_time_sum",60,"right","string",["","휴게<br>시간합"],{readonly:true,format:"s_hmm",sort:null}),new FingerDataGridColumn("work_time_sum",60,"right","string",["","근무<br>시간합"],{readonly:true,format:"s_hmm",sort:null}),new FingerDataGridColumn("modify_desc",104,"left","popup",["",{text:"수정사유",colspan:1}],{sort:null,cssFormat:modifyErroStyle}),new FingerDataGridColumn("leave_str",110,"center","string",[{text:"연장/휴일근무 기안",colspan:5},"휴가"],{readonly:true,isLink:true,sort:null}),new FingerDataGridColumn("week_str",65,"center","string",["","연장"],{readonly:true,isLink:true,sort:null}),new FingerDataGridColumn("night_str",65,"center","string",["","야간"],{readonly:true,isLink:true,sort:null}),new FingerDataGridColumn("vac_str",65,"center","string",["","휴일<br>(이동시간)"],{readonly:true,isLink:true,sort:null}),new FingerDataGridColumn("hol_str",70,"center","string",["","전사휴일<br>근무"],{readonly:true,isLink:true,sort:null}),new FingerDataGridColumn("day_num",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("yyyymmdd_type",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("jucha",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("work_day_type",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("leave_wf_doc_id",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("leave_start_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("leave_end_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("yyyymmdd",90,"center","string",["",""],{hidden:true}),new FingerDataGridColumn("week_wf_doc_id",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("week_start_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("week_end_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("night_wf_doc_id",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("night_start_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("night_end_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("vac_wf_doc_id",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("vac_start_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("vac_end_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("hol_wf_doc_id",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("hol_start_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("hol_end_date",0,"left","int",["",""],{hidden:true}),new FingerDataGridColumn("tree_id",0,"center","string",["",""],{hidden:true}),new FingerDataGridColumn("tree_parent_id",0,"center","string",["",""],{hidden:true}),new FingerDataGridColumn("modifyError",0,"center","string",["",""],{hidden:true}),new FingerDataGridColumn("extra_field",0,"center","string",["",""],{hidden:true}),new FingerDataGridColumn("coreTime",0,"center","string",["",""],{hidden:true})]);$.grdList.init({scroll:"x",isFilter:false,headerRowHeight:45,view:"treetable",leftSplit:13,treeKey:{id:"tree_id",parent:"tree_parent_id"}});$.grdList.setEditable(true);$.grdList.setBorder(false);var msg="◈ 연장/야간 실 근무시간은 월간업무계획서에 기입한 정보가 실시간 반영됩니다.<br>◈ 실근무시간의 합과 계획시간의 합은 상이할 수 있음을 참고 바랍니다.<br>◈ 연장/야간 업무계획을 승인 받았더라도, 가급적 총 근로시간내에 근무 할 수 있도록 업무계획을 조정 바랍니다.";$.htmlHelpMsg.setHTML(msg);$.htmlHelpMsg.setStyle("line-height","18px");$.htmlHelpMsg.setStyle("font-size","12px");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panWorkInfo);$.panMain.add($.panList);$.panMain.add($.htmlHelpMsg);$.panTop.add($.lblYyyymm);$.panTop.add($.dteYyyymm);$.panTop.add($.lblEmployee);$.panTop.add($.bteEmployee);$.panTop.add($.btnSearch);$.panWorkInfo.add($.htmlWorkTime);$.panWorkInfo.add($.htmlWorkExtend);$.panWorkInfo.add($.htmlWorkApprovalTime);$.panList.add($.grdList);$.panList.add($.btnSave);$.panList.add($.btnSettings);initView();searchList("Q");$.varFirst=false};$.callback=function(type,ds){if(type=="Q"){initData();$.varNowJucha=ds.resultList[1][0].jucha;$.varWorkingDay=ds.resultList[2][0].working_day;$.varIsSave=ds.resultList[3][0].cnt?true:false;setDataGrid([$.grdList],ds);$.grdList.openNode("all",true);for(var i=0;i<$.grdList.getRowCount();i++){var row=$.grdList.getValue(i);var isHoliday=false;if($.grdList.getValue(i,"$level")==1){$.grdList.addSpan(row.id,"group_title",13,1,null,"time-msg-focus");$.grdList.addSpan(row.id,"leave_str",5,1,null,null)}if($.grdList.getValue(i,"gubun")){var rowColor="#c4def5 !important";$.grdList.setCellStyle(i,"leave_str",{background:rowColor});$.grdList.setCellStyle(i,"week_str",{background:rowColor});$.grdList.setCellStyle(i,"night_str",{background:rowColor});$.grdList.setCellStyle(i,"vac_str",{background:rowColor});$.grdList.setCellStyle(i,"hol_str",{background:rowColor})}if($.grdList.getValue(i,"jucha")==$.varNowJucha&&getToday().substr(0,6)==$.dteYyyymm.getValue().substr(0,6)){var juchaColor="#f8f9a4 !important";$.grdList.setCellStyle(i,"jucha_name",{background:juchaColor});$.grdList.setCellStyle(i,"gubun",{background:juchaColor});$.grdList.setCellStyle(i,"yyyymmdd_str",{background:juchaColor});$.grdList.setCellStyle(i,"day",{background:juchaColor});$.grdList.setCellStyle(i,"ffday_yn",{background:juchaColor});$.grdList.setCellStyle(i,"work_start_time",{background:juchaColor});$.grdList.setCellStyle(i,"work_end_time",{background:juchaColor});$.grdList.setCellStyle(i,"vac_move_time",{background:juchaColor});$.grdList.setCellStyle(i,"work_desc",{background:juchaColor});$.grdList.setCellStyle(i,"rest_time_sum",{background:juchaColor});$.grdList.setCellStyle(i,"work_time_sum",{background:juchaColor});$.grdList.setCellStyle(i,"modify_desc",{background:juchaColor})}if($.grdList.getValue(i,"gubun")=="WK20"||$.grdList.getValue(i,"gubun")=="WK40"||$.grdList.getValue(i,"gubun")=="WK50"){$.grdList.setCellStyle(i,"gubun",{color:"red !important"});$.grdList.setCellStyle(i,"yyyymmdd_str",{color:"red !important"});$.grdList.setCellStyle(i,"day",{color:"red !important"})}else{if($.grdList.getValue(i,"gubun")=="WK3L"||$.grdList.getValue(i,"gubun")=="WK3M"||$.grdList.getValue(i,"gubun")=="WK3N"){var holColor="#cccccc !important";$.grdList.setCellStyle(i,"jucha_name",{background:holColor});$.grdList.setCellStyle(i,"gubun",{background:holColor});$.grdList.setCellStyle(i,"yyyymmdd_str",{background:holColor});$.grdList.setCellStyle(i,"day",{background:holColor});$.grdList.setCellStyle(i,"ffday_yn",{background:holColor});$.grdList.setCellStyle(i,"work_start_time",{background:holColor});$.grdList.setCellStyle(i,"work_end_time",{background:holColor});$.grdList.setCellStyle(i,"vac_move_time",{background:holColor});$.grdList.setCellStyle(i,"work_desc",{background:holColor});$.grdList.setCellStyle(i,"rest_time_sum",{background:holColor});$.grdList.setCellStyle(i,"work_time_sum",{background:holColor});$.grdList.setCellStyle(i,"modify_desc",{background:holColor});$.grdList.setCellStyle(i,"leave_str",{background:holColor});$.grdList.setCellStyle(i,"week_str",{background:holColor});$.grdList.setCellStyle(i,"night_str",{background:holColor});$.grdList.setCellStyle(i,"vac_str",{background:holColor});$.grdList.setCellStyle(i,"hol_str",{background:holColor});$.grdList.setCellStyle(i,"gubun",{color:"red !important"});$.grdList.setValue(i,"work_start_time","");$.grdList.setValue(i,"work_end_time","");$.grdList.setValue(i,"leave_wf_doc_id","")}}if($.grdList.getValue(i,"extra_field").indexOf("TIME_VAC")>-1){$.grdList.setCellStyle(i,"gubun",{cursor:"pointer","text-decoration":"underline",color:"#0e6dd8"})}var totalWorkTime="",restHHMM="",realWorkTime="",t="";if($.grdList.getValue(i,"leave_wf_doc_id")&&$.grdList.getValue(i,"gubun")!="WK20"){var vacType=$.grdList.getValue(i,"leave_vac_type");isHoliday=true;if(vacType=="10"){$.grdList.setValue(i,"leave_str","전일연차")}else{$.grdList.setValue(i,"leave_str",row.leave_vac_name)}}if($.grdList.getValue(i,"week_wf_doc_id")){t=calcRealWorkTime($.grdList.getValue(i,"week_start_date"),$.grdList.getValue(i,"week_end_date"),"","","STR");$.grdList.setValue(i,"week_str",t)}if($.grdList.getValue(i,"night_wf_doc_id")){t=calcRealWorkTime($.grdList.getValue(i,"night_start_date"),$.grdList.getValue(i,"night_end_date"),"","","STR");$.grdList.setValue(i,"night_str",t)}if($.grdList.getValue(i,"vac_wf_doc_id")){t=calcRealWorkTime($.grdList.getValue(i,"vac_start_date"),$.grdList.getValue(i,"vac_end_date"),"","","STR");$.grdList.setValue(i,"vac_str",t)}if($.grdList.getValue(i,"vac_move_wf_doc_id")){t=calcRealWorkTime($.grdList.getValue(i,"vac_move_start_date"),$.grdList.getValue(i,"vac_move_end_date"),"","","MOVE");var resultStr="";if($.grdList.getValue(i,"vac_wf_doc_id")){var vacStr=$.grdList.getValue(i,"vac_str");resultStr=vacStr.substr(0,vacStr.length-2)+"("+t+")"}else{resultStr=t}$.grdList.setValue(i,"vac_str",resultStr)}if($.grdList.getValue(i,"hol_wf_doc_id")){t=calcRealWorkTime($.grdList.getValue(i,"hol_start_date"),$.grdList.getValue(i,"hol_end_date"),"","","STR");$.grdList.setValue(i,"hol_str",t)}if($.grdList.getValue(i,"work_start_time")&&$.grdList.getValue(i,"work_end_time")){sumRestnWorkTime(i)}if(isHoliday&&$.grdList.getValue(i,"leave_vac_type")!="70"){$.grdList.setValue(i,"work_start_time","");$.grdList.setValue(i,"work_end_time","");$.grdList.setValue(i,"rest_time_sum","")}}$.grdList.selectRow(0);$.grdList.clearSelect();compareWorkTime();$.grdList.saveColumns($.grdList.getAllRows());var modifyYn=ds.resultList[4][0].modify_yn;if(modifyYn=="N"){$.btnSave.setEnable(false);$.btnSettings.setEnable(false)}else{$.btnSave.setEnable(true);$.btnSettings.setEnable(true)}}else{if(type=="SAVE"){if(ds){if($.varIsSave){var json=createJSON_Q("Q_DEPT");var ds=callQuerySync(["req",json],"Q_DEPT");if(ds&&ds.resultList[0]){sendWorkPlanMail(ds.resultList[0][0])}}else{MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q")}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){$.grdList.editStop();initData();searchList("Q")}else{if(id=="btnSettings"){if($.grdList.getRowCount()<1){MessageBoxShow("설정할 내역이 없습니다.");return}g_main.openPopup("popCommuteTimeSettings.html","popCommuteTimeSettings","",0,0,"","","","","")}else{if(id=="btnSave"){$.grdList.editStop();if($.grdList.getRowCount()<1){MessageBoxShow("저장할 내역이 없습니다.");return}if(!chkWorkTime()){return}confirmBoxShow("저장 하시겠습니까?",function(){if(g_main.msgShare==true){saveList("")}})}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmployee"){var param={emp_name:$.bteEmployee.getText()||"",};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteYyyymm"){if(!value){return}if(!$.varFirst){searchList("Q")}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){$.varRowId=rId;var rowData=$.grdList.getValue(rId);if(!rowData[cInd]){return}if(cInd=="week_str"){var param={wf_doc_id:rowData.week_wf_doc_id};loadGian(param)}else{if(cInd=="night_str"){var param={wf_doc_id:rowData.night_wf_doc_id};loadGian(param)}else{if(cInd=="vac_str"){var param={wf_doc_id:rowData.vac_wf_doc_id};loadGian(param)}else{if(cInd=="hol_str"){var param={wf_doc_id:rowData.hol_wf_doc_id};loadGian(param)}else{if(cInd=="leave_str"){var param={wf_doc_id:rowData.leave_wf_doc_id};loadGian(param)}else{if(cInd=="gubun"){if(rowData.extra_field.indexOf("TIME_VAC")>-1){g_main.openPopup("popSelectWork.html","popSelectWork","",0,0,"","",{workType:rowData.leave_vac_type},"","")}}}}}}}}};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){var rowData=$.grdList.getValue(rId);rowData.work_start_time_readonly=false;rowData.work_end_time_readonly=false;rowData.work_desc_readonly=false;rowData.modify_desc_readonly=false;if(rowData.extra_field&&(rowData.extra_field=="TIME_FIXED"||rowData.gubun=="WK3A")){rowData.work_start_time_readonly=true;rowData.work_end_time_readonly=true;rowData.work_desc_readonly=true;rowData.modify_desc_readonly=true}if(rowData.$level==1){rowData.work_start_time_readonly=true;rowData.work_end_time_readonly=true;rowData.work_desc_readonly=true;rowData.modify_desc_readonly=true}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){var rowData=$.grdList.getValue(rId);if(cInd=="work_start_time"||cInd=="work_end_time"||cInd=="vac_move_time"){if(!nValue){$.grdList.setValue(rId,"rest_time_sum","");$.grdList.setValue(rId,"work_time_sum","");sumRestnWorkTime(rId);compareWorkTime();return}nValue=nValue.toString();var regExp=/[^0123456789]/g;if(nValue.length!=4){MessageBoxShow("hhmm (ex:1200) 형식으로 입력해야 합니다.");$.grdList.setValue(rId,cInd,oValue||"");return}if(regExp.test(nValue)){MessageBoxShow("숫자만 입력이 가능합니다.");$.grdList.setValue(rId,cInd,oValue||"");return}var HH=getWorkTimeHH(nValue);var MM=getWorkTimeMM(nValue);if(MM!=30&&MM!=0){MessageBoxShow("30분 단위로 입력해 주시기 바랍니다.");$.grdList.setValue(rId,cInd,oValue||"");return}if(cInd=="work_start_time"||cInd=="work_end_time"){if(cInd=="work_start_time"){if(HH>=22){if(!rowData.night_wf_doc_id){MessageBoxShow("야간근무 계획서 승인이 반드시 필요합니다.");$.grdList.setValue(rId,cInd,oValue||"");return}}}if(cInd=="work_end_time"){if(nValue>"2200"){if(!rowData.night_wf_doc_id){MessageBoxShow("야간근무 계획서 승인이 반드시 필요합니다.");$.grdList.setValue(rId,cInd,oValue||"");return}}}if(HH>24||HH<0){MessageBoxShow("시간은 24시를 초과할 수 없습니다.");$.grdList.setValue(rId,cInd,oValue||"");return}if(rowData.yyyymmdd_type=="BEFORE"&&!rowData.modify_desc){if(rowData.gubun=="WK10"&&rowData.work_start_time&&rowData.work_end_time){if(rowData.work_start_time>"1000"||rowData.work_end_time<"1700"){$.grdList.setValue(rId,"coreTime","STAY");$.grdList.setValue(rId,"coreTime","STAY")}else{$.grdList.setValue(rId,"coreTime","");$.grdList.setValue(rId,"coreTime","")}}if(!compareModifyDesc(rowData.yyyymmdd,rId,cInd)){var errMsg=$.grdList.getValue(rId,"modifyError");if(errMsg&&errMsg=="ERR"){}else{errMsg="STAY"}$.grdList.setValue(rId,"modifyError",errMsg)}else{$.grdList.setValue(rId,"modifyError","")}}if(rowData.gubun=="WK20"){if(!rowData.week_wf_doc_id&&!rowData.night_wf_doc_id&&!rowData.vac_wf_doc_id&&!rowData.leave_wf_doc_id&&!rowData.hol_wf_doc_id){MessageBoxShow("휴일에 근무입력시<br>연장/휴일근무 기안이 필요합니다.");$.grdList.setValue(rId,cInd,"");return}}if(rowData.day_num==7||rowData.day_num==1||rowData.gubun=="WK20"){MessageBoxShow("휴일에는 가급적 휴식을 취하길 바라며,<br>8시간 이상의 근무는 불가합니다.")}if(rowData.work_start_time&&rowData.work_end_time){sumRestnWorkTime(rId);compareWorkTime()}}else{if(rowData.gubun!="WK20"){MessageBoxShow("구분이 휴일인 경우만 입력가능합니다.");$.grdList.setValue(rId,cInd,"");return}var t=calcRealWorkTime("0100",rowData.vac_move_time,"","","HH");compareWorkTime()}}else{if(cInd=="modify_desc"){if(nValue){$.grdList.setValue(rId,"modifyError",false)}else{$.grdList.setValue(rId,"modifyError",true)}}else{if(cInd=="ffday_yn"){if(rowData.day_num!="6"){MessageBoxShow("금요일만 선택이 가능합니다.");$.grdList.setValue(rId,cInd,"N");return}for(var i=0;i<$.grdList.getRowCount();i++){var rowId=$.grdList.getRowId(i);if(rId!=rowId){$.grdList.setValue(i,cInd,"N")}}}}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if($.grdList.getRowCount()<1){MessageBoxShow("엑셀로 출력할 내역이 없습니다.");return}var cols=deepCopyObj($.grdList.columns);var dt=deepCopyObj($.grdList.getAllRows());var xlsCols=[];for(var i=0;i<cols.length;i++){if(cols[i].id!="jucha_name"){if(cols[i].id=="group_title"){cols[i].header[0].colspan=12;cols[i].header[0].$colspan=12}if(cols[i].id=="work_desc"){cols[i].header[1].colspan=1;cols[i].header[1].$colspan=1}if(cols[i].id=="modify_desc"){cols[i].header[1].colspan=1;cols[i].header[1].$colspan=1}xlsCols.push({header:cols[i].header,datatype:cols[i].type,datafield:cols[i].id,width:(cols[i].width+"px"),ishidden:(cols[i].excelHidden===true?true:(cols[i].hidden?true:false)),docNum:(cols[i].docNum?true:false),instId:(cols[i].instId?true:false),tableBorder:(cols[i].borderCss?true:false),rowSpan:(cols[i].rowSpan?true:false)})}}for(var i=0;i<dt.length;i++){if(dt[i].work_start_time){dt[i].work_start_time=dt[i].work_start_time.substr(0,2)+":"+dt[i].work_start_time.substr(2,2)}if(dt[i].work_end_time){dt[i].work_end_time=(dt[i].work_end_time.substr(0,2)=="24"?"00":dt[i].work_end_time.substr(0,2))+":"+dt[i].work_end_time.substr(2,2)}if(dt[i].rest_time_sum){dt[i].rest_time_sum=dt[i].rest_time_sum.substr(0,2)+":"+dt[i].rest_time_sum.substr(2,2)}if(dt[i].work_time_sum){dt[i].work_time_sum=dt[i].work_time_sum.substr(0,2)+":"+dt[i].work_time_sum.substr(2,2)}}$.grdList.excelDownCustom("엑셀다운",false,false,xlsCols,dt)}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmployee"){$.bteEmployee.setText(popResult.emp_name);$.varEmployeeId=popResult.employee_id;$.varDeptCode=popResult.dept_code}}else{if(id=="popCommuteTimeSettings"){var sp=popResult.commuteTime.split("~");var HH=sp[0].trim().replace(":","");var MM=sp[1].trim().replace(":","");HH=(HH.length<4?"0"+HH:HH);for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"day_num")==7||$.grdList.getValue(i,"day_num")==1){continue}if($.grdList.getValue(i,"gubun")=="WK10"){$.grdList.setValue(i,"work_start_time",HH);$.grdList.setValue(i,"work_end_time",MM);sumRestnWorkTime(i)}$.grdList.setValue(i,"modifyError","");if($.grdList.getValue(i,"yyyymmdd_type")=="BEFORE"&&!$.grdList.getValue(i,"modify_desc")){if($.grdList.getValue(i,"gubun")=="WK10"&&$.grdList.getValue(i,"work_start_time")&&$.grdList.getValue(i,"work_end_time")){if($.grdList.getValue(i,"work_start_time")>"1000"||$.grdList.getValue(i,"work_end_time")<"1700"){$.grdList.setValue(i,"coreTime","STAY");$.grdList.setValue(i,"coreTime","STAY")}else{$.grdList.setValue(i,"coreTime","");$.grdList.setValue(i,"coreTime","")}}if(!compareModifyDesc($.grdList.getValue(i,"yyyymmdd"),i,"")){$.grdList.setValue(i,"modifyError","STAY")}}}compareWorkTime()}else{if(id=="popSelectWork"){var workType=popResult.workType;var rowData=$.grdList.getValue($.varRowId);$.grdList.setValue($.varRowId,"gubun",workType);if(popResult.workType=="WK3A"){$.grdList.setValue($.varRowId,"work_start_time","0900");$.grdList.setValue($.varRowId,"work_end_time","1800")}$.grdList.setValue($.varRowId,"modifyError","");if(rowData.yyyymmdd_type=="BEFORE"&&!rowData.modify_desc){if(!compareModifyDesc(rowData.yyyymmdd,$.varRowId,"gubun")){$.grdList.setValue($.varRowId,"modifyError","STAY")}}sumRestnWorkTime($.varRowId);compareWorkTime();if(popResult.workType=="WK3A"){$.grdList.setValue($.varRowId,"work_start_time","");$.grdList.setValue($.varRowId,"work_end_time","");$.grdList.setValue($.varRowId,"rest_time_sum","")}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>