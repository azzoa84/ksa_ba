<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMenu=null;$.panBM=null;$.grdMenu=null;$.grdBM=null;$.btnAdd=null;$.btnDel=null;$.btnUp=null;$.btnDown=null;$.lblHelp=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_BookMarkManage_Q",[workType,"#UserID#"]);return json}function createJSON_S(workType){var rows=[];var aRows=$.grdBM.getAllRows();rows.push(["D","","",0,"#UserID#"]);var order_seq=1;for(var i in aRows){rows.push([workType,aRows[i].menu_id,aRows[i].menu_name,order_seq++,"#UserID#"])}return createExecuteParamInfo("P_BookMarkManage_S",rows)}function searchData(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveBM(){var json=createJSON_S("N");callExecute(["req",json],"S",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,705);$.panMain.setText("");$.panMain.setBottomLine(true);$.panMenu=new FingerPanel(host,"panMenu",0,0,540,700);$.panMenu.setText("전체메뉴 목록");$.panMenu.setBottomLine(true);$.panBM=new FingerPanel(host,"panBM",610,0,520,700);$.panBM.setText("즐겨찾기 목록");$.panBM.setBottomLine(true);$.grdMenu=new FingerDataGrid(host,"grdMenu",0,0,540,655);$.grdBM=new FingerDataGrid(host,"grdBM",0,28,520,620);$.btnAdd=new FingerButton(host,"btnAdd",562,325,50,20);$.btnAdd.setText("▶");$.btnDel=new FingerButton(host,"btnDel",562,360,50,20);$.btnDel.setText("◀");$.btnUp=new FingerButton(host,"btnUp",1145,320,60,35);$.btnUp.setText("▲");$.btnDown=new FingerButton(host,"btnDown",1145,360,60,35);$.btnDown.setText("▼");$.lblHelp=new FingerLabel(host,"lblHelp",0,0,520,20);$.lblHelp.setText("(* 저장 후 재 로그인을 통해 즐겨찾기 메뉴가 반영됩니다.)");$.panBM.addButtons(["btnSave"]);$.grdMenu.setColumns([new FingerDataGridColumn("menu_id",100,"left","string","메뉴ID",{hidden:true}),new FingerDataGridColumn("p_menu_id",100,"left","string","상위메뉴ID",{hidden:true}),new FingerDataGridColumn("menu_name",520,"left","string","메뉴명",{template:"tree"}),new FingerDataGridColumn("menu_lv",100,"left","string","메뉴Level",{hidden:true}),new FingerDataGridColumn("sort_seq_w40",100,"left","string","워크넷40 순서",{hidden:true}),new FingerDataGridColumn("category",100,"left","string","카테고리",{hidden:true}),new FingerDataGridColumn("form_id",100,"left","string","폼ID",{hidden:true}),new FingerDataGridColumn("release_status",100,"left","string","",{hidden:true}),new FingerDataGridColumn("help_yn",100,"left","string","도움말 여부",{hidden:true})]);$.grdMenu.init({panel:$.panMenu,view:"treetable",treeKey:{id:"menu_id",parent:"p_menu_id"},nonExcel:true});$.grdMenu.setBorder(false);$.grdBM.setColumns([new FingerDataGridColumn("menu_id",100,"left","string","메뉴ID",{hidden:true}),new FingerDataGridColumn("p_menu_id",100,"left","string","상위메뉴ID",{hidden:true}),new FingerDataGridColumn("menu_name",500,"left","string","메뉴명"),new FingerDataGridColumn("category",100,"left","string","카테고리",{hidden:true})]);$.grdBM.init({panel:$.panBM,nonExcel:true,isFilter:false});$.grdBM.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMenu);$.panMain.add($.panBM);$.panMain.add($.btnUp);$.panMain.add($.btnDown);$.panMain.add($.btnDel);$.panMain.add($.btnAdd);$.panMenu.add($.grdMenu);$.panBM.add($.grdBM);$.panBM.add($.lblHelp);searchData("Q1")};$.callback=function(type,ds){if(type=="Q1"){setDataGrid([$.grdMenu],ds);$.grdMenu.openNode("all");searchData("Q2")}else{if(type=="Q2"){setDataGrid([$.grdBM],ds);$.grdBM.selectRow(0)}else{if(type=="S"){MessageBoxShow("변경된 즐겨찾기 목록은 재 로그인 하셔야 반영됩니다.");searchData("Q2")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnAdd"){var rId=$.grdMenu.getSelectedRowIdx();if(!rId){return}var aRows=$.grdBM.getAllRows();var sData=$.grdMenu.getValue(rId);if(sData.category=="GROUP"){return}for(var i in aRows){if(aRows[i].menu_id==sData.menu_id){MessageBoxShow("'"+sData.menu_name+"' 메뉴는 이미 즐겨찾기로 추가되어 있습니다.");return}}aRows.push({menu_id:sData.menu_id,menu_name:sData.menu_name,p_menu_id:"MyMenu",cataegory:"FORM"});$.grdBM.setData(aRows);$.grdBM.selectRow($.grdBM.getGridRowIndex("menu_id",sData.menu_id,0))}else{if(id=="btnDel"){$.grdBM.deleteCurrentRow();var aRows=$.grdBM.getAllRows();$.grdBM.setData(aRows);$.grdBM.selectRow(0)}else{if(id=="btnUp"){var rId=$.grdBM.getSelectedRowIdx();if(!rId){return}var aRows=$.grdBM.getAllRows();var sp=null;for(var i in aRows){if(aRows[i].menu_id==$.grdBM.getValue(rId,"menu_id")){sp=i;break}}if(sp==0||!sp){return}var sData=aRows[sp];var cData=aRows[Number(sp)-1];aRows[Number(sp)-1]=sData;aRows[sp]=cData;$.grdBM.setData(aRows);$.grdBM.selectRow($.grdBM.getGridRowIndex("menu_id",$.grdBM.getValue(rId,"menu_id"),0))}else{if(id=="btnDown"){var rId=$.grdBM.getSelectedRowIdx();if(!rId){return}var aRows=$.grdBM.getAllRows();var sp=null;for(var i in aRows){if(aRows[i].menu_id==$.grdBM.getValue(rId,"menu_id")){sp=i;break}}if(sp==aRows.length-1||!sp){return}var sData=aRows[sp];var cData=aRows[Number(sp)+1];aRows[Number(sp)+1]=sData;aRows[sp]=cData;$.grdBM.setData(aRows);$.grdBM.selectRow($.grdBM.getGridRowIndex("menu_id",$.grdBM.getValue(rId,"menu_id"),0))}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panBM"){if(btnId=="btnSave"){if($.grdBM.getAllRows().length<=0){return}saveBM()}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){}};</script>