<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblYear=null;$.lblSite=null;$.lblDate=null;$.lblWave=null;$.lblType=null;$.lblEarner=null;$.lblPrint=null;$.lblPrintType=null;$.lblPrintType2=null;$.dteYear=null;$.cmbSite=null;$.dteStart=null;$.dteEnd=null;$.cmbType=null;$.txtEarner=null;$.bteEarner=null;$.dtePrint=null;$.cmbPrintType=null;$.cmbPrintType2=null;$.btnPrint=null;$.btnView=null;$.varPrintType="";function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRA2400_Q",[workType,$.dteYear.getValue(),$.cmbSite.getValue(),$.dteStart.getValue(),$.dteEnd.getValue(),$.cmbType.getValue(),$.txtEarner.getValue(),$.dtePrint.getValue()]);return json}function searchData(){if(!validateControls([$.dteYear,$.cmbSite,$.dteStart,$.dteEnd,$.cmbType,$.cmbPrintType,$.cmbPrintType2])){return}var workType="";if($.cmbPrintType.getValue()=="10"){workType="REPORT1"}else{if($.cmbPrintType.getValue()=="20"){workType="REPORT2"}else{if($.cmbPrintType.getValue()=="30"){workType="REPORT2"}}}var json=createJSON_Q(workType);callQuery(["req",json],"REPORT",$)}function mergeObjectProperty(arr){var resultObject={};for(var i=0,length=arr.length;i<length;i++){var object=arr[i];for(var property in object){if(object.hasOwnProperty(property)){resultObject[property]=object[property]}}}return resultObject}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",420,0,360,310);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,10,100,20);$.lblYear.setText("귀속연도");$.lblSite=new FingerLabel(host,"lblSite",0,40,100,20);$.lblSite.setText("사업장");$.lblDate=new FingerLabel(host,"lblDate",0,70,100,20);$.lblDate.setText("지급기간");$.lblWave=new FingerLabel(host,"lblWave",205,70,20,20);$.lblWave.setText("~");$.lblType=new FingerLabel(host,"lblType",0,100,100,20);$.lblType.setText("거주구분");$.lblEarner=new FingerLabel(host,"lblEarner",0,130,100,20);$.lblEarner.setText("소득자");$.lblPrint=new FingerLabel(host,"lblPrint",0,160,100,20);$.lblPrint.setText("출력일자");$.lblPrintType=new FingerLabel(host,"lblPrintType",0,190,100,20);$.lblPrintType.setText("출력구분");$.lblPrintType2=new FingerLabel(host,"lblPrintType2",0,220,100,20);$.lblPrintType2.setText("출력형식구분");$.dteYear=new FingerDateEdit(host,"dteYear",105,10,100,20);$.cmbSite=new FingerComboBox(host,"cmbSite",105,40,230,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,70,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",230,70,100,20);$.cmbType=new FingerComboBox(host,"cmbType",105,100,230,20);$.txtEarner=new FingerEdit(host,"txtEarner",105,130,80,20);$.bteEarner=new FingerButtonEdit(host,"bteEarner",190,130,140,20);$.bteEarner.setText("");$.dtePrint=new FingerDateEdit(host,"dtePrint",105,160,100,20);$.cmbPrintType=new FingerComboBox(host,"cmbPrintType",105,190,230,20);$.cmbPrintType2=new FingerComboBox(host,"cmbPrintType2",105,220,230,20);$.btnPrint=new FingerButton(host,"btnPrint",160,265,100,20);$.btnPrint.setText("출력");$.btnView=new FingerButton(host,"btnView",95,265,100,20);$.btnView.setText("미리보기");$.panMain.setBorder(true);$.dteYear.setDateFormat("yyyy");$.dteYear.setAllowBlank(false,"귀속연도");$.cmbSite.setAllowBlank(false,"사업장");$.dteStart.setAllowBlank(false,"지급기간 시작일");$.dteEnd.setAllowBlank(false,"지급기간 종료일");$.cmbType.setAllowBlank(false,"거주구분");$.cmbPrintType.setAllowBlank(false,"출력구분");$.cmbPrintType2.setAllowBlank(false,"출력형식구분");var today=getToday();$.dteYear.setValue(today.substr(0,4));$.dtePrint.setValue(today);$.btnView.setVisible(false);$.txtEarner.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.lblYear);$.panMain.add($.lblSite);$.panMain.add($.lblDate);$.panMain.add($.lblWave);$.panMain.add($.lblType);$.panMain.add($.lblEarner);$.panMain.add($.lblPrint);$.panMain.add($.lblPrintType);$.panMain.add($.lblPrintType2);$.panMain.add($.dteYear);$.panMain.add($.cmbSite);$.panMain.add($.dteStart);$.panMain.add($.dteEnd);$.panMain.add($.cmbType);$.panMain.add($.txtEarner);$.panMain.add($.bteEarner);$.panMain.add($.dtePrint);$.panMain.add($.cmbPrintType);$.panMain.add($.cmbPrintType2);$.panMain.add($.btnPrint);$.panMain.add($.btnView);$.cmbSite.setColumnConfig({id:"site_code"});$.cmbSite.setColumnConfig({id:"site_name"});$.cmbSite.setColumnConfig({id:"descr"});$.cmbSite.setColumn("site_code","site_name");$.cmbPrintType2.setEmptyRow(true);var ds=bizComponentData2($,"Q1","L_ORG001|L_HRA015|L_HRA026|L_HRA040");setComboBind([$.cmbSite,$.cmbType,$.cmbPrintType,$.cmbPrintType2],ds);$.cmbPrintType.setValue("10")};$.callback=function(type,ds){if(type=="REPORT"){if(!ds.resultList[0][0]){MessageBoxShow("조건에 해당하는 데이터가 없습니다.");return}var rs=ds.resultList;if($.cmbPrintType.getValue()=="10"){rs[0][0].tot_pay_sum=setComma(rs[0][0].tot_pay_sum);rs[0][0].tot_income_tax_sum=setComma(rs[0][0].tot_income_tax_sum);rs[0][0].tot_local_tax_sum=setComma(rs[0][0].tot_local_tax_sum);rs[0][0].tot_sum=setComma(rs[0][0].tot_sum);rs[0][0].tot_pay_sum_1=setComma(rs[0][0].tot_pay_sum_1);rs[0][0].tot_income_tax_sum_1=setComma(rs[0][0].tot_income_tax_sum_1);rs[0][0].tot_local_tax_sum_1=setComma(rs[0][0].tot_local_tax_sum_1);rs[0][0].tot_sum_1=setComma(rs[0][0].tot_sum_1);rs[0][0].tot_pay_sum_2=setComma(rs[0][0].tot_pay_sum_2);rs[0][0].tot_income_tax_sum_2=setComma(rs[0][0].tot_income_tax_sum_2);rs[0][0].tot_local_tax_sum_2=setComma(rs[0][0].tot_local_tax_sum_2);rs[0][0].tot_sum_2=setComma(rs[0][0].tot_sum_2);k=3;for(var i=0;i<rs[1].length;i++){rs[0][0]["Rownumber"+k]=rs[1][i].Rownumber;rs[0][0]["income_type"+k]=rs[1][i].income_type;rs[0][0]["earner_name"+k]=rs[1][i].earner_name;rs[0][0]["social_no"+k]=rs[1][i].social_no;rs[0][0]["foreign_type"+k]=rs[1][i].foreign_type;rs[0][0]["pay_date"+k]=rs[1][i].pay_date;rs[0][0]["tot_out_cnt"+k]=rs[1][i].out_cnt;rs[0][0]["tot_pay_sum"+k]=setComma(rs[1][i].tot_pay_sum);rs[0][0]["tax_rate"+k]=rs[1][i].tax_rate;rs[0][0]["tot_income_tax_sum"+k]=setComma(rs[1][i].tot_income_tax_sum);rs[0][0]["tot_local_tax_sum"+k]=setComma(rs[1][i].tot_local_tax_sum);rs[0][0]["tot_sum"+k]=setComma(rs[1][i].tot_tax_sum);k++}if($.varPrintType=="V"){var params={report:"report_HRA2400_2",isPrint:false,data:{Info:rs[0]}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.varPrintType=="P"){var params={report:"report_HRA2400_2",isPrint:true,data:{Info:rs[0]}};g_printBrowser.callPrint(params)}}}else{if($.cmbPrintType.getValue()=="20"||$.cmbPrintType.getValue()=="30"){for(var i in rs[0]){rs[0][i].tax_site_stamp=convertByteArrayToImageSource(rs[0][i].tax_site_stamp);var arr=[rs[0][i],rs[1][i]];rs[0][i]=mergeObjectProperty(arr)}if($.varPrintType=="V"){var params={report:"report_HRA2400_1",isPrint:false,data:{Info:rs[0]}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.varPrintType=="P"){var params={report:"report_HRA2400_1",isPrint:true,data:{Info:rs[0]}};g_printBrowser.callPrint(params)}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPrint"){$.varPrintType="P";searchData()}else{if(id=="btnView"){$.varPrintType="V";searchData()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEarner"){var param={earner_code:$.txtEarner.getValue()||"",earner_name:$.bteEarner.getText()||""};g_main.openPopup("popEarner.html","popEarner","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){if(id=="bteEarner"){if($.bteEarner.getText()==""){$.txtEarner.setValue("")}}};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEarner"){if($.popUpCallId=="bteEarner"){$.txtEarner.setValue(popResult.earner_code);$.bteEarner.setValue(popResult.earner_code);$.bteEarner.setText(popResult.earner_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>