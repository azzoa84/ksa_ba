<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblYear=null;$.lblSite=null;$.lblDate=null;$.lblWave=null;$.lblType=null;$.lblEarner=null;$.lblProduct=null;$.lblPrint=null;$.lblPrintType=null;$.lblPrintType2=null;$.dteYear=null;$.cmbSite=null;$.dteStart=null;$.dteEnd=null;$.cmbType=null;$.txtEarner=null;$.bteEarner=null;$.cmbProduct=null;$.dtePrint=null;$.cmbPrintType=null;$.cmbPrintType2=null;$.btnPrint=null;$.btnView=null;$.lblLabel1=null;$.lblLabel2=null;$.lblLabel3=null;$.memHead=null;$.memBody=null;$.memFoot=null;$.btnExcel=null;$.chkCheck=null;$.panQuery=null;$.varPrintType="";$.varHead="";$.varBody="";$.varFoot="";function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRA3410_Q",[workType,$.dteYear.getValue(),$.cmbSite.getValue(),$.dteStart.getValue(),$.dteEnd.getValue(),$.cmbType.getValue(),$.txtEarner.getValue(),$.cmbProduct.getValue(),$.dtePrint.getValue(),$.chkCheck.getValue(),$.cmbPrintType.getValue()]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("HR..P_HRA3410_S",[workType,$.memHead.getValue(),$.memBody.getValue(),$.memFoot.getValue(),"#UserID#","#HostInfo#"]);return json}function searchData(workType){if(workType!="LETTER"){if(!validateControls([$.dteYear,$.cmbSite,$.dteStart,$.dteEnd,$.cmbType,$.cmbPrintType,$.cmbPrintType2])){return}}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveHistory(workType){if(!validateControls([$.dteYear,$.cmbSite,$.dteStart,$.dteEnd,$.cmbType,$.cmbPrintType,$.cmbPrintType2])){return}var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],workType,$);if(ds.errorCode=="MSG0002"){return true}else{MessageBoxShow("레터지 저장도중 오류가 발생하였습니다.");return false}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",225,0,750,400);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,10,100,20);$.lblYear.setText("귀속연도");$.lblSite=new FingerLabel(host,"lblSite",0,40,100,20);$.lblSite.setText("사업장");$.lblDate=new FingerLabel(host,"lblDate",0,70,100,20);$.lblDate.setText("지급기간");$.lblWave=new FingerLabel(host,"lblWave",205,70,20,20);$.lblWave.setText("~");$.lblType=new FingerLabel(host,"lblType",0,100,100,20);$.lblType.setText("거주구분");$.lblEarner=new FingerLabel(host,"lblEarner",0,130,100,20);$.lblEarner.setText("소득자");$.lblProduct=new FingerLabel(host,"lblProduct",0,160,100,20);$.lblProduct.setText("관리품목");$.lblPrint=new FingerLabel(host,"lblPrint",0,190,100,20);$.lblPrint.setText("출력일자");$.lblPrintType=new FingerLabel(host,"lblPrintType",0,220,100,20);$.lblPrintType.setText("출력구분");$.lblPrintType2=new FingerLabel(host,"lblPrintType2",0,250,100,20);$.lblPrintType2.setText("출력형식구분");$.dteYear=new FingerDateEdit(host,"dteYear",105,10,100,20);$.cmbSite=new FingerComboBox(host,"cmbSite",105,40,230,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,70,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",230,70,100,20);$.cmbType=new FingerComboBox(host,"cmbType",105,100,230,20);$.txtEarner=new FingerEdit(host,"txtEarner",105,130,80,20);$.bteEarner=new FingerButtonEdit(host,"bteEarner",190,130,140,20);$.bteEarner.setText("");$.cmbProduct=new FingerComboBox(host,"cmbProduct",105,160,230,20);$.dtePrint=new FingerDateEdit(host,"dtePrint",105,190,100,20);$.cmbPrintType=new FingerComboBox(host,"cmbPrintType",105,220,230,20);$.cmbPrintType2=new FingerComboBox(host,"cmbPrintType2",105,250,230,20);$.btnPrint=new FingerButton(host,"btnPrint",135,330,115,20);$.btnPrint.setText("출력");$.btnView=new FingerButton(host,"btnView",80,330,115,20);$.btnView.setText("미리보기");$.lblLabel1=new FingerLabel(host,"lblLabel1",345,0,100,20);$.lblLabel1.setText("레터지 수신부");$.lblLabel2=new FingerLabel(host,"lblLabel2",340,80,90,20);$.lblLabel2.setText("레터지 본문");$.lblLabel3=new FingerLabel(host,"lblLabel3",345,315,100,20);$.lblLabel3.setText("레터지 발신부");$.memHead=new FingerMemoEdit(host,"memHead",355,25,375,40);$.memBody=new FingerMemoEdit(host,"memBody",355,105,375,195);$.memFoot=new FingerMemoEdit(host,"memFoot",355,340,375,40);$.btnExcel=new FingerButton(host,"btnExcel",80,360,220,20);$.btnExcel.setText("대상자 리스트 Excel 파일생성");$.chkCheck=new FingerCheckBox(host,"chkCheck",100,285,140,20);$.chkCheck.setText("대상자리스트 포함");$.panQuery=new FingerPanel(host,"panQuery",0,0,345,315);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panMain.setBorder(true);$.dteYear.setDateFormat("yyyy");$.dteYear.setAllowBlank(false,"귀속연도");$.cmbSite.setAllowBlank(false,"사업장");$.dteStart.setAllowBlank(false,"지급기간 시작일");$.dteEnd.setAllowBlank(false,"지급기간 종료일");$.cmbType.setAllowBlank(false,"거주구분");$.cmbPrintType.setAllowBlank(false,"출력구분");$.cmbPrintType2.setAllowBlank(false,"출력형식구분");var today=getToday();$.dteYear.setValue(today.substr(0,4));$.dtePrint.setValue(today);$.txtEarner.setEnable(false);$.btnView.setVisible(false);$.panQuery.setBorder(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.btnPrint);$.panMain.add($.btnView);$.panMain.add($.lblLabel1);$.panMain.add($.lblLabel2);$.panMain.add($.lblLabel3);$.panMain.add($.memHead);$.panMain.add($.memBody);$.panMain.add($.memFoot);$.panMain.add($.btnExcel);$.panMain.add($.panQuery);$.panQuery.add($.lblYear);$.panQuery.add($.lblSite);$.panQuery.add($.lblDate);$.panQuery.add($.lblWave);$.panQuery.add($.lblType);$.panQuery.add($.lblEarner);$.panQuery.add($.lblProduct);$.panQuery.add($.lblPrint);$.panQuery.add($.lblPrintType);$.panQuery.add($.lblPrintType2);$.panQuery.add($.dteYear);$.panQuery.add($.cmbSite);$.panQuery.add($.dteStart);$.panQuery.add($.dteEnd);$.panQuery.add($.cmbType);$.panQuery.add($.txtEarner);$.panQuery.add($.bteEarner);$.panQuery.add($.cmbProduct);$.panQuery.add($.dtePrint);$.panQuery.add($.cmbPrintType);$.panQuery.add($.cmbPrintType2);$.panQuery.add($.chkCheck);$.cmbSite.setColumnConfig({id:"site_code"});$.cmbSite.setColumnConfig({id:"site_name"});$.cmbSite.setColumnConfig({id:"descr"});$.cmbSite.setColumn("site_code","site_name");$.cmbProduct.setEmptyRow(true);$.cmbPrintType2.setEmptyRow(true);var ds=bizComponentData2($,"Q1","L_ORG001|L_HRA015|L_HRA025|L_HRA036|L_HRA040");setComboBind([$.cmbSite,$.cmbType,$.cmbProduct,$.cmbPrintType,$.cmbPrintType2],ds);$.cmbPrintType.setValue("20")};$.callback=function(type,ds){if(type=="Q"){if(!ds.resultList[0][0]){MessageBoxShow("조건에 해당하는 데이터가 없습니다.");return}var rs=ds.resultList;if($.cmbType.getValue()=="1"){for(var i in rs[0]){for(var j=1;j<19;j++){rs[0][i]["pay_date_yyyy"+j]="";rs[0][i]["pay_date_mm"+j]="";rs[0][i]["pay_date_dd"+j]="";rs[0][i]["job_yyyy"+j]="";rs[0][i]["job_mm"+j]="";rs[0][i]["total_pay_amt"+j]="";rs[0][i]["need_expense_amt"+j]="";rs[0][i]["income_amt"+j]="";rs[0][i]["tax_rate"+j]="";rs[0][i]["income_tax_amt"+j]="";rs[0][i]["corporate_tax_amt"+j]="";rs[0][i]["local_tax_amt"+j]="";rs[0][i]["special_tax_amt"+j]="";rs[0][i]["tot_sum"+j]="";rs[0][i]["earner_code"+j]="";rs[0][i]["income_sec"+j]=""}rs[0][i].type2_1=1;rs[0][i].type2_2=0;rs[0][i].letter_head=$.memHead.getValue();rs[0][i].letter_body=$.memBody.getValue();rs[0][i].letter_foot=$.memFoot.getValue();if($.cmbPrintType2.getValue()=="10"){rs[0][i].type1_1=1;rs[0][i].type1_2=0}else{if($.cmbPrintType2.getValue()=="20"){rs[0][i].type1_1=0;rs[0][i].type1_2=1}}}for(var i in rs[0]){var k=1;for(var j=0;j<rs[1].length;j++){if(rs[0][i].earner_code==rs[1][j].earner_code){rs[0][i]["pay_date_yyyy"+k]=rs[1][j].pay_date_yyyy;rs[0][i]["pay_date_mm"+k]=rs[1][j].pay_date_mm;rs[0][i]["pay_date_dd"+k]=rs[1][j].pay_date_dd;rs[0][i]["job_yyyy"+k]=rs[1][j].job_yyyy;rs[0][i]["job_mm"+k]=rs[1][j].job_mm;rs[0][i]["total_pay_amt"+k]=setComma(rs[1][j].total_pay_amt)||0;rs[0][i]["need_expense_amt"+k]=setComma(rs[1][j].need_expense_amt)||0;rs[0][i]["income_amt"+k]=setComma(rs[1][j].income_amt)||0;rs[0][i]["tax_rate"+k]=setComma(rs[1][j].tax_rate)||0;rs[0][i]["income_tax_amt"+k]=setComma(rs[1][j].income_tax_amt)||0;rs[0][i]["corporate_tax_amt"+k]=setComma(rs[1][j].corporate_tax_amt)||0;rs[0][i]["local_tax_amt"+k]=setComma(rs[1][j].local_tax_amt)||0;rs[0][i]["special_tax_amt"+k]=setComma(rs[1][j].special_tax_amt)||0;rs[0][i]["tot_sum"+k]=setComma(rs[1][j].tot_sum)||0;rs[0][i]["earner_code"+k]=rs[1][j].earner_code;rs[0][i]["income_sec"+k]=rs[1][j].income_sec;rs[1].splice(j,1);j=0;k++}}}if($.varPrintType=="V"){if($.chkCheck.getValue()=="N"){var params={report:"report_HRA3410_1",isPrint:false,data:{Info:rs[0]}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.chkCheck.getValue()=="Y"){var params={report:"report_HRA3410_2",isPrint:false,data:{Info:rs[0],List:rs[3]}};g_main.openModelWithBusiness("popReportView",params,false,false)}}}else{if($.varPrintType=="P"){if($.chkCheck.getValue()=="N"){var params={report:"report_HRA3410_1",isPrint:true,data:{Info:rs[0]}};g_printBrowser.callPrint(params)}else{if($.chkCheck.getValue()=="Y"){var params={report:"report_HRA3410_2",isPrint:true,data:{Info:rs[0],List:rs[3]}};g_printBrowser.callPrint(params)}}}}}else{if($.cmbType.getValue()=="2"){for(var i in rs[0]){for(var j=1;j<8;j++){rs[0][i]["pay_date_yyyy"+j]="";rs[0][i]["pay_date_mm"+j]="";rs[0][i]["pay_date_dd"+j]="";rs[0][i]["job_yyyy"+j]="";rs[0][i]["job_mm"+j]="";rs[0][i]["total_pay_amt"+j]="";rs[0][i]["need_expense_amt"+j]="";rs[0][i]["income_amt"+j]="";rs[0][i]["tax_rate"+j]="";rs[0][i]["income_tax_amt"+j]="";rs[0][i]["corporate_tax_amt"+j]="";rs[0][i]["local_tax_amt"+j]="";rs[0][i]["special_tax_amt"+j]="";rs[0][i]["tot_sum"+j]="";rs[0][i]["earner_code"+j]="";rs[0][i]["income_sec"+j]=""}rs[0][i].letter_head=$.memHead.getText();rs[0][i].letter_body=$.memBody.getText();rs[0][i].letter_foot=$.memFoot.getText();rs[0][i].type1_1=1;rs[0][i].type1_2=0}for(var i in rs[0]){var k=1;for(var j=0;j<rs[1].length;j++){if(rs[0][i].earner_code==rs[1][j].earner_code){rs[0][i]["pay_date_yyyy"+k]=rs[1][j].pay_date_yyyy;rs[0][i]["pay_date_mm"+k]=rs[1][j].pay_date_mm;rs[0][i]["pay_date_dd"+k]=rs[1][j].pay_date_dd;rs[0][i]["job_yyyy"+k]=rs[1][j].job_yyyy;rs[0][i]["job_mm"+k]=rs[1][j].job_mm;rs[0][i]["total_pay_amt"+k]=setComma(rs[1][j].total_pay_amt)||0;rs[0][i]["need_expense_amt"+k]=setComma(rs[1][j].need_expense_amt)||0;rs[0][i]["income_amt"+k]=setComma(rs[1][j].income_amt)||0;rs[0][i]["tax_rate"+k]=setComma(rs[1][j].tax_rate)||0;rs[0][i]["income_tax_amt"+k]=setComma(rs[1][j].income_tax_amt)||0;rs[0][i]["corporate_tax_amt"+k]=setComma(rs[1][j].corporate_tax_amt)||0;rs[0][i]["local_tax_amt"+k]=setComma(rs[1][j].local_tax_amt)||0;rs[0][i]["special_tax_amt"+k]=setComma(rs[1][j].special_tax_amt)||0;rs[0][i]["tot_sum"+k]=setComma(rs[1][j].tot_sum)||0;rs[0][i]["earner_code"+k]=rs[1][j].earner_code;rs[0][i]["income_sec"+k]=rs[1][j].income_sec;rs[1].splice(j,1);j=0;k++}}}if($.varPrintType=="V"){if($.chkCheck.getValue()=="N"){var params={report:"report_HRA3410_ETCIncome_1",isPrint:false,data:{Info:rs[0]}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.chkCheck.getValue()=="Y"){var params={report:"report_HRA3410_ETCIncome_2",isPrint:false,data:{Info:rs[0],List:rs[3]}};g_main.openModelWithBusiness("popReportView",params,false,false)}}}else{if($.varPrintType=="P"){if($.chkCheck.getValue()=="N"){var params={report:"report_HRA3410_ETCIncome_1",isPrint:true,data:{Info:rs[0]}};g_printBrowser.callPrint(params)}else{if($.chkCheck.getValue()=="Y"){var params={report:"report_HRA3410_ETCIncome_2",isPrint:true,data:{Info:rs[0],List:rs[3]}};g_printBrowser.callPrint(params)}}}}}}}else{if(type=="LETTER"){}else{if(type=="EXCEL"){var column=[{headertext:"순번",datatype:"number",datafield:"seq",ishidden:false},{headertext:"소득자코드",datatype:"string",datafield:"earner_code",width:"100px",ishidden:true},{headertext:"소득자명",datatype:"string",datafield:"earner_name",ishidden:false,width:"120px"},{headertext:"상호",datatype:"string",datafield:"comp_name",ishidden:false,width:"200px"},{headertext:"소속",datatype:"string",datafield:"belong_to",ishidden:false,width:"150px"},{headertext:"우편번호",datatype:"string",datafield:"zip_code",ishidden:false,width:"100px"},{headertext:"주소",datatype:"string",datafield:"address",ishidden:false,width:"300px"}];excelDown(ds.resultList[0],column)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.varHead=$.memHead.getValue();$.varBody=$.memBody.getValue();$.varFoot=$.memFoot.getValue();if(id=="btnPrint"){$.varPrintType="P";if(saveHistory("N")){searchData("Q")}}else{if(id=="btnView"){$.varPrintType="V";if(saveHistory("N")){searchData("Q")}}else{if(id=="btnExcel"){searchData("EXCEL")}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEarner"){var param={earner_code:$.txtEarner.getValue()||"",earner_name:$.bteEarner.getText()||""};g_main.openPopup("popHRA021.html","popHRA021","소득자정보",400,585,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popHRA021"){if(popResult!=null){$.txtEarner.setValue(popResult.earner_code);$.bteEarner.setText(popResult.earner_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>