<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblYear=null;$.lblSite=null;$.lblDate=null;$.lblWave=null;$.lblQuarter=null;$.lblEarner=null;$.lblPrint=null;$.lblPrintType=null;$.dteYear=null;$.cmbSite=null;$.dteStart=null;$.dteEnd=null;$.cmbQuarter=null;$.txtEarner=null;$.bteEarner=null;$.dtePrint=null;$.cmbPrintType=null;$.btnPrint=null;$.btnView=null;$.lblType=null;$.cmbType=null;$.varPrintType="";$.varWowrkType="";function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRA4500_Q",[workType,$.dteYear.getValue(),$.cmbSite.getValue(),$.cmbQuarter.getValue(),$.txtEarner.getValue(),$.dtePrint.getValue(),$.cmbPrintType.getValue(),$.cmbType.getValue(),$.dteStart.getValue(),$.dteEnd.getValue()]);return json}function searchData(){if(!validateControls([$.dteYear,$.cmbSite,$.dteStart,$.dteEnd,$.cmbQuarter,$.dtePrint,$.cmbPrintType,$.cmbType])){return}var workType="";if($.cmbPrintType.getValue()=="01"){$.varWowrkType="PROVIDER"}else{$.varWowrkType="PAYE"}var json=createJSON_Q($.varWowrkType);callQuery(["req",json],"REPORT",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",420,0,360,310);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,10,100,20);$.lblYear.setText("귀속연도");$.lblSite=new FingerLabel(host,"lblSite",0,40,100,20);$.lblSite.setText("사업장");$.lblDate=new FingerLabel(host,"lblDate",0,130,100,20);$.lblDate.setText("지급기간");$.lblWave=new FingerLabel(host,"lblWave",205,130,20,20);$.lblWave.setText("~");$.lblQuarter=new FingerLabel(host,"lblQuarter",0,100,100,20);$.lblQuarter.setText("지급분기");$.lblEarner=new FingerLabel(host,"lblEarner",0,160,100,20);$.lblEarner.setText("소득자");$.lblPrint=new FingerLabel(host,"lblPrint",0,190,100,20);$.lblPrint.setText("출력일자");$.lblPrintType=new FingerLabel(host,"lblPrintType",0,220,100,20);$.lblPrintType.setText("출력구분");$.dteYear=new FingerDateEdit(host,"dteYear",105,10,100,20);$.cmbSite=new FingerComboBox(host,"cmbSite",105,40,230,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,130,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",230,130,100,20);$.cmbQuarter=new FingerComboBox(host,"cmbQuarter",105,100,230,20);$.txtEarner=new FingerEdit(host,"txtEarner",105,160,80,20);$.bteEarner=new FingerButtonEdit(host,"bteEarner",190,160,140,20);$.bteEarner.setText("");$.dtePrint=new FingerDateEdit(host,"dtePrint",105,190,100,20);$.cmbPrintType=new FingerComboBox(host,"cmbPrintType",105,220,230,20);$.btnPrint=new FingerButton(host,"btnPrint",165,265,100,20);$.btnPrint.setText("출력");$.btnView=new FingerButton(host,"btnView",95,265,100,20);$.btnView.setText("미리보기");$.lblType=new FingerLabel(host,"lblType",0,70,100,20);$.lblType.setText("지급일자구분");$.cmbType=new FingerComboBox(host,"cmbType",105,70,230,20);$.panMain.setBorder(true);$.dteYear.setDateFormat("yyyy");$.dteYear.setAllowBlank(false,"귀속연도");$.cmbSite.setAllowBlank(false,"사업장");$.dteStart.setAllowBlank(false,"지급기간 시작일");$.dteEnd.setAllowBlank(false,"지급기간 종료일");$.cmbQuarter.setAllowBlank(false,"지급분기");$.cmbPrintType.setAllowBlank(false,"출력구분");$.cmbType.setAllowBlank(false,"지급일자구분");$.dtePrint.setAllowBlank(false,"출력일자");$.txtEarner.setEnable(false);$.cmbQuarter.setEnable(false);$.btnView.setVisible(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.lblYear);$.panMain.add($.lblSite);$.panMain.add($.lblDate);$.panMain.add($.lblWave);$.panMain.add($.lblQuarter);$.panMain.add($.lblEarner);$.panMain.add($.lblPrint);$.panMain.add($.lblPrintType);$.panMain.add($.dteYear);$.panMain.add($.cmbSite);$.panMain.add($.dteStart);$.panMain.add($.dteEnd);$.panMain.add($.cmbQuarter);$.panMain.add($.txtEarner);$.panMain.add($.bteEarner);$.panMain.add($.dtePrint);$.panMain.add($.cmbPrintType);$.panMain.add($.btnPrint);$.panMain.add($.btnView);$.panMain.add($.lblType);$.panMain.add($.cmbType);relocateChildIndexInPanel([$.panMain]);$.cmbSite.setColumnConfig({id:"site_code"});$.cmbSite.setColumnConfig({id:"site_name"});$.cmbSite.setColumnConfig({id:"descr"});$.cmbSite.setColumn("site_code","site_name");$.cmbType.addItem("Q","분기별");$.cmbType.addItem("D","일자별");var ds=bizComponentData2($,"Q1","L_ORG001|L_COM021|L_HRA028");setComboBind([$.cmbSite,$.cmbQuarter,$.cmbPrintType],ds);var today=getToday();$.dteYear.setValue(today.substr(0,4));$.dteStart.setValue(today);$.dteEnd.setValue(today);$.dtePrint.setValue(today);$.cmbType.setValue("D");switch(today.substr(4,2)){case"01":case"02":case"03":$.cmbQuarter.setValue("1");break;case"04":case"05":case"06":$.cmbQuarter.setValue("2");break;case"07":case"08":case"09":$.cmbQuarter.setValue("3");break;case"10":case"11":case"12":$.cmbQuarter.setValue("4");break}$.cmbPrintType.setValue("02")};$.callback=function(type,ds){if(type=="REPORT"){if(!ds.resultList[0][0]){MessageBoxShow("조건에 해당하는 데이터가 없습니다.");return}var rs=ds.resultList;var printDate={year:$.dtePrint.getValue().substr(0,4),month:$.dtePrint.getValue().substr(4,2),day:$.dtePrint.getValue().substr(6,2)};if($.varWowrkType=="PROVIDER"){rs[0][0].tax_site_stamp=convertByteArrayToImageSource(rs[0][0].tax_site_stamp);for(var i in rs[1]){switch(rs[1][i].quarter){case"1":rs[1][i].quarter_type1=1;rs[1][i].quarter_type2=0;rs[1][i].quarter_type3=0;rs[1][i].quarter_type4=0;break;case"2":rs[1][i].quarter_type1=0;rs[1][i].quarter_type2=1;rs[1][i].quarter_type3=0;rs[1][i].quarter_type4=0;break;case"3":rs[1][i].quarter_type1=0;rs[1][i].quarter_type2=0;rs[1][i].quarter_type3=1;rs[1][i].quarter_type4=0;break;case"4":rs[1][i].quarter_type1=0;rs[1][i].quarter_type2=0;rs[1][i].quarter_type3=0;rs[1][i].quarter_type4=1;break;default:break}}if(rs[3].length<=0){rs[3][0]={seq:"",earner_name:"",tel:"",foreign_type:"",social_no:"",social_no1:"",social_no2:"",pay_mm_1:"",pay_month_1:"",work_mm_1:"",work_day_1:"",total_pay_sum_1:"",non_taxable_sum_1:"",income_sum_1:"",local_tax_sum_1:"",pay_mm_2:"",pay_month_2:"",work_mm_2:"",work_day_2:"",total_pay_sum_2:"",non_taxable_sum_2:"",income_sum_2:"",local_tax_sum_2:"",pay_mm_3:"",pay_month_3:"",work_mm_3:"",work_day_3:"",total_pay_sum_3:"",non_taxable_sum_3:"",income_sum_3:"",local_tax_sum_3:"",pay_mm_4:"",pay_month_4:"",work_mm_4:"",work_day_4:"",total_pay_sum_4:"",non_taxable_sum_4:"",income_sum_4:"",local_tax_sum_4:"",pay_mm_5:"",pay_month_5:"",work_mm_5:"",work_day_5:"",total_pay_sum_5:"",non_taxable_sum_5:"",income_sum_5:"",local_tax_sum_5:""}}if($.varPrintType=="V"){var params={report:"report_HRA4500_2",isPrint:false,data:{Info1:rs[0],Info2:rs[1],List:rs[2],List2:rs[3],Print:printDate}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.varPrintType=="P"){var params={report:"report_HRA4500_2",isPrint:true,data:{Info1:rs[0],Info2:rs[1],List:rs[2],List2:rs[3],Print:printDate}};g_printBrowser.callPrint(params)}}}else{if($.varWowrkType=="PAYE"){for(var i in rs[0]){rs[0][i].foreign_type=(rs[0][i].foreign_type=="1"?"( 아니오 )":"( 예 )");if($.cmbType.getValue()=="D"){rs[0][i].work_day_label="(15) 근무일"}else{if($.cmbType.getValue()=="Q"){rs[0][i].work_day_label="(15) 근무일수"}}rs[0][i].tax_site_stamp=convertByteArrayToImageSource(rs[0][i].tax_site_stamp);log(rs[0][i].print_type1);if($.cmbPrintType.getValue()=="03"){rs[0][i].print_type1=1;rs[0][i].print_type2=0}else{if($.cmbPrintType.getValue()=="02"){rs[0][i].print_type1=0;rs[0][i].print_type2=1}}switch(rs[0][i].quarter){case"1":rs[0][i].quarter_type1=1;rs[0][i].quarter_type2=0;rs[0][i].quarter_type3=0;rs[0][i].quarter_type4=0;break;case"2":rs[0][i].quarter_type1=0;rs[0][i].quarter_type2=1;rs[0][i].quarter_type3=0;rs[0][i].quarter_type4=0;break;case"3":rs[0][i].quarter_type1=0;rs[0][i].quarter_type2=0;rs[0][i].quarter_type3=1;rs[0][i].quarter_type4=0;break;case"4":rs[0][i].quarter_type1=0;rs[0][i].quarter_type2=0;rs[0][i].quarter_type3=0;rs[0][i].quarter_type4=1;break;default:break}}if($.varPrintType=="V"){var params={report:"report_HRA4500_1",isPrint:false,data:{Info:rs[0],List:rs[1],Print:printDate}};g_main.openModelWithBusiness("popReportView",params,false,false)}else{if($.varPrintType=="P"){var params={report:"report_HRA4500_1",isPrint:true,data:{Info:rs[0],List:rs[1],Print:printDate}};g_printBrowser.callPrint(params)}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPrint"){$.varPrintType="P";searchData()}else{if(id=="btnView"){$.varPrintType="V";searchData()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEarner"){var param={earner_code:$.txtEarner.getValue()||"",earner_name:$.bteEarner.getText()||""};g_main.openPopup("popEarner.html","popEarner","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){if(id=="bteEarner"){if($.bteEarner.getText()==""){$.txtEarner.setValue("")}}};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbType"){if(value=="D"){$.cmbQuarter.setEnable(false);$.dteStart.setEnable(true);$.dteEnd.setEnable(true)}else{if(value=="Q"){$.cmbQuarter.setEnable(true);$.dteStart.setEnable(false);$.dteEnd.setEnable(false)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEarner"){if($.popUpCallId=="bteEarner"){$.txtEarner.setValue(popResult.earner_code);$.bteEarner.setValue(popResult.earner_code);$.bteEarner.setText(popResult.earner_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>