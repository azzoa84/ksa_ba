<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.panImage=null;$.lblType=null;$.cmbType=null;$.grdList=null;$.img1=null;$.img2=null;$.img3=null;$.btnSearch=null;$.varImgData={img1:"",img2:"",img3:""};$.deleteRows=[];function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRB1400_Q",[workType,$.cmbType.getValue()]);return json}function createJSON_S(workType){var json="";var rows=[];var cRow=$.grdList.getChangedRows();if($.deleteRows.length>0){for(var i=0;i<$.deleteRows.length;i++){cRow.push($.deleteRows[i])}}if(cRow.length<1){return"NOROW"}for(var i in cRow){if(cRow[i].wf_line_seq.toString()==""){MessageBoxShow("결재순번 은(는) 필수입력 항목입니다.");return"FALSE"}else{if(!cRow[i].wf_disp_title){MessageBoxShow("표시명칭 은(는) 필수입력 항목입니다.");return"FALSE"}}rows.push([cRow[i].rowType,$.cmbType.getValue(),Number(cRow[i].wf_line_seq),cRow[i].wf_disp_title,cRow[i].descr||"",cRow[i].use_yn||"Y"])}if(!wf_line_seq_Check()){return"FALSE"}json=createExecuteParamInfo("HR..P_HRB1400_S",rows);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("HR..P_HRB1400_S1_B64",["S",$.cmbType.getValue(),$.img1.getUploadParam()["image_base64"]||"",$.img2.getUploadParam()["image_base64"]||"",$.img3.getUploadParam()["image_base64"]||""]);return json}function searchData(){if(!validateControls([$.cmbType])){return}var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function saveData(workType){var json=createJSON_S(workType);if(json&&json!="NOROW"&&json!="FALSE"){var ds=callExecuteSync(["req",json],workType,$);if(ds){var rs=ds.resultList;if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){MessageBoxShow(rs[i].errorCode+"</br>"+rs[i].errorMsg);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}}}else{return}}else{if(json=="FALSE"){return}}if($.img1.getUploadParam()||$.img2.getUploadParam()||$.img3.getUploadParam()){saveImage()}else{MessageBoxShow("정상적으로 저장되었습니다.");searchData()}}function saveImage(){var json=createJSON_S2();if(json){var ds=callExecuteSync(["req",json],"D",$);if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 저장되었습니다.");searchData()}}}function wf_line_seq_Check(){for(var i=0;i<$.grdList.getRowCount();i++){for(var j=i+1;j<$.grdList.getRowCount();j++){if($.grdList.getValue(i,"wf_line_seq")==$.grdList.getValue(j,"wf_line_seq")){MessageBoxShow("결재순번은 중복될 수 없습니다.");$.grdList.selectRow(j);return false}}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,65,1200,350);$.panList.setText("결재란 설정");$.panList.setBottomLine(true);$.panImage=new FingerPanel(host,"panImage",0,430,1200,275);$.panImage.setText("사용 이미지 설정");$.panImage.setBottomLine(true);$.lblType=new FingerLabel(host,"lblType",0,15,100,20);$.lblType.setText("결재문서유형");$.cmbType=new FingerComboBox(host,"cmbType",105,15,180,20);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,305);$.img1=new FingerImage(host,"img1",20,15,220,200);$.img2=new FingerImage(host,"img2",270,15,220,200);$.img3=new FingerImage(host,"img3",520,15,220,200);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panQuery.setBorder(true);$.panList.addButtons(["btnDelete","btnSave","btnNew"]);$.panList.disableButton(["btnDelete","btnSave","btnNew"]);$.grdList.setColumns([new FingerDataGridColumn("wf_line_seq",200,"right","string",[{text:"결재순번",css:"col_chk"}]),new FingerDataGridColumn("wf_disp_title",200,"left","string",[{text:"표시명칭",css:"col_chk"}]),new FingerDataGridColumn("descr",300,"left","string","비 고"),new FingerDataGridColumn("use_yn",100,"center","checkbox","사용여부")]);$.grdList.init({panel:$.panList,nonExcel:true,eventCellReadOnly:true});$.grdList.setBorder(false);$.grdList.setEditable(true);$.cmbType.setAllowBlank(false,"결재문서유형");$.imgGroup=new FingerImageGroup([$.img1,$.img2,$.img3]);$.img1.setMode("N");$.img2.setMode("N");$.img3.setMode("N");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panImage);$.panQuery.add($.lblType);$.panQuery.add($.cmbType);$.panQuery.add($.btnSearch);$.panList.add($.grdList);$.panImage.add($.img1);$.panImage.add($.img2);$.panImage.add($.img3);$.cmbType.setEmptyRow(true);var ds=bizComponentData2($,"Q1","L_HRB015");setComboBind([$.cmbType],ds)};$.callback=function(type,ds){if(type=="Q"){$.deleteRows=[];var rs=ds.resultList[0];for(var i in ds.resultList[0]){ds.resultList[0][i].wf_line_seq_readonly=true}setDataGrid([$.grdList],ds);$.panList.enableButton(["btnDelete","btnSave","btnNew"]);$.img1.setValue("");$.img2.setValue("");$.img3.setValue("");$.img1.setMode("N");$.img2.setMode("N");$.img3.setMode("N");if(ds.resultList[1].length>0){if(ds.resultList[1][0].img1){$.img1.setValue(ds.get(1,0,"img1"));$.img1.setMode("U")}else{if(ds.resultList[1][0].img2){$.img2.setValue(ds.get(1,0,"img2"));$.img2.setMode("U")}else{if(ds.resultList[1][0].img3){$.img3.setValue(ds.get(1,0,"img3"));$.img3.setMode("U")}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchData()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbType"){searchData()}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="wf_line_seq"){if(isNaN(nValue)){$.grdList.setValue(rId,cInd,oValue||0);return}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnNew"){$.grdList.addRow({rowType:"N",wf_line_seq:0,wf_disp_title:"",descr:"",use_yn:"Y"})}else{if(btnId=="btnSave"){$.grdList.editStop();saveData("")}else{if(btnId=="btnDelete"){var rId=$.grdList.getSelectedRowIdx();if(!rId||rId<=0){return}if($.grdList.getValue(rId,"rowType")=="N"){$.grdList.deleteRow(rId)}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare){$.grdList.getItem(rId).rowType="D";$.deleteRows.push($.grdList.getValue(rId));$.grdList.deleteCurrentRow()}})}}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){}};</script>