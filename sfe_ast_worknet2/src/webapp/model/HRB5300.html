<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMaster=null;$.panDetail=null;$.panResult=null;$.panTab1=null;$.panTab2=null;$.lblSite=null;$.lblType1=null;$.lblType2=null;$.lblType3=null;$.cmbSite=null;$.cmbType1=null;$.cmbType2=null;$.cmbType3=null;$.grdMaster=null;$.tabDetail=null;$.grdPay=null;$.grdWork=null;$.btnSearch=null;$.lblPayFormula=null;$.lblPayFormulaDesc=null;$.txtPayFormula=null;$.txtPayFormulaDesc=null;$.btnNum1=null;$.btnNum2=null;$.btnNum3=null;$.btnNum4=null;$.btnNum5=null;$.btnNum6=null;$.btnNum7=null;$.btnNum8=null;$.btnNum9=null;$.btnNum0=null;$.btnNum00=null;$.btnDot=null;$.btnPlus=null;$.btnMinus=null;$.btnMulti=null;$.btnDivide=null;$.btnLeftParent=null;$.btnRightParent=null;$.btnClear=null;$.btnAC=null;$.varPayItemCode="";function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRB5300_Q",[workType,$.cmbType1.getValue(),$.cmbSite.getValue(),$.cmbType2.getValue(),$.cmbType3.getValue(),(workType=="MASTER"?"":$.varPayItemCode)]);return json}function createJSON_S(workType){var rows=[];var aRows=$.grdMaster.getAllRows();for(var i in aRows){if(aRows[i].rowType=="U"||aRows[i].pay_formula!=aRows[i].pay_formula_tmp){aRows[i].pay_formula=aRows[i].pay_formula.replace(/&lt;/gi,"<").replace(/&gt;/gi,">");rows.push([workType,$.cmbSite.getValue(),$.cmbType1.getValue(),$.cmbType2.getValue(),aRows[i].chk_yn,aRows[i].pay_item_code,aRows[i].pay_formula,aRows[i].pay_formula_desc,aRows[i].apply_max_yn,aRows[i].apply_max_amt,aRows[i].apply_min_yn,aRows[i].apply_min_amt,aRows[i].calculate_seq,aRows[i].descr,"#UserID#","#HostInfo#"])}}if(rows.length<=0){return}return createExecuteParamInfo("HR..P_HRB5300_S",rows)}function searchList(workType){if(!validateControls([$.cmbSite,$.cmbType1,$.cmbType2])){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveData(){if(!validateControls([$.cmbSite,$.cmbType1,$.cmbType2])){return}var json=createJSON_S("N");if(json){callExecute(["req",json],"N",$)}}function calcButtonEnable(bool){$.btnNum1.setEnable(bool);$.btnNum2.setEnable(bool);$.btnNum3.setEnable(bool);$.btnNum4.setEnable(bool);$.btnNum5.setEnable(bool);$.btnNum6.setEnable(bool);$.btnNum7.setEnable(bool);$.btnNum8.setEnable(bool);$.btnNum9.setEnable(bool);$.btnNum0.setEnable(bool);$.btnNum00.setEnable(bool);$.btnDot.setEnable(bool);$.btnPlus.setEnable(bool);$.btnMinus.setEnable(bool);$.btnMulti.setEnable(bool);$.btnDivide.setEnable(bool);$.btnLeftParent.setEnable(bool);$.btnRightParent.setEnable(bool);$.btnClear.setEnable(bool);$.btnAC.setEnable(bool)}function calcButton(val){if(val=="CLEAR"){var var1=$.txtPayFormula.getValue(),var2=$.txtPayFormulaDesc.getValue();if(var1==""||var2==""){return}if(var1.substr(var1.length-1,1)==">"){for(var i=var1.length-2;i>=0;i--){if(var1.substr(i,1)=="<"){var1=var1.substr(0,i);break}}}else{var1=var1.substr(0,var1.length-1)}if(var2.substr(var2.length-1,1)==">"){for(var i=var2.length-2;i>=0;i--){if(var2.substr(i,1)=="<"){var2=var2.substr(0,i);break}}}else{var2=var2.substr(0,var2.length-1)}$.txtPayFormula.setValue(var1);$.txtPayFormulaDesc.setValue(var2)}else{if(val=="AC"){$.txtPayFormula.setValue("");$.txtPayFormulaDesc.setValue("")}else{$.txtPayFormula.setValue($.txtPayFormula.getValue()+val);$.txtPayFormulaDesc.setValue($.txtPayFormulaDesc.getValue()+val)}}var MrId=$.grdMaster.getSelectedRowIdx();$.grdMaster.setValue(MrId,"pay_formula",$.txtPayFormula.getValue().replace(/</gi,"&lt;").replace(/>/gi,"&gt;"));$.grdMaster.setValue(MrId,"pay_formula_desc",$.txtPayFormulaDesc.getValue())}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,840);$.panMain.setText("");$.panMain.setBottomLine(true);$.panMaster=new FingerPanel(host,"panMaster",0,0,1200,320);$.panMaster.setText("급여체계별 급여항목");$.panMaster.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",0,330,1200,330);$.panDetail.setText("급여 산식 설정");$.panDetail.setBottomLine(true);$.panResult=new FingerPanel(host,"panResult",0,670,1200,140);$.panResult.setText("급여 산식 결과");$.panResult.setBottomLine(true);$.panTab1=new FingerPanel(host,"panTab1",0,0,755,300);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,755,300);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.lblSite=new FingerLabel(host,"lblSite",0,15,100,20);$.lblSite.setText("사업장");$.lblType1=new FingerLabel(host,"lblType1",230,15,100,20);$.lblType1.setText("급여체계");$.lblType2=new FingerLabel(host,"lblType2",460,15,100,20);$.lblType2.setText("지급구분");$.lblType3=new FingerLabel(host,"lblType3",715,15,100,20);$.lblType3.setText("급여항목구분");$.cmbSite=new FingerComboBox(host,"cmbSite",105,15,140,20);$.cmbType1=new FingerComboBox(host,"cmbType1",335,15,140,20);$.cmbType2=new FingerComboBox(host,"cmbType2",565,15,140,20);$.cmbType3=new FingerComboBox(host,"cmbType3",820,15,140,20);$.grdMaster=new FingerDataGrid(host,"grdMaster",0,60,1200,215);$.tabDetail=new FingerTab(host,"tabDetail",0,0,757,285);$.grdPay=new FingerDataGrid(host,"grdPay",0,0,755,255);$.grdWork=new FingerDataGrid(host,"grdWork",0,0,755,255);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.lblPayFormula=new FingerLabel(host,"lblPayFormula",0,15,100,20);$.lblPayFormula.setText("급여산식");$.lblPayFormulaDesc=new FingerLabel(host,"lblPayFormulaDesc",0,50,100,20);$.lblPayFormulaDesc.setText("급여산식설명");$.txtPayFormula=new FingerEdit(host,"txtPayFormula",105,15,500,20);$.txtPayFormulaDesc=new FingerEdit(host,"txtPayFormulaDesc",105,50,500,20);$.btnNum1=new FingerButton(host,"btnNum1",865,45,60,40);$.btnNum1.setText("1");$.btnNum2=new FingerButton(host,"btnNum2",915,45,60,40);$.btnNum2.setText("2");$.btnNum3=new FingerButton(host,"btnNum3",965,45,60,40);$.btnNum3.setText("3");$.btnNum4=new FingerButton(host,"btnNum4",865,95,60,40);$.btnNum4.setText("4");$.btnNum5=new FingerButton(host,"btnNum5",915,95,60,40);$.btnNum5.setText("5");$.btnNum6=new FingerButton(host,"btnNum6",965,95,60,40);$.btnNum6.setText("6");$.btnNum7=new FingerButton(host,"btnNum7",865,145,60,40);$.btnNum7.setText("7");$.btnNum8=new FingerButton(host,"btnNum8",915,145,60,40);$.btnNum8.setText("8");$.btnNum9=new FingerButton(host,"btnNum9",965,145,60,40);$.btnNum9.setText("9");$.btnNum0=new FingerButton(host,"btnNum0",865,195,60,40);$.btnNum0.setText("0");$.btnNum00=new FingerButton(host,"btnNum00",915,195,60,40);$.btnNum00.setText("00");$.btnDot=new FingerButton(host,"btnDot",965,195,60,40);$.btnDot.setText(".");$.btnPlus=new FingerButton(host,"btnPlus",1015,45,60,40);$.btnPlus.setText("+");$.btnMinus=new FingerButton(host,"btnMinus",1015,95,60,40);$.btnMinus.setText("-");$.btnMulti=new FingerButton(host,"btnMulti",1015,145,60,40);$.btnMulti.setText("*");$.btnDivide=new FingerButton(host,"btnDivide",1015,195,60,40);$.btnDivide.setText("/");$.btnLeftParent=new FingerButton(host,"btnLeftParent",1065,45,60,40);$.btnLeftParent.setText("(");$.btnRightParent=new FingerButton(host,"btnRightParent",1065,95,60,40);$.btnRightParent.setText(")");$.btnClear=new FingerButton(host,"btnClear",1065,145,60,40);$.btnClear.setText("←");$.btnAC=new FingerButton(host,"btnAC",1065,195,60,40);$.btnAC.setText("AC");$.panMaster.addButtons(["btnSave"]);$.grdMaster.setColumns([new FingerDataGridColumn("chk_yn",50,"center","checkbox","사용"),new FingerDataGridColumn("pay_item_category",120,"left","string","급여항목구분",{readonly:true}),new FingerDataGridColumn("pay_item_code",120,"left","string","급여항목코드",{readonly:true}),new FingerDataGridColumn("pay_item_name",120,"left","string","급여항목명",{readonly:true}),new FingerDataGridColumn("summary_type",120,"left","string","집계방법구분",{readonly:true}),new FingerDataGridColumn("summary_related_code",120,"left","string","관련항목",{readonly:true}),new FingerDataGridColumn("calculate_seq",80,"right","int",[{text:"계산순서",css:"col_edit"}],{format:"int"}),new FingerDataGridColumn("apply_max_yn",120,"center","checkbox",[{text:"최대한도 적용",css:"col_edit"}]),new FingerDataGridColumn("apply_max_amt",120,"right","int",[{text:"최대한도값",css:"col_edit"}],{format:"int"}),new FingerDataGridColumn("apply_min_yn",120,"center","checkbox",[{text:"최소한도 적용",css:"col_edit"}]),new FingerDataGridColumn("apply_min_amt",120,"right","int",[{text:"최소한도값",css:"col_edit"}],{format:"int"}),new FingerDataGridColumn("descr",300,"left","string","메모"),new FingerDataGridColumn("pay_formula",400,"left","string","급여산식",{readonly:true}),new FingerDataGridColumn("pay_formula_tmp",99,"left","string","급여산식",{hidden:true}),new FingerDataGridColumn("pay_formula_desc",400,"left","string","급여산식설명",{readonly:true})]);$.grdMaster.init({panel:$.panMaster,scroll:"xy",eventCellReadOnly:true,leftSplit:1});$.grdMaster.setBorder(false);$.grdMaster.setEditable(true);$.grdPay.setColumns([new FingerDataGridColumn("pay_item_category",120,"left","string","급여항목구분"),new FingerDataGridColumn("pay_item_code",120,"left","string","항목코드"),new FingerDataGridColumn("pay_item_name",150,"left","string","항목명")]);$.grdPay.init();$.grdWork.setColumns([new FingerDataGridColumn("pay_item_code",120,"left","string","항목코드"),new FingerDataGridColumn("pay_item_name",150,"left","string","항목명")]);$.grdWork.init();$.tabDetail.addTab([{text:"급여항목",body:$.panTab1,width:150},{text:"근태항목",body:$.panTab2,width:150},]);$.cmbSite.setAllowBlank(false,"사업장");$.cmbType1.setAllowBlank(false,"급여체계");$.cmbType2.setAllowBlank(false,"지급구분");$.txtPayFormula.setEnable(false);$.txtPayFormulaDesc.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMaster);$.panMain.add($.panResult);$.panMain.add($.panDetail);$.panMaster.add($.grdMaster);$.panMaster.add($.cmbType3);$.panMaster.add($.cmbType2);$.panMaster.add($.cmbType1);$.panMaster.add($.cmbSite);$.panMaster.add($.lblType3);$.panMaster.add($.lblType2);$.panMaster.add($.lblType1);$.panMaster.add($.lblSite);$.panMaster.add($.btnSearch);$.panDetail.add($.tabDetail);$.panDetail.add($.btnNum1);$.panDetail.add($.btnNum2);$.panDetail.add($.btnNum3);$.panDetail.add($.btnNum4);$.panDetail.add($.btnNum5);$.panDetail.add($.btnNum6);$.panDetail.add($.btnNum7);$.panDetail.add($.btnNum8);$.panDetail.add($.btnNum9);$.panDetail.add($.btnNum0);$.panDetail.add($.btnNum00);$.panDetail.add($.btnDot);$.panDetail.add($.btnPlus);$.panDetail.add($.btnMinus);$.panDetail.add($.btnMulti);$.panDetail.add($.btnDivide);$.panDetail.add($.btnLeftParent);$.panDetail.add($.btnRightParent);$.panDetail.add($.btnClear);$.panDetail.add($.btnAC);$.panResult.add($.lblPayFormula);$.panResult.add($.lblPayFormulaDesc);$.panResult.add($.txtPayFormula);$.panResult.add($.txtPayFormulaDesc);$.panTab1.add($.grdPay);$.panTab2.add($.grdWork);$.cmbSite.setEmptyRow(true);$.cmbType1.setEmptyRow(true);$.cmbType2.setEmptyRow(true);$.cmbType3.setEmptyRow(true);$.cmbSite.setColumn("site_code","site_name");$.cmbType1.setColumn("pay_group_code","pay_group_name");var ds=bizComponentData2($,"Q1","L_ORG001|L_HRI010|L_HRB008|L_HRB009|L_HRB011|L_HRB012");setComboBind([$.cmbSite,$.cmbType1,$.cmbType2,$.cmbType3],ds);$.grdMaster.setColumnDropDownList("pay_item_category",ds.resultList[3]);$.grdMaster.setColumnDropDownList("summary_type",ds.resultList[4]);$.grdMaster.setColumnDropDownList("summary_related_code",ds.resultList[5]);$.grdPay.setColumnDropDownList("pay_item_category",ds.resultList[3]);$.cmbSite.setValue("1");calcButtonEnable(false)};$.callback=function(type,ds){if(type=="MASTER"){var rs=ds.resultList[0];for(var i in rs){rs[i].pay_item_category_readonly=true;rs[i].summary_type_readonly=true;rs[i].summary_related_code_readonly=true;rs[i].pay_formula=rs[i].pay_formula.replace(/</gi,"&lt;").replace(/>/g,"&gt;")}setDataGrid([$.grdMaster],ds);$.grdMaster.selectRow(0)}else{if(type=="DETAIL"){setDataGrid([$.grdPay,$.grdWork],ds);if(ds.resultList[2].length>0){$.txtPayFormula.setValue(ds.resultList[2][0].pay_formula.replace(/&lt;/gi,"<").replace(/&gt;/gi,">"));$.txtPayFormulaDesc.setValue(ds.resultList[2][0].pay_formula_desc)}else{$.txtPayFormula.setValue("");$.txtPayFormulaDesc.setValue("")}}else{if(type=="N"){if(ds){if(ds.errorCode=="MSG0000"){searchList("MASTER")}}else{searchList("MASTER")}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("MASTER")}else{if(id=="btnNum1"){calcButton("1")}else{if(id=="btnNum2"){calcButton("2")}else{if(id=="btnNum3"){calcButton("3")}else{if(id=="btnNum4"){calcButton("4")}else{if(id=="btnNum5"){calcButton("5")}else{if(id=="btnNum6"){calcButton("6")}else{if(id=="btnNum7"){calcButton("7")}else{if(id=="btnNum8"){calcButton("8")}else{if(id=="btnNum9"){calcButton("9")}else{if(id=="btnNum0"){calcButton("0")}else{if(id=="btnNum00"){calcButton("00")}else{if(id=="btnDot"){calcButton(".")}else{if(id=="btnPlus"){calcButton("+")}else{if(id=="btnMinus"){calcButton("-")}else{if(id=="btnMulti"){calcButton("*")}else{if(id=="btnDivide"){calcButton("/")}else{if(id=="btnLeftParent"){calcButton("(")}else{if(id=="btnRightParent"){calcButton(")")}else{if(id=="btnClear"){calcButton("CLEAR")}else{if(id=="btnAC"){calcButton("AC")}}}}}}}}}}}}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdMaster"){$.varPayItemCode=$.grdMaster.getValue(rId,"pay_item_code");log("summary_type "+$.grdMaster.getValue(rId,"summary_type"));if($.grdMaster.getValue(rId,"summary_type")=="FORMULA"){calcButtonEnable(true)}else{calcButtonEnable(false)}searchList("DETAIL")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){var MrId=$.grdMaster.getSelectedRowIdx();if(id=="grdPay"){if($.grdMaster.getValue(MrId,"summary_type")!="FORMULA"){return}$.txtPayFormula.setValue($.txtPayFormula.getValue()+"<"+$.grdPay.getValue(rId,"pay_item_code")+">");$.txtPayFormulaDesc.setValue($.txtPayFormulaDesc.getValue()+"<"+$.grdPay.getValue(rId,"pay_item_name")+">");$.grdMaster.setValue(MrId,"pay_formula",$.txtPayFormula.getValue().replace(/</gi,"&lt;").replace(/>/gi,"&gt;"));$.grdMaster.setValue(MrId,"pay_formula_desc",$.txtPayFormulaDesc.getValue())}else{if(id=="grdWork"){if($.grdMaster.getValue(MrId,"summary_type")!="FORMULA"){return}$.txtPayFormula.setValue($.txtPayFormula.getValue()+"<"+$.grdWork.getValue(rId,"pay_item_code")+">");$.txtPayFormulaDesc.setValue($.txtPayFormulaDesc.getValue()+"<"+$.grdWork.getValue(rId,"pay_item_name")+">");$.grdMaster.setValue(MrId,"pay_formula",$.txtPayFormula.getValue());$.grdMaster.setValue(MrId,"pay_formula_desc",$.txtPayFormulaDesc.getValue())}}};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panMaster"){if(btnId=="btnSave"){saveData()}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){}};</script>