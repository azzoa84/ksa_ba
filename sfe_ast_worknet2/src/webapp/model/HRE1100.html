<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panMaster=null;$.panInfo=null;$.panCopy=null;$.panTop=null;$.grdMaster=null;$.grdDetail=null;$.lbleval_year=null;$.ymdeval_year=null;$.lbleval_month=null;$.cmbeval_month=null;$.btnSearch=null;$.lbleval_year1=null;$.ymdeval_year1=null;$.lbleval_period=null;$.cmbeval_period=null;$.lbleval_name=null;$.txteval_name=null;$.lbleval_month1=null;$.ymdeval_month=null;$.lbleval_from_date=null;$.ymdeval_from_date=null;$.lbleval_to_date=null;$.ymdeval_to_date=null;$.lblweighted_rate=null;$.lblkpi_weighted_rate=null;$.numkpi_weighted_rate=null;$.lblkbi_weighted_rate=null;$.numkbi_weighted_rate=null;$.lblmemo=null;$.txtmemo=null;$.btnCopy=null;$.lbleval_year2=null;$.cmbeval_year2=null;$.lbleval_month2=null;$.cmbeval_month2=null;$.btnCopy1=null;$.btnDelete=null;$.visibleYN=null;$.varDeleteRows=[];var strStatus=false;function QueryClick(){fnQRY_P_HRE1100_Q("MASTER");$.panCopy.clear();$.panCopy.setVisible(false);$.panTop.setProperty(0,435,1200,230);$.visibleYN.setValue("Y");if($.grdMaster.getRowCount()<0){NewClick()}}function fnQRY_P_HRE1100_Q(workType){if(workType=="MASTER"){if(!validateControls([$.ymdeval_year])){return}}else{if(workType=="BEFORE"){if(!validateControls([$.ymdeval_year1,$.cmbeval_period,$.txteval_name,$.ymdeval_month,$.ymdeval_from_date,$.ymdeval_to_date])||!validateControls([$.cmbeval_year2,$.cmbeval_month2])){return}}}var streval_year="";var streval_month="";if(workType=="MASTER"){streval_year=$.ymdeval_year.getValue();streval_month=$.cmbeval_month.getValue()}else{if(workType=="BEFORE"){streval_year=$.cmbeval_year2.getValue();streval_month=$.cmbeval_month2.getValue()}else{streval_year=$.ymdeval_year1.getValue();streval_month=$.ymdeval_month.getValue()}}var json=createJSON_Q(workType,streval_year,streval_month);callQuery(["req",json],workType,$)}function createJSON_Q(workType,streval_year,streval_month){var json=createExecuteParamInfo("HR..P_HRE1100_Q",[workType,streval_year,streval_month]);return json}function focusedRowChanged(){var rId=$.grdMaster.getSelectedRowIdx();$.ymdeval_year1.setValue($.grdMaster.getValue(rId,"eval_year"));$.txteval_name.setValue($.grdMaster.getValue(rId,"eval_name"));$.ymdeval_month.setValue($.grdMaster.getValue(rId,"eval_month"));$.ymdeval_from_date.setValue($.grdMaster.getValue(rId,"eval_from_date"));$.ymdeval_to_date.setValue($.grdMaster.getValue(rId,"eval_to_date"));$.cmbeval_period.setValue($.grdMaster.getValue(rId,"eval_period"));$.numkpi_weighted_rate.setValue($.grdMaster.getValue(rId,"kpi_weighted_rate"));$.numkbi_weighted_rate.setValue($.grdMaster.getValue(rId,"kbi_weighted_rate"));fnQRY_P_HRE1100_Q("DETAIL");$.ymdeval_year1.setEnable(false);$.ymdeval_month.setEnable(false);strStatus=false}function NewClick(){$.panInfo.clear();$.grdDetail.clear();$.ymdeval_year1.setEnable(true);$.ymdeval_month.setEnable(true);$.panInfo.enableButton(["btnSave"]);strStatus=true}function fnSET_P_HRE1100_S(workType){if(!validateControls([$.ymdeval_year1,$.cmbeval_period,$.txteval_name,$.ymdeval_month,$.ymdeval_from_date,$.ymdeval_to_date])){return}var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],workType,$);var bResult=false;if(ds!=null){if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제 되었습니다.");bResult=true}else{if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"){bResult=true}else{bResult=false}}}return bResult}function createJSON_S(workType){var json=createExecuteParamInfo("HR..P_HRE1100_S",[workType,$.ymdeval_year1.getValue(),$.ymdeval_month.getValue(),$.cmbeval_period.getValue(),$.txteval_name.getValue(),$.numkpi_weighted_rate.getValue(),$.numkbi_weighted_rate.getValue(),$.ymdeval_from_date.getValue(),$.ymdeval_to_date.getValue(),$.txtmemo.getValue(),g_main.session.obj.EmpCode,"#HostInfo#"]);return json}function fnSET_P_HRE1100_S1(workType){if(!gridValidator($.grdDetail,"eval_category")||!gridValidator($.grdDetail,"eval_step")||!gridValidator($.grdDetail,"eval_step_from_date")||!gridValidator($.grdDetail,"eval_step_to_date")){return}var bResult=false;var changedRows=$.grdDetail.getChangedRows();if($.grdDetail.getRowCount()<0&&$.varDeleteRows.length==0){bResult=false}else{if(changedRows.length==0&&$.varDeleteRows.length==0){bResult=false}else{var json=createJSON_S1(workType);var ds=callExecuteSync(["req",json],workType,$)}}if(ds!=null){if(ds.errorCode=="MSG0003"){bResult=true}else{if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"){bResult=true}else{bResult=false}}}return bResult}function createJSON_S1(workType){var json="";if(workType==""){var changedRows=$.grdDetail.getChangedRows();var rows=[];if($.varDeleteRows!=""){for(var i in $.varDeleteRows){rows.push($.varDeleteRows[i])}}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,$.ymdeval_year1.getValue(),$.ymdeval_month.getValue(),changedRows[i].eval_step,changedRows[i].eval_category,getFormatDate(changedRows[i].eval_step_from_date,"yyyyMMdd"),getFormatDate(changedRows[i].eval_step_to_date,"yyyyMMdd"),changedRows[i].memo||"","#UserID#","#HostInfo#"])}json=createExecuteParamInfo("HR..P_HRE1100_S1",rows)}return json}function gridValidator(){if(arguments.length<2){return false}var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,965);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panMaster=new FingerPanel(host,"panMaster",0,60,1200,195);$.panMaster.setText("");$.panMaster.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,260,1200,165);$.panInfo.setText("평가기본정보");$.panInfo.setBottomLine(true);$.panCopy=new FingerPanel(host,"panCopy",0,435,1200,105);$.panCopy.setText("복사대상");$.panCopy.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,545,1200,415);$.panTop.setText("평가 일정 상세");$.panTop.setBottomLine(true);$.grdMaster=new FingerDataGrid(host,"grdMaster",0,0,1200,195);$.grdDetail=new FingerDataGrid(host,"grdDetail",0,0,1200,370);$.lbleval_year=new FingerLabel(host,"lbleval_year",0,15,100,20);$.lbleval_year.setText("평가년도");$.ymdeval_year=new FingerDateEdit(host,"ymdeval_year",105,15,140,20);$.lbleval_month=new FingerLabel(host,"lbleval_month",250,15,100,20);$.lbleval_month.setText("평가명");$.cmbeval_month=new FingerComboBox(host,"cmbeval_month",355,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.lbleval_year1=new FingerLabel(host,"lbleval_year1",0,15,100,20);$.lbleval_year1.setText("평가년도");$.ymdeval_year1=new FingerDateEdit(host,"ymdeval_year1",105,15,140,20);$.lbleval_period=new FingerLabel(host,"lbleval_period",250,15,100,20);$.lbleval_period.setText("평가시기");$.cmbeval_period=new FingerComboBox(host,"cmbeval_period",355,15,305,20);$.lbleval_name=new FingerLabel(host,"lbleval_name",665,15,100,20);$.lbleval_name.setText("평가명");$.txteval_name=new FingerEdit(host,"txteval_name",770,15,195,20);$.lbleval_month1=new FingerLabel(host,"lbleval_month1",0,45,100,20);$.lbleval_month1.setText("평가년월");$.ymdeval_month=new FingerDateEdit(host,"ymdeval_month",105,45,140,20);$.lbleval_from_date=new FingerLabel(host,"lbleval_from_date",250,45,100,20);$.lbleval_from_date.setText("평가기간");$.ymdeval_from_date=new FingerDateEdit(host,"ymdeval_from_date",355,45,140,20);$.lbleval_to_date=new FingerLabel(host,"lbleval_to_date",495,45,20,20);$.lbleval_to_date.setText("~");$.ymdeval_to_date=new FingerDateEdit(host,"ymdeval_to_date",520,45,140,20);$.lblweighted_rate=new FingerLabel(host,"lblweighted_rate",665,45,100,20);$.lblweighted_rate.setText("가중치");$.lblkpi_weighted_rate=new FingerLabel(host,"lblkpi_weighted_rate",770,45,40,20);$.lblkpi_weighted_rate.setText("업적");$.numkpi_weighted_rate=new FingerSpinEdit(host,"numkpi_weighted_rate",815,45,50,20);$.lblkbi_weighted_rate=new FingerLabel(host,"lblkbi_weighted_rate",870,45,40,20);$.lblkbi_weighted_rate.setText("역량");$.numkbi_weighted_rate=new FingerSpinEdit(host,"numkbi_weighted_rate",915,45,50,20);$.lblmemo=new FingerLabel(host,"lblmemo",0,75,100,20);$.lblmemo.setText("비고");$.txtmemo=new FingerEdit(host,"txtmemo",105,75,860,20);$.btnCopy=new FingerButton(host,"btnCopy",1080,75,120,20);$.btnCopy.setText("전기자료복사");$.lbleval_year2=new FingerLabel(host,"lbleval_year2",0,15,100,20);$.lbleval_year2.setText("평가년도");$.cmbeval_year2=new FingerComboBox(host,"cmbeval_year2",105,15,140,20);$.lbleval_month2=new FingerLabel(host,"lbleval_month2",250,15,100,20);$.lbleval_month2.setText("평가명");$.cmbeval_month2=new FingerComboBox(host,"cmbeval_month2",355,15,300,20);$.btnCopy1=new FingerButton(host,"btnCopy1",1080,15,120,20);$.btnCopy1.setText("전기자료복사");$.btnDelete=new FingerButton(host,"btnDelete",1055,15,80,20);$.btnDelete.setText("삭제");$.visibleYN=new FingerEdit(host,"visibleYN",1170,-40.5,30,20);$.panQuery.setBorder(true);$.visibleYN.setVisible(false);$.ymdeval_year.setDateFormat("yyyy");$.ymdeval_year1.setDateFormat("yyyy");$.ymdeval_month.setDateFormat("yyyymm");$.cmbeval_month.setEmptyRow(true);$.cmbeval_period.setEmptyRow(true);$.cmbeval_month2.setEmptyRow(true);$.ymdeval_year.setAllowBlank(false,"평가년도");$.ymdeval_year1.setAllowBlank(false,"평가년도");$.cmbeval_period.setAllowBlank(false,"평가시기");$.txteval_name.setAllowBlank(false,"평가명");$.ymdeval_month.setAllowBlank(false,"평가년월");$.ymdeval_from_date.setAllowBlank(false,"평가기간 시작일");$.ymdeval_to_date.setAllowBlank(false,"평가기간 종료일");$.cmbeval_year2.setAllowBlank(false,"평가년도");$.cmbeval_month2.setAllowBlank(false,"평가명");$.panInfo.addButtons(["btnSave","btnDelete","btnAdd","btnNew"]);$.cmbeval_month.setColumn("eval_month","eval_name");$.cmbeval_period.setColumn("sub_code","code_name");$.cmbeval_year2.setColumn("eval_year","eval_year1");$.cmbeval_month2.setColumn("eval_month","eval_name");$.grdMaster.setColumns([new FingerDataGridColumn("eval_year",120,"left","string","평가년도"),new FingerDataGridColumn("eval_month",120,"left","string","평가년월",{format:"s_ym"}),new FingerDataGridColumn("eval_period",120,"left","string","평가시기"),new FingerDataGridColumn("eval_name",160,"left","string","평가명"),new FingerDataGridColumn("eval_from_date",120,"left","date","평가일정(From)",{format:"s_ymd"}),new FingerDataGridColumn("eval_to_date",120,"left","date","평가일정(To)",{format:"s_ymd"}),new FingerDataGridColumn("kpi_weighted_rate",120,"right","string","업 적가중치(%)"),new FingerDataGridColumn("kbi_weighted_rate",120,"right","string","역량가중치(%)")]);$.grdMaster.init({scroll:"xy"});$.grdDetail.setColumns([new FingerDataGridColumn("eval_category",120,"left","string",{text:"평가구분",css:"col_chk"}),new FingerDataGridColumn("eval_step",150,"left","string",{text:"평가진행구분",css:"col_chk"}),new FingerDataGridColumn("eval_step_from_date",120,"left","date",{text:"일정(From)",css:"col_chk"},{format:"ymd"}),new FingerDataGridColumn("eval_step_to_date",120,"left","date",{text:"일정(To)",css:"col_chk"},{format:"ymd"}),new FingerDataGridColumn("memo",450,"left","string","비고")]);$.grdDetail.init({panel:$.panTop,scroll:"xy",eventCellReadOnly:true});$.grdDetail.setEditable(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panMaster);$.panMain.add($.panInfo);$.panMain.add($.panCopy);$.panMain.add($.panTop);$.panQuery.add($.lbleval_year);$.panQuery.add($.ymdeval_year);$.panQuery.add($.lbleval_month);$.panQuery.add($.cmbeval_month);$.panQuery.add($.btnSearch);$.panQuery.add($.btnDelete);$.panMaster.add($.grdMaster);$.panInfo.add($.lbleval_year1);$.panInfo.add($.ymdeval_year1);$.panInfo.add($.lbleval_period);$.panInfo.add($.cmbeval_period);$.panInfo.add($.lbleval_name);$.panInfo.add($.txteval_name);$.panInfo.add($.lbleval_month1);$.panInfo.add($.ymdeval_month);$.panInfo.add($.lbleval_from_date);$.panInfo.add($.ymdeval_from_date);$.panInfo.add($.lbleval_to_date);$.panInfo.add($.ymdeval_to_date);$.panInfo.add($.lblweighted_rate);$.panInfo.add($.lblkpi_weighted_rate);$.panInfo.add($.numkpi_weighted_rate);$.panInfo.add($.lblkbi_weighted_rate);$.panInfo.add($.numkbi_weighted_rate);$.panInfo.add($.lblmemo);$.panInfo.add($.txtmemo);$.panInfo.add($.btnCopy);$.panCopy.add($.lbleval_year2);$.panCopy.add($.cmbeval_year2);$.panCopy.add($.lbleval_month2);$.panCopy.add($.cmbeval_month2);$.panCopy.add($.btnCopy1);$.panCopy.add($.visibleYN);$.panTop.add($.grdDetail);$.ymdeval_year.setValue(getToday(""));var ds=bizComponentData2($,"Q1","L_HRE004|L_HRE010|L_HRE005|L_HRE003|L_HRE004");setComboBind([$.cmbeval_period,$.cmbeval_year2],ds);$.grdDetail.setColumnDropDownList("eval_category",ds.resultList[2]);$.grdDetail.setColumnDropDownList("eval_step",ds.resultList[3]);$.grdMaster.setColumnDropDownList("eval_period",ds.resultList[4]);QueryClick()};$.callback=function(type,ds){$.varDeleteRows=[];if(type=="MASTER"){setDataGrid([$.grdMaster],ds);$.grdMaster.selectRow(0)}else{if(type=="NEW"){setDataGrid([$.grdMaster],ds);$.grdMaster.selectRow(0)}else{if(type=="DETAIL"){for(var i=0;i<ds.resultList[0].length;i++){ds.resultList[0][i].eval_category_readonly=true;ds.resultList[0][i].eval_step_readonly=true;ds.resultList[0][i].eval_step_from_date=extFormat(ds.resultList[0][i].eval_step_from_date,"yyyyMMdd");ds.resultList[0][i].eval_step_to_date=extFormat(ds.resultList[0][i].eval_step_to_date,"yyyyMMdd")}setDataGrid([$.grdDetail],ds);$.grdDetail.selectRow(0)}else{if(type=="BEFORE"){if($.grdDetail.getRowCount()>0){for(var i=0;i<$.grdDetail.getRowCount();i++){$.varDeleteRows.push(["D",$.ymdeval_year1.getValue(),$.ymdeval_month.getValue(),$.grdDetail.getValue(i,"eval_step"),$.grdDetail.getValue(i,"eval_category"),getFormatDate($.grdDetail.getValue(i,"eval_step_from_date"),"yyyyMMdd"),getFormatDate($.grdDetail.getValue(i,"eval_step_to_date"),"yyyyMMdd"),$.grdDetail.getValue(i,"memo"),"#UserID#","#HostInfo#"])}$.grdDetail.clear()}for(var i=0;i<ds.resultList[0].length;i++){$.grdDetail.addRow({eval_category:ds.resultList[0][i].eval_category,eval_step:ds.resultList[0][i].eval_step})}for(var i=0;i<$.grdDetail.getRowCount();i++){$.grdDetail.setValue(i,"eval_step_from_date",extFormat($.ymdeval_from_date.getValue(),"yyyyMMdd"));$.grdDetail.setValue(i,"eval_step_to_date",extFormat($.ymdeval_to_date.getValue(),"yyyyMMdd"))}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){QueryClick()}else{if(id=="btnCopy"){if(!validateControls([$.ymdeval_year1,$.cmbeval_period,$.txteval_name,$.ymdeval_month,$.ymdeval_from_date,$.ymdeval_to_date])){return}if($.visibleYN.getValue()=="Y"){$.panCopy.setVisible(true);$.panTop.setProperty(0,545,1200,415);$.visibleYN.setValue("N")}else{$.panCopy.setVisible(false);$.panTop.setProperty(0,435,1200,415);$.visibleYN.setValue("Y")}}else{if(id=="btnCopy1"){confirmBoxShow("기존에 저장된 평가일정이 있는 경우 삭제됩니다. 계속 하시겠습니까?",function(){if(g_main.msgShare){fnQRY_P_HRE1100_Q("BEFORE")}})}else{if(id=="btnDelete"){var strMSG=$.txteval_name.getValue()+" 삭제하시겠습니까?";confirmBoxShow(strMSG,function(){if(g_main.msgShare){if(fnSET_P_HRE1100_S("D")){QueryClick()}var ds=bizComponentData2($,"Q1","L_HRE009");$.cmbeval_month.setColumn("eval_month","eval_name");setComboBind([$.cmbeval_month],ds)}})}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbeval_year2"){$.cmbeval_month2.clear();var ds=bizComponentData2($,"Q4","L_HRE009"," and eval_year = '"+$.cmbeval_year2.getValue()+"'");setComboBind([$.cmbeval_month2],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="ymdeval_year"){$.cmbeval_month.clear();var ds=bizComponentData2($,"Q4","L_HRE009"," and eval_year = '"+$.ymdeval_year.getValue()+"'");setComboBind([$.cmbeval_month],ds)}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdMaster"){if($.grdMaster.getRowCount()==0){return}focusedRowChanged()}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){NewClick()}else{if(btnId=="btnAdd"){$.grdDetail.addRow({})}else{if(btnId=="btnDelete"){var rId=$.grdDetail.getSelectedRowIdx();if($.grdDetail.getRowCount()==0){return}if($.grdDetail.getValue(rId,"rowType")=="N"){$.grdDetail.deleteRow(rId);$.grdDetail.selectRow(0)}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare){var rId=$.grdDetail.getSelectedRowIdx();$.varDeleteRows.push(["D",$.ymdeval_year1.getValue(),$.ymdeval_month.getValue(),$.grdDetail.getValue(rId,"eval_step"),$.grdDetail.getValue(rId,"eval_category"),getFormatDate($.grdDetail.getValue(rId,"eval_step_from_date"),"yyyyMMdd"),getFormatDate($.grdDetail.getValue(rId,"eval_step_to_date"),"yyyyMMdd"),$.grdDetail.getValue(rId,"memo"),"#UserID#","#HostInfo#"]);$.grdDetail.deleteRow(rId);$.grdDetail.selectRow(0)}})}}else{if(btnId=="btnSave"){var strWorkType="";if(strStatus==true){strWorkType="N"}else{strWorkType="U"}if(!fnSET_P_HRE1100_S(strWorkType)){return}if(fnSET_P_HRE1100_S1("")){if(strWorkType=="N"){fnQRY_P_HRE1100_Q("NEW")}else{QueryClick()}}QueryClick()}}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>