<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panRatingList=null;$.panTab=null;$.lblYear=null;$.lblEvalMonth=null;$.cmbEvalMonth=null;$.txtEvalPeriod=null;$.lblEmpName=null;$.bteEmpName=null;$.lblJobRank=null;$.cmbJobRank=null;$.lblDutyCode=null;$.cmbDutyCode=null;$.lblEmpName1=null;$.cmbEmpName1=null;$.lblEmpName2=null;$.cmbEmpName2=null;$.tabMain=null;$.panTab1=null;$.panTab2=null;$.panTab3=null;$.grdRatingList=null;$.grdList1=null;$.grdList2=null;$.grdList3=null;$.panSub=null;$.memReqText=null;$.btnSave=null;$.btnSearch=null;$.cmbYear=null;$.dteYear=null;$.panTFT=null;$.lblTFT=null;$.memoTFT=null;$.lblTFT2=null;$.txtAvgScore=null;$.lblCompNotice1=null;$.lblCompNotice2=null;$.lblKpiNotice1=null;$.varJobRank="";$.kpi_self_grade_readonly=true;function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_HRE4240_CompKPIInfo_Q",[workType,$.grdList1.getValue($.grdList1.getSelectedRowIdx(),"kpi_code")]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("HR..P_HRE4120_CompEvalInfo_Q",[workType,$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"competency_level"),$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"comp_code")]);return json}function createJSON_Q3(workType){var json=createExecuteParamInfo("HR..P_HRE4240_PERIOD_Q",[workType,$.cmbYear.getValue(),$.cmbEvalMonth.getValue()]);return json}function createJSON_Q4(workType){var json=createExecuteParamInfo("HR..P_HRE4240_MASTER_Q",[workType,$.cmbYear.getValue(),$.cmbEvalMonth.getValue(),$.bteEmpName.getValue()]);return json}function createJSON_Q5(workType){var json=createExecuteParamInfo("HR..P_HRE4120_Comp_Q",[workType,$.cmbYear.getValue(),$.cmbEvalMonth.getValue(),$.bteEmpName.getValue()]);return json}function createJSON_Q6(workType){var json=createExecuteParamInfo("HR..P_HRE4240_KPI_Q",[workType,$.cmbYear.getValue(),$.cmbEvalMonth.getValue(),$.bteEmpName.getValue()]);return json}function createJSON_Q7(workType){var json=createExecuteParamInfo("HR..P_HRE4120_SMARTSheet_Q",[workType,$.cmbYear.getValue(),$.bteEmpName.getValue()]);return json}function createJSON_S(workType){var rows=[];for(var i=0;i<$.grdList1.getRowCount();i++){rows.push([workType,$.cmbYear.getValue(),$.cmbEvalMonth.getValue(),$.bteEmpName.getValue(),$.grdList1.getValue(i,"kpi_code"),$.grdList1.getValue(i,"kpi_self_grade"),$.grdList1.getValue(i,"kpi_self_comment"),$.grdList1.getValue(i,"kpi_self_output"),$.memoTFT.getValue(),g_main.session.obj.UserID])}var json=createExecuteParamInfo("HR..P_HRE4240_KPI_S",rows);return json}function createJSON_S2(workType){var rows=[];for(var i=0;i<$.grdList2.getRowCount();i++){rows.push([workType,$.bteEmpName.getValue(),$.cmbYear.getValue(),$.cmbEvalMonth.getValue(),$.grdList2.getValue(i,"kbi_code"),$.grdList2.getValue(i,"competency_self_comment"),$.grdList2.getValue(i,"competency_self_grade"),g_main.session.obj.UserID])}var json=createExecuteParamInfo("HR..P_HRE4240_Comp_S",rows);return json}function createJSON_S3(workType){var rows=[];var json="";for(var i=0;i<$.grdList3.getRowCount();i++){rows.push([workType,$.cmbYear.getValue(),$.bteEmpName.getValue(),$.grdList3.getValue(i,"compcode"),Number($.grdList3.getValue(i,"seq")),$.grdList3.getValue(i,"from_now"),$.grdList3.getValue(i,"to_be"),$.grdList3.getValue(i,"act_chg_indicator"),$.grdList3.getValue(i,"dev_resource"),$.grdList3.getValue(i,"dev_plan"),$.grdList3.getValue(i,"time_plan"),$.memReqText.getValue(),g_main.session.obj.UserID])}log(rows);json=createExecuteParamInfo("HR..P_HRE4120_SMARTSheet_S",rows);return json}function searchCompKPIInfo(workType){var json=createJSON_Q(workType);callQuery(["req",json],"CompKPIInfo",$)}function searchCompEvalInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CompEvalInfo",$)}function searchRERIOD(workType){var json=createJSON_Q3(workType);callQuery(["req",json],"RERIOD",$)}function searchMASTER(workType){var json=createJSON_Q4(workType);callQuery(["req",json],"MASTER",$)}function searchComp(workType){var json=createJSON_Q5(workType);callQuery(["req",json],"Comp",$)}function searchKPI(workType){var json=createJSON_Q6(workType);callQuery(["req",json],"KPI",$)}function searchSMARTSheet(workType){var json=createJSON_Q7(workType);callQuery(["req",json],"SMARTSheet",$)}function saveKPI(workType){var json=createJSON_S(workType);callQuery(["req",json],"S_KPI",$)}function saveComp(workType){var json=createJSON_S2(workType);callQuery(["req",json],"S_Comp",$)}function saveSmartSheet(workType){var json=createJSON_S3(workType);callQuery(["req",json],"S_SMARTSheet",$)}function setProperty(){var aRow=$.grdList1.getAllRows();if(g_main.session.obj.DeptCode.substr(0,1)=="S"||g_main.session.obj.DeptCode.substr(0,1)=="T"){var ds=bizComponentData2($,"Q4","L_HRE008");$.grdList1.setColumnDropDownList("kpi_self_grade",ds.resultList[0]);for(var i in aRow){aRow[i].kpi_self_grade_readonly=true}}else{var ds=bizComponentData2($,"Q4","L_HRE008","and system_yn = 'Y'");$.grdList1.setColumnDropDownList("kpi_self_grade",ds.resultList[0]);for(var i in aRow){aRow[i].kpi_self_grade_readonly=false}}}function setAvgScore(){var ScoreSum=0;var AvgScore=0;for(var i=0;i<$.grdList1.getRowCount();i++){ScoreSum+=(Number($.grdList1.getValue(i,"weighted_rate"))*Number($.grdList1.getValue(i,"kpi_self_grade"))/100);log(ScoreSum)}ScoreSum=Math.round(ScoreSum*100)/100;$.txtAvgScore.setText(ScoreSum)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,250,300);$.panQuery.setText("평가 기본 정보");$.panQuery.setBottomLine(true);$.panRatingList=new FingerPanel(host,"panRatingList",0,310,250,450);$.panRatingList.setText("평가 척도");$.panRatingList.setBottomLine(true);$.panTab=new FingerPanel(host,"panTab",260,0,940,650);$.panTab.setText("");$.panTab.setBottomLine(true);$.lblYear=new FingerLabel(host,"lblYear",0,10,80,20);$.lblYear.setText("평가년도");$.lblEvalMonth=new FingerLabel(host,"lblEvalMonth",0,40,80,20);$.lblEvalMonth.setText("평가명");$.cmbEvalMonth=new FingerComboBox(host,"cmbEvalMonth",85,40,145,20);$.txtEvalPeriod=new FingerEdit(host,"txtEvalPeriod",85,70,140,20);$.lblEmpName=new FingerLabel(host,"lblEmpName",0,100,80,20);$.lblEmpName.setText("이름");$.bteEmpName=new FingerButtonEdit(host,"bteEmpName",85,100,140,20);$.bteEmpName.setText("");$.lblJobRank=new FingerLabel(host,"lblJobRank",0,130,80,20);$.lblJobRank.setText("직급");$.cmbJobRank=new FingerComboBox(host,"cmbJobRank",85,130,145,20);$.lblDutyCode=new FingerLabel(host,"lblDutyCode",0,160,80,20);$.lblDutyCode.setText("직책");$.cmbDutyCode=new FingerComboBox(host,"cmbDutyCode",85,160,145,20);$.lblEmpName1=new FingerLabel(host,"lblEmpName1",0,190,80,20);$.lblEmpName1.setText("1차평가자");$.cmbEmpName1=new FingerComboBox(host,"cmbEmpName1",85,190,145,20);$.lblEmpName2=new FingerLabel(host,"lblEmpName2",0,220,80,20);$.lblEmpName2.setText("2차평가자");$.cmbEmpName2=new FingerComboBox(host,"cmbEmpName2",85,220,145,20);$.tabMain=new FingerTab(host,"tabMain",0,20,940,745);$.panTab1=new FingerPanel(host,"panTab1",0,0,940,600);$.panTab1.setText("KPI List");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,940,600);$.panTab2.setText("Competencies");$.panTab2.setBottomLine(true);$.panTab3=new FingerPanel(host,"panTab3",0,0,940,600);$.panTab3.setText("SMART Sheet");$.panTab3.setBottomLine(true);$.grdRatingList=new FingerDataGrid(host,"grdRatingList",0,0,250,405);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,940,550);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,940,600);$.grdList3=new FingerDataGrid(host,"grdList3",0,0,940,500);$.panSub=new FingerPanel(host,"panSub",0,500,940,100);$.panSub.setText("역량개발 활용방법(Recource)관련 제안사항");$.panSub.setBottomLine(true);$.memReqText=new FingerMemoEdit(host,"memReqText",0,0,934,95);$.btnSave=new FingerButton(host,"btnSave",860,10,90,30);$.btnSave.setText("저장");$.btnSearch=new FingerButton(host,"btnSearch",185,-37.5,80,20);$.btnSearch.setText("조회");$.cmbYear=new FingerComboBox(host,"cmbYear",85,10,145,20);$.dteYear=new FingerDateEdit(host,"dteYear",85,10,140,20);$.panTFT=new FingerPanel(host,"panTFT",0,555,940,110);$.panTFT.setText("");$.panTFT.setBottomLine(true);$.lblTFT=new FingerLabel(host,"lblTFT",0,30,110,20);$.lblTFT.setText("");$.memoTFT=new FingerMemoEdit(host,"memoTFT",140,0,795,105);$.lblTFT2=new FingerLabel(host,"lblTFT2",0,50,120,20);$.lblTFT2.setText("AKR TFT 활동사항");$.txtAvgScore=new FingerEdit(host,"txtAvgScore",360,522,80,20);$.lblCompNotice1=new FingerLabel(host,"lblCompNotice1",160,-45,570,20);$.lblCompNotice1.setText("본인이 성과를 내기 위하여 “어떻게” 업무를 수행하고 각 항목의 역량이 어떠한 수준으로 발현 되었는지 ");$.lblCompNotice2=new FingerLabel(host,"lblCompNotice2",165,-25,390,20);$.lblCompNotice2.setText("Review 해 주시기 바랍니다.    (Astellas Competencies guide 참고 )");$.lblKpiNotice1=new FingerLabel(host,"lblKpiNotice1",125,-35,600,20);$.lblKpiNotice1.setText('조직변경과 무관하여 FY19에 연간평가로 진행하는 경우는 "자기평가 점수"를 작성하지 않으셔도 됩니다.');$.tabMain.addTab([{text:"업적KPI",body:$.panTab1,width:150},{text:"역량 7' Competencies",body:$.panTab2,width:150},{text:"SMART(개발역랑) Sheet",body:$.panTab3,width:150}]);$.tabMain.hideTab(2);$.cmbJobRank.setEnable(false);$.cmbDutyCode.setEnable(false);$.cmbEmpName1.setEnable(false);$.cmbEmpName2.setEnable(false);$.txtAvgScore.setEnable(false);$.cmbYear.setAllowBlank(false,"평가년도");$.cmbEvalMonth.setAllowBlank(false,"평가명");$.cmbJobRank.setAllowBlank(false,"직급");$.cmbDutyCode.setAllowBlank(false,"직책");$.cmbEmpName1.setAllowBlank(false,"1차평가자");$.cmbEmpName2.setAllowBlank(false,"2차평가자");$.panTFT.setBorder(true);$.txtAvgScore.setFontColor("black");$.txtAvgScore.setBackgroundColor("#F1F1F1");$.txtAvgScore.setStyle("border","solid 0px #ddd");$.txtAvgScore.setStyle("text-align","center");$.txtAvgScore.setStyle("font-size","14px");$.grdRatingList.colIdx=$.grdRatingList.setColumns([new FingerDataGridColumn("RatingScore",60,"center","string","Rating",{verticalMiddle:true}),new FingerDataGridColumn("RatingScale",172,"left","string","평가척도",{adjustRowHeight:true})]);$.grdRatingList.init({scroll:"xy"});$.grdRatingList.setEditable(false);$.grdList1.colIdx=$.grdList1.setColumns([new FingerDataGridColumn("kpi_csf",140,"center","string","핵심실행과제",{readonly:true,multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("kpi_name",140,"center","string","KPI",{readonly:true,multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("kpi_code",140,"left","string","KPI코드",{hidden:true}),new FingerDataGridColumn("kpi_type",140,"left","string","성과구분",{hidden:true}),new FingerDataGridColumn("weighted_rate",80,"center","string","가중치(%)",{readonly:true,footer:{content:"summColumn"},verticalMiddle:true}),new FingerDataGridColumn("kpi_self_grade",75,"center","string","자기평가",{footer:{content:"summColumn"},verticalMiddle:true}),new FingerDataGridColumn("kpi_self_output",240,"left","multi_line_edit","주요 성과 Review (FY19 상반기)"),new FingerDataGridColumn("kpi_self_comment",240,"left","multi_line_edit","본인 의견(Reflection)"),new FingerDataGridColumn("kpi_progress_state",250,"left","multi_line_edit","진행상황",{readonly:true,hidden:true}),new FingerDataGridColumn("kpi_plan_request",250,"left","multi_line_edit","향후 Action Plan 및 제안(요청사항)",{readonly:true,hidden:true}),new FingerDataGridColumn("mgr_feedback",250,"left","multi_line_edit","상사 feedback",{readonly:true,hidden:true})]);$.grdList1.init({panel:$.panTab1,scroll:"xy",footer:true,eventCellReadOnly:true,leftSplit:5,rowHeight:140});$.grdList1.setEditable(true);$.grdList2.colIdx=$.grdList2.setColumns([new FingerDataGridColumn("comp_name",200,"center","string","역량항목<br>Astellas<br>7Competencies",{readonly:true,multiLine:true,verticalMiddle:true}),new FingerDataGridColumn("competency_level",140,"left","string","역량구분",{hidden:true}),new FingerDataGridColumn("comp_code",140,"left","string","역량코드",{hidden:true}),new FingerDataGridColumn("kbi_code",140,"left","string","KBI 코드",{hidden:true}),new FingerDataGridColumn("competency_self_grade",75,"center","multi_line_edit","자기 평가",{hidden:true,verticalMiddle:true}),new FingerDataGridColumn("competency_self_comment",350,"left","multi_line_edit","발현 역량　본인 Review<br>(FY19 상반기 내용 작성)"),new FingerDataGridColumn("self_review_3q",200,"left","multi_line_edit","3Q(본인행동기록)<br/>(현재 수준 및 역량행동 Review)",{hidden:true}),new FingerDataGridColumn("feedback_3q",200,"left","multi_line_edit","3Q(상사 Feedback)<br/>(육성Point 및 진행사항, 코칭Point)",{readonly:true,hidden:true}),new FingerDataGridColumn("self_review_4q",200,"left","multi_line_edit","4Q(본인행동기록)<br/>(현재 수준 및  역량행동 Review)",{hidden:true}),new FingerDataGridColumn("feedback_4q",200,"left","multi_line_edit","4Q(상사 Feedback)<br/>(육성Point 및 진행사항, 코칭Point)",{readonly:true,hidden:true}),new FingerDataGridColumn("self_review_1q",200,"left","multi_line_edit","1Q(본인행동기록)<br/>(현재 수준 및 역량행동 Review)",{hidden:true}),new FingerDataGridColumn("feedback_1q",200,"left","multi_line_edit","1Q(상사 Feedback)<br/>(육성Point 및 진행사항, 코칭Point)",{readonly:true,hidden:true}),new FingerDataGridColumn("self_review_2q",200,"left","multi_line_edit","2Q(본인행동기록)<br/>(현재 수준 및 역량행동 Review)",{hidden:true}),new FingerDataGridColumn("feedback_2q",200,"left","multi_line_edit","2Q(상사 Feedback)<br/>(육성Point 및 진행사항, 코칭Point)",{readonly:true,hidden:true})]);$.grdList2.init({panel:$.panTab2,scroll:"xy",headerRowHeight:60,rowHeight:140});$.grdList2.setEditable(true);$.grdList3.colIdx=$.grdList3.setColumns([new FingerDataGridColumn("compcode",200,"left","string",[{text:"",colspan:2},"개발 역량 항목"]),new FingerDataGridColumn("seq",140,"left","string",["","순번"],{hidden:true}),new FingerDataGridColumn("from_now",200,"left","string",[{text:"목표 수준",colspan:2},"From"]),new FingerDataGridColumn("to_be",200,"left","string",["","To"]),new FingerDataGridColumn("act_chg_indicator",140,"left","multi_line_edit",[{text:"",colspan:6},"구체적 행동 변화 지표"]),new FingerDataGridColumn("dev_resource",200,"left","string",["","개발 Resource"]),new FingerDataGridColumn("dev_plan",200,"left","multi_line_edit",["","본인 개발계획"]),new FingerDataGridColumn("time_plan",200,"left","multi_line_edit",["","진행일정"]),new FingerDataGridColumn("feedback",200,"left","multi_line_edit",["","Manager FeedBack"]),new FingerDataGridColumn("fix_yn",200,"left","string",["","승인여부"])]);$.grdList3.init({panel:$.panTab3,scroll:"xy",headerRowHeight:80,rowHeight:140});$.grdList3.setEditable(true);$.cmbEvalMonth.setEmptyRow(true);$.cmbJobRank.setEmptyRow(true);$.cmbDutyCode.setEmptyRow(true);$.cmbEmpName1.setEmptyRow(true);$.cmbEmpName2.setEmptyRow(true);$.txtEvalPeriod.setReadOnly(true);$.btnSave.setClass("btn_save");$.dteYear.setVisible(false);$.bteEmpName.setDirectSearch("#EMP#",function(ds){if(ds&&ds.resultList&&ds.resultList[0]){var list=ds.resultList[0];if(list.length==1){$.bteEmpName.setValue(list[0]["value"]);$.bteEmpName.setText(list[0]["text"]);$.fingerbutton_click("btnSearch")}else{$.fingerbuttonedit_click("bteEmpName")}}});$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panRatingList);$.panMain.add($.panTab);$.panQuery.add($.lblYear);$.panQuery.add($.lblEvalMonth);$.panQuery.add($.cmbEvalMonth);$.panQuery.add($.txtEvalPeriod);$.panQuery.add($.lblEmpName);$.panQuery.add($.bteEmpName);$.panQuery.add($.lblJobRank);$.panQuery.add($.cmbJobRank);$.panQuery.add($.lblDutyCode);$.panQuery.add($.cmbDutyCode);$.panQuery.add($.lblEmpName1);$.panQuery.add($.cmbEmpName1);$.panQuery.add($.lblEmpName2);$.panQuery.add($.cmbEmpName2);$.panQuery.add($.btnSearch);$.panQuery.add($.cmbYear);$.panQuery.add($.dteYear);$.panRatingList.add($.grdRatingList);$.panTab.add($.tabMain);$.panTab.add($.btnSave);$.panTab1.add($.grdList1);$.panTab1.add($.txtAvgScore);$.panTab1.add($.panTFT);$.panTab1.add($.lblKpiNotice1);$.panTab2.add($.grdList2);$.panTab2.add($.lblCompNotice1);$.panTab2.add($.lblCompNotice2);$.panTab3.add($.grdList3);$.panTab3.add($.panSub);$.panSub.add($.memReqText);$.panTFT.add($.lblTFT);$.panTFT.add($.memoTFT);$.panTFT.add($.lblTFT2);$.bteEmpName.setText(g_main.session.getValue("UserName"));$.bteEmpName.setValue(g_main.session.getValue("UserID"));log(g_main.session.getValue("HREvaluateRole"));if(g_main.session.getValue("HREvaluateRole")!="ADMIN"){$.bteEmpName.setReadOnly(true);$.dteYear.setReadOnly(false)}$.cmbEvalMonth.setColumn("eval_month","eval_name");$.cmbYear.setColumn("eval_year","eval_year1");$.cmbEmpName1.setColumn("emp_code","emp_name");$.cmbEmpName2.setColumn("emp_code","emp_name");var ds=bizComponentData2($,"Q1","L_HRI005|L_HRI003|P_HRI0001|P_HRI0001|L_HRE010|L_HRE028|L_HRE029|L_HRE030|L_HRE032");setComboBind([$.cmbJobRank,$.cmbDutyCode,$.cmbEmpName1,$.cmbEmpName2,$.cmbYear],ds);$.cmbYear.setValue(ds.resultList[4][0].eval_year);var strQuery=" and eval_year = '"+$.dteYear.getValue()+"' and eval_month = '201904'";var ds2=bizComponentData2($,"Q4","L_HRE009",strQuery);setComboBind([$.cmbEvalMonth],ds2);$.grdList3.setColumnDropDownList("compcode",ds.resultList[5],{key:"CompetencyCode",name:"CompetencyShortName"});$.grdList3.setColumnDropDownList("from_now",ds.resultList[6]);$.grdList3.setColumnDropDownList("to_be",ds.resultList[6]);$.grdList3.setColumnDropDownList("dev_resource",ds.resultList[7]);$.grdList2.setColumnDropDownList("competency_self_grade",ds.resultList[8])};$.callback=function(type,ds){if(type=="RERIOD"){if(ds.resultList[0].length>0){$.txtEvalPeriod.setValue(ds.resultList[0][0].eval_period)}else{$.txtEvalPeriod.setValue("")}}else{if(type=="MASTER"){if(ds.resultList[0].length>0){$.cmbJobRank.setValue(ds.resultList[0][0].job_rank);$.cmbDutyCode.setValue(ds.resultList[0][0].duty_code);$.cmbEmpName1.setValue(ds.resultList[0][0].evaluate_emp1);$.cmbEmpName2.setValue(ds.resultList[0][0].evaluate_emp2);$.memoTFT.setValue(ds.resultList[0][0].tft_action_result);$.lblTFT.setText(ds.resultList[0][0].eval_period)}else{$.cmbJobRank.setValue("");$.cmbDutyCode.setValue("");$.cmbEmpName1.setValue("");$.cmbEmpName2.setValue("")}}else{if(type=="Comp"){if(ds.resultList[0].length>0){setDataGrid([$.grdList2],ds)}else{setDataGrid([$.grdList2],ds);$.grdList2.setDisplayPanelRowCount(0)}}else{if(type=="KPI"){if(ds.resultList[0].length>0){$.grdList1.setData("");setDataGrid([$.grdList1],ds);$.grdList1.selectRow(0);$.varJobRank=$.cmbJobRank.getValue();var aRow=$.grdList1.getAllRows();if(g_main.session.obj.DeptCode.substr(0,1)=="S"||g_main.session.obj.DeptCode.substr(0,1)=="T"){var ds=bizComponentData2($,"Q4","L_HRE008");$.grdList1.setColumnDropDownList("kpi_self_grade",ds.resultList[0]);$.kpi_self_grade_readonly=true}else{var ds=bizComponentData2($,"Q4","L_HRE008","and system_yn = 'Y'");$.grdList1.setColumnDropDownList("kpi_self_grade",ds.resultList[0]);$.kpi_self_grade_readonly=false}}else{setDataGrid([$.grdList1],ds);$.grdList1.setDisplayPanelRowCount(0)}setProperty();setAvgScore()}else{if(type=="SMARTSheet"){log(ds);if(ds.resultList[0].length>0){setDataGrid([$.grdList3],ds);$.memReqText.setValue(ds.resultList[0][0].request_descr)}else{setDataGrid([$.grdList3],ds);$.grdList3.setDisplayPanelRowCount(0);$.memReqText.setValue("")}}else{if(type=="CompEvalInfo"){if(ds.resultList[0].length>0){setDataGrid([$.grdRatingList],ds)}else{setDataGrid([$.grdRatingList],ds);$.grdRatingList.setDisplayPanelRowCount(0)}}else{if(type=="CompKPIInfo"){setDataGrid([$.grdRatingList],ds)}else{if(type=="S_KPI"){searchKPI("Q")}else{if(type=="S_Comp"){searchComp("Q")}else{if(type=="S_SMARTSheet"){searchSMARTSheet("Q")}}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSave"){$.grdList1.editStop();$.grdList2.editStop();$.grdList3.editStop();saveKPI("S");saveComp("S");saveSmartSheet("S")}else{if(id=="btnSearch"){if($.cmbEvalMonth.getValue()==""){$.txtEvalPeriod.setValue("");return}else{searchRERIOD("Q");searchMASTER("Q");searchComp("Q");searchKPI("Q");searchSMARTSheet("Q");setProperty()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmpName"){param={emp_name:$.bteEmpName.getValue()};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){if(id=="bteEmpName"){if($.cmbEvalMonth.getValue()==""||$.cmbYear.getValue==""){return}else{searchRERIOD("Q");searchMASTER("Q");searchComp("Q");searchKPI("Q");setProperty()}}};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbEvalMonth"){if($.cmbEvalMonth.getValue()==""){$.txtEvalPeriod.setValue("");return}else{searchRERIOD("Q");searchMASTER("Q");searchComp("Q");searchKPI("Q");searchSMARTSheet("Q");setProperty()}}else{if(id=="cmbYear"){if($.bteEmpName.getValue()!=""){$.cmbEvalMonth.clear();$.cmbEvalMonth.setColumn("eval_month","eval_name");var strQuery=" and eval_year = '"+$.cmbYear.getValue()+"' and eval_month = '201904'";var ds2=bizComponentData2($,"Q4","L_HRE009",strQuery);setComboBind([$.cmbEvalMonth],ds2)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList1"){var aRow=$.grdList1.getAllRows();for(var i in aRow){aRow[i].kpi_self_grade_readonly=$.kpi_self_grade_readonly}searchCompKPIInfo("Q")}else{if(id=="grdList2"){searchCompEvalInfo("Q")}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList1"){setAvgScore()}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmpName"){if(popResult.employee_id){$.bteEmpName.setValue(popResult.employee_id);$.bteEmpName.setText(popResult.emp_name);$.fingerbutton_click("btnSearch")}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>