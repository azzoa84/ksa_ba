<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.panTab=null;$.lblDate=null;$.dteStart=null;$.dteEnddate=null;$.lblDateDelimiter=null;$.lblProjectName=null;$.txtProjectName=null;$.lblProductName=null;$.cmbProductName=null;$.lblNickName=null;$.txtNickName=null;$.lblEmployee=null;$.bteEmployee=null;$.lblIndNeedYn=null;$.htmView=null;$.btnSearch=null;$.grdList=null;$.panTab1=null;$.btnAKRWithdrawal=null;$.btnIRBWithdrawal=null;$.btnINDWithdrawal=null;$.btnEnd=null;$.btnPayemntEnd=null;$.btndisuse=null;$.lblProjectName2=null;$.lblProjectNickName2=null;$.lblProductName2=null;$.lblTotProjectAmt=null;$.lblEmployee2=null;$.memProjectName=null;$.txtNickName2=null;$.cmbProduct2=null;$.bteEmployee2=null;$.lblstatus2=null;$.lblTotGoalPeopleCnt=null;$.cmbStatus2=null;$.lblremark1=null;$.memRemark=null;$.txtDeptCode=null;$.panTab2_4=null;$.lblIndApprovalNo=null;$.lblIndApprovalDate=null;$.txtIndApprovalNo=null;$.dteIndApprovalDate=null;$.grdAKRDoc=null;$.btnAKR=null;$.btnAddDraft=null;$.panTab3=null;$.panTab3_1=null;$.panTab3_2=null;$.btnContractAdd=null;$.btnContractDel=null;$.grdContract=null;$.panTab4=null;$.grdFile=null;$.tabProject=null;$.txtProjectAmt=null;$.txtTotGoalPeopleCnt=null;$.btnFileAdd=null;$.btnFileDel=null;$.btnContractUpdate=null;$.btnGianLoad=null;$.cmbStudyType=null;$.lblStudyType=null;$.lblRemark2=null;$.memRemark2=null;$.lblISN=null;$.txtISN=null;$.grdPayList=null;$.cmbPayType=null;$.btnWriteDraft=null;$.btnPaymentDone=null;$.lblISN2=null;$.txtISN2=null;$.cmbDocType=null;$.panTab5=null;$.grdPayment=null;$.session=g_main.session.obj;$.strmass_id="";$.panListWorkType="";$.bSave=false;$.deleteFile=[];$.deletePayment=[];$.iit_wf_doc_id="";$.mass_id="";$.contract_id="";$.employeeId="";$.varEmployeeId="";$.varEmployeeId2="";$.last_status="";$.institute_id="";$.investigator="";$.strStatus="";$.draft_type="";$.approval_wf_doc_id="";$.approval_doc_title="";$.wf_status="10";function createJSON_Q(workType){var json=createExecuteParamInfo("P_MASS1000_Q",[workType,$.dteStart.getValue(),$.dteEnddate.getValue(),$.mass_id||"",$.txtISN.getValue()||"",$.txtProjectName.getValue()||"",$.txtNickName.getValue()||"",$.cmbProductName.getValue()||"",$.bteEmployee.getValue()?$.employeeId:"","#UserID#"]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_MASS1000_Q2",[workType,$.mass_id||"",$.contract_id||""]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_MASS1000_S",[workType,$.mass_id,$.txtISN2.getText(),$.cmbStatus2.getValue()||"",$.last_status,$.memProjectName.getValue()||"",$.txtNickName2.getValue()||"",$.cmbProduct2.getValue()||"",$.cmbStudyType.getValue()||"",$.txtDeptCode.getValue()||"",$.varEmployeeId,Number($.txtProjectAmt.getValue()),Number($.txtTotGoalPeopleCnt.getValue()),$.txtIndApprovalNo.getValue(),$.dteIndApprovalDate.getValue(),$.memRemark.getValue()||"",$.memRemark2.getValue()||"","#UserID#"]);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("P_MASSP1000_S",[workType,$.mass_id,$.grdContract.getValue($.grdContract.getSelectedRowIdx(),"contract_id"),"","","","","","","","",0,0,0,"","","","","","#UserID#"]);return json}function createJSON_S3(workType){var json=createExecuteParamInfo("P_MASS1000_S2",[workType,$.mass_id,$.grdContract.getValue($.grdContract.getSelectedRowIdx(),"contract_id"),$.draft_type,$.approval_wf_doc_id,$.approval_doc_title,"#UserID#"]);return json}function createJSON_S4(workType,strwf_doc_id){var json=createExecuteParamInfo("P_MASS1000_S1",[workType,$.mass_id,strwf_doc_id]);return json}function createJSON_S5(){var json;var gRow=$.grdFile.getChangedRows();if($.deleteFile.length>0){for(var i in $.deleteFile){gRow.push($.deleteFile[i])}}if(gRow.length<1){MessageBoxShow("저장할 내용이 존재하지 않습니다.");return false}for(var i in gRow){if(gRow[i].rowType=="N"){}}var rows=[];for(var i in gRow){workType=gRow[i].rowType;rows.push([workType,$.mass_id,Number(gRow[i].file_seq)||0,gRow[i].server_path,gRow[i].server_fname,gRow[i].local_fname,gRow[i].institution||"",gRow[i].contract_yn||"N",gRow[i].plan_yn||"N",gRow[i].use_akr_yn||"N",gRow[i].use_pay_yn||"N","#UserID#"])}json=createExecuteParamInfo("P_MASS1000_S3",rows);return json}function createJSON_S6(){var json;var rows=[];for(var i=0;i<$.grdPayment.getRowCount();i++){rows.push(["S",$.mass_id,$.grdPayment.getValue(i,"seq")||1,$.grdPayment.getValue(i,"institution")||"",$.grdPayment.getValue(i,"event_date")||"",$.grdPayment.getValue(i,"meal_amt")||0,$.grdPayment.getValue(i,"trans_amt")||0,$.grdPayment.getValue(i,"contents")||"",$.grdPayment.getValue(i,"attend_cnt")||0,$.grdPayment.getValue(i,"remark")||"",$.grdPayment.getValue(i,"wf_doc_id")||"","#UserID#"])}json=createExecuteParamInfo("P_MASS1000_S4",rows);return json}function searchMASS(workType){if(!validateControls([$.dteStart,$.dteEnddate])){return}if(workType=="AKR"){var json=createJSON_Q(workType);return callQuerySync(["req",json],workType)}else{if(workType=="Q"){$.mass_id=""}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}}function searchMASSPayment(workType){var json=createJSON_Q2(workType);callQuery(["req",json],workType,$)}function saveMASS(workType){if(workType=="N"||workType=="U"){if(!$.panTab1.validateControls()){return}}var json=createJSON_S(workType);callExecute(["req",json],"MASS_"+workType,$)}function saveContract(workType){if(workType=="D"){var json=createJSON_S2("D");callExecute(["req",json],"D",$)}}function savePayment(workType){var json=createJSON_S3(workType);if(json){callExecute(["req",json],"workType",$)}}function saveWfList(strWorkType,strwf_doc_id){var json=createJSON_S4(strWorkType,strwf_doc_id);var ds=callExecuteSync(["req",json],"S_WF",$);if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return false}}else{return false}return true}function saveFile(){var json=createJSON_S5();if(json){callExecute(["req",json],"S_FILE",$)}}function SaveMeetingPayment(){var json=createJSON_S6();if(json){callExecute(["req",json],"S",$)}}function panTab1ButtonHidden(bo){$.btnAKRWithdrawal.setEnable(bo);$.btnIRBWithdrawal.setEnable(bo);$.btnINDWithdrawal.setEnable(bo);$.btnEnd.setEnable(bo);$.btnPayemntEnd.setEnable(bo);$.btndisuse.setEnable(bo)}function fnReFocus(){$.strmass_id=$.mass_id}function fnTabchange(value){$.grdPayList.clear();$.grdPayment.clear();if(value=="0"){searchMASS("Q1")}else{if(value=="1"){searchMASS("Q2")}else{if(value=="2"){searchMASS("Q4")}else{if(value=="3"){searchMASS("Q5")}}}}}function getDrawalMsg(type){var msg="";if(type=="DRAWAL_N"){msg="정상적으로 등록되었습니다."}else{if(type=="DRAWAL_U"||type=="DRAWAL_U1"){msg="정상적으로 수정되었습니다."}else{if(type=="DRAWAL_D"){msg="정상적으로 삭제되었습니다."}else{msg="정상적으로 처리되었습니다."}}}return msg}function newClick(){$.panTab1.clear();$.tabProject.setActiveTab(0);$.tabProject.hideTab(1);$.tabProject.hideTab(2);$.panTab1.setEnable(true);$.cmbStatus2.setEnable(false);$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnAKR.setEnable(false);$.btnAddDraft.setEnable(false);$.btnGianLoad.setEnable(false);$.btnEnd.setEnable(false);$.btnPayemntEnd.setEnable(false);$.btndisuse.setEnable(false);$.panListWorkType="N";$.mass_id="";$.last_status="10";$.institute_id="";$.strStatus="10";$.bteEmployee2.setText($.session.EmpName);$.txtDeptCode.setValue($.session.DeptCode);$.varEmployeeId=$.session.UserID;$.grdAKRDoc.clear();$.grdContract.clear();$.grdPayList.clear();$.grdFile.clear();$.grdPayment.clear();$.cmbProduct2.setEnable(true);$.memProjectName.setFocus()}function saveButton(bo){if(bo){$.panList.enableButton(["btnSave"])}else{$.panList.disableButton(["btnSave"])}}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdAKRDoc.getRowCount();i++){if(strwf_doc_id==$.grdAKRDoc.getValue(i,"wf_doc_id")){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1135);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,110);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,120,1200,500);$.panList.setText("임상 연구 목록");$.panList.setBottomLine(true);$.panTab=new FingerPanel(host,"panTab",0,630,1200,500);$.panTab.setText("");$.panTab.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",0,10,100,20);$.lblDate.setText("계약일");$.dteStart=new FingerDateEdit(host,"dteStart",105,10,100,20);$.dteEnddate=new FingerDateEdit(host,"dteEnddate",215,10,100,20);$.lblDateDelimiter=new FingerLabel(host,"lblDateDelimiter",195,10,15,20);$.lblDateDelimiter.setText("~");$.lblProjectName=new FingerLabel(host,"lblProjectName",310,10,80,20);$.lblProjectName.setText("연구제목");$.txtProjectName=new FingerEdit(host,"txtProjectName",395,10,375,20);$.lblProductName=new FingerLabel(host,"lblProductName",765,40,100,20);$.lblProductName.setText("품목");$.cmbProductName=new FingerComboBox(host,"cmbProductName",870,40,145,20);$.lblNickName=new FingerLabel(host,"lblNickName",310,40,80,20);$.lblNickName.setText("Nickname");$.txtNickName=new FingerEdit(host,"txtNickName",395,40,375,20);$.lblEmployee=new FingerLabel(host,"lblEmployee",0,40,100,20);$.lblEmployee.setText("담당자");$.bteEmployee=new FingerButtonEdit(host,"bteEmployee",105,40,140,20);$.bteEmployee.setText("");$.lblIndNeedYn=new FingerLabel(host,"lblIndNeedYn",0,70,100,20);$.lblIndNeedYn.setText("MFDS승인");$.htmView=new FingerHTMLView(host,"htmView",100,75,255,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,75,80,20);$.btnSearch.setText("조회");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,455);$.panTab1=new FingerPanel(host,"panTab1",0,0,1197,430);$.panTab1.setText("연구상세");$.panTab1.setBottomLine(true);$.btnAKRWithdrawal=new FingerButton(host,"btnAKRWithdrawal",565,10,135,30);$.btnAKRWithdrawal.setText("AKR Withdrawal");$.btnIRBWithdrawal=new FingerButton(host,"btnIRBWithdrawal",685,10,135,30);$.btnIRBWithdrawal.setText("IRB Withdrawal");$.btnINDWithdrawal=new FingerButton(host,"btnINDWithdrawal",805,10,145,30);$.btnINDWithdrawal.setText("KFDA Withdrawal");$.btnEnd=new FingerButton(host,"btnEnd",1105,10,100,30);$.btnEnd.setText("연구종료");$.btnPayemntEnd=new FingerButton(host,"btnPayemntEnd",1020,10,100,30);$.btnPayemntEnd.setText("회계완료");$.btndisuse=new FingerButton(host,"btndisuse",1105,10,100,30);$.btndisuse.setText("문서폐기");$.lblProjectName2=new FingerLabel(host,"lblProjectName2",0,125,100,20);$.lblProjectName2.setText("연구제목");$.lblProjectNickName2=new FingerLabel(host,"lblProjectNickName2",0,200,100,20);$.lblProjectNickName2.setText("nickname");$.lblProductName2=new FingerLabel(host,"lblProductName2",0,230,100,20);$.lblProductName2.setText("품목");$.lblTotProjectAmt=new FingerLabel(host,"lblTotProjectAmt",0,290,100,20);$.lblTotProjectAmt.setText("총연구비");$.lblEmployee2=new FingerLabel(host,"lblEmployee2",0,320,100,20);$.lblEmployee2.setText("담당자");$.memProjectName=new FingerMemoEdit(host,"memProjectName",105,90,380,100);$.txtNickName2=new FingerEdit(host,"txtNickName2",105,200,385,20);$.cmbProduct2=new FingerComboBox(host,"cmbProduct2",105,230,140,20);$.bteEmployee2=new FingerButtonEdit(host,"bteEmployee2",105,320,140,20);$.bteEmployee2.setText("");$.lblstatus2=new FingerLabel(host,"lblstatus2",515,60,100,20);$.lblstatus2.setText("진행상태");$.lblTotGoalPeopleCnt=new FingerLabel(host,"lblTotGoalPeopleCnt",225,230,120,20);$.lblTotGoalPeopleCnt.setText("총대상자수");$.cmbStatus2=new FingerComboBox(host,"cmbStatus2",620,60,140,20);$.lblremark1=new FingerLabel(host,"lblremark1",775,80,100,20);$.lblremark1.setText("비고");$.memRemark=new FingerMemoEdit(host,"memRemark",880,60,300,60);$.txtDeptCode=new FingerEdit(host,"txtDeptCode",255,290,140,20);$.panTab2_4=new FingerPanel(host,"panTab2_4",535,205,650,170);$.panTab2_4.setText("AKR 기안목록");$.panTab2_4.setBottomLine(true);$.lblIndApprovalNo=new FingerLabel(host,"lblIndApprovalNo",515,90,105,20);$.lblIndApprovalNo.setText("MFDS 승인번호");$.lblIndApprovalDate=new FingerLabel(host,"lblIndApprovalDate",515,120,100,20);$.lblIndApprovalDate.setText("MFDS 승인일");$.txtIndApprovalNo=new FingerEdit(host,"txtIndApprovalNo",620,90,140,20);$.dteIndApprovalDate=new FingerDateEdit(host,"dteIndApprovalDate",620,120,140,20);$.grdAKRDoc=new FingerDataGrid(host,"grdAKRDoc",0,0,645,120);$.btnAKR=new FingerButton(host,"btnAKR",330,-40,110,30);$.btnAKR.setText("AKR 기안");$.btnAddDraft=new FingerButton(host,"btnAddDraft",530,-40,135,30);$.btnAddDraft.setText("기안 불러오기");$.panTab3=new FingerPanel(host,"panTab3",0,0,1200,430);$.panTab3.setText("");$.panTab3.setBottomLine(true);$.panTab3_1=new FingerPanel(host,"panTab3_1",0,0,650,380);$.panTab3_1.setText("연구 계약 목록");$.panTab3_1.setBottomLine(true);$.panTab3_2=new FingerPanel(host,"panTab3_2",655,0,540,380);$.panTab3_2.setText("연구비 지급 목록");$.panTab3_2.setBottomLine(true);$.btnContractAdd=new FingerButton(host,"btnContractAdd",400,-40,95,30);$.btnContractAdd.setText("계약추가");$.btnContractDel=new FingerButton(host,"btnContractDel",560,-40,95,30);$.btnContractDel.setText("삭제");$.grdContract=new FingerDataGrid(host,"grdContract",0,0,650,335);$.panTab4=new FingerPanel(host,"panTab4",0,0,1197,430);$.panTab4.setText("연구관련 첨부파일");$.panTab4.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1197,385);$.tabProject=new FingerTab(host,"tabProject",0,0,1200,500);$.txtProjectAmt=new FingerSpinEdit(host,"txtProjectAmt",105,290,140,25);$.txtTotGoalPeopleCnt=new FingerSpinEdit(host,"txtTotGoalPeopleCnt",350,230,140,25);$.btnFileAdd=new FingerButton(host,"btnFileAdd",1070,5,80,20);$.btnFileAdd.setText("파일추가");$.btnFileDel=new FingerButton(host,"btnFileDel",1135,5,80,20);$.btnFileDel.setText("파일삭제");$.btnContractUpdate=new FingerButton(host,"btnContractUpdate",480,-40,95,30);$.btnContractUpdate.setText("계약수정");$.btnGianLoad=new FingerButton(host,"btnGianLoad",425,-40,120,30);$.btnGianLoad.setText("결제문서보기");$.cmbStudyType=new FingerComboBox(host,"cmbStudyType",105,260,390,20);$.lblStudyType=new FingerLabel(host,"lblStudyType",0,260,100,20);$.lblStudyType.setText("구분");$.lblRemark2=new FingerLabel(host,"lblRemark2",775,150,100,20);$.lblRemark2.setText("지출보고서 비고");$.memRemark2=new FingerMemoEdit(host,"memRemark2",880,130,300,60);$.lblISN=new FingerLabel(host,"lblISN",765,10,100,20);$.lblISN.setText("ISN");$.txtISN=new FingerEdit(host,"txtISN",870,10,140,20);$.grdPayList=new FingerDataGrid(host,"grdPayList",0,0,540,330);$.cmbPayType=new FingerComboBox(host,"cmbPayType",235,-40,140,20);$.btnWriteDraft=new FingerButton(host,"btnWriteDraft",375,-40,100,30);$.btnWriteDraft.setText("지급기안");$.btnPaymentDone=new FingerButton(host,"btnPaymentDone",460,-40,100,30);$.btnPaymentDone.setText("지급완료");$.lblISN2=new FingerLabel(host,"lblISN2",0,60,100,20);$.lblISN2.setText("ISN");$.txtISN2=new FingerEdit(host,"txtISN2",105,60,200,20);$.cmbDocType=new FingerComboBox(host,"cmbDocType",190,-40,140,30);$.panTab5=new FingerPanel(host,"panTab5",0,0,1200,430);$.panTab5.setText("연구자모임");$.panTab5.setBottomLine(true);$.grdPayment=new FingerDataGrid(host,"grdPayment",0,0,1197,385);$.panQuery.setBorder(true);$.panList.addButtons(["btnDelete","btnSave","btnNew"]);$.panTab4.addButtons(["btnDelete","btnAdd"]);$.panTab5.addButtons(["btnDelete","btnSave","btnAdd"]);$.btnFileAdd.setVisible(false);$.btnFileDel.setVisible(false);$.cmbProductName.setEmptyRow(true);$.cmbStudyType.setEmptyRow(true);$.txtISN2.setAllowBlank(false,"ISN");$.dteStart.setAllowBlank(false,"등록일");$.dteEnddate.setAllowBlank(false,"등록일");$.cmbStudyType.setAllowBlank(false,"구분");$.cmbStatus2.setEnable(false);$.btnAKRWithdrawal.setVisible(false);$.btnIRBWithdrawal.setVisible(false);$.btnINDWithdrawal.setVisible(false);$.btnPayemntEnd.setVisible(false);$.btndisuse.setVisible(false);$.htmView.setHTML("<input type = 'radio' id = 'rdoINDA' name = 'rdoIND' value = 'A' style='margin-right: 4px;margin-left: 10px'><label for='rdoINDA'>전체</label></input><input type = 'radio' id = 'rdoINDY' name = 'rdoIND' value = 'Y' style='margin-right: 4px;margin-left: 10px'><label for='rdoINDY'>승인필요</label></input><input type = 'radio' id = 'rdoINDN'  name = 'rdoIND' value = 'N' style='margin-right: 4px;margin-left: 10px'><label for='rdoINDN'>해당없음</label></input>");$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("seq",30,"right","string",""),new FingerDataGridColumn("isn",130,"left","string","ISN"),new FingerDataGridColumn("project_name",260,"left","string","연구제목"),new FingerDataGridColumn("project_nickname",170,"left","string","nickname"),new FingerDataGridColumn("status",100,"center","string","진행상태"),new FingerDataGridColumn("product_code",100,"center","string","품목"),new FingerDataGridColumn("study_type",190,"left","string","연구구분"),new FingerDataGridColumn("tot_project_amt",110,"right","string","총연구비",{format:"int"}),new FingerDataGridColumn("emplayee_no",90,"center","string","담당자"),new FingerDataGridColumn("finish_date",242,"center","string","연구종료일","yyyyMMdd",{excelHidden:false}),new FingerDataGridColumn("mass_id",0,"left","string","mass_id",{excelHidden:false}),new FingerDataGridColumn("wf_status",100,"left","string","AKR승인상태",{excelHidden:false})]);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdList.setColumnHidden(["project_type","finish_date","mass_id","wf_status"],true);$.grdList.setBorder(false);$.grdAKRDoc.colIdx=$.grdAKRDoc.setColumns([new FingerDataGridColumn("seq",30,"right","string",""),new FingerDataGridColumn("wf_doc_id",100,"left","string","결제문서아이디"),new FingerDataGridColumn("doc_title",400,"left","string","기안명"),new FingerDataGridColumn("wf_status",100,"left","string","결재상태"),new FingerDataGridColumn("wf_time",100,"left","string","결제일",{format:"s_ymd"})]);$.grdAKRDoc.init();$.grdAKRDoc.setColumnHidden(["wf_doc_id"],true);$.grdAKRDoc.setBorder(false);$.grdContract.colIdx=$.grdContract.setColumns([new FingerDataGridColumn("seq",30,"right","string",""),new FingerDataGridColumn("contract_id",100,"left","string","계약ID"),new FingerDataGridColumn("institute",230,"left","string","연구기관",{hidden:true}),new FingerDataGridColumn("institute_name",230,"left","string","연구기관"),new FingerDataGridColumn("investigator",90,"left","string","시험책임자",{hidden:true}),new FingerDataGridColumn("investigator_name",90,"left","string","시험책임자"),new FingerDataGridColumn("contact_type",99,"center","string","역할"),new FingerDataGridColumn("start_date",85,"left","string","계약일",{format:"s_ymd"}),new FingerDataGridColumn("contract_date",100,"left","string","계약체결일",{format:"s_ymd"}),new FingerDataGridColumn("contract_amt",100,"right","string","연구비",{format:"int"}),new FingerDataGridColumn("pay_count",90,"left","string","분납횟수"),new FingerDataGridColumn("medicine_support_yn",100,"center","checkbox","임상약지급",{readonly:true}),new FingerDataGridColumn("goal_people_cnt",85,"right","string","목표대상자"),new FingerDataGridColumn("irb_approval_date",100,"left","string","IRB승인일",{format:"s_ymd"}),new FingerDataGridColumn("irb_approval_no",120,"left","string","IRB승인번호"),new FingerDataGridColumn("exception_end_yn",100,"left","checkbox","계약임의종료"),new FingerDataGridColumn("remark",100,"left","string","비고")]);$.grdContract.init({scroll:"xy"});$.grdContract.setColumnHidden(["contract_id","contract_date","exception_end_yn","remark"],true);$.grdContract.setBorder(false);$.grdContract.setEditable(false);$.grdPayList.colIdx=$.grdPayList.setColumns([new FingerDataGridColumn("seq",50,"left","center","차수",{readonly:true}),new FingerDataGridColumn("pay_seq",100,"left","string","결제연번"),new FingerDataGridColumn("pay_amt",110,"right","string","금액",{format:"int",readonly:true}),new FingerDataGridColumn("draft_type",100,"center","string","기안종류",{readonly:true}),new FingerDataGridColumn("approval_doc_title",300,"left","string","기안명",{readonly:true}),new FingerDataGridColumn("wf_status",100,"right","string","기안상태",{readonly:true}),new FingerDataGridColumn("approval_date",100,"left","string","결재일",{format:"s_ymd",readonly:true}),new FingerDataGridColumn("approval_wf_doc_id",100,"left","string","colapproval_wf_doc_id",{readonly:true}),new FingerDataGridColumn("pay_date",100,"left","date",[{text:"지급일",css:"col_chk"}],{format:"s_ymd"}),new FingerDataGridColumn("pay_yn",100,"left","string","지급여부",{readonly:true})]);$.grdPayList.init({scroll:"xy"});$.grdPayList.setColumnHidden(["pay_seq","draft_type","wf_status","approval_wf_doc_id","pay_yn"],true);$.grdPayList.setBorder(false);$.bteEmployee.setDirectSearch("#EMP#");$.grdFile.colIdx=$.grdFile.setColumns([new FingerDataGridColumn("seq",50,"right","string","",{readonly:true}),new FingerDataGridColumn("file_seq",100,"right","string","파일순번",{hidden:true}),new FingerDataGridColumn("server_path",110,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("institution",230,"left","string","연구기관"),new FingerDataGridColumn("local_fname",550,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("contract_yn",80,"center","checkbox","계약서",{sort:null}),new FingerDataGridColumn("plan_yn",80,"center","checkbox","계획서",{sort:null}),new FingerDataGridColumn("use_akr_yn",80,"center","checkbox","AKR기안",{sort:null}),new FingerDataGridColumn("use_pay_yn",80,"center","checkbox","연구비지급기안",{sort:null}),new FingerDataGridColumn("localfilepath",90,"left","string","로컬파일경로",{hidden:true})]);$.grdFile.init({editable:true});$.grdFile.setBorder(false);$.grdPayment.colIdx=$.grdPayment.setColumns([new FingerDataGridColumn("seq",50,"right","string","순번",{readonly:true}),new FingerDataGridColumn("institution",230,"left","string","연구기관"),new FingerDataGridColumn("event_date",100,"left","date","일자",{format:"ymd"}),new FingerDataGridColumn("meal_amt",100,"right","string","식비",{format:"int"}),new FingerDataGridColumn("trans_amt",100,"right","string","교통비",{format:"int"}),new FingerDataGridColumn("contents",200,"left","string","내역"),new FingerDataGridColumn("attend_cnt",100,"right","string","참석인원",{format:"int"}),new FingerDataGridColumn("remark",200,"left","string","비고"),new FingerDataGridColumn("wf_doc_id",150,"left","string","기안문서번호")]);$.grdPayment.init({scroll:"xy",editable:true});$.grdPayment.setBorder(false);$.tabProject.addTab([{text:"연구상세",body:$.panTab1,width:140},{text:"연구계약",body:$.panTab3,width:140},{text:"첨부파일",body:$.panTab4,width:140},{text:"연구자모임",body:$.panTab5,width:140}]);$.memProjectName.setAllowBlank(false,"연구제목");$.cmbProduct2.setAllowBlank(false,"품목");$.bteEmployee2.setAllowBlank(false,"담당자");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panTab);$.panQuery.add($.lblDate);$.panQuery.add($.dteStart);$.panQuery.add($.dteEnddate);$.panQuery.add($.lblDateDelimiter);$.panQuery.add($.lblProjectName);$.panQuery.add($.txtProjectName);$.panQuery.add($.lblProductName);$.panQuery.add($.cmbProductName);$.panQuery.add($.txtNickName);$.panQuery.add($.lblNickName);$.panQuery.add($.lblEmployee);$.panQuery.add($.bteEmployee);$.panQuery.add($.lblIndNeedYn);$.panQuery.add($.htmView);$.panQuery.add($.btnSearch);$.panQuery.add($.lblISN);$.panQuery.add($.txtISN);$.panList.add($.grdList);$.panTab.add($.tabProject);$.panTab1.add($.btnAKRWithdrawal);$.panTab1.add($.btndisuse);$.panTab1.add($.btnEnd);$.panTab1.add($.btnINDWithdrawal);$.panTab1.add($.btnIRBWithdrawal);$.panTab1.add($.btnPayemntEnd);$.panTab1.add($.lblTotProjectAmt);$.panTab1.add($.lblProjectNickName2);$.panTab1.add($.lblProjectName2);$.panTab1.add($.lblProductName2);$.panTab1.add($.lblEmployee2);$.panTab1.add($.cmbProduct2);$.panTab1.add($.memProjectName);$.panTab1.add($.txtNickName2);$.panTab1.add($.bteEmployee2);$.panTab1.add($.lblstatus2);$.panTab1.add($.lblTotGoalPeopleCnt);$.panTab1.add($.cmbStatus2);$.panTab1.add($.lblremark1);$.panTab1.add($.memRemark);$.panTab1.add($.txtDeptCode);$.panTab1.add($.txtProjectAmt);$.panTab1.add($.txtTotGoalPeopleCnt);$.panTab1.add($.cmbStudyType);$.panTab1.add($.lblStudyType);$.panTab1.add($.lblRemark2);$.panTab1.add($.memRemark2);$.panTab1.add($.lblIndApprovalNo);$.panTab1.add($.lblIndApprovalDate);$.panTab1.add($.txtIndApprovalNo);$.panTab1.add($.dteIndApprovalDate);$.panTab1.add($.panTab2_4);$.panTab1.add($.lblISN2);$.panTab1.add($.txtISN2);$.panTab2_4.add($.grdAKRDoc);$.panTab2_4.add($.btnAKR);$.panTab2_4.add($.btnAddDraft);$.panTab2_4.add($.btnGianLoad);$.panTab2_4.add($.cmbDocType);$.panTab3.add($.panTab3_1);$.panTab3.add($.panTab3_2);$.panTab3_1.add($.btnContractAdd);$.panTab3_1.add($.btnContractDel);$.panTab3_1.add($.grdContract);$.panTab3_1.add($.btnContractUpdate);$.panTab3_2.add($.grdPayList);$.panTab3_2.add($.cmbPayType);$.panTab3_2.add($.btnWriteDraft);$.panTab3_2.add($.btnPaymentDone);$.panTab4.add($.grdFile);$.panTab4.add($.btnFileDel);$.panTab4.add($.btnFileAdd);$.panTab5.add($.grdPayment);$.dteStart.setValue("20130401");$.dteEnddate.setValue(getToday(""));relocateChildIndexInPanel([$.panTab1]);document.getElementById("rdoINDA").checked=true;var ds=bizComponentData2($,"Q1","L_ST0061|L_CRM0285|L_CRM0286");setComboBind([$.cmbStatus2,$.cmbStudyType],ds);$.grdList.setColumnDropDownList("status",ds.resultList[0]);$.grdList.setColumnDropDownList("study_type",ds.resultList[1]);$.grdContract.setColumnDropDownList("contact_type",ds.resultList[2]);var ds2=bizComponentData2($,"Q1","L_ST0067|L_ST0067|L_CRM0293|L_CRM0219");$.cmbProductName.setColumn("product_code","product_name");$.cmbProduct2.setColumn("product_code","product_name");setComboBind([$.cmbProductName,$.cmbProduct2,$.cmbDocType],ds2);$.grdList.setColumnDropDownList("product_code",ds2.resultList[0],{key:"product_code",name:"product_name"});$.grdList.setColumnDropDownList("emplayee_no",ds2.resultList[3],{key:"employee_id",name:"emp_name"});var ds4=bizComponentData2($,"Q1","L_ST0063");setComboBind([$.cmbApiReviewResult],ds4);var ds5=bizComponentData2($,"Q1","L_CRM0006");setComboBind([$.cmbIitStatus],ds5);var ds6=bizComponentData2($,"Q1","L_ST0066");setComboBind([$.cmbPayType],ds6);$.grdAKRDoc.setColumnDropDownList("wf_status",ds5.resultList[0]);$.cmbProduct2.setValue("");$.cmbStatus2.setValue("");if($.session.DeptCode=="A030"||$.session.DeptCode=="A120"){$.bSave=true}else{$.bSave=false;$.panList.disableButton(["btnNew"]);panTab1ButtonHidden(false);$.btnAKR.setEnable(false);$.btnContractAdd.setEnable(false);$.btnContractDel.setEnable(false)}$.txtDeptCode.setVisible(false);saveButton(false)};$.callback=function(type,ds){if(type=="Q"){saveButton(false);if(ds.resultList[0].length<1){$.grdList.clear();$.grdList.setDisplayPanelRowCount(0);newClick()}else{setDataGrid([$.grdList],ds);var rIndex;if($.panListWorkType=="N"){rIndex=$.grdList.getRowCount()-1}else{rIndex=($.strmass_id!=""?$.grdList.getGridRowIndex("mass_id",$.strmass_id):0)}$.grdList.selectRow(rIndex)}}else{if(type=="Q1"){$.txtISN2.setValue(ds.resultList[0][0].isn);$.memProjectName.setValue(ds.resultList[0][0].project_name);$.txtNickName2.setValue(ds.resultList[0][0].project_nickname);$.cmbProduct2.setValue(ds.resultList[0][0].product_code);$.cmbStudyType.setValue(ds.resultList[0][0].study_type);$.txtProjectAmt.setValue(ds.resultList[0][0].tot_project_amt);$.bteEmployee2.setValue(ds.resultList[0][0].emplayee_no);$.bteEmployee2.setText(ds.resultList[0][0].emp_name);$.txtDeptCode.setValue(ds.resultList[0][0].dept_code);$.varEmployeeId=ds.resultList[0][0].emplayee_no;$.cmbStatus2.setValue(ds.resultList[0][0].status);$.txtTotGoalPeopleCnt.setValue(ds.resultList[0][0].tot_goal_people_cnt);$.memRemark.setValue(ds.resultList[0][0].remark);$.memRemark2.setValue(ds.resultList[0][0].remark2);$.last_status=ds.resultList[0][0].last_status;$.txtIndApprovalNo.setValue(ds.resultList[0][0].mfds_approval_no);$.dteIndApprovalDate.setValue(ds.resultList[0][0].mfds_approval_date);var month="";var day="";for(var i=0;i<ds.resultList[1].length;i++){if(ds.resultList[1][i].wf_time!=""){if(ds.resultList[1][i].wf_time.month<9){month="0"+(ds.resultList[1][i].wf_time.month+1)}else{month=ds.resultList[1][i].wf_time.month+1}if(ds.resultList[1][i].wf_time.date<10){day="0"+ds.resultList[1][i].wf_time.date}else{day=ds.resultList[1][i].wf_time.date}ds.resultList[1][i].wf_time=("20"+ds.resultList[1][i].wf_time.year.toString().substring(1,3))+month+day}}$.grdAKRDoc.clear();setDataGrid([$.grdAKRDoc],ds.resultList[1],true);$.grdAKRDoc.selectRow(0);if($.bSave){$.panList.enableButton(["btnDelete"])}else{$.panList.disableButton(["btnDelete"])}saveButton(false)}else{if(type=="Q2"){$.grdContract.clear();setDataGrid([$.grdContract],ds.resultList[0],true);$.panTab3_1.setTitleType("SMALL");if($.grdContract.getRowCount()<0){$.panTab3_2.disableButton(["btnDelete","btnSave","btnAdd"]);$.btnContractDel.setEnable(false);$.btnContractUpdate.setEnable(false);if($.strStatus=="10"||$.strStatus=="20"||$.strStatus=="30"||$.strStatus=="40"){$.btnContractAdd.setEnable(true)}else{$.btnContractAdd.setEnable(false)}}$.panList.disableButton(["btnDelete"]);saveButton(false);$.grdContract.selectRow(0)}else{if(type=="Q4"){var ds1=bizComponentData2($,"Q3","L_CRM0295",$.mass_id,"","");$.grdFile.extObj.clearAll();$.grdFile.setColumnDropDownList("institution",ds1.resultList[0],{key:"institute",name:"institute_name"});setDataGrid([$.grdFile],ds);$.panList.disableButton(["btnDelete"])}else{if(type=="Q5"){var ds1=bizComponentData2($,"Q3","L_CRM0295",$.mass_id,"","");$.grdPayment.extObj.clearAll();$.grdPayment.setColumnDropDownList("institution",ds1.resultList[0],{key:"institute",name:"institute_name"});if(ds){setDataGrid([$.grdPayment],ds)}}else{if(type=="D"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{$.strmass_id="";$.panListWorkType=="";$.deleteFile=[];$.deletePayment=[];searchMASS("Q")}}}else{if(type=="S_Pay"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 저장되었습니다.");searchMASS("Q3")}}}else{if(type=="MASS_N"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){if(ds.errorCode=="MSG0002"){var strmass_id=ds.returnStr;fnReFocus();searchMASS("Q")}else{MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg);return}}else{MessageBoxShow(getDrawalMsg(type));fnReFocus();searchMASS("Q")}}}else{if(type=="DRAWAL_AKR"||type=="DRAWAL_IRB"||type=="DRAWAL_IND"||type=="MASS_U"||type=="DRAWAL_D"||type=="DRAWAL_U1"||type=="DRAWAL_CLOSE"||type=="DRAWAL_PAYEND"||type=="DRAWAL_DISCARD"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow(getDrawalMsg(type));if(type!="MASS_D"){fnReFocus()}searchMASS("Q")}}}else{if(type=="S_FILE"){if(ds){var rs=ds.resultList;var msg="정상적으로 저장되었습니다.";if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){msg=rs[i].errorCode+"</br>"+rs[i].errorMsg;MessageBoxShow(msg);return}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){msg=ds.errorCode+"</br>"+ds.errorMsg;MessageBoxShow(msg);return}}MessageBoxShow(msg);$.deleteFile=[];fnReFocus();searchMASS("Q")}}else{if(type=="S_WF"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 저장되었습니다.");fnTabchange($.tabProject.getActiveTab())}}}else{if(type=="Payment"){setDataGrid([$.grdPayList],ds)}}}}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){$.strmass_id="";$.panListWorkType=="";$.deleteFile=[];$.deletePayment=[];searchMASS("Q")}else{if(id=="btnEnd"){if($.panListWorkType=="N"){return}else{confirmBoxShow("연구 종료 처리를 진행 하시겠습니까?",function(){if(g_main.msgShare==true){saveWithDrawal("CLOSE")}})}}else{if(id=="btnPayemntEnd"){if($.panListWorkType=="N"){return}if($.dteAccountingEndDate1.getValue()==""||!$.dteAccountingEndDate1.getValue()){MessageBoxShow("회계정산요청일을 입력해 주십시오.");$.dteAccountingEndDate1.setFocus();return}else{confirmBoxShow("회계 완료 처리를 진행 하시겠습니까?",function(){if(g_main.msgShare==true){saveWithDrawal("PAYEND")}})}}else{if(id=="btndisuse"){if($.panListWorkType=="N"){return}if($.dteDiscardDate1.getValue()==""||!$.dteDiscardDate1.getValue()){MessageBoxShow("문서폐기일을 입력해 주십시오.");$.dteDiscardPlanDate1.setFocus();return}else{confirmBoxShow("문서를 폐기 하시겠습니까?",function(){if(g_main.msgShare==true){saveWithDrawal("DISCARD")}})}}else{if(id=="btnContractAdd"){if($.grdList.getRowCount()<1){return}$.popUpCallId=id;var param={};param.mass_id=$.mass_id;param.contract_id="";param.end_visible="N";param.save_visible="Y";param.exception_end_yn="N";g_main.openPopup("popMASS1000.html","popMASS1000","연구 계약 정보",525,780,"","",param,"","")}else{if(id=="btnContractDel"){if($.grdList.getRowCount()<1||$.grdContract.getRowCount()<1){return}confirmBoxShow($.grdContract.getValue($.grdContract.getSelectedRowIdx(),"institute_name")+"["+$.grdContract.getValue($.grdContract.getSelectedRowIdx(),"investigator_name")+"]계약건을 <br/>삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveContract("D")}})}else{if(id=="btnContractUpdate"){var rId=$.grdContract.getSelectedRowIdx();var data=$.grdContract.getValue(rId);$.popUpCallId=id;var param={};param.mass_id=$.mass_id;param.contract_id=data.contract_id;param.end_visible="Y";param.exception_end_yn=data.exception_end_yn;if($.strStatus=="10"||$.strStatus=="20"||$.strStatus=="30"||$.strStatus=="40"){if($.bSave){param.save_visible="Y"}else{param.save_visible="N"}}else{param.save_visible="N"}g_main.openPopup("popMASS1000.html","popMASS1000","연구 계약 정보",525,780,"","",param,"","")}else{if(id=="btnAddDraft"){$.popUpCallId=id;var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(id=="btnAKR"){$.popUpCallId=id;var rId=$.grdList.getSelectedRowIdx();if(!rId){return}var ds=searchMASS("AKR");if(ds.resultList.length<2||ds.resultList[0].length<1){return}if($.cmbDocType.getValue()=="10"){var strtitle="[CIT 계획 기안] "+ds.resultList[0][0].isn;var strcontent='<p>다음과 같이 기안합니다.</p><p><br></p><p><strong><span style="font-family: times new roman;"><span style="font-family: arial;">1.</span> 기안 차수</span></strong></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">n차 *n은 1부터 시작</span></p><p><br></p><p><span style="font-family: times new roman;"><strong><span style="font-family: arial;">2. </span>ISN</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].isn+'</p><p><br></p><p><span style="font-family: arial;"><strong>3.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험 제목</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].project_name+'</p><p><br></p><p><strong><span style="font-family: arial;">4. </span><span style="font-family: 굴림,gulim;">국내 시험기관 수</span></strong></p><p><br></p><p><br></p><p><strong><span style="font-family: arial;">5.</span><span style="font-family: 굴림,gulim;">시험대상자 수</span></strong></P><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].tot_goal_people_cnt+'</p><p><br></p><p><span style="font-family: arial;"><strong>6.</strong></span> <span style="font-family: 굴림,gulim;"><strong>Timeline</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">CMP Approval, Budget Approval, Protocol Finalization, IRB Submission, SIV, FPI, LPI, LPO, CSR</span></p><p><br></p><p><span style="font-family: arial;"><strong>7.</strong></span> <span style="font-family: 굴림,gulim;"><strong>연구비</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].tot_project_amt+'</p><p><br></p><p><span style="font-family: arial;"><strong>8.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험용 의약품</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">제품명, 수량, 비용(원)</span></p><p><br></p><p><br></p>';var param={title:strtitle,content:strcontent,file_list:ds.resultList[1]};g_main.openPopup("crmWFGeneralNew.html","crmWFGeneralNew","자유기안",1200,1000,"","",param,"","")}else{if($.cmbDocType.getValue()=="20"){var strtitle="[CIT 계약 검토] "+ds.resultList[0][0].isn;var strcontent='<p>첨부한 계약 서식으로 CRO와 계약을 체결하려 하오니, 검토 후 재가 바랍니다.</p><p><br></p><p>&nbsp;&nbsp;&nbsp;<p><span style="font-family: times new roman;"><strong><span style="font-family: arial;">1. </span>ISN</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].isn+'</p><p><br></p><p><span style="font-family: arial;"><strong>2.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험 제목</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].project_name+'</p><p><br></p><p><strong><span style="font-family: arial;">3. </span><span style="font-family: 굴림,gulim;">CRO명</span></strong></p><p><br></p><p><br></p><p><strong><span style="font-family: arial;">4.</span><span style="font-family: 굴림,gulim;">임상시험 계획에 대한 AKR 대표이사 승인</span></strong></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">승인일 DD-MMM-YYYY</span></p><p><br></p><p><span style="font-family: arial;"><strong>5.</strong></span> <span style="font-family: 굴림,gulim;"><strong>AKR 총무팀의 CRO 선정</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">통보일 DD-MMM-YYYY</span></p><p><br></p><p><span style="font-family: arial;"><strong>6.</strong></span> <span style="font-family: 굴림,gulim;"><strong>사용 계약 서식</strong></span><span style="font-family: arial; color:Green;"> * 아래 A,B 중 택 1</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. AKR 표준서식</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. CRO 서식</span></p><p><br></p><p><span style="font-family: arial;"><strong>7.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식에 대한 AKR CP팀 승인</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">승인일 DD-MMM-YYYY</span></p><p><br></p><p><br></p>';var param={title:strtitle,content:strcontent,file_list:ds.resultList[1]};g_main.openPopup("crmWFGeneralNew.html","crmWFGeneralNew","자유기안",1200,1000,"","",param,"","")}else{if($.cmbDocType.getValue()=="30"){var strtitle="[CIT 계약 검토] "+ds.resultList[0][0].isn;var strcontent='<p>첨부한 계약 서식으로 시험기관과 계약을 체결하려 하오니, 검토 후 재가 바랍니다.</p><p><br></p><p>&nbsp;&nbsp;&nbsp;<p><span style="font-family: times new roman;"><strong><span style="font-family: arial;">1. </span>ISN</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].isn+'</p><p><br></p><p><span style="font-family: arial;"><strong>2.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험 제목</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].project_name+'</p><p><br></p><p><strong><span style="font-family: arial;">3. </span><span style="font-family: 굴림,gulim;">시험기관명 / PI 소속 및 성명</span></strong></p><p><br></p><p><br></p><p><strong><span style="font-family: arial;">4.</span><span style="font-family: 굴림,gulim;">임상시험 실시에 대한 해당 시험기관 IRB 승인</span></strong></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">(시정)승인일 DD-MMM-YYYY</span></p><p><br></p><p><span style="font-family: arial;"><strong>5.</strong></span> <span style="font-family: 굴림,gulim;"><strong>사용 계약 서식</strong></span><span style="font-family: arial; color:Green;">   * 아래 A-E 중 택 1</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. Clinical Trial / 영문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. Clinical Trial / 국문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">C. Non-Interventional / 영문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">D. Non-Interventional / 국문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">E. 시험 기관 서식</span></p><p><br></p><p><span style="font-family: arial;"><strong>6.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식 변경에 대한 API Legal 승인</strong></span><span style="font-family: arial; color:Green;">   * 아래 A,B 중 택 1</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. 기본 계약 서식 변경 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY, 모든 변경에 대해 API Legal 승인을 받음</span></p><p><br></p><p><span style="font-family: arial;"><strong>7.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식에 대한 AKR CP팀 승인</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">승인일 DD-MMM-YYYY</span></p><p><br></p><p><br></p>';var param={title:strtitle,content:strcontent,file_list:ds.resultList[1]};g_main.openPopup("crmWFGeneralNew.html","crmWFGeneralNew","자유기안",1200,1000,"","",param,"","")}else{if($.cmbDocType.getValue()=="40"){var strtitle="[CIT n차 계약 변경 검토] "+ds.resultList[0][0].isn;var strcontent='<p>첨부한 계약 서식으로 CRO 계약 내용을 변경하려 하오니, 검토 후 재가 바랍니다.</p><p><br></p><p>&nbsp;&nbsp;&nbsp;<p><span style="font-family: times new roman;"><strong><span style="font-family: arial;">1. </span>ISN</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].isn+'</p><p><br></p><p><span style="font-family: arial;"><strong>2.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험 제목</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].project_name+'</p><p><br></p><p><strong><span style="font-family: arial;">3. </span><span style="font-family: 굴림,gulim;">CRO명</span></strong></p><p><br></p><p><strong><span style="font-family: arial;">4. </span><span style="font-family: 굴림,gulim;">변경 차수</span></strong></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">n차</span><span style="font-family: arial; color:Green;">* 최초 계약을 0으로 보고, n은 1부터 시작</span></p><p><br></p><p><strong><span style="font-family: arial;">5.</span><span style="font-family: 굴림,gulim;">변경 사항에 대한 MAAO/CMT 승인</span></strong><span style="font-family: arial; color:Green;">    * 아래 A, B중 택 1</span></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. MAAO/CMT 승인을 요하는 변경 사항 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY</span></p><p><br></p><p><strong><span style="font-family: arial;">6.</span><span style="font-family: 굴림,gulim;">변경 사항에 대한 AKR 대표이사 승인</span></strong><span style="font-family: arial; color:Green;">    * 아래 A, B중 택 1</span></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. AKR 대표이사 승인을 요하는 변경 사항 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY</span></p><p><br></p><p><strong><span style="font-family: arial;">7.</span><span style="font-family: 굴림,gulim;">사용 계약 서식</span></strong><span style="font-family: arial; color:Green;">    * 아래 A, B중 택 1</span></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. AKR 표준 서식</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. CRO 서식</span></p><p><br></p><p><span style="font-family: arial;"><strong>8.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식에 대한 AKR CP팀 승인</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">승인일 DD-MMM-YYYY</span></p><p><br></p><p><br></p>';var param={title:strtitle,content:strcontent,file_list:ds.resultList[1]};g_main.openPopup("crmWFGeneralNew.html","crmWFGeneralNew","자유기안",1200,1000,"","",param,"","")}else{if($.cmbDocType.getValue()=="50"){var strtitle="[CIT n차 계약 변경 검토] "+ds.resultList[0][0].isn;var strcontent='<p>첨부한 계약 서식으로 시험기관 계약 내용을 변경하려 하오니, 검토 후 재가 바랍니다.</p><p><br></p><p>&nbsp;&nbsp;&nbsp;<p><span style="font-family: times new roman;"><strong><span style="font-family: arial;">1. </span>ISN</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].isn+'</p><p><br></p><p><span style="font-family: arial;"><strong>2.</strong></span> <span style="font-family: 굴림,gulim;"><strong>임상시험 제목</strong></span></p><p>&nbsp;&nbsp;&nbsp;'+ds.resultList[0][0].project_name+'</p><p><br></p><p><strong><span style="font-family: arial;">3. </span><span style="font-family: 굴림,gulim;">시험기관명 / PI 소속 및 성명</span></strong></p><p><br></p><p><br></p><p><span style="font-family: arial;"><strong>4.</strong></span> <span style="font-family: 굴림,gulim;"><strong>사용 계약 서식</strong></span><span style="font-family: arial; color:Green;">   * 아래 A-E 중 택 1</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. Clinical Trial / 영문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. Clinical Trial / 국문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">C. Non-Interventional / 영문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">D. Non-Interventional / 국문</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">E. 시험 기관 서식</span></p><p><br></p><p><strong><span style="font-family: arial;">5. </span><span style="font-family: 굴림,gulim;">변경 차수</span></strong></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">n차</span><span style="font-family: arial; color:Green;">   * 최초 계약을 0으로 보고, n은 1부터 시작</span></p><p><br></p><p><strong><span style="font-family: arial;">6.</span><span style="font-family: 굴림,gulim;">변경 사항에 대한 MAAO/CMT 승인</span></strong><span style="font-family: arial; color:Green;">    * 아래 A, B중 택 1</span></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. MAAO/CMT 승인을 요하는 변경 사항 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY</span></p><p><br></p><p><strong><span style="font-family: arial;">7.</span><span style="font-family: 굴림,gulim;">변경 사항에 대한 AKR 대표이사 승인</span></strong><span style="font-family: arial; color:Green;">    * 아래 A, B중 택 1</span></P><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. AKR 대표이사 승인을 요하는 변경 사항 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY</span></p><p><br></p><p><strong><span style="font-family: arial;">8.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식 변경에 대한 API Legal 승인</strong></span><span style="font-family: arial; color:Green;">   * 아래 A,B 중 택 1</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">A. 기본 계약 서식 변경 없음</span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">B. 승인일 DD-MMM-YYYY, 모든 변경에 대해 API Legal 승인을 받음</span></p><p><br></p><p><span style="font-family: arial;"><strong>9.</strong></span> <span style="font-family: 굴림,gulim;"><strong>계약 서식에 대한 AKR CP팀 승인</strong></span></p><p>&nbsp;&nbsp;&nbsp;<span style="font-family: arial; color:DodgerBlue;">승인일 DD-MMM-YYYY</span></p>';var param={title:strtitle,content:strcontent,file_list:ds.resultList[1]};g_main.openPopup("crmWFGeneralNew.html","crmWFGeneralNew","자유기안",1200,1000,"","",param,"","")}}}}}}else{if(id=="btnGianLoad"){if($.grdAKRDoc.getRowCount()<1){return}$.popUpCallId=id;var rId=$.grdAKRDoc.getSelectedRowIdx();var param={wf_doc_id:$.grdAKRDoc.getValue(rId,"wf_doc_id")};g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if(id=="btnWriteDraft"){if(!$.grdContract.getSelectedRowIdx()){return}if($.grdContract.getValue($.grdContract.getSelectedRowIdx(),"exception_end_yn")=="Y"){MessageBoxShow("임의 종료된 계약건입니다. 확인 하시고 진행하시기 바랍니다.")}var strtitle="["+$.grdList.getValue($.grdList.getSelectedRowIdx(),"isn")+"]";var paramht={clinical_id:$.grdList.getValue($.grdList.getSelectedRowIdx(),"mass_id"),akr_clinical_no:$.grdList.getValue($.grdList.getSelectedRowIdx(),"isn"),institute_name:$.grdContract.getValue($.grdContract.getSelectedRowIdx(),"institute_name"),title:strtitle,content:"",seq:"",server_path:"",server_fname:"",local_fname:"",files:""};if($.cmbPayType.getValue()=="10"){g_main.openPopup("crmWFBgtPlanPre.html","crmWFBgtPlanPre","가불신청",1200,1325,"","",paramht,"","")}else{if($.cmbPayType.getValue()=="20"){g_main.openPopup("crmWFBgtAft.html","crmWFBgtAft","사후정리",1200,1675,"","",paramht,"","")}else{g_main.openPopup("crmWFBgtUsePre.html","crmWFBgtUsePre","가불정리",1200,1755,"","",paramht,"","")}}}else{if(id=="btnPaymentDone"){if(!$.grdPayList.getSelectedRowIdx()){MessageBoxShow("지급완료할 내용이 없습니다.");return}else{$.payindex=$.grdPayList.getSelectedRowIdx();saveResearchPay("PAY")}}}}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmployee"){var param={employee_id:$.varEmployeeId||"",emp_name:$.bteEmployee.getText()||""};g_main.openPopup("popEmp.html","popEmp","사원 조회",750,500,"","",param,"","")}else{if(id=="bteEmployee2"){var param={employee_id:$.varEmployeeId||"",emp_name:$.bteEmployee.getText()||""};g_main.openPopup("popEmp.html","popEmp","사원 조회",750,500,"","",param,"","")}else{if(id=="bteInvestigatorName"){var param={contact_name:$.bteInvestigatorName.getText()||""};g_main.openPopup("popContact.html","popContact","의뢰자 조회",600,550,"","",param,"","")}else{if(id=="bteIitDocTitle"){var param={type:"single"};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",1100,735,"","",param,"","")}}}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){saveButton(true);if(id=="chkIitNeedYn"||id=="chkApiNeedYn"||id=="chkIndNeedYn"){changeCheckBox(id,value)}};$.fingercombobox_change=function(id,value){if(id=="cmbProductName"||id=="cmbClinicalStatus"){}else{saveButton(true)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStart"||id=="dteEnddate"){}else{if(id=="dteDiscardDate1"){saveButton(false)}else{if(id=="dteAccountingEndDate1"){if(value==""){$.dteDiscardPlanDate1.setValue("")}else{$.dteDiscardPlanDate1.setValue(getCalcMonth(value,60))}saveButton(false)}else{saveButton(true)}}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.deleteFile=[];$.deletePayment=[];$.panListWorkType="";$.mass_id=$.grdList.getValue(rId,"mass_id");$.memProjectName.setValue("");$.txtNickName2.setValue("");$.cmbProduct2.setValue("");$.txtProjectAmt.setValue("");$.bteEmployee2.setText("");$.cmbStatus2.setValue("");$.txtTotGoalPeopleCnt.setValue("");$.memRemark.setValue("");$.memRemark2.setValue("");$.last_status="";$.txtDeptCode.setValue("");$.varEmployeeId="";$.strStatus=$.grdList.getValue(rId,"status");$.panTab1.setEnable(true);$.cmbStatus2.setEnable(false);if($.strStatus=="10"){$.btnAKRWithdrawal.setEnable(true);$.btnIRBWithdrawal.setEnable(true);$.btnINDWithdrawal.setEnable(true);$.btnEnd.setEnable(false);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(false);$.cmbProduct2.setEnable(true)}else{if($.strStatus=="20"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(true);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(false);$.cmbProduct2.setEnable(true)}else{if($.strStatus=="30"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(false);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(true);$.cmbProduct2.setReadOnly(false)}else{if($.strStatus=="40"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(false);$.btndisuse.setEnable(true);$.btnPayemntEnd.setEnable(false);$.cmbProduct2.setEnable(true)}else{if($.strStatus=="50"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(false);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(false);$.cmbProduct2.setEnable(false)}else{if($.strStatus=="60"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(false);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(false);$.panTab1.setEnable(false)}else{if($.strStatus=="70"){$.btnAKRWithdrawal.setEnable(false);$.btnIRBWithdrawal.setEnable(false);$.btnINDWithdrawal.setEnable(false);$.btnEnd.setEnable(false);$.btndisuse.setEnable(false);$.btnPayemntEnd.setEnable(false);$.cmbProduct2.setEnable(false)}}}}}}}$.tabProject.showTab(1);$.tabProject.showTab(2);fnTabchange($.tabProject.getActiveTab());saveButton(false)}else{if(id=="grdContract"){$.contract_id=$.grdContract.getValue(rId,"contract_id");searchMASSPayment("Payment")}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdFile"){saveButton(true)}else{saveButton(false)}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="txtProjectName"||id=="txtInstituteName"||id=="txtClinicalId"||id=="txtNickName"||id=="txtInvestigatorName"){}else{saveButton(true)}};$.fingeredit_keypress=function(id,value){if((id=="txtProjectName")&&value=="13"){searchMASS("Q")}else{if((id=="txtInstituteName")&&value=="13"){searchMASS("Q")}else{if((id=="txtClinicalId")&&value=="13"){searchMASS("Q")}else{if((id=="txtNickName")&&value=="13"){searchMASS("Q")}else{if((id=="txtInvestigatorName")&&value=="13"){searchMASS("Q")}}}}}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnNew"){newClick()}else{if(btnId=="btnDelete"){if($.grdList.getRowCount()<1||$.panListWorkType=="N"){return}var rId=$.grdList.getSelectedRowIdx();var data=$.grdList.getValue(rId);var msg="";if(data.mass_id==""){return}else{msg=data.mass_id+" 을(를) 삭제하시겠습니까?"}confirmBoxShow(msg,function(){if(g_main.msgShare==true){saveMASS("D")}})}else{if(btnId=="btnSave"){var tabIndex=$.tabProject.getActiveTab();var strWork_type="U";if(tabIndex=="0"||tabIndex=="1"){if(tabIndex=="0"){strWork_type=($.panListWorkType=="N"?$.panListWorkType:strWork_type)}else{strWork_type="U1"}saveMASS(strWork_type)}else{if(tabIndex=="2"){saveFile()}}}}}}else{if(panelId=="panTab4"){if(btnId=="btnAdd"){OpenFileUploader("CT",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].seq=0;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["server_path"]==$.grdFile.getSSSSValue(j,"server_path")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList);saveButton(true)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){if(result){if($.grdFile.getRowStatus(rId)!="N"){$.grdFile.getItem(rId).rowType="D";$.deleteFile.push($.grdFile.getValue(rId))}MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);saveButton(true)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}else{if(panelId=="panTab5"){if(btnId=="btnAdd"){$.grdPayment.addRow({meal_amt:0,trans_amt:0,attend_cnt:1});var contRow=$.grdPayment.getAllRows();for(var i in contRow){contRow[i].seq=Number(i)+1}}else{if(btnId=="btnDelete"){var rId=$.grdPayment.getSelectedRowIdx();if(!rId){return}confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){$.grdPayment.deleteRow(rId);var contRow=$.grdPayment.getAllRows();for(var i in contRow){contRow[i].seq=Number(i)+1}}})}else{if(btnId=="btnSave"){if($.grdPayment.getRowCount()<1){return}else{SaveMeetingPayment()}}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmployee"){if(!popResult.employee_id){$.employeeId="";$.bteEmployee.setText("")}else{$.employeeId=popResult.employee_id;$.bteEmployee.setText(popResult.emp_name)}}else{if($.popUpCallId=="bteEmployee2"){saveButton(true);if(!popResult.employee_id){$.varEmployeeId="";$.bteEmployee2.setText("")}else{$.varEmployeeId=popResult.employee_id;$.bteEmployee2.setText(popResult.emp_name)}}}}if(id=="popContact"){saveButton(true);if($.popUpCallId=="bteInvestigatorName"){if(!popResult.company_id){$.institute_id="";$.investigator="";$.txtInstituteName2.setValue("");$.bteInvestigatorName.setText("")}else{$.institute_id=popResult.company_id;$.investigator=popResult.contact_id;$.txtInstituteName2.setValue(popResult.company_name);$.bteInvestigatorName.setText(popResult.contact_name)}}}else{if(id=="crmWFEndDocSub"){saveButton(true);if($.popUpCallId=="btnAddDraft"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){popResult[i].seq="1";popResult[i].wf_status="90";$.grdAKRDoc.addRow(popResult[i]);saveWfList("N",popResult[i]["wf_doc_id"])}}}else{if($.popUpCallId=="bteIitDocTitle"){$.bteIitDocTitle.setText(popResult[0].doc_title);$.dteIitApprovalDate.setValue(popResult[0].update_time.substring(0,8));$.iit_wf_doc_id=popResult[0].wf_doc_id;$.cmbIitStatus.setValue("90")}}}else{if(id=="popMASS1000"){if($.popUpCallId=="btnContractAdd"){if(popResult.result=="Y"){if($.strStatus=="10"){$.grdList.setValue($.grdList.getSelectedRowIdx(),"status","20")}fnTabchange($.tabProject.getActiveTab())}}else{if($.popUpCallId=="btnContractUpdate"){if(popResult.result=="Y"){fnTabchange($.tabProject.getActiveTab())}}}}else{if(id=="crmWFGeneralNew"){if($.popUpCallId=="btnAKR"){saveWfList("N",popResult.wf_doc_id)}}else{if(id=="crmWFBgtPlanPre"||id=="crmWFBgtAft"||id=="crmWFBgtUsePre"){$.draft_type=$.cmbPayType.getValue();$.approval_wf_doc_id=popResult.wf_doc_id;$.approval_doc_title=popResult.doc_title;savePayment("S_Pay")}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){if(id=="tabProject"){$.deleteFile=[];$.deletePayment=[];if($.grdList.getRowCount()<1){newClick();return}fnTabchange(tabid);$.panListWorkType="";saveButton(false)}};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>