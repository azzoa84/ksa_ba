<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panNowDept=null;$.grdList1=null;$.panBaseInfo=null;$.lblChangeDateKey=null;$.lblChangeDate=null;$.dteChangeDate=null;$.lblMemo=null;$.memMemo=null;$.btnSearch=null;$.panChangeDept=null;$.grdList2=null;$.lblSiteCode=null;$.cmbSiteCode=null;$.lblDeptCode=null;$.txtDeptCode=null;$.lblDeptName=null;$.txtDeptName=null;$.lblDeptNameEng=null;$.txtDeptNameEng=null;$.lblDeptNameChn=null;$.txtDeptNameChn=null;$.lblParentDept=null;$.cmbParentDept=null;$.lblDeptLeader=null;$.txtDeptLeader=null;$.bteDeptLeader=null;$.lblMaypoleCode=null;$.cmbMaypoleCode=null;$.chkSalesDeptYn=null;$.chkMarketingDeptYn=null;$.lblMemo2=null;$.memMemo2=null;$.bteChangeDateKey=null;$.lblTodayDate=null;$.dteTodayDate=null;$.dtChangeOrg=[];$.varDeptReadOnlyCheck=true;function createJSON_Q(workType){var json=createExecuteParamInfo("HR..P_ORG2100_Q",[workType,$.changeDate]);return json}function createJSON_S(workType){log("1");var json=createExecuteParamInfo("HR..P_ORG2100_S",[workType,$.changeDate,$.memMemo.getValue(),"#UserID#","#HostInfo#"]);return json}function createJSON_S2(workType){var json="";var changedRows=$.grdList2.getAllRows();var rows=[];if(workType=="D"){var json=createExecuteParamInfo("HR..P_ORG2100_S1",[workType,$.changeDate,$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"dept_code"),$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"dept_name"),"","","","","","","","",""]);return json}else{for(var i in changedRows){rows.push([changedRows[i].nodeStatus,$.changeDate,changedRows[i].dept_code,changedRows[i].dept_name,changedRows[i].dept_name_eng,changedRows[i].dept_name_for,changedRows[i].site_code,changedRows[i].parent_dept,changedRows[i].dept_leader,changedRows[i].sales_dept_yn,changedRows[i].marketing_dept_yn,changedRows[i].maypole_code,changedRows[i].memo])}json=createExecuteParamInfo("HR..P_ORG2100_S1",rows);return json}}function searchList(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveBase(workType){if(!validateControls([$.dteChangeDate])){return}var json=createJSON_S(workType);if(workType=="D"){callQuery(["req",json],"D_BASE",$)}else{if(workType=="APPLY"){callQuery(["req",json],workType,$)}else{callQuery(["req",json],"S_BASE",$)}}}function saveList(workType){var json=createJSON_S2(workType);callQuery(["req",json],"S_LIST",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,790);$.panMain.setText("");$.panMain.setBottomLine(true);$.panNowDept=new FingerPanel(host,"panNowDept",0,0,400,760);$.panNowDept.setText("현재조직도");$.panNowDept.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,55,400,665);$.panBaseInfo=new FingerPanel(host,"panBaseInfo",410,0,790,145);$.panBaseInfo.setText("조직도 변경");$.panBaseInfo.setBottomLine(true);$.lblChangeDateKey=new FingerLabel(host,"lblChangeDateKey",0,10,100,20);$.lblChangeDateKey.setText("변경번호");$.lblChangeDate=new FingerLabel(host,"lblChangeDate",250,10,100,20);$.lblChangeDate.setText("변경일자");$.dteChangeDate=new FingerDateEdit(host,"dteChangeDate",355,10,140,20);$.lblMemo=new FingerLabel(host,"lblMemo",0,40,100,20);$.lblMemo.setText("비고");$.memMemo=new FingerMemoEdit(host,"memMemo",105,40,385,45);$.btnSearch=new FingerButton(host,"btnSearch",660,60,130,20);$.btnSearch.setText("조직변경적용");$.panChangeDept=new FingerPanel(host,"panChangeDept",410,160,790,605);$.panChangeDept.setText("변경될조직도");$.panChangeDept.setBottomLine(true);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,400,560);$.lblSiteCode=new FingerLabel(host,"lblSiteCode",420,15,100,20);$.lblSiteCode.setText("사업장");$.cmbSiteCode=new FingerComboBox(host,"cmbSiteCode",525,15,225,20);$.lblDeptCode=new FingerLabel(host,"lblDeptCode",420,45,100,20);$.lblDeptCode.setText("부서코드");$.txtDeptCode=new FingerEdit(host,"txtDeptCode",525,45,225,20);$.lblDeptName=new FingerLabel(host,"lblDeptName",420,75,100,20);$.lblDeptName.setText("부서명");$.txtDeptName=new FingerEdit(host,"txtDeptName",525,75,225,20);$.lblDeptNameEng=new FingerLabel(host,"lblDeptNameEng",420,105,100,20);$.lblDeptNameEng.setText("부서명(영문)");$.txtDeptNameEng=new FingerEdit(host,"txtDeptNameEng",525,105,225,20);$.lblDeptNameChn=new FingerLabel(host,"lblDeptNameChn",420,135,100,20);$.lblDeptNameChn.setText("부서명(한문)");$.txtDeptNameChn=new FingerEdit(host,"txtDeptNameChn",525,135,225,20);$.lblParentDept=new FingerLabel(host,"lblParentDept",420,165,100,20);$.lblParentDept.setText("상위부서");$.cmbParentDept=new FingerComboBox(host,"cmbParentDept",525,165,225,20);$.lblDeptLeader=new FingerLabel(host,"lblDeptLeader",420,195,100,20);$.lblDeptLeader.setText("부서장");$.txtDeptLeader=new FingerEdit(host,"txtDeptLeader",525,195,100,20);$.bteDeptLeader=new FingerButtonEdit(host,"bteDeptLeader",630,195,120,20);$.bteDeptLeader.setText("");$.lblMaypoleCode=new FingerLabel(host,"lblMaypoleCode",420,225,100,20);$.lblMaypoleCode.setText("MayPoleCode");$.cmbMaypoleCode=new FingerComboBox(host,"cmbMaypoleCode",525,225,225,20);$.chkSalesDeptYn=new FingerCheckBox(host,"chkSalesDeptYn",525,255,140,20);$.chkSalesDeptYn.setText("영업부서");$.chkMarketingDeptYn=new FingerCheckBox(host,"chkMarketingDeptYn",525,285,140,20);$.chkMarketingDeptYn.setText("마케팅부서");$.lblMemo2=new FingerLabel(host,"lblMemo2",420,315,100,20);$.lblMemo2.setText("비고");$.memMemo2=new FingerMemoEdit(host,"memMemo2",525,315,220,220);$.bteChangeDateKey=new FingerButtonEdit(host,"bteChangeDateKey",105,10,140,20);$.bteChangeDateKey.setText("");$.lblTodayDate=new FingerLabel(host,"lblTodayDate",0,15,100,20);$.lblTodayDate.setText("현재일자");$.dteTodayDate=new FingerDateEdit(host,"dteTodayDate",105,15,140,20);$.grdList1.colIdx=$.grdListMap=$.grdList1.setColumns([new FingerDataGridColumn("nodeStatus",100,"left","text","상태",{hidden:true}),new FingerDataGridColumn("dept_name",170,"left","text","부서명",{template:"tree"}),new FingerDataGridColumn("dept_code",90,"left","text","부서코드"),new FingerDataGridColumn("dept_name_eng",80,"left","text","부서명(영문)",{hidden:true}),new FingerDataGridColumn("dept_name_for",80,"left","text","부서명(한문)",{hidden:true}),new FingerDataGridColumn("site_code",80,"left","text","사업장코드",{hidden:true}),new FingerDataGridColumn("site_name",120,"left","text","사업장"),new FingerDataGridColumn("parent_dept",80,"left","text","상위부서",{hidden:true}),new FingerDataGridColumn("sales_dept_yn",80,"left","text","영업부서여부",{hidden:true}),new FingerDataGridColumn("marketing_dept_yn",80,"left","text","마케팅부서여부",{hidden:true}),new FingerDataGridColumn("descr",80,"left","text","적요",{hidden:true}),new FingerDataGridColumn("parent_dept_name",80,"left","text","상위부서명",{hidden:true}),new FingerDataGridColumn("header_descr",80,"left","text","적요헤더",{hidden:true}),new FingerDataGridColumn("maypole_code",80,"left","text","maypole_code",{hidden:true})]);$.grdList1.init({nonExcel:true,panel:$.panTree,scroll:"xy",view:"treetable",treeKey:{id:"KeyID",parent:"ParentKeyID"}});$.grdList1.setBorder(false);$.grdList2.colIdx=$.grdListMap=$.grdList2.setColumns([new FingerDataGridColumn("nodeStatus",100,"left","text","상태",{hidden:true}),new FingerDataGridColumn("dept_name",170,"left","text","부서명",{template:"tree"}),new FingerDataGridColumn("dept_code",90,"left","text","부서코드"),new FingerDataGridColumn("dept_name_eng",80,"left","text","부서명(영문)",{hidden:true}),new FingerDataGridColumn("dept_name_for",80,"left","text","부서명(한문)",{hidden:true}),new FingerDataGridColumn("site_code",80,"left","text","사업장코드",{hidden:true}),new FingerDataGridColumn("site_name",120,"left","text","사업장"),new FingerDataGridColumn("parent_dept",80,"left","text","상위부서",{hidden:true}),new FingerDataGridColumn("parent_dept_name",80,"left","text","상위부서명",{hidden:true}),new FingerDataGridColumn("dept_leader",80,"left","text","부서장",{hidden:true}),new FingerDataGridColumn("dept_leader_name",80,"left","text","부서장",{hidden:true}),new FingerDataGridColumn("sales_dept_yn",80,"left","text","영업부서여부",{hidden:true}),new FingerDataGridColumn("marketing_dept_yn",80,"left","text","마케팅부서여부",{hidden:true}),new FingerDataGridColumn("descr",80,"left","text","적요",{hidden:true}),new FingerDataGridColumn("header_descr",80,"left","text","적요헤더",{hidden:true}),new FingerDataGridColumn("maypole_code",80,"left","text","maypole_code",{hidden:true})]);$.grdList2.init({nonExcel:true,panel:$.panTree,scroll:"xy",view:"treetable",treeKey:{id:"KeyID",parent:"ParentKeyID"}});$.grdList2.setBorder(false);$.panBaseInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panChangeDept.addButtons(["btnDelete","btnSave","btnNew"]);$.dteChangeDate.setAllowBlank(false,"변경일자");$.cmbSiteCode.setAllowBlank(false,"사업장");$.txtDeptCode.setAllowBlank(false,"부서코드");$.txtDeptName.setAllowBlank(false,"부서명");$.txtDeptNameEng.setAllowBlank(false,"부서명(영문)");$.txtDeptLeader.setAllowBlank(false,"부서장");$.bteDeptLeader.setAllowBlank(false,"부서장");$.cmbMaypoleCode.setAllowBlank(false,"MaypoleCode");$.cmbSiteCode.setEmptyRow(true);$.cmbParentDept.setEmptyRow(true);$.cmbMaypoleCode.setEmptyRow(true);$.bteChangeDateKey.setReadOnly(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panNowDept);$.panMain.add($.panBaseInfo);$.panMain.add($.panChangeDept);$.panNowDept.add($.grdList1);$.panNowDept.add($.lblTodayDate);$.panNowDept.add($.dteTodayDate);$.panBaseInfo.add($.lblChangeDateKey);$.panBaseInfo.add($.lblChangeDate);$.panBaseInfo.add($.dteChangeDate);$.panBaseInfo.add($.lblMemo);$.panBaseInfo.add($.memMemo);$.panBaseInfo.add($.btnSearch);$.panBaseInfo.add($.bteChangeDateKey);$.panChangeDept.add($.grdList2);$.panChangeDept.add($.lblSiteCode);$.panChangeDept.add($.cmbSiteCode);$.panChangeDept.add($.lblDeptCode);$.panChangeDept.add($.txtDeptCode);$.panChangeDept.add($.lblDeptName);$.panChangeDept.add($.txtDeptName);$.panChangeDept.add($.lblDeptNameEng);$.panChangeDept.add($.txtDeptNameEng);$.panChangeDept.add($.lblDeptNameChn);$.panChangeDept.add($.txtDeptNameChn);$.panChangeDept.add($.lblParentDept);$.panChangeDept.add($.cmbParentDept);$.panChangeDept.add($.lblDeptLeader);$.panChangeDept.add($.txtDeptLeader);$.panChangeDept.add($.bteDeptLeader);$.panChangeDept.add($.lblMaypoleCode);$.panChangeDept.add($.cmbMaypoleCode);$.panChangeDept.add($.chkSalesDeptYn);$.panChangeDept.add($.chkMarketingDeptYn);$.panChangeDept.add($.lblMemo2);$.panChangeDept.add($.memMemo2);$.dteTodayDate.setValue(getToday());$.changeDate=$.dteTodayDate.getValue();$.cmbParentDept.setColumn("dept_code","dept_name");$.cmbSiteCode.setColumn("site_code","site_name");var ds=bizComponentData2($,"Q1","L_ORG001|L_HRI048");setComboBind([$.cmbSiteCode,$.cmbMaypoleCode],ds);searchList("TODAY")};$.callback=function(type,ds){if(type=="TODAY"){setDataGrid([$.grdList1],ds);$.grdList1.openNode("all")}else{if(type=="CHANGE"){setDataGrid([$.grdList2],ds);if(ds.resultList[0].length>0){$.grdList2.selectRow(0);var tempChangeOrg={};if($.dtChangeOrg.length==0){tempChangeOrg.dept_code="";tempChangeOrg.dept_name="";$.dtChangeOrg.push(tempChangeOrg);log($.dtChangeOrg);setComboBind([$.cmbParentDept],$.dtChangeOrg,false);return}if(ds.resultList[0][0].nodeStatus=="U"){$.bteChangeDateKey.setText($.dteChangeDate.getValue())}else{$.bteChangeDateKey.setText("")}}}else{if(type=="S_BASE"){saveList("")}else{if(type=="S_LIST"){searchList("CHANGE")}else{if(type=="D_BASE"){for(var i=0;i<$.grdList2.getRowCount();i++){$.grdList2.setValue(i,"nodeStatus","D")}saveList("")}else{if(type=="APPLY"){log(ds);if(ds.errorMsg!=""){MessageBoxShow(ds.errorMsg);return}else{MessageBoxShow("조직변경적용이 완료되었습니다.")}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){confirmBoxShow("조직변경적용을 실행하시겠습니까?",function(){if(g_main.msgShare==true){saveBase("APPLY")}})}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteDeptLeader"){var param={employee_id:$.txtDeptLeader.getValue()||"",emp_name:$.bteDeptLeader.getText()||""};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}else{if(id=="bteChangeDateKey"){g_main.openPopup("popORG2100.html","popORG2100","",0,0,"","","","","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteChangeDate"){if($.dteChangeDate.getValue()==""){return}if($.bteChangeDateKey.getText()!=""){return}$.changeDate=$.dteChangeDate.getValue();$.memMemo.setValue("");searchList("CHANGE")}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList2"){$.cmbParentDept.clear();if(rId==null){return}$.grdList2.openNode("all");$.cmbSiteCode.setValue($.grdList2.getValue(rId,"site_code"));$.txtDeptCode.setValue($.grdList2.getValue(rId,"dept_code"));$.txtDeptName.setValue($.grdList2.getValue(rId,"dept_name"));$.txtDeptNameEng.setValue($.grdList2.getValue(rId,"dept_name_eng"));$.txtDeptNameChn.setValue($.grdList2.getValue(rId,"dept_name_for"));$.txtDeptLeader.setValue($.grdList2.getValue(rId,"dept_leader"));$.bteDeptLeader.setText($.grdList2.getValue(rId,"dept_leader_name"));$.cmbMaypoleCode.setValue($.grdList2.getValue(rId,"maypole_code"));$.chkSalesDeptYn.setValue($.grdList2.getValue(rId,"sales_dept_yn"));$.chkMarketingDeptYn.setValue($.grdList2.getValue(rId,"marketing_dept_yn"));$.memMemo2.setValue($.grdList2.getValue(rId,"header_descr"));$.txtKeyID=$.grdList2.getValue(rId,"KeyID");$.txtDeptCode.setReadOnly(true);$.varDeptReadOnlyCheck=true;var tempChangeOrg={};tempChangeOrg.dept_code="";tempChangeOrg.dept_name="";tempChangeOrg.ParentKeyID="";$.dtChangeOrg.push(tempChangeOrg);for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"nodeStatus")!="D"&&$.grdList2.getValue(i,"dept_code")!=$.grdList2.getValue(rId,"dept_code")){tempChangeOrg.dept_code=$.grdList2.getValue(i,"dept_code");tempChangeOrg.dept_name=$.grdList2.getValue(i,"dept_name");tempChangeOrg.ParentKeyID=$.grdList2.getValue(i,"ParentKeyID");$.dtChangeOrg.push(tempChangeOrg);tempChangeOrg={}}}setComboBind([$.cmbParentDept],$.dtChangeOrg,false);$.cmbParentDept.setValue($.grdList2.getValue(rId,"parent_dept"))}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panChangeDept"){if(btnId=="btnNew"){$.cmbParentDept.clear();$.panChangeDept.clear();$.txtDeptCode.setReadOnly(false);$.varDeptReadOnlyCheck=false;$.txtDeptCode.setAllowBlank(false,"부서코드");$.cmbSiteCode.setValue(g_main.session.getValue("SiteCode"));var tempChangeOrg={};tempChangeOrg.dept_code="";tempChangeOrg.dept_name="";$.dtChangeOrg.push(tempChangeOrg);if($.dtChangeOrg){for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"nodeStatus")!="D"){tempChangeOrg.dept_code=$.grdList2.getValue(i,"dept_code");tempChangeOrg.dept_name=$.grdList2.getValue(i,"dept_name");tempChangeOrg.ParentKeyID=$.grdList2.getValue(i,"ParentKeyID");$.dtChangeOrg.push(tempChangeOrg);tempChangeOrg={}}}}setComboBind([$.cmbParentDept],$.dtChangeOrg,false)}else{if(btnId=="btnSave"){if(!validateControls([$.dteChangeDate])){return}if(!validateControls([$.cmbSiteCode,$.txtDeptCode,$.txtDeptName,$.txtDeptNameEng,$.txtDeptLeader,$.bteDeptLeader,$.cmbMaypoleCode])){return}if($.dtChangeOrg.length==0){return}if($.varDeptReadOnlyCheck){$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_name",$.txtDeptName.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_code",$.txtDeptCode.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_name_eng",$.txtDeptNameEng.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_name_for",$.txtDeptNameChn.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"site_code",$.cmbSiteCode.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"site_name",$.cmbSiteCode.getText());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"parent_dept",$.cmbParentDept.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_leader",$.txtDeptLeader.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"dept_leader_name",$.bteDeptLeader.getText());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"sales_dept_yn",$.chkSalesDeptYn.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"marketing_dept_yn",$.chkMarketingDeptYn.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"descr",$.chkMarketingDeptYn.getValue());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"parent_dept_name",$.cmbParentDept.getText());$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"header_descr",strKeyId==""?$.txtDeptCode.getValue():strKeyId);$.grdList2.setValue($.grdList2.getSelectedRowIdx(),"maypole_code",$.cmbMaypoleCode.getValue())}else{for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"dept_code")==$.txtDeptCode.getValue()&&$.grdList2.getValue(i,"nodeStatus")!="D"){MessageBoxShow("중복된 부서코드가 있습니다.");return}if($.grdList2.getValue(i,"dept_code")==$.txtDeptCode.getValue()){strKeyId=$.txtDeptCode.getValue()+"_1"}}var strKeyId="";var strNode=strKeyId==""?$.txtDeptCode.getValue():strKeyId;$.grdList2.addRow({nodeStatus:"N",dept_name:$.txtDeptName.getValue(),dept_code:$.txtDeptCode.getValue(),dept_name_eng:$.txtDeptNameEng.getValue(),dept_name_for:$.txtDeptNameChn.getValue(),site_code:$.cmbSiteCode.getValue(),site_name:$.cmbSiteCode.getText(),parent_dept:$.cmbParentDept.getValue(),dept_leader:$.txtDeptLeader.getValue(),dept_leader_name:$.bteDeptLeader.getText(),sales_dept_yn:$.chkSalesDeptYn.getValue(),marketing_dept_yn:$.chkMarketingDeptYn.getValue(),descr:$.memMemo2.getValue(),parent_dept_name:$.cmbParentDept.getText(),header_descr:strKeyId==""?$.txtDeptCode.getValue():strKeyId,maypole_code:$.cmbMaypoleCode.getValue()});$.cmbParentDept.addItem($.txtDeptCode.getValue(),$.txtDeptName.getValue())}}else{if(btnId=="btnDelete"){if(!$.grdList2.getSelectedRowIdx()){MessageBoxShow("삭제할 내용을 선택하십시오.");return false}for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"nodeStatus")!="D"&&$.grdList2.getValue(i,"ParentKeyID")==$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"dept_code")){MessageBoxShow("하위부서가 있습니다. 하위부서 먼저 삭제하십시오.");return false}}if($.grdList2.getValue($.grdList2.getSelectedRowIdx(),"nodeStatus")!="N"){confirmBoxShow("해당 내용을 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveList("D")}})}else{confirmBoxShow("해당 내용을 삭제하시겠습니까?",function(){if(g_main.msgShare==true){$.grdList2.deleteRow($.grdList2.getSelectedRowIdx())}})}}}}}else{if(panelId=="panBaseInfo"){if(btnId=="btnSave"){var strChange_date=$.dteChangeDate.getValue();var nCount=0;var uCount=0;for(var i=0;i<$.grdList2.getRowCount();i++){if($.grdList2.getValue(i,"nodeStatus")=="U"){uCount++}else{if($.grdList2.getValue(i,"nodeStatus")=="N"){nCount++}}}if(uCount==0&&nCount==0){MessageBoxShow("저장할 내용이 없습니다.");return}saveBase("N")}else{if(btnId=="btnNew"){$.panBaseInfo.clear();$.panChangeDept.clear();$.grdList2.clear();$.cmbParentDept.clear()}else{if(btnId=="btnDelete"){confirmBoxShow("해당 내용을 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveBase("D")}})}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if($.popUpCallId=="bteDeptLeader"){$.txtDeptLeader.setValue(popResult.employee_id);$.bteDeptLeader.setText(popResult.emp_name)}else{if($.popUpCallId=="bteChangeDateKey"){$.dteChangeDate.setValue(popResult.change_date);$.bteChangeDateKey.setText(popResult.apply_yn);$.memMemo.setValue(popResult.memo)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>