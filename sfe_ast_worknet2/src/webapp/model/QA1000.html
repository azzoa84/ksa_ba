<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.panDetail=null;$.panFile=null;$.panProc=null;$.lblInstockDateQ=null;$.lblStatusQ=null;$.lblProductQ=null;$.lblLotNoQ=null;$.dteInstockFromQ=null;$.dteInstockToQ=null;$.bteProductQ=null;$.txtLotNoQ=null;$.lblWaveQ=null;$.cmbStatusQ=null;$.btnSearch=null;$.grdList=null;$.lblStatusD=null;$.lblLotNoD=null;$.lblInstockDateD=null;$.lblInstockAmtD=null;$.lblProductD=null;$.lblManufacturerD=null;$.lblPackUnitD=null;$.lblQCAmtD=null;$.lblValidMonthD=null;$.lblKeepAmtD=null;$.lblUseExpireDateD=null;$.lblProduceYearD=null;$.lblImport=null;$.txtLotNoD=null;$.dteInstockDateD=null;$.bteProductD=null;$.txtManufacturerD=null;$.txtPackUnitD=null;$.dteUseExpireD=null;$.dteProduceD=null;$.cmbImportD=null;$.grdFile=null;$.memMemo=null;$.btnPrint=null;$.btnCheck=null;$.panRelation=null;$.lblProductCheckDateP=null;$.lblTakeDateP=null;$.lblQCAmtP=null;$.lblKeepAmtP=null;$.lblTestEndDateP=null;$.lblApprovalDateQAP=null;$.lblApprovalDateP=null;$.dteProductCheckP=null;$.dteTakeP=null;$.dteTestEndP=null;$.dteApprovalQAP=null;$.dteApprovalP=null;$.txtStatusD=null;$.lblMemo=null;$.btnApproval=null;$.speInstockAmtD=null;$.speQCAmtD=null;$.speValidMonthD=null;$.speKeepAmtD=null;$.speQCAmtP=null;$.speKeepAmtP=null;$.lblModifyReason=null;$.txtModifyReason=null;$.cmbTestResult=null;$.txtTestDocNo=null;$.dteRequestDate=null;$.btnAuditTrail=null;$.varQaId="";$.varStatus="";$.varBtnType="";$.varC1ResultYn="";$.varC2ResultYn="";$.varC3ResultYn="";$.varAuthorityYn="";$.varDeleteFiles=[];$.varLotNo="";$.varInstockDate="";$.varInstockAmt=0;$.varExpireDate="";$.varProductDate="";$.session=g_main.session.obj;function createJSON_Q(workType){var json=createExecuteParamInfo("P_QA1000_Q1",[workType,$.dteInstockFromQ.getValue()||"",$.dteInstockToQ.getValue()||"",$.cmbStatusQ.getValue()||"",$.bteProductQ.getValue()||"",$.txtLotNoQ.getText()||""]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_QA1000_Q2",[workType,$.varQaId]);return json}function createJSON_REPORT_Q(workType){var json=createExecuteParamInfo("P_QA1000_REPORT_Q",[workType,$.varQaId]);return json}function createJSON_REPORT_Q2(workType){var json=createExecuteParamInfo("P_QA1000_REPORT_Q2",[workType,$.varQaId]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_QA1000_S",[workType,$.varQaId||"",$.varStatusD||"10",$.txtLotNoD.getText(),$.bteProductD.getValue(),$.bteProductD.getText(),$.txtPackUnitD.getText(),$.txtManufacturerD.getText(),$.dteInstockDateD.getValue(),unmask($.speInstockAmtD.getText()),$.dteUseExpireD.getValue(),unmask($.speValidMonthD.getText()),$.dteProduceD.getValue(),unmask($.speQCAmtD.getText()),unmask($.speKeepAmtD.getText()),$.cmbImportD.getValue(),$.memMemo.getText(),$.txtModifyReason.getValue(),"#UserID#"]);return json}function createJSON_S2(){var rows=[];var aRows=$.grdFile.getChangedRows();var dRows=$.varDeleteFiles;for(var i in aRows){rows.push([aRows[i].rowType,$.varQaId,i,aRows[i].local_filename,aRows[i].server_filename,aRows[i].server_path,"#UserID#"])}if(dRows.length>0){for(var i in dRows){rows.push(["D",$.varQaId,dRows[i].file_seq,dRows[i].local_filename,dRows[i].server_filename,dRows[i].server_path,"#UserID#"])}}log(rows);if(rows.length){return createExecuteParamInfo("P_QA1000_S2",rows)}else{return false}}function createJSON_S3(){var json=createExecuteParamInfo("P_QA1000_S3",["APPROVAL",$.varQaId,"#UserID#"]);return json}function initControls(){$.txtStatusD.setValue("입고계획");$.txtLotNoD.setValue("");$.dteInstockDateD.setValue("");$.speInstockAmtD.setValue(0);$.bteProductD.setText("");$.bteProductD.setValue("");$.txtManufacturerD.setValue("");$.txtPackUnitD.setValue("");$.speQCAmtD.setValue(0);$.speValidMonthD.setValue(0);$.speKeepAmtD.setValue(0);$.dteUseExpireD.setValue("");$.dteProduceD.setValue("");$.cmbImportD.setValue("");$.memMemo.setValue("");$.txtModifyReason.setValue("");$.grdFile.setData("");$.dteProductCheckP.setValue("");$.dteTakeP.setValue("");$.speQCAmtP.setValue("");$.speKeepAmtP.setValue("");$.dteTestEndP.setValue("");$.dteApprovalQAP.setValue("");$.dteApprovalP.setValue("");$.varDeleteFiles=[]}function searchList(){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function searchList1(){var json=createJSON_Q("Q1");callQuery(["req",json],"Q",$)}function searchDetail(){var json=createJSON_Q2("Q");callQuery(["req",json],"Q_D",$)}function saveDetail(workType){var json=createJSON_S(workType);var ds=callExecuteSync(["req",json],"S",false);if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"||workType=="D"){if(workType=="N"){$.varQaId=ds.returnStr}else{if(workType=="D"){$.varQaId="";$.panDetail.clear()}}if(workType!="D"&&($.grdFile.getRowCount()>0||$.varDeleteFiles.length>0)){saveFiles()}searchList()}}function saveFiles(){var json=createJSON_S2();var ds="";if(json){callExecuteSync(["req",json],"F")}}function saveApproval(){var json=createJSON_S3();var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0004"){var param={mail_type:"30",product_name:$.bteProductD.getText(),test_end_date:$.dteTestEndP.getValue(),test_result:$.cmbTestResult.getText(),test_doc_no:$.txtTestDocNo.getValue(),lot_no:$.txtLotNoD.getValue(),instock_date:$.dteInstockDateD.getValue(),use_expire_date:$.dteUseExpireD.getValue(),request_date:$.dteRequestDate.getValue(),approval_date_qa:getToday()};g_main.openPopup("QAP5000.html","popBtnApprovalSendmail","메일발송",570,530,"","",param,"","")}}function printView(){var workType=($.cmbImportD.getValue=="Y"?"REPORT1":"REPORT2");var json=createJSON_REPORT_Q(workType);callQuery(["req",json],"Q_REPORT",$)}function printView2(){var json=createJSON_REPORT_Q2("REPORT");callQuery(["req",json],"Q_REPORT2",$)}function setAuthority(){var authList=searchQAAuth("Q_AUTH");$.MGT_ADD=false;$.MGT_REM=false;$.MGT_SAVE=false;$.MGT_DOC_ADD=false;$.MGT_DOC_REM=false;$.MGT_REPORT_PRINT=false;$.MGT_FIN_CONFIRM=false;$.MGT_DOC_FIRST=false;$.MGT_DOC_SECOND=false;$.MGT_DOC_THIRD=false;if(authList){for(var i=0;i<authList.length;i++){if(authList[i].perm_code=="MGT_ADD"){$.MGT_ADD=true}else{if(authList[i].perm_code=="MGT_REM"){$.MGT_REM=true}else{if(authList[i].perm_code=="MGT_SAVE"){$.MGT_SAVE=true}else{if(authList[i].perm_code=="MGT_DOC_ADD"){$.MGT_DOC_ADD=true}else{if(authList[i].perm_code=="MGT_DOC_REM"){$.MGT_DOC_REM=true}else{if(authList[i].perm_code=="MGT_REPORT_PRINT"){$.MGT_REPORT_PRINT=true}else{if(authList[i].perm_code=="MGT_FIN_CONFIRM"){$.MGT_FIN_CONFIRM=true}else{if(authList[i].perm_code=="MGT_DOC_FIRST"){$.MGT_DOC_FIRST=true}else{if(authList[i].perm_code=="MGT_DOC_SECOND"){$.MGT_DOC_SECOND=true}else{if(authList[i].perm_code=="MGT_DOC_THIRD"){$.MGT_DOC_THIRD=true}}}}}}}}}}}}if(!$.MGT_ADD){$.panDetail.disableButton(["btnNew"])}if(!$.MGT_REM){$.panDetail.disableButton(["btnDelete"])}if(!$.MGT_SAVE){$.panDetail.disableButton(["btnSave"])}if(!$.MGT_DOC_ADD){$.panFile.disableButton(["btnAdd"])}if(!$.MGT_DOC_REM){$.panFile.disableButton(["btnDelete"])}if(!$.MGT_REPORT_PRINT){$.btnPrint.setEnable(false)}if(!$.MGT_FIN_CONFIRM){$.btnApproval.setVisible(false)}}function searchQAAuth(workType){var json=createJSON_Q_AUTH(workType);var ds=callQuerySync(["req",json],workType);if(ds&&ds.resultList){return ds.resultList[0]}else{return false}}function createJSON_Q_AUTH(workType){var json=createExecuteParamInfo("P_stQAAuth_Q",[workType,"","","QA1000","#UserID#"]);return json}function setEnable(){$.panDetail.disableButton(["btnDelete"]);$.panFile.disableButton(["btnDelete","btnAdd"]);$.panDetail.disableButton(["btnSave"]);$.btnCheck.setVisible(false);$.btnApproval.setVisible(false);if($.varStatusD=="10"||$.varStatusD=="15"||$.varStatusD=="20"){if($.MGT_REM){$.panDetail.enableButton(["btnNew","btnSave","btnDelete"]);$.panFile.enableButton(["btnDelete","btnAdd"]);$.txtLotNoD.setReadOnly(false);$.dteInstockDateD.setReadOnly(false);$.speInstockAmtD.setReadOnly(false);$.dteUseExpireD.setReadOnly(false);$.dteProduceD.setReadOnly(false);$.memMemo.setReadOnly(false)}if($.varC1ResultYn!="Y"){$.varBtnType="1";$.btnCheck.setText("서류확인 수입담당자");if($.MGT_DOC_FIRST){$.btnCheck.setVisible(true)}}else{if($.varC1ResultYn=="Y"&&$.varC2ResultYn!="Y"){$.varBtnType="2";$.btnCheck.setText("서류확인 수입담당자");if($.MGT_DOC_SECOND){$.btnCheck.setVisible(true)}}else{if($.varC1ResultYn=="Y"&&$.varC2ResultYn=="Y"&&$.varC3ResultYn!="Y"){$.varBtnType="3";$.btnCheck.setText("서류확인 QA담당자");if($.MGT_DOC_THIRD){$.btnCheck.setVisible(true)}}}}}else{$.txtLotNoD.setReadOnly(true);$.dteInstockDateD.setReadOnly(true);$.speInstockAmtD.setReadOnly(true);$.dteUseExpireD.setReadOnly(true);$.dteProduceD.setReadOnly(true);$.cmbImportD.setReadOnly(true);$.memMemo.setReadOnly(true);$.panFile.disableButton(["btnDelete","btnAdd"]);$.panDetail.disableButton(["btnSave"])}if($.varStatusD=="30"||$.varStatusD=="40"||$.varStatusD=="45"||$.varStatusD=="50"||$.varStatusD=="55"||$.varStatusD=="57"||$.varStatusD=="60"||$.varStatusD=="65"||$.varStatusD=="70"){if($.MGT_REM){$.panDetail.enableButton(["btnNew","btnSave","btnDelete"]);$.panFile.enableButton(["btnDelete","btnAdd"])}}if($.varStatusD=="80"&&$.MGT_FIN_CONFIRM){$.btnApproval.setVisible(true);$.dteApprovalP.setEnable(true)}else{$.btnApproval.setVisible(false);$.dteApprovalP.setEnable(false)}if($.varStatusD=="90"&&$.MGT_DOC_ADD&&$.cmbImportD.getValue()=="N"){$.panFile.enableButton(["btnDelete","btnAdd"]);$.panDetail.enableButton(["btnSave"])}}function chkModify(){var result=true;if($.varLotNo!=$.txtLotNoD.getValue()){result=false}if($.varInstockDate!=$.dteInstockDateD.getValue()){result=false}if($.varInstockAmt!=$.speInstockAmtD.getValue()){result=false}if($.varExpireDate!=$.dteUseExpireD.getValue()){result=false}if($.varProductDate!=$.dteProduceD.getValue()){result=false}return result}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,945);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,65,1200,500);$.panList.setText("품목 입고 목록");$.panList.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",0,0,450,375);$.panDetail.setText("입고 품목 정보");$.panDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",460,0,420,175);$.panFile.setText("품목 입고 관련 서류");$.panFile.setBottomLine(true);$.panProc=new FingerPanel(host,"panProc",890,0,310,375);$.panProc.setText("입고 진행 현황");$.panProc.setBottomLine(true);$.lblInstockDateQ=new FingerLabel(host,"lblInstockDateQ",0,15,80,20);$.lblInstockDateQ.setText("입고일");$.lblStatusQ=new FingerLabel(host,"lblStatusQ",320,15,100,20);$.lblStatusQ.setText("QA진행단계");$.lblProductQ=new FingerLabel(host,"lblProductQ",535,15,70,20);$.lblProductQ.setText("품목");$.lblLotNoQ=new FingerLabel(host,"lblLotNoQ",760,15,100,20);$.lblLotNoQ.setText("Lot No");$.dteInstockFromQ=new FingerDateEdit(host,"dteInstockFromQ",85,15,100,20);$.dteInstockToQ=new FingerDateEdit(host,"dteInstockToQ",210,15,100,20);$.bteProductQ=new FingerButtonEdit(host,"bteProductQ",610,15,180,20);$.bteProductQ.setText("");$.txtLotNoQ=new FingerEdit(host,"txtLotNoQ",865,15,130,20);$.lblWaveQ=new FingerLabel(host,"lblWaveQ",185,15,20,20);$.lblWaveQ.setText("~");$.cmbStatusQ=new FingerComboBox(host,"cmbStatusQ",425,15,125,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,455);$.lblStatusD=new FingerLabel(host,"lblStatusD",5,10,90,20);$.lblStatusD.setText("QA진행단계");$.lblLotNoD=new FingerLabel(host,"lblLotNoD",5,40,90,20);$.lblLotNoD.setText("Lot No");$.lblInstockDateD=new FingerLabel(host,"lblInstockDateD",5,70,90,20);$.lblInstockDateD.setText("입고일");$.lblInstockAmtD=new FingerLabel(host,"lblInstockAmtD",220,70,90,20);$.lblInstockAmtD.setText("입고계획수량");$.lblProductD=new FingerLabel(host,"lblProductD",5,100,90,20);$.lblProductD.setText("품목");$.lblManufacturerD=new FingerLabel(host,"lblManufacturerD",5,130,90,20);$.lblManufacturerD.setText("제조원");$.lblPackUnitD=new FingerLabel(host,"lblPackUnitD",5,160,90,20);$.lblPackUnitD.setText("포장단위");$.lblQCAmtD=new FingerLabel(host,"lblQCAmtD",220,160,90,20);$.lblQCAmtD.setText("QC용");$.lblValidMonthD=new FingerLabel(host,"lblValidMonthD",5,190,90,20);$.lblValidMonthD.setText("유효기간(월)");$.lblKeepAmtD=new FingerLabel(host,"lblKeepAmtD",220,190,90,20);$.lblKeepAmtD.setText("보관용");$.lblUseExpireDateD=new FingerLabel(host,"lblUseExpireDateD",5,220,90,20);$.lblUseExpireDateD.setText("사용기한");$.lblProduceYearD=new FingerLabel(host,"lblProduceYearD",220,220,90,20);$.lblProduceYearD.setText("제조일자");$.lblImport=new FingerLabel(host,"lblImport",5,250,90,20);$.lblImport.setText("국내/수입");$.txtLotNoD=new FingerEdit(host,"txtLotNoD",100,40,340,20);$.dteInstockDateD=new FingerDateEdit(host,"dteInstockDateD",100,70,125,20);$.bteProductD=new FingerButtonEdit(host,"bteProductD",100,100,335,20);$.bteProductD.setText("");$.txtManufacturerD=new FingerEdit(host,"txtManufacturerD",100,130,340,20);$.txtPackUnitD=new FingerEdit(host,"txtPackUnitD",100,160,125,25);$.dteUseExpireD=new FingerDateEdit(host,"dteUseExpireD",100,220,125,20);$.dteProduceD=new FingerDateEdit(host,"dteProduceD",315,220,125,20);$.cmbImportD=new FingerComboBox(host,"cmbImportD",100,250,125,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,420,130);$.memMemo=new FingerMemoEdit(host,"memMemo",460,225,415,123);$.btnPrint=new FingerButton(host,"btnPrint",760,195,140,20);$.btnPrint.setText("서류확인서 출력");$.btnCheck=new FingerButton(host,"btnCheck",600,195,175,20);$.btnCheck.setText("서류확인 수입담당자");$.panRelation=new FingerPanel(host,"panRelation",0,580,1200,375);$.panRelation.setText("");$.panRelation.setBottomLine(true);$.lblProductCheckDateP=new FingerLabel(host,"lblProductCheckDateP",40,10,110,20);$.lblProductCheckDateP.setText("검수완료일");$.lblTakeDateP=new FingerLabel(host,"lblTakeDateP",40,40,110,20);$.lblTakeDateP.setText("검체채취완료일");$.lblQCAmtP=new FingerLabel(host,"lblQCAmtP",10,70,140,20);$.lblQCAmtP.setText("검체채취수량(QA용)");$.lblKeepAmtP=new FingerLabel(host,"lblKeepAmtP",10,100,140,20);$.lblKeepAmtP.setText("검체채취수량(보관용)");$.lblTestEndDateP=new FingerLabel(host,"lblTestEndDateP",10,150,140,20);$.lblTestEndDateP.setText("QA완료일");$.lblApprovalDateQAP=new FingerLabel(host,"lblApprovalDateQAP",10,180,140,20);$.lblApprovalDateQAP.setText("출하승인일(QA)");$.lblApprovalDateP=new FingerLabel(host,"lblApprovalDateP",10,210,140,20);$.lblApprovalDateP.setText("출하승인일(최종)");$.dteProductCheckP=new FingerDateEdit(host,"dteProductCheckP",155,10,140,20);$.dteTakeP=new FingerDateEdit(host,"dteTakeP",155,40,140,20);$.dteTestEndP=new FingerDateEdit(host,"dteTestEndP",155,150,140,20);$.dteApprovalQAP=new FingerDateEdit(host,"dteApprovalQAP",155,180,140,20);$.dteApprovalP=new FingerDateEdit(host,"dteApprovalP",155,210,140,20);$.txtStatusD=new FingerEdit(host,"txtStatusD",100,10,340,20);$.lblMemo=new FingerLabel(host,"lblMemo",450,195,40,20);$.lblMemo.setText("비고");$.btnApproval=new FingerButton(host,"btnApproval",100,250,130,20);$.btnApproval.setText("최종출하승인");$.speInstockAmtD=new FingerSpinEdit(host,"speInstockAmtD",315,70,125,25);$.speQCAmtD=new FingerSpinEdit(host,"speQCAmtD",315,160,125,25);$.speValidMonthD=new FingerSpinEdit(host,"speValidMonthD",100,190,125,25);$.speKeepAmtD=new FingerSpinEdit(host,"speKeepAmtD",315,190,125,25);$.speQCAmtP=new FingerSpinEdit(host,"speQCAmtP",155,70,135,25);$.speKeepAmtP=new FingerSpinEdit(host,"speKeepAmtP",155,100,135,25);$.lblModifyReason=new FingerLabel(host,"lblModifyReason",5,280,90,20);$.lblModifyReason.setText("변경사유");$.txtModifyReason=new FingerEdit(host,"txtModifyReason",100,280,340,20);$.cmbTestResult=new FingerComboBox(host,"cmbTestResult",0,250,30,20);$.txtTestDocNo=new FingerEdit(host,"txtTestDocNo",0,220,30,20);$.dteRequestDate=new FingerDateEdit(host,"dteRequestDate",0,190,30,20);$.btnAuditTrail=new FingerButton(host,"btnAuditTrail",100,270,130,20);$.btnAuditTrail.setText("Audit Trail");$.panQuery.setBorder(true);$.panDetail.addButton("btnDelete","삭제");$.panDetail.addButton("btnSave","수정");$.panDetail.addButton("btnNew","신규");$.panDetail.setButtonAction("btnDelete","delete");$.panDetail.setButtonAction("btnSave","save");$.panDetail.setButtonAction("btnNew","new");$.panFile.addButtons(["btnDelete","btnAdd"]);$.speQCAmtD.setReadOnly(true);$.speKeepAmtD.setReadOnly(true);$.grdList.setColumns([new FingerDataGridColumn("qa_id",99,"left","string","입고ID",{hidden:true}),new FingerDataGridColumn("instock_date",90,"center","string","입고일",{format:"s_ymd"}),new FingerDataGridColumn("lot_no",90,"center","string","Lot No"),new FingerDataGridColumn("product_name",160,"left","string","품목"),new FingerDataGridColumn("instock_amt",95,"right","string","입고계획수량",{format:"int"}),new FingerDataGridColumn("good_instock_amt",80,"right","string","입고수량",{format:"int"}),new FingerDataGridColumn("shipment_amt",80,"right","string","출하수량",{format:"int"}),new FingerDataGridColumn("status",99,"left","string","QA진행단계ID",{hidden:true}),new FingerDataGridColumn("status_name",95,"center","string","QA진행단계"),new FingerDataGridColumn("product_check_date",95,"center","string","검수완료일",{format:"s_ymd"}),new FingerDataGridColumn("test_request_date",95,"center","string","시험의뢰일",{format:"s_ymd"}),new FingerDataGridColumn("test_result_request_date",100,"center","string","QC완료예정일",{format:"s_ymd"}),new FingerDataGridColumn("test_end_date",95,"center","string","QC완료일",{format:"s_ymd"}),new FingerDataGridColumn("approval_date_qa",99,"center","string","출하승인일(QA)",{hidden:true}),new FingerDataGridColumn("approval_date",115,"center","string","출하승인일(최종)",{format:"s_ymd"}),new FingerDataGridColumn("import",99,"left","string","국내/수입",{hidden:true}),new FingerDataGridColumn("check2_result_yn",99,"left","string","서류확인 수입담당자",{hidden:true}),new FingerDataGridColumn("check3_result_yn",99,"left","string","서류확인 QA담당자",{hidden:true})]);$.grdList.init({panel:$.panList});$.grdList.setColumnHidden(["qa_id","status","import","check1_result_yn","check2_result_yn","check3_result_yn"],true);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_seq",50,"center","string","순번",{readonly:true}),new FingerDataGridColumn("local_filename",300,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_filename"]}),new FingerDataGridColumn("server_path",99,"left","string","파일경로",{hidden:true}),new FingerDataGridColumn("server_filename",99,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("file_path",99,"left","string","로컬파일경로",{hidden:true})]);$.grdFile.init({scroll:"xy"});$.grdFile.setBorder(false);$.grdFile.setEditable(true);$.dteInstockFromQ.setValue(getCalcMonth(getToday(""),-1));$.dteInstockToQ.setValue(getToday(""));$.dteInstockFromQ.setDefaultValue(getCalcMonth(getToday(""),-1));$.dteInstockToQ.setDefaultValue(getToday(""));$.txtStatusD.setReadOnly(true);$.bteProductD.setEnable(false);$.dteProductCheckP.setEnable(false);$.dteTakeP.setEnable(false);$.speQCAmtP.setReadOnly(true);$.speKeepAmtP.setReadOnly(true);$.dteTestEndP.setEnable(false);$.dteApprovalQAP.setEnable(false);$.dteApprovalP.setReadOnly(true);$.txtManufacturerD.setEnable(false);$.txtPackUnitD.setEnable(false);$.speValidMonthD.setEnable(false);$.cmbImportD.setEnable(false);$.lblApprovalDateP.setVisible(false);$.dteApprovalP.setVisible(false);$.cmbTestResult.setVisible(false);$.txtTestDocNo.setVisible(false);$.dteRequestDate.setVisible(false);$.memMemo.setReadOnly(true);$.panDetail.setEnable(false);$.dteProductCheckP.setEnable(false);$.dteTakeP.setEnable(false);$.speQCAmtP.setReadOnly(true);$.speKeepAmtP.setReadOnly(true);$.dteTestEndP.setEnable(false);$.dteApprovalQAP.setEnable(false);$.dteApprovalP.setEnable(false);$.cmbStatusQ.setEmptyRow(true);$.speInstockAmtD.setAllowBlank(false,"입고수량");$.txtLotNoD.setAllowBlank(false,"Lot No");$.dteInstockDateD.setAllowBlank(false,"입고일");$.dteUseExpireD.setAllowBlank(false,"사용기한");$.dteProduceD.setAllowBlank(false,"제조일자");$.bteProductD.setAllowBlank(false,"품목");$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panRelation);$.panQuery.add($.lblInstockDateQ);$.panQuery.add($.lblStatusQ);$.panQuery.add($.lblProductQ);$.panQuery.add($.lblLotNoQ);$.panQuery.add($.dteInstockFromQ);$.panQuery.add($.lblWaveQ);$.panQuery.add($.dteInstockToQ);$.panQuery.add($.bteProductQ);$.panQuery.add($.txtLotNoQ);$.panQuery.add($.cmbStatusQ);$.panQuery.add($.btnSearch);$.panList.add($.grdList);$.panDetail.add($.lblLotNoD);$.panDetail.add($.lblInstockDateD);$.panDetail.add($.lblInstockAmtD);$.panDetail.add($.lblProductD);$.panDetail.add($.lblManufacturerD);$.panDetail.add($.lblPackUnitD);$.panDetail.add($.lblQCAmtD);$.panDetail.add($.lblValidMonthD);$.panDetail.add($.lblKeepAmtD);$.panDetail.add($.lblUseExpireDateD);$.panDetail.add($.lblProduceYearD);$.panDetail.add($.lblImport);$.panDetail.add($.txtLotNoD);$.panDetail.add($.dteInstockDateD);$.panDetail.add($.bteProductD);$.panDetail.add($.txtManufacturerD);$.panDetail.add($.txtPackUnitD);$.panDetail.add($.dteUseExpireD);$.panDetail.add($.dteProduceD);$.panDetail.add($.cmbImportD);$.panDetail.add($.lblStatusD);$.panDetail.add($.txtStatusD);$.panDetail.add($.speInstockAmtD);$.panDetail.add($.speQCAmtD);$.panDetail.add($.speValidMonthD);$.panDetail.add($.speKeepAmtD);$.panDetail.add($.lblModifyReason);$.panDetail.add($.txtModifyReason);$.panFile.add($.grdFile);$.panProc.add($.lblProductCheckDateP);$.panProc.add($.lblTakeDateP);$.panProc.add($.lblQCAmtP);$.panProc.add($.lblKeepAmtP);$.panProc.add($.lblTestEndDateP);$.panProc.add($.lblApprovalDateQAP);$.panProc.add($.lblApprovalDateP);$.panProc.add($.dteProductCheckP);$.panProc.add($.dteTakeP);$.panProc.add($.dteTestEndP);$.panProc.add($.dteApprovalQAP);$.panProc.add($.dteApprovalP);$.panProc.add($.btnApproval);$.panProc.add($.speQCAmtP);$.panProc.add($.speKeepAmtP);$.panProc.add($.cmbTestResult);$.panProc.add($.txtTestDocNo);$.panProc.add($.dteRequestDate);$.panProc.add($.btnAuditTrail);$.panRelation.add($.panDetail);$.panRelation.add($.btnPrint);$.panRelation.add($.btnCheck);$.panRelation.add($.panFile);$.panRelation.add($.panProc);$.panRelation.add($.memMemo);$.panRelation.add($.lblMemo);var ds=bizComponentData2($,"Q1","L_ST0001|L_CRM279");setComboBind([$.cmbStatusQ],ds);var ds=bizComponentData2($,"Q2","L_ST0068");setComboBind([$.cmbImportD],ds);var ds=bizComponentData2($,"Q1","L_ST0009");setComboBind([$.cmbTestResult],ds);setAuthority();if($.MGT_FIN_CONFIRM){searchList1()}else{searchList()}$.btnCheck.setVisible(false);$.btnApproval.setVisible(false);relocateChildIndexInPanel([$.panQuery,$.panRelation,$.panDetail,$.panProc])};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdList],ds);if(ds.resultList[0].length>0){if($.varQaId==""){$.grdList.selectRow(0)}else{$.grdList.selectRow($.grdList.getGridRowIndex("qa_id",$.varQaId))}}}else{if(type=="Q_D"){if(!ds||ds.resultList[0].length<=0){return}var result="",result2="";if(ds.resultList[0].length>0){result=ds.resultList[0][0]}var session=g_main.session.obj;$.varC1ResultYn=result.check1_result_yn||"";$.varC2ResultYn=result.check2_result_yn||"";$.varC3ResultYn=result.check3_result_yn||"";$.varStatusD=result.status;$.txtStatusD.setText(result.status_name);$.txtLotNoD.setText(result.lot_no);$.dteInstockDateD.setValue(result.instock_date);$.speInstockAmtD.setValue(result.instock_amt);$.bteProductD.setText(result.product_name);$.bteProductD.setValue(result.product_code);$.txtManufacturerD.setValue(result.manufacturer);$.txtPackUnitD.setText(result.pack_unit);$.speQCAmtD.setText(result.qc_amt);$.speValidMonthD.setText(result.valid_month);$.speKeepAmtD.setText(result.keep_amt);$.dteUseExpireD.setValue(result.use_expire_date);$.dteProduceD.setValue(result.produce_year);$.cmbImportD.setValue(result["import"]);$.memMemo.setValue(result.remark);$.txtModifyReason.setText(result.modify_reason);$.dteProductCheckP.setValue(result.product_check_date);$.dteTakeP.setValue(result.take_date);$.speQCAmtP.setValue(result.qc_amt1);$.speKeepAmtP.setValue(result.keep_amt1);$.dteTestEndP.setValue(result.test_end_date);$.dteApprovalQAP.setValue(result.approval_date_qa);$.dteApprovalP.setValue(result.approval_date);$.cmbTestResult.setValue(result.test_result);$.txtTestDocNo.setValue(result.test_doc_no);$.dteRequestDate.setValue(result.request_date);$.bteProductD.setEnable(false);$.btnCheck.setVisible(false);$.varLotNo=result.lot_no;$.varInstockDate=result.instock_date;$.varInstockAmt=result.instock_amt;$.varExpireDate=result.use_expire_date;$.varProductDate=result.produce_year;setEnable();setDataGrid([null,$.grdFile,null],ds)}else{if(type=="Q_REPORT"){if(ds.resultList[1].length>0){for(var i in ds.resultList[1]){if(ds.resultList[1][i].check_result1=="○"){ds.resultList[1][i].check_result1="True"}else{ds.resultList[1][i].check_result1="False"}if(ds.resultList[1][i].check_result2=="○"){ds.resultList[1][i].check_result2="True"}else{ds.resultList[1][i].check_result2="False"}if(ds.resultList[1][i].check_result3=="○"){ds.resultList[1][i].check_result3="True"}else{ds.resultList[1][i].check_result3="False"}if(ds.resultList[1][i].check_result4=="○"){ds.resultList[1][i].check_result4="True"}else{ds.resultList[1][i].check_result4="False"}if(ds.resultList[1][i].check_result5=="○"){ds.resultList[1][i].check_result5="True"}else{ds.resultList[1][i].check_result5="False"}if(ds.resultList[1][i].check2_sign){ds.resultList[1][i].check2_sign=convertByteArrayToImageSource(ds.resultList[1][i].check2_sign)}if(ds.resultList[1][i].check3_sign){ds.resultList[1][i].check3_sign=convertByteArrayToImageSource(ds.resultList[1][i].check3_sign)}if(ds.resultList[1][i].check2_time){ds.resultList[1][i].check2_time=ds.resultList[1][i].check2_time.toString()}if(ds.resultList[1][i].check3_time){ds.resultList[1][i].check3_time=ds.resultList[1][i].check3_time.toString()}}}var rs1=ds.resultList[0];var rs2=ds.resultList[1];var reportName="";if($.cmbImportD.getValue()=="Y"){reportName="report_QA1000_1"}else{reportName="report_QA1000"}var params={report:reportName,isPrint:false,data:{Info:rs1,Check:rs2}};g_printBrowser.callPrint(params)}else{if(type=="Q_REPORT2"){var params={report:"report_QA_Audit_Trail",isPrint:false};params.data={Info:{product_name:$.bteProductD.getText(),lot_no:$.txtLotNoD.getValue()},List:ds.resultList[0]};g_printBrowser.callPrint(params)}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){$.varQaId="";searchList()}else{if(id=="btnCheck"){if($.varQdId==""){return}$.popUpCallId="bteCheck";var param={qa_id:$.varQaId,btn_type:$.varBtnType};g_main.openPopup("QA1000sub.html","QA1000sub","서류확인",700,550,"","",param,"","")}else{if(id=="btnPrint"){printView()}else{if(id=="btnApproval"){confirmBoxShow("최종 출하 승인 하시겠습니까? <br>(완료 후에는 수정 및 변경이 불가능합니다.)",function(){if(g_main.msgShare==true){var param={};g_main.openPopup("popWFPassword.html","popWFPassword","QA 결재비밀번호",300,150,"","",param,"","")}})}else{if(id=="btnAuditTrail"){printView2()}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){if(id=="bteProductQ"){$.popUpCallId="bteProductQ";var param={product_code:"",product_name:$.bteProductQ.getText()};g_main.openPopup("popQAProduct.html","popQAProduct","QA제품팝업",705,500,"","",param,"","")}else{if(id=="bteProductD"){$.popUpCallId="bteProductD";var param={product_code:"",product_name:$.bteProductD.getText()};g_main.openPopup("popQAProduct.html","popQAProduct","QA제품팝업",705,500,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteInstockDateD"){if(value!=""||value){if(value>$.dteUseExpireD.getValue()||$.dteUseExpireD.getValue()==""||!$.dteUseExpireD.getValue()){$.dteUseExpireD.setValue(value)}}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){if(rId==-1){return}$.varQaId=$.grdList.getValue(rId,"qa_id");$.varDeleteFiles=[];searchDetail()}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtLotNoQ"&&value=="13"){searchList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panDetail"){if(btnId=="btnNew"){$.varStatusD="10";initControls();setEnable();$.bteProductD.setEnable(true);$.bteProductD.setAllowBlank(false,"품목");$.panDetail.disableButton(["btnDelete"]);$.varQaId=""}else{if(btnId=="btnSave"){if($.speInstockAmtD.getValue()=="0"){MessageBoxShow("입고수량은 1이상이 되어야 합니다.");$.speInstockAmtD.setFocus();return}else{if($.bteProductD.getValue()==""){MessageBoxShow("품목 은(는) 필수입력 항목 입니다.");return}}if(!validateControls([$.speInstockAmtD,$.txtLotNoD,$.dteInstockDateD,$.dteUseExpireD,$.dteProduceD,$.bteProductD])){return}var workType=($.varQaId==""?"N":"U");if(workType=="U"&&$.txtModifyReason.getText()==""&&!chkModify()){MessageBoxShow("변경사유를 입력하시기 바랍니다.");return}if(workType=="U"&&chkModify()){saveDetail(workType);searchList()}else{saveDetail(workType)}}else{if(btnId=="btnDelete"){if($.varQaId==""){return}confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){saveDetail("D")}})}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("QA",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_filename")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}fileList[i].local_filename=fileList[i].local_fname;fileList[i].server_filename=fileList[i].server_fname}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare){var rId=$.grdFile.getSelectedRowIdx();$.varDeleteFiles.push($.grdFile.getValue(rId));$.grdFile.deleteCurrentRow()}})}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popQAProduct"){if($.popUpCallId=="bteProductQ"){$.bteProductQ.setText(popResult.product_name);$.bteProductQ.setValue(popResult.product_code)}else{if($.popUpCallId=="bteProductD"){$.bteProductD.setText(popResult.product_name);$.bteProductD.setValue(popResult.product_code);$.txtPackUnitD.setValue(popResult.pack_unit||"");$.txtManufacturerD.setValue(popResult.manufacturer||"");$.speValidMonthD.setValue(popResult.valid_month||0);$.speKeepAmtD.setValue(popResult.keep_amt||0);$.speQCAmtD.setValue(popResult.qc_amt||0);$.cmbImportD.setValue(popResult["import"])}}}else{if(id=="QA1000sub"){if($.popUpCallId=="bteCheck"&&popResult.save_yn=="Y"){$.popUpCallId="bteCheck";var param={mail_type:($.varBtnType=="1"?"40":$.varBtnType=="2"?"50":"60"),product_name:$.bteProductD.getText(),instock_amt:$.speInstockAmtD.getValue(),instock_date:$.dteInstockDateD.getValue(),product_check_date:"",lot_no:$.txtLotNoD.getText(),use_expire_date:$.dteUseExpireD.getValue()};g_main.openPopup("QAP5000.html","QAP5000","메일발송",570,530,"","",param,"","")}}else{if(id=="QAP5000"){if($.popUpCallId=="bteCheck"){if(popResult.send_yn=="Y"){MessageBoxShow("메일이 발송 되었습니다.")}searchList()}}else{if(id=="popWFPassword"){if(popResult.result){saveApproval()}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>