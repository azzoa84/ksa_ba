<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.grdList=null;$.btnCancel=null;$.btnSave=null;$.panRequest=null;$.lblRequestDate=null;$.dteRequestDate=null;$.panCheckList=null;$.lblChkItem1=null;$.lblChkItem2=null;$.lblChkItem3=null;$.lblChkItem4=null;$.lblChkItem5=null;$.lblChkItem6=null;$.ChkItem1=null;$.ChkItem2=null;$.ChkItem3=null;$.ChkItem4=null;$.ChkItem5=null;$.ChkItem6=null;$.panComment=null;$.memoComment1=null;$.memoComment2=null;$.memoComment3=null;$.memoComment4=null;$.memoComment5=null;$.lblComment1=null;$.lblComment2=null;$.lblComment3=null;$.lblComment4=null;$.lblComment5=null;$.varQaId="";$.varCheckType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_QAP1000_Q",[workType,$.varQaId]);return json}function createJSON_S(workType){var json="";var cRow=$.grdList.getAllRows();if(cRow.length<1){return false}var rows=[];for(var i in cRow){rows.push([workType,cRow[i].qa_id,$.dteRequestDate.getValue(),$.varCheckType,$.ChkItem1.getValue(),$.ChkItem2.getValue(),$.ChkItem3.getValue(),$.ChkItem4.getValue(),$.ChkItem5.getValue(),$.ChkItem6.getValue(),$.memoComment1.getValue(),$.memoComment2.getValue(),$.memoComment3.getValue(),$.memoComment4.getValue(),$.memoComment5.getValue(),cRow[i].good_instock_amt,"#UserID#"])}json=createExecuteParamInfo("P_QAP1000_S",rows);return json}function createJSON_S2(workType){var json=createExecuteParamInfo("P_QAP1000_S",[workType,$.varQaId,"",$.varCheckType,"","","","","","","","","","","",0,"#UserID#"]);return json}function searchList(){if($.varQaId==""){return}var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function saveRequest(){var json=createJSON_S("N");var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0002"){MailSend();if($.IMPORT_MANAGER){var share={save_yn:"Y",close_yn:"Y"};g_popupStack.setData(share);g_popupStack.close()}else{var share={save_yn:"Y",close_yn:"N"};g_popupStack.setData(share);g_popupStack.close()}}}function MailSend(){var json=createJSON_S2("Mail");callQuery(["req",json],"Mail",$)}function setAuthority(){var dt=searchQAAuth("Q_AUTH");var authList=dt[0];$.TALLY_SN_UPLOAD=false;$.TALLY_FIN_SENDMAIL=false;$.TALLY_FIN_END=false;$.TALLY_FIN_REPORT=false;$.TALLY_FIN_REQUEST=false;$.TALLY_FIN_SUCCESS=false;$.TALLY_DELETE=false;$.TALLY_FIRST=false;$.TALLY_SECOND=false;$.TALLY_THIRD=false;$.TALLY_FOURH=false;if(authList){for(var i=0;i<authList.length;i++){if(authList[i].perm_code=="TALLY_SN_UPLOAD"){$.TALLY_SN_UPLOAD=true}else{if(authList[i].perm_code=="TALLY_FIN_SENDMAIL"){$.TALLY_FIN_SENDMAIL=true}else{if(authList[i].perm_code=="TALLY_FIN_END"){$.TALLY_FIN_END=true}else{if(authList[i].perm_code=="TALLY_FIN_REPORT"){$.TALLY_FIN_REPORT=true}else{if(authList[i].perm_code=="TALLY_FIN_REQUEST"){$.TALLY_FIN_REQUEST=true}else{if(authList[i].perm_code=="TALLY_FIN_SUCCESS"){$.TALLY_FIN_SUCCESS=true}else{if(authList[i].perm_code=="TALLY_DELETE"){$.TALLY_DELETE=true}else{if(authList[i].perm_code=="TALLY_FIRST"){$.TALLY_FIRST=true}else{if(authList[i].perm_code=="TALLY_SECOND"){$.TALLY_SECOND=true}else{if(authList[i].perm_code=="TALLY_THIRD"){$.TALLY_THIRD=true}else{if(authList[i].perm_code=="TALLY_FOURH"){$.TALLY_FOURH=true}}}}}}}}}}}}}var authCode=dt[1];$.WH_USER=false;$.QC_USER=false;$.QA_USER=false;$.QA_MANAGER=false;$.IMPORT_MANAGER=false;if(authCode){for(var i=0;i<authCode.length;i++){if(authCode[i].qa_auth_code=="WH_USER"){$.WH_USER=true}else{if(authCode[i].qa_auth_code=="QC_USER"){$.QC_USER=true}else{if(authCode[i].qa_auth_code=="QA_USER"){$.QA_USER=true}else{if(authCode[i].qa_auth_code=="QA_MANAGER"){$.QA_MANAGER=true}else{if(authCode[i].qa_auth_code=="IMPORT_MANAGER"){$.IMPORT_MANAGER=true}}}}}}}}function searchQAAuth(workType){var json=createJSON_Q_AUTH(workType);var ds=callQuerySync(["req",json],workType);if(ds&&ds.resultList){return ds.resultList}else{return false}}function createJSON_Q_AUTH(workType){var json=createExecuteParamInfo("P_stQAAuth_Q",[workType,"","","QA2000",g_main.session.obj.UserID]);return json}function setReadOnly(){if($.WH_USER){$.memoComment1.setReadOnly(false);$.dteRequestDate.setReadOnly(false)}else{if($.QC_USER){$.ChkItem1.setEnable(true);$.ChkItem2.setEnable(true);$.ChkItem3.setEnable(true);$.ChkItem4.setEnable(true);$.ChkItem5.setEnable(true);$.memoComment2.setReadOnly(false)}else{if($.QA_USER){$.ChkItem6.setEnable(true);$.memoComment3.setReadOnly(false)}else{if($.QA_MANAGER){$.memoComment4.setReadOnly(false)}else{if($.IMPORT_MANAGER){$.memoComment5.setReadOnly(false)}}}}}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,700,810);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,700,205);$.panList.setText("제품 입고 정보");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,700,155);$.btnCancel=new FingerButton(host,"btnCancel",625,15,80,20);$.btnCancel.setText("취소");$.btnSave=new FingerButton(host,"btnSave",560,15,80,20);$.btnSave.setText("확인");$.panRequest=new FingerPanel(host,"panRequest",0,710,700,100);$.panRequest.setText("검수 요청");$.panRequest.setBottomLine(true);$.lblRequestDate=new FingerLabel(host,"lblRequestDate",150,15,100,20);$.lblRequestDate.setText("검수요청일");$.dteRequestDate=new FingerDateEdit(host,"dteRequestDate",255,15,140,20);$.panCheckList=new FingerPanel(host,"panCheckList",0,205,700,175);$.panCheckList.setText("점검사항");$.panCheckList.setBottomLine(true);$.lblChkItem1=new FingerLabel(host,"lblChkItem1",0,20,220,20);$.lblChkItem1.setText("1.부착된 표지의 상태 (도착지 정보)");$.lblChkItem2=new FingerLabel(host,"lblChkItem2",300,20,200,20);$.lblChkItem2.setText("2.외관 및 봉합의 파손 여부");$.lblChkItem3=new FingerLabel(host,"lblChkItem3",0,50,200,20);$.lblChkItem3.setText("3.물에 젖거나 침적된 흔적 여부");$.lblChkItem4=new FingerLabel(host,"lblChkItem4",325,50,250,20);$.lblChkItem4.setText("4.곤충이나 쥐 등의 침해를 받은 흔적 여부");$.lblChkItem5=new FingerLabel(host,"lblChkItem5",0,80,195,20);$.lblChkItem5.setText("5.품명, 수량, 제조번호 등 확인");$.lblChkItem6=new FingerLabel(host,"lblChkItem6",330,80,150,20);$.lblChkItem6.setText("6.제조원의 성적서 유무");$.ChkItem1=new FingerCheckBox(host,"ChkItem1",240,20,60,25);$.ChkItem1.setText("적합");$.ChkItem2=new FingerCheckBox(host,"ChkItem2",600,20,60,25);$.ChkItem2.setText("적합");$.ChkItem3=new FingerCheckBox(host,"ChkItem3",240,50,60,25);$.ChkItem3.setText("적합");$.ChkItem4=new FingerCheckBox(host,"ChkItem4",600,50,60,25);$.ChkItem4.setText("적합");$.ChkItem5=new FingerCheckBox(host,"ChkItem5",240,80,60,25);$.ChkItem5.setText("적합");$.ChkItem6=new FingerCheckBox(host,"ChkItem6",600,80,60,25);$.ChkItem6.setText("적합");$.panComment=new FingerPanel(host,"panComment",0,385,700,320);$.panComment.setText("담당자 의견");$.panComment.setBottomLine(true);$.memoComment1=new FingerMemoEdit(host,"memoComment1",120,10,500,40);$.memoComment2=new FingerMemoEdit(host,"memoComment2",120,60,500,40);$.memoComment3=new FingerMemoEdit(host,"memoComment3",120,110,500,40);$.memoComment4=new FingerMemoEdit(host,"memoComment4",120,160,500,40);$.memoComment5=new FingerMemoEdit(host,"memoComment5",120,210,500,40);$.lblComment1=new FingerLabel(host,"lblComment1",10,20,100,20);$.lblComment1.setText("입고담당자");$.lblComment2=new FingerLabel(host,"lblComment2",0,70,110,20);$.lblComment2.setText("품질관리담당자");$.lblComment3=new FingerLabel(host,"lblComment3",10,120,100,20);$.lblComment3.setText("QA 담당자");$.lblComment4=new FingerLabel(host,"lblComment4",10,170,100,20);$.lblComment4.setText("QA 관리자");$.lblComment5=new FingerLabel(host,"lblComment5",10,220,100,20);$.lblComment5.setText("수입관리자");$.grdList.setColumns([new FingerDataGridColumn("qa_id",99,"left","ro","입고ID",{hidden:true}),new FingerDataGridColumn("instock_date",100,"center","ro","입고일",{format:"s_ymd",readonly:true}),new FingerDataGridColumn("lot_no",110,"left","ro","Lot No",{readonly:true}),new FingerDataGridColumn("product_name",200,"left","ro","품목명",{readonly:true}),new FingerDataGridColumn("instock_amt",80,"right","ro","입고수량",{format:"int",readonly:true}),new FingerDataGridColumn("good_instock_amt",100,"right","ro","적합입고수량",{format:"int"}),new FingerDataGridColumn("manufacturer",200,"left","ro","제조원",{readonly:true}),new FingerDataGridColumn("use_expire_date",100,"center","ro","사용기한",{format:"s_ymd",readonly:true}),new FingerDataGridColumn("produce_year",100,"center","ro","제조일자",{format:"s_ymd",readonly:true}),new FingerDataGridColumn("pack_unit",99,"left","ro","포장단위",{hidden:true}),new FingerDataGridColumn("valid_month",99,"left","ro","유통기한(월)",{hidden:true}),new FingerDataGridColumn("qc_amt",99,"left","ro","QC용",{hidden:true}),new FingerDataGridColumn("keep_amt",99,"left","ro","보관용",{hidden:true}),new FingerDataGridColumn("status",99,"left","ro","QA진행단계",{hidden:true}),new FingerDataGridColumn("import",99,"left","ro","국내/수입",{hidden:true}),new FingerDataGridColumn("check1_result_yn",99,"left","ro","서류확인 1차",{hidden:true}),new FingerDataGridColumn("check2_result_yn",99,"left","ro","서류확인 수입담당자",{hidden:true}),new FingerDataGridColumn("check3_result_yn",99,"left","ro","서류확인 QA담당자",{hidden:true})]);$.grdList.init({scroll:"xy",eventCellReadOnly:true});$.grdList.setBorder(false);$.grdList.setEditable(true);$.dteRequestDate.setValue(getToday(""));$.ChkItem1.setEnable(false);$.ChkItem2.setEnable(false);$.ChkItem3.setEnable(false);$.ChkItem4.setEnable(false);$.ChkItem5.setEnable(false);$.ChkItem6.setEnable(false);$.memoComment1.setReadOnly(true);$.memoComment2.setReadOnly(true);$.memoComment3.setReadOnly(true);$.memoComment4.setReadOnly(true);$.memoComment5.setReadOnly(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panRequest);$.panMain.add($.panCheckList);$.panMain.add($.panComment);$.panList.add($.grdList);$.panRequest.add($.btnSave);$.panRequest.add($.btnCancel);$.panRequest.add($.dteRequestDate);$.panRequest.add($.lblRequestDate);$.panCheckList.add($.lblChkItem1);$.panCheckList.add($.lblChkItem2);$.panCheckList.add($.lblChkItem3);$.panCheckList.add($.lblChkItem5);$.panCheckList.add($.lblChkItem6);$.panCheckList.add($.lblChkItem4);$.panCheckList.add($.ChkItem1);$.panCheckList.add($.ChkItem2);$.panCheckList.add($.ChkItem3);$.panCheckList.add($.ChkItem4);$.panCheckList.add($.ChkItem5);$.panCheckList.add($.ChkItem6);$.panComment.add($.memoComment1);$.panComment.add($.memoComment2);$.panComment.add($.memoComment3);$.panComment.add($.memoComment4);$.panComment.add($.memoComment5);$.panComment.add($.lblComment1);$.panComment.add($.lblComment2);$.panComment.add($.lblComment4);$.panComment.add($.lblComment5);$.panComment.add($.lblComment3);if($.p_argument){if($.p_argument.qa_id){$.varQaId=$.p_argument.qa_id}if($.p_argument.checkType){$.varCheckType=$.p_argument.checkType}}setAuthority();searchList();setReadOnly()};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdList],ds);var result="";if(ds.resultList[1].length>0){result=ds.resultList[1][0]}else{return}$.ChkItem1.setValue(result.item1_check);$.ChkItem2.setValue(result.item2_check);$.ChkItem3.setValue(result.item3_check);$.ChkItem4.setValue(result.item4_check);$.ChkItem5.setValue(result.item5_check);$.ChkItem6.setValue(result.item6_check);$.memoComment1.setValue(result.create_comment);$.memoComment2.setValue(result.check1_comment);$.memoComment3.setValue(result.check2_comment);$.memoComment4.setValue(result.check3_comment);$.memoComment5.setValue(result.check4_comment);if(!($.QA_USER)){var aRow=$.grdList.getAllRows();for(var i in aRow){aRow[i].good_instock_amt_readonly=true}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSave"){if($.dteRequestDate.getValue()==""){MessageBoxShow("검수요청일 은(는) 필수 입력 항목 입니다.");return}if($.QC_USER){if($.ChkItem1.getValue()=="N"||$.ChkItem2.getValue()=="N"||$.ChkItem3.getValue()=="N"||$.ChkItem4.getValue()=="N"||$.ChkItem5.getValue()=="N"){confirmBoxShow("부적합 건이 존재합니다. 진행하시겠습니까?",function(){if(g_main.msgShare==true){var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}})}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}else{if($.QA_USER){if($.ChkItem6.getValue()=="N"){confirmBoxShow("부적합 건이 존재합니다. 진행하시겠습니까?",function(){if(g_main.msgShare==true){var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}})}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}else{var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}}else{if(id=="btnCancel"){g_popupStack.close()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popWFPassword"){if(popResult.result){saveRequest()}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>