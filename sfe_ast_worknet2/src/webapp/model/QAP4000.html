<script>function Main(){var $=this;$.host=null;$.bteProductName1=null;$.dteInstockDate=null;$.dteProduceYear=null;$.dteRequestDate=null;$.dteResultRequestDate=null;$.dteUseExpireDate=null;$.panInfo=null;$.panRequest=null;$.lblInstockAmt=null;$.lblInstockDate=null;$.lblKeepAmt=null;$.lblLotNo1=null;$.lblManufacturer=null;$.lblPackUnit=null;$.lblProduceYear=null;$.lblProductCode1=null;$.lblProductName=null;$.lblPurpose=null;$.lblQaId=null;$.lblQcAmt=null;$.lblRequestDate=null;$.lblResultRequestDate=null;$.lblTestAgency=null;$.lblTestItem=null;$.lblTestStandard=null;$.lblUnusual=null;$.lblUseExpireDate=null;$.lblValidMonth=null;$.cmbPurpose=null;$.cmbTestAgency=null;$.cmbTestItem=null;$.cmbTestStandard=null;$.btnRequest=null;$.btnClose=null;$.speInstockAmt=null;$.speKeepAmt=null;$.speQcAmt=null;$.speSeq=null;$.speValidMonth=null;$.txtLotNo1=null;$.txtManufacturer=null;$.txtPackUnit=null;$.txtPurposeText=null;$.txtQaId=null;$.txtTestItemText=null;$.txtTestStandardText=null;$.txtUnusual=null;$.panMain=null;function createJSON_S(workType){var json=createExecuteParamInfo("P_QAP4000_S",[workType,$.txtQaId.getValue()||"",$.speSeq.getValue(),$.cmbTestAgency.getValue()||"",$.dteRequestDate.getValue()||"","",$.cmbPurpose.getValue()||"",$.txtPurposeText.getValue()||"",$.cmbTestItem.getValue()||"",$.txtTestItemText.getValue()||"",$.cmbTestStandard.getValue()||"",$.txtTestStandardText.getValue()||"",$.dteResultRequestDate.getValue()||"",$.txtUnusual.getValue()||"","#UserID#"]);return json}function saveRequest(workType){var json=createJSON_S(workType);callExecute(["req",json],workType,$)}$.init=function(host,args){$.bteProductName1=new FingerButtonEdit(host,"bteProductName1",110,70,400,20);$.bteProductName1.setText("");$.dteInstockDate=new FingerDateEdit(host,"dteInstockDate",110,40,140,20);$.dteProduceYear=new FingerDateEdit(host,"dteProduceYear",365,190,145,20);$.dteRequestDate=new FingerDateEdit(host,"dteRequestDate",115,45,135,25);$.dteResultRequestDate=new FingerDateEdit(host,"dteResultRequestDate",115,165,135,20);$.dteUseExpireDate=new FingerDateEdit(host,"dteUseExpireDate",110,190,140,20);$.panInfo=new FingerPanel(host,"panInfo",0,0,535,300);$.panInfo.setText("제품 입고 정보");$.panInfo.setBottomLine(true);$.panRequest=new FingerPanel(host,"panRequest",0,305,535,305);$.panRequest.setText("시험의뢰");$.panRequest.setBottomLine(true);$.lblInstockAmt=new FingerLabel(host,"lblInstockAmt",255,40,100,20);$.lblInstockAmt.setText("입고수량");$.lblInstockDate=new FingerLabel(host,"lblInstockDate",0,40,100,20);$.lblInstockDate.setText("입고일");$.lblKeepAmt=new FingerLabel(host,"lblKeepAmt",255,160,100,20);$.lblKeepAmt.setText("보관용");$.lblLotNo1=new FingerLabel(host,"lblLotNo1",0,10,100,20);$.lblLotNo1.setText("Lot No");$.lblManufacturer=new FingerLabel(host,"lblManufacturer",0,100,100,20);$.lblManufacturer.setText("제조원");$.lblPackUnit=new FingerLabel(host,"lblPackUnit",0,130,100,20);$.lblPackUnit.setText("포장단위");$.lblProduceYear=new FingerLabel(host,"lblProduceYear",255,190,100,20);$.lblProduceYear.setText("제조일자");$.lblProductCode1=new FingerLabel(host,"lblProductCode1",255,215,100,20);$.lblProductCode1.setText("순번");$.lblProductName=new FingerLabel(host,"lblProductName",0,70,100,20);$.lblProductName.setText("제품");$.lblPurpose=new FingerLabel(host,"lblPurpose",5,75,100,20);$.lblPurpose.setText("의뢰목적");$.lblQaId=new FingerLabel(host,"lblQaId",0,215,100,20);$.lblQaId.setText("입고ID");$.lblQcAmt=new FingerLabel(host,"lblQcAmt",255,130,100,20);$.lblQcAmt.setText("QC용");$.lblRequestDate=new FingerLabel(host,"lblRequestDate",5,45,100,20);$.lblRequestDate.setText("시험의뢰일");$.lblResultRequestDate=new FingerLabel(host,"lblResultRequestDate",0,165,105,20);$.lblResultRequestDate.setText("결과통보요망일");$.lblTestAgency=new FingerLabel(host,"lblTestAgency",5,10,100,20);$.lblTestAgency.setText("시험위탁기관");$.lblTestItem=new FingerLabel(host,"lblTestItem",5,105,100,20);$.lblTestItem.setText("시험항목");$.lblTestStandard=new FingerLabel(host,"lblTestStandard",5,135,100,20);$.lblTestStandard.setText("규격");$.lblUnusual=new FingerLabel(host,"lblUnusual",5,195,100,20);$.lblUnusual.setText("특이사항");$.lblUseExpireDate=new FingerLabel(host,"lblUseExpireDate",0,190,100,20);$.lblUseExpireDate.setText("사용기한");$.lblValidMonth=new FingerLabel(host,"lblValidMonth",0,160,100,20);$.lblValidMonth.setText("유효기한(월)");$.cmbPurpose=new FingerComboBox(host,"cmbPurpose",115,75,140,20);$.cmbTestAgency=new FingerComboBox(host,"cmbTestAgency",115,10,185,20);$.cmbTestItem=new FingerComboBox(host,"cmbTestItem",115,105,140,20);$.cmbTestStandard=new FingerComboBox(host,"cmbTestStandard",115,135,140,20);$.btnRequest=new FingerButton(host,"btnRequest",360,225,100,20);$.btnRequest.setText("저장");$.btnClose=new FingerButton(host,"btnClose",445,225,100,20);$.btnClose.setText("취소");$.speInstockAmt=new FingerSpinEdit(host,"speInstockAmt",365,40,145,20);$.speKeepAmt=new FingerSpinEdit(host,"speKeepAmt",365,160,145,20);$.speQcAmt=new FingerSpinEdit(host,"speQcAmt",365,130,145,20);$.speSeq=new FingerSpinEdit(host,"speSeq",365,215,140,20);$.speValidMonth=new FingerSpinEdit(host,"speValidMonth",110,160,140,20);$.txtLotNo1=new FingerEdit(host,"txtLotNo1",110,10,400,20);$.txtManufacturer=new FingerEdit(host,"txtManufacturer",110,100,400,20);$.txtPackUnit=new FingerEdit(host,"txtPackUnit",110,130,140,20);$.txtPurposeText=new FingerEdit(host,"txtPurposeText",265,75,140,20);$.txtQaId=new FingerEdit(host,"txtQaId",110,215,140,20);$.txtTestItemText=new FingerEdit(host,"txtTestItemText",265,105,140,20);$.txtTestStandardText=new FingerEdit(host,"txtTestStandardText",265,135,140,20);$.txtUnusual=new FingerEdit(host,"txtUnusual",115,195,135,20);$.panMain=new FingerPanel(host,"panMain",0,0,535,610);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblProductCode1.setVisible(false);$.lblQaId.setVisible(false);$.speSeq.setVisible(false);$.txtQaId.setVisible(false);$.bteProductName1.setEnable(false);$.dteInstockDate.setEnable(false);$.dteProduceYear.setEnable(false);$.dteUseExpireDate.setEnable(false);$.speInstockAmt.setEnable(false);$.speKeepAmt.setEnable(false);$.speQcAmt.setEnable(false);$.speSeq.setEnable(false);$.speValidMonth.setEnable(false);$.txtLotNo1.setEnable(false);$.txtManufacturer.setEnable(false);$.txtPackUnit.setEnable(false);$.txtQaId.setEnable(false);$.txtPurposeText.setReadOnly(true);$.txtTestItemText.setReadOnly(true);$.txtTestStandardText.setReadOnly(true);$.cmbPurpose.setColumn("sub_code","code_name");$.cmbTestAgency.setColumn("sub_code","code_name");$.cmbTestItem.setColumn("sub_code","code_name");$.cmbTestStandard.setColumn("sub_code","code_name");$.cmbPurpose.setEmptyRow(true);$.cmbTestAgency.setEmptyRow(true);$.cmbTestItem.setEmptyRow(true);$.cmbTestStandard.setEmptyRow(true);$.take_date="";$.host=host;$.args=args};$.start=function(){$.panInfo.add($.speValidMonth);$.panInfo.add($.lblValidMonth);$.panInfo.add($.txtPackUnit);$.panInfo.add($.speSeq);$.panInfo.add($.bteProductName1);$.panInfo.add($.txtLotNo1);$.panInfo.add($.lblLotNo1);$.panInfo.add($.lblProductName);$.panInfo.add($.lblProductCode1);$.panInfo.add($.lblManufacturer);$.panInfo.add($.txtManufacturer);$.panInfo.add($.lblPackUnit);$.panInfo.add($.lblInstockDate);$.panInfo.add($.lblInstockAmt);$.panInfo.add($.dteInstockDate);$.panInfo.add($.speInstockAmt);$.panInfo.add($.dteUseExpireDate);$.panInfo.add($.lblUseExpireDate);$.panInfo.add($.lblQcAmt);$.panInfo.add($.speQcAmt);$.panInfo.add($.speKeepAmt);$.panInfo.add($.lblKeepAmt);$.panInfo.add($.lblProduceYear);$.panInfo.add($.dteProduceYear);$.panInfo.add($.lblQaId);$.panInfo.add($.txtQaId);$.panRequest.add($.lblUnusual);$.panRequest.add($.lblTestAgency);$.panRequest.add($.lblRequestDate);$.panRequest.add($.lblPurpose);$.panRequest.add($.lblTestItem);$.panRequest.add($.lblTestStandard);$.panRequest.add($.lblResultRequestDate);$.panRequest.add($.cmbPurpose);$.panRequest.add($.cmbTestAgency);$.panRequest.add($.cmbTestItem);$.panRequest.add($.cmbTestStandard);$.panRequest.add($.btnClose);$.panRequest.add($.btnRequest);$.panRequest.add($.txtTestStandardText);$.panRequest.add($.txtUnusual);$.panRequest.add($.txtPurposeText);$.panRequest.add($.dteResultRequestDate);$.panRequest.add($.dteRequestDate);$.panRequest.add($.txtTestItemText);$.panMain.add($.panInfo);$.panMain.add($.panRequest);$.dsL_ST0008=bizComponentData2($,"Q1","L_ST0008");setComboBind([$.cmbPurpose],$.dsL_ST0008);$.dsL_ST0011=bizComponentData2($,"Q1","L_ST0011");setComboBind([$.cmbTestAgency],$.dsL_ST0011);$.dsL_ST0006=bizComponentData2($,"Q1","L_ST0006");setComboBind([$.cmbTestItem],$.dsL_ST0006);$.dsL_ST0007=bizComponentData2($,"Q1","L_ST0007");setComboBind([$.cmbTestStandard],$.dsL_ST0007);if($.p_argument){$.txtLotNo1.setValue($.p_argument.lot_no);$.dteInstockDate.setValue($.p_argument.instock_date);$.speInstockAmt.setValue($.p_argument.instock_amt);$.bteProductName1.setText($.p_argument.product_name);$.txtManufacturer.setValue($.p_argument.manufacturer);$.txtPackUnit.setValue($.p_argument.pack_unit);$.speQcAmt.setValue($.p_argument.qc_amt);$.speKeepAmt.setValue($.p_argument.keep_amt);$.dteUseExpireDate.setValue($.p_argument.use_expire_date);$.dteProduceYear.setValue($.p_argument.produce_year);$.txtQaId.setValue($.p_argument.qa_id);$.speValidMonth.setValue($.p_argument.valid_month);$.take_date=$.p_argument.take_date;$.dteRequestDate.setValue(getToday());$.dteResultRequestDate.setValue(getToday());if($.p_argument.request_seq){$.cmbTestAgency.setValue($.p_argument.test_agency);$.dteRequestDate.setValue($.p_argument.request_date);$.cmbPurpose.setValue($.p_argument.purpose);$.txtPurposeText.setValue($.p_argument.purpose_text);$.cmbTestItem.setValue($.p_argument.test_item);$.txtTestItemText.setValue($.p_argument.test_item_text);$.cmbTestStandard.setValue($.p_argument.test_standard);$.txtTestStandardText.setValue($.p_argument.test_standard_text);$.dteResultRequestDate.setValue($.p_argument.result_request_date);$.speSeq.setValue($.p_argument.request_seq);$.txtUnusual.setValue($.p_argument.unusual)}else{$.dteRequestDate.setValue(getToday());$.cmbPurpose.setValue("10");$.cmbTestItem.setValue("10");$.cmbTestStandard.setValue("10")}}else{$.dteRequestDate.setValue(getToday());$.cmbPurpose.setValue("10");$.cmbTestItem.setValue("10");$.cmbTestStandard.setValue("10")}};$.callback=function(type,ds){if(type=="N"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 등록되었습니다.");g_popupStack.setData({result:"OK"});g_popupStack.close()}}}else{if(type=="U"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{MessageBoxShow("정상적으로 수정되었습니다.");g_popupStack.setData({result:"OK"});g_popupStack.close()}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnClose"){g_popupStack.close()}else{if(id=="btnRequest"){if($.txtUnusual.getValue()==""){MessageBoxShow("특이사항은 필수입력항목입니다.");return}if($.txtTestStandardText.getValue()==""){MessageBoxShow("규격은 필수입력항목입니다.");return}if($.txtTestItemText.getValue()==""){MessageBoxShow("시험항목은 필수입력항목입니다.");return}if($.txtPurposeText.getValue()==""){MessageBoxShow("의뢰목적은 필수입력항목입니다.");return}if($.cmbTestAgency.getValue()==""){MessageBoxShow("시험기관은 필수입력항목입니다.");return}if($.dteRequestDate.getValue()==""){MessageBoxShow("시험의뢰일은 필수입력항목입니다.");return}var param=null;g_main.openPopup("popWFPassword.html","popWFPassword","",0,0,"","",param,"","")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbPurpose"){if(value=="99"){$.txtPurposeText.setReadOnly(false);$.txtPurposeText.setFocus()}else{$.txtPurposeText.setReadOnly(true);$.txtPurposeText.setValue($.cmbPurpose.getText())}}else{if(id=="cmbTestItem"){if(value=="99"){$.txtTestItemText.setReadOnly(false);$.txtTestItemText.setFocus()}else{$.txtTestItemText.setReadOnly(true);$.txtTestItemText.setValue($.cmbTestItem.getText())}}else{if(id=="cmbTestStandard"){if(value=="99"){$.txtTestStandardText.setReadOnly(false);$.txtTestStandardText.setFocus()}else{$.txtTestStandardText.setReadOnly(true);$.txtTestStandardText.setValue($.cmbTestStandard.getText())}}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteRequestDate"){if(value<$.take_date){MessageBoxShow("시험의뢰일은 검체채취완료일 보다 빠를 수 없다.");$.dteRequestDate.setValue("");return}}else{if(id=="dteResultRequestDate"){if(value<$.take_date){MessageBoxShow("결과통보요망일이 검체채취완료일보다 빠를 수 없다.");$.dteResultRequestDate.setValue("");return}}}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popWFPassword"){if(popResult.result){if($.speSeq.getValue()>0){saveRequest("U")}else{saveRequest("N")}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>