<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panMdProgress=null;$.panMdUse=null;$.grdMdProgress=null;$.panMdTitle=null;$.panQuery=null;$.lblHalf=null;$.lblDept=null;$.cmbHalf=null;$.cmbDept=null;$.btnSearch=null;$.lbFirstAssgn=null;$.lblUse=null;$.lblPresentAssgn=null;$.lblDutyCycle=null;$.lblRecommandProgress=null;$.grdMdUse=null;$.txtFirstAssgn=null;$.txtUse=null;$.txtPresentAssgn=null;$.txtDutyCycle=null;$.txtRecommandProgress=null;function createJSON_Q(workType){var json;if(workType=="Q"){json=createExecuteParamInfo("P_crmBudgetMonitoring2_Q",[workType,$.cmbHalf.getValue().substring(0,4),$.cmbHalf.getValue().substring(4),$.cmbDept.getValue()])}else{if(workType=="Q1"){json=createExecuteParamInfo("P_crmBudgetMonitoring2_Q",[workType,$.cmbHalf.getValue().substring(0,4),$.cmbHalf.getValue().substring(4),$.cmbDept.getValue()])}else{if(workType=="Q2"){json=createExecuteParamInfo("P_crmBudgetMonitoring2_Q",[workType,$.cmbHalf.getValue().substring(0,4),$.cmbHalf.getValue().substring(4),$.cmbDept.getValue()])}}}return json}function searchBudgetMonitoring2(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function fnSetData(ds){if(ds.resultList.length>0){fnSetColumns(ds.resultList[0]);if(ds.resultList.length>1){fnSetDatas(ds.resultList[1])}}}function fnSetColumns(rs){$.grdMdProgress.clear();$.grdMdProgress.removeColumns();var cols=[];cols.push(new FingerDataGridColumn("dept_name",100,"left","string","사용률"));for(var i=0;i<rs.length;i++){cols.push(new FingerDataGridColumn(rs[i].dept_code,140,"right","int",rs[i].dept_name,{format:"percent_2"}))}$.grdMdProgress.resetColumns(cols)}function fnSetDatas(rs){$.grdMdProgress.addRow({});$.grdMdProgress.setValue(0,"dept_name","영업소");for(var i=0;i<rs.length;i++){$.grdMdProgress.setValue(0,rs[i].dept_code,rs[i].use_rate)}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,910);$.panMain.setText("");$.panMain.setBottomLine(true);$.panMdProgress=new FingerPanel(host,"panMdProgress",0,205,1200,185);$.panMdProgress.setText("영업소별 사용현황");$.panMdProgress.setBottomLine(true);$.panMdUse=new FingerPanel(host,"panMdUse",0,405,1200,500);$.panMdUse.setText("담당자별 사용현황");$.panMdUse.setBottomLine(false);$.grdMdProgress=new FingerDataGrid(host,"grdMdProgress",0,0,1200,140);$.panMdTitle=new FingerPanel(host,"panMdTitle",0,65,1200,130);$.panMdTitle.setText("정책지원예산 사용현황");$.panMdTitle.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.lblHalf=new FingerLabel(host,"lblHalf",0,15,100,20);$.lblHalf.setText("년도/반기");$.lblDept=new FingerLabel(host,"lblDept",225,15,100,20);$.lblDept.setText("부서");$.cmbHalf=new FingerComboBox(host,"cmbHalf",105,15,140,20);$.cmbDept=new FingerComboBox(host,"cmbDept",330,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.lbFirstAssgn=new FingerLabel(host,"lbFirstAssgn",0,15,100,20);$.lbFirstAssgn.setText("최초배정");$.lblUse=new FingerLabel(host,"lblUse",225,15,100,20);$.lblUse.setText("사용");$.lblPresentAssgn=new FingerLabel(host,"lblPresentAssgn",0,45,100,20);$.lblPresentAssgn.setText("현재배정");$.lblDutyCycle=new FingerLabel(host,"lblDutyCycle",225,45,100,20);$.lblDutyCycle.setText("사용률");$.lblRecommandProgress=new FingerLabel(host,"lblRecommandProgress",485,45,100,20);$.lblRecommandProgress.setText("권장진행률");$.grdMdUse=new FingerDataGrid(host,"grdMdUse",0,0,1200,455);$.txtFirstAssgn=new FingerSpinEdit(host,"txtFirstAssgn",105,15,140,20);$.txtUse=new FingerSpinEdit(host,"txtUse",330,15,140,20);$.txtPresentAssgn=new FingerSpinEdit(host,"txtPresentAssgn",105,45,140,20);$.txtDutyCycle=new FingerSpinEdit(host,"txtDutyCycle",330,45,140,20);$.txtRecommandProgress=new FingerSpinEdit(host,"txtRecommandProgress",590,45,140,20);$.panQuery.setBorder(true);$.txtFirstAssgn.setValue("0");$.txtUse.setValue("0");$.txtPresentAssgn.setValue("0");$.txtDutyCycle.setValue("0.00");$.txtDutyCycle.setFontColor("RED");$.txtRecommandProgress.setValue("0.00");$.txtRecommandProgress.setFontColor("RED");$.txtFirstAssgn.setReadOnly(true);$.txtUse.setReadOnly(true);$.txtPresentAssgn.setReadOnly(true);$.txtDutyCycle.setReadOnly(true);$.txtRecommandProgress.setReadOnly(true);$.cmbDept.setAllowBlank(false,"부서");$.cmbHalf.setAllowBlank(false,"년도/반기");$.cmbDept.setEmptyRow(true);$.fixedGrdColumns=[new FingerDataGridColumn("",100,"left","string","영업소")];$.grdMdProgress.colIdx=$.grdMdProgress.setColumns($.fixedGrdColumns);$.grdMdProgress.init({panel:$.panMdProgress,scroll:"xy"});$.grdMdProgress.setBorder(false);$.grdMdUse.colIdx=$.grdMdUse.setColumns([new FingerDataGridColumn("dept_name",180,"left","string","영업소"),new FingerDataGridColumn("emp_name",120,"left","string","사원명"),new FingerDataGridColumn("use_rate",250,"right","int","배정 대비 누적 사용률",{format:"percent_2"})]);$.grdMdUse.init({panel:$.panMdUse,scroll:"xy"});$.grdMdUse.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panMdTitle);$.panMain.add($.panMdProgress);$.panMain.add($.panMdUse);$.panMain.add($.panQuery);$.panMdProgress.add($.grdMdProgress);$.panMdUse.add($.grdMdUse);$.panMdTitle.add($.lbFirstAssgn);$.panMdTitle.add($.lblUse);$.panMdTitle.add($.lblPresentAssgn);$.panMdTitle.add($.lblDutyCycle);$.panMdTitle.add($.lblRecommandProgress);$.panMdTitle.add($.txtFirstAssgn);$.panMdTitle.add($.txtUse);$.panMdTitle.add($.txtPresentAssgn);$.panMdTitle.add($.txtDutyCycle);$.panMdTitle.add($.txtRecommandProgress);$.panQuery.add($.lblHalf);$.panQuery.add($.lblDept);$.panQuery.add($.cmbHalf);$.panQuery.add($.cmbDept);$.panQuery.add($.btnSearch);var ds=bizComponentData2($,"Q1","S_9999");$.cmbHalf.setColumn("half_code","half_name");setComboBind([$.cmbHalf],ds);$.cmbHalf.setValue(ds.resultList[0][0].half_code);var ds1=bizComponentData2($,"Q2","L_CRM0122");setComboBind([$.cmbDept],ds1);$.cmbDept.setValue(g_main.session.obj.DeptCode);if(g_main.session.obj.SystemDeveloper=="Y"||g_main.session.obj.UserID=="ka160376"||g_main.session.obj.UserID=="ka130286"||g_main.session.obj.UserID=="ka041191"||g_main.session.obj.UserID=="ka041186"||g_main.session.obj.UserID=="ka971018"){$.cmbDept.setEnable(true)}else{if(g_main.session.obj.DeptCode.substring(1,4)=="000"){$.cmbDept.clear();subQuery=" and dept_code like '"+g_main.session.obj.DeptCode.substring(0,1)+"%'";ds1=bizComponentData2($,"Q4","L_CRM0122",subQuery);setComboBind([$.cmbDept],ds1);$.cmbDept.setValue(g_main.session.obj.DeptCode)}else{$.cmbDept.setEnable(false)}}};$.callback=function(type,ds){if(type=="Q"){var jsonArr=ds.resultList[0];$.txtFirstAssgn.setValue(jsonArr[0].half_base_amt);$.txtUse.setValue(jsonArr[0].use_amt);$.txtPresentAssgn.setValue(jsonArr[0].half_amt);$.txtDutyCycle.setValue(jsonArr[0].use_rate.toFixed(2));$.txtRecommandProgress.setValue(jsonArr[0].standard_use_rate.toFixed(2))}else{if(type=="Q1"){if(ds!=null){if(ds.errorCode.substr(0,1)!="P"||ds.errorCode.substr(0,1)!="E"){fnSetData(ds);if($.grdMdProgress.getRowCount()>0){$.grdMdProgress.selectRow(0)}}}else{MessageBoxShow(ds.errorCode)}}else{if(type=="Q2"){setDataGrid([$.grdMdUse],ds);$.grdMdUse.selectRow(0)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!validateControls([$.cmbHalf,$.cmbDept])){return}searchBudgetMonitoring2("Q");searchBudgetMonitoring2("Q1");searchBudgetMonitoring2("Q2")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>