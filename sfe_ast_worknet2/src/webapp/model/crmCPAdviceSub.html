<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.grdList=null;$.panInfo=null;$.panBottom=null;$.panReport=null;$.lbl_contact_name=null;$.bte_contact_name=null;$.lbl_company_name=null;$.txt_company_name=null;$.txt_company_id=null;$.lbl_advice_amt=null;$.spel_advice_amt=null;$.txt_contact_id=null;$.panReport1=null;$.panReport2=null;$.lbl_trans_amt=null;$.spe_trans_amt=null;$.lbl_stay_amt=null;$.spe_stay_amt=null;$.lbl_meal_amt=null;$.spe_meal_amt=null;$.lbl_lect_bank_account=null;$.txt_lect_bank_account=null;$.btnConfirm=null;$.btnCancel=null;$.panReport3=null;$.chk_trans_yn=null;$.chk_stay_yn=null;$.chk_meal_yn=null;$.lbl_product_code=null;$.cmb_product_code=null;$.lbl_cp_advice_date1=null;$.dte_cp_advice_date1=null;$.lbl_cp_place=null;$.txt_cp_place=null;$.lbl_cp_date=null;$.dte_cp_start_date=null;$.dte_cp_end_date=null;$.lbl_advice_desc1_1=null;$.mem_advice_desc1_1=null;$.lbl_advice_desc1_2=null;$.mem_advice_desc1_2=null;$.lbl_cp_etc1=null;$.mem_cp_etc1=null;$.lbl_advice_desc1_3=null;$.mem_advice_desc1_3=null;$.lbl_Txt1=null;$.lbl_cp_advice_subject=null;$.txt_cp_advice_subject=null;$.lbl_cp_choice_dexc=null;$.mem_cp_choice_desc=null;$.lbl_cp_advice_date2=null;$.dte_cp_advice_date2=null;$.cmb_cp_HH_fr=null;$.cmb_cp_MM_fr=null;$.cmb_cp_HH_to=null;$.cmb_cp_MM_to=null;$.lbl_advice_desc2_1=null;$.mem_advice_desc2_1=null;$.lbl_advice_desc2_2=null;$.mem_advice_desc2_2=null;$.lbl_cp_etc2=null;$.mem_cp_etc2=null;$.lbl_Txt2=null;$.lbl_Txt3=null;$.lbl_Txt4=null;$.spe_etc_expense_sum=null;$.strcp_code="";$.bChange=false;function saveClick(){if(!validateControls([$.bte_contact_name,$.txt_contact_id])){return false}if(!validateControls([$.cmb_product_code,$.txt_cp_place,$.dte_cp_start_date,$.dte_cp_end_date,$.mem_advice_desc1_1,$.dte_cp_advice_date1])){return false}if(!validateControls([$.txt_cp_advice_subject,$.mem_cp_choice_desc,$.dte_cp_advice_date2,$.cmb_cp_HH_fr,$.cmb_cp_MM_fr,$.cmb_cp_HH_to,$.cmb_cp_MM_to,$.mem_advice_desc2_1,$.mem_advice_desc2_2])){return false}if($.strcp_code=="CP04"&&!spinEditValidation([$.spe_trans_amt,$.spe_stay_amt,$.spe_meal_amt])){return false}var rId=$.grdList.getSelectedRowIdx();$.grdList.setValue(rId,"contact_id",$.txt_contact_id.getValue());$.grdList.setValue(rId,"contact_name",$.bte_contact_name.getText());$.grdList.setValue(rId,"company_id",$.txt_company_id.getValue());$.grdList.setValue(rId,"company_name",$.txt_company_name.getValue());$.grdList.setValue(rId,"advice_amt",Number($.spel_advice_amt.getValue())||0);$.grdList.setValue(rId,"product_code",$.cmb_product_code.getValue());$.grdList.setValue(rId,"cp_advice_date1",$.dte_cp_advice_date1.getValue()||"");$.grdList.setValue(rId,"cp_place",$.txt_cp_place.getValue());$.grdList.setValue(rId,"cp_start_date",extFormat($.dte_cp_start_date.getValue(),"yyyyMMdd"));$.grdList.setValue(rId,"cp_end_date",extFormat($.dte_cp_end_date.getValue(),"yyyyMMdd"));$.grdList.setValue(rId,"advice_desc1_1",$.mem_advice_desc1_1.getValue());$.grdList.setValue(rId,"advice_desc1_2",$.mem_advice_desc1_2.getValue());$.grdList.setValue(rId,"cp_etc1",$.mem_cp_etc1.getValue()||"");$.grdList.setValue(rId,"advice_desc1_3",$.mem_advice_desc1_3.getValue()||"");$.grdList.setValue(rId,"cp_advice_subject",$.txt_cp_advice_subject.getValue());$.grdList.setValue(rId,"cp_choice_desc",$.mem_cp_choice_desc.getValue());$.grdList.setValue(rId,"cp_advice_date2",$.dte_cp_advice_date2.getValue());$.grdList.setValue(rId,"cp_HH_fr",$.cmb_cp_HH_fr.getValue());$.grdList.setValue(rId,"cp_MM_fr",$.cmb_cp_MM_fr.getValue());$.grdList.setValue(rId,"cp_HH_to",$.cmb_cp_HH_to.getValue());$.grdList.setValue(rId,"cp_MM_to",$.cmb_cp_MM_to.getValue());$.grdList.setValue(rId,"advice_desc2_1",$.mem_advice_desc2_1.getValue());$.grdList.setValue(rId,"advice_desc2_2",$.mem_advice_desc2_2.getValue());$.grdList.setValue(rId,"cp_etc2",$.mem_cp_etc2.getValue()||"");$.grdList.setValue(rId,"trans_yn",$.chk_trans_yn.getValue()||"N");$.grdList.setValue(rId,"stay_yn",$.chk_stay_yn.getValue()||"N");$.grdList.setValue(rId,"meal_yn",$.chk_meal_yn.getValue()||"N");$.grdList.setValue(rId,"trans_amt",Number($.spe_trans_amt.getValue())||0);$.grdList.setValue(rId,"stay_amt",Number($.spe_stay_amt.getValue())||0);$.grdList.setValue(rId,"meal_amt",Number($.spe_meal_amt.getValue())||0);$.grdList.setValue(rId,"advisor_bank_account",$.txt_lect_bank_account.getValue()||"");$.grdList.setValue(rId,"etc_expense_sum",Number($.spe_etc_expense_sum.getValue())||0);return true}function fnEnableSet(bo){if(bo){$.panInfo.enableButton(["btnDelete","btnSave","btnNew"])}else{$.panInfo.disableButton(["btnDelete","btnSave","btnNew"])}$.btnConfirm.setEnable(bo);$.bte_contact_name.setEnable(bo);$.spel_advice_amt.setEnable(bo);$.cmb_product_code.setEnable(bo);$.dte_cp_advice_date1.setEnable(bo);$.txt_cp_place.setReadOnly(!bo);$.dte_cp_start_date.setEnable(bo);$.dte_cp_end_date.setEnable(bo);$.mem_advice_desc1_1.setReadOnly(!bo);$.mem_advice_desc1_2.setReadOnly(!bo);$.mem_cp_etc1.setReadOnly(!bo);$.mem_advice_desc1_3.setReadOnly(!bo);$.txt_cp_advice_subject.setReadOnly(!bo);$.mem_cp_choice_desc.setReadOnly(!bo);$.dte_cp_advice_date2.setEnable(bo);$.cmb_cp_HH_fr.setEnable(bo);$.cmb_cp_MM_fr.setEnable(bo);$.cmb_cp_HH_to.setEnable(bo);$.cmb_cp_MM_to.setEnable(bo);$.mem_advice_desc2_1.setReadOnly(!bo);$.mem_advice_desc2_2.setReadOnly(!bo);$.mem_cp_etc2.setReadOnly(!bo);$.spe_trans_amt.setEnable(bo);$.spe_stay_amt.setEnable(bo);$.spe_meal_amt.setEnable(bo);$.chk_trans_yn.setEnable(bo);$.chk_stay_yn.setEnable(bo);$.chk_meal_yn.setEnable(bo);$.txt_lect_bank_account.setReadOnly(!bo)}function spinEditValidation(controls){for(var i in controls){if(controls[i]!=null){if(controls[i].getAllowBlank()==false&&String(controls[i].getValue())==""){MessageBoxShow(controls[i].getFieldName()+" 은(는) 필수입력 항목 입니다.");controls[i].setFocus();return false}}}return true}function gridValidator(){if(arguments.length<2){return false}var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,920);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,1200,235);$.panList.setText("자문자리스트");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,190);$.panInfo=new FingerPanel(host,"panInfo",0,245,1200,100);$.panInfo.setText("자문자정보");$.panInfo.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,845,1200,75);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.panReport=new FingerPanel(host,"panReport",0,360,615,365);$.panReport.setText("자문결과보고서");$.panReport.setBottomLine(true);$.lbl_contact_name=new FingerLabel(host,"lbl_contact_name",0,15,100,20);$.lbl_contact_name.setText("자문자");$.bte_contact_name=new FingerButtonEdit(host,"bte_contact_name",105,15,140,20);$.bte_contact_name.setText("");$.lbl_company_name=new FingerLabel(host,"lbl_company_name",230,15,100,20);$.lbl_company_name.setText("소속");$.txt_company_name=new FingerEdit(host,"txt_company_name",335,15,445,20);$.txt_company_id=new FingerEdit(host,"txt_company_id",1155,15,35,20);$.lbl_advice_amt=new FingerLabel(host,"lbl_advice_amt",785,15,100,20);$.lbl_advice_amt.setText("자문료");$.spel_advice_amt=new FingerSpinEdit(host,"spel_advice_amt",890,15,140,20);$.txt_contact_id=new FingerEdit(host,"txt_contact_id",1110,15,40,20);$.panReport1=new FingerPanel(host,"panReport1",625,360,575,365);$.panReport1.setText("자문위촉선정사유서");$.panReport1.setBottomLine(true);$.panReport2=new FingerPanel(host,"panReport2",0,740,1200,100);$.panReport2.setText("여비정보");$.panReport2.setBottomLine(true);$.lbl_trans_amt=new FingerLabel(host,"lbl_trans_amt",225,15,100,20);$.lbl_trans_amt.setText("교통비");$.spe_trans_amt=new FingerSpinEdit(host,"spe_trans_amt",330,15,130,20);$.lbl_stay_amt=new FingerLabel(host,"lbl_stay_amt",450,15,100,20);$.lbl_stay_amt.setText("숙박비");$.spe_stay_amt=new FingerSpinEdit(host,"spe_stay_amt",555,15,130,20);$.lbl_meal_amt=new FingerLabel(host,"lbl_meal_amt",0,15,100,20);$.lbl_meal_amt.setText("식음료비");$.spe_meal_amt=new FingerSpinEdit(host,"spe_meal_amt",105,15,130,20);$.lbl_lect_bank_account=new FingerLabel(host,"lbl_lect_bank_account",690,15,100,20);$.lbl_lect_bank_account.setText("계좌번호");$.txt_lect_bank_account=new FingerEdit(host,"txt_lect_bank_account",795,15,240,20);$.btnConfirm=new FingerButton(host,"btnConfirm",555,15,95,45);$.btnConfirm.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",635,15,95,45);$.btnCancel.setText("취소");$.panReport3=new FingerPanel(host,"panReport3",0,740,1200,100);$.panReport3.setText("여비");$.panReport3.setBottomLine(true);$.chk_trans_yn=new FingerCheckBox(host,"chk_trans_yn",285,15,140,20);$.chk_trans_yn.setText("교통");$.chk_stay_yn=new FingerCheckBox(host,"chk_stay_yn",480,15,140,20);$.chk_stay_yn.setText("숙박");$.chk_meal_yn=new FingerCheckBox(host,"chk_meal_yn",90,15,140,20);$.chk_meal_yn.setText("식음료");$.lbl_product_code=new FingerLabel(host,"lbl_product_code",0,10,100,20);$.lbl_product_code.setText("해당품목");$.cmb_product_code=new FingerComboBox(host,"cmb_product_code",105,10,140,20);$.lbl_cp_advice_date1=new FingerLabel(host,"lbl_cp_advice_date1",250,10,100,20);$.lbl_cp_advice_date1.setText("자문일자");$.dte_cp_advice_date1=new FingerDateEdit(host,"dte_cp_advice_date1",355,10,110,20);$.lbl_cp_place=new FingerLabel(host,"lbl_cp_place",0,40,100,20);$.lbl_cp_place.setText("자문장소");$.txt_cp_place=new FingerEdit(host,"txt_cp_place",105,40,140,20);$.lbl_cp_date=new FingerLabel(host,"lbl_cp_date",250,40,100,20);$.lbl_cp_date.setText("계약기간");$.dte_cp_start_date=new FingerDateEdit(host,"dte_cp_start_date",355,40,110,20);$.dte_cp_end_date=new FingerDateEdit(host,"dte_cp_end_date",490,40,110,20);$.lbl_advice_desc1_1=new FingerLabel(host,"lbl_advice_desc1_1",0,80,100,20);$.lbl_advice_desc1_1.setText("자문안건");$.mem_advice_desc1_1=new FingerMemoEdit(host,"mem_advice_desc1_1",105,70,490,50);$.lbl_advice_desc1_2=new FingerLabel(host,"lbl_advice_desc1_2",0,140,100,20);$.lbl_advice_desc1_2.setText("자문내용");$.mem_advice_desc1_2=new FingerMemoEdit(host,"mem_advice_desc1_2",105,130,490,50);$.lbl_cp_etc1=new FingerLabel(host,"lbl_cp_etc1",0,200,100,20);$.lbl_cp_etc1.setText("기타사항");$.mem_cp_etc1=new FingerMemoEdit(host,"mem_cp_etc1",105,190,490,50);$.lbl_advice_desc1_3=new FingerLabel(host,"lbl_advice_desc1_3",0,250,100,25);$.lbl_advice_desc1_3.setText("자문내역사후<br/>사용계획");$.mem_advice_desc1_3=new FingerMemoEdit(host,"mem_advice_desc1_3",105,250,490,50);$.lbl_Txt1=new FingerLabel(host,"lbl_Txt1",465,40,20,20);$.lbl_Txt1.setText("~");$.lbl_cp_advice_subject=new FingerLabel(host,"lbl_cp_advice_subject",0,10,100,20);$.lbl_cp_advice_subject.setText("자문주제");$.txt_cp_advice_subject=new FingerEdit(host,"txt_cp_advice_subject",105,10,460,20);$.lbl_cp_choice_dexc=new FingerLabel(host,"lbl_cp_choice_dexc",0,50,100,20);$.lbl_cp_choice_dexc.setText("선정사유");$.mem_cp_choice_desc=new FingerMemoEdit(host,"mem_cp_choice_desc",105,40,455,50);$.lbl_cp_advice_date2=new FingerLabel(host,"lbl_cp_advice_date2",0,100,100,20);$.lbl_cp_advice_date2.setText("자문일시");$.dte_cp_advice_date2=new FingerDateEdit(host,"dte_cp_advice_date2",105,100,140,20);$.cmb_cp_HH_fr=new FingerComboBox(host,"cmb_cp_HH_fr",260,100,60,20);$.cmb_cp_MM_fr=new FingerComboBox(host,"cmb_cp_MM_fr",340,100,60,20);$.cmb_cp_HH_to=new FingerComboBox(host,"cmb_cp_HH_to",425,100,60,20);$.cmb_cp_MM_to=new FingerComboBox(host,"cmb_cp_MM_to",505,100,60,20);$.lbl_advice_desc2_1=new FingerLabel(host,"lbl_advice_desc2_1",0,150,100,20);$.lbl_advice_desc2_1.setText("자문내용");$.mem_advice_desc2_1=new FingerMemoEdit(host,"mem_advice_desc2_1",105,130,455,50);$.lbl_advice_desc2_2=new FingerLabel(host,"lbl_advice_desc2_2",0,200,100,20);$.lbl_advice_desc2_2.setText("활용방안");$.mem_advice_desc2_2=new FingerMemoEdit(host,"mem_advice_desc2_2",105,190,455,50);$.lbl_cp_etc2=new FingerLabel(host,"lbl_cp_etc2",0,260,100,20);$.lbl_cp_etc2.setText("기타");$.mem_cp_etc2=new FingerMemoEdit(host,"mem_cp_etc2",105,250,455,50);$.lbl_Txt2=new FingerLabel(host,"lbl_Txt2",320,100,15,20);$.lbl_Txt2.setText(":");$.lbl_Txt3=new FingerLabel(host,"lbl_Txt3",400,100,20,20);$.lbl_Txt3.setText("~");$.lbl_Txt4=new FingerLabel(host,"lbl_Txt4",485,100,15,20);$.lbl_Txt4.setText(":");$.spe_etc_expense_sum=new FingerSpinEdit(host,"spe_etc_expense_sum",1060,15,130,20);$.panList.setBorder(true);$.panInfo.setBorder(true);$.panInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panReport.setBorder(true);$.panReport1.setBorder(true);$.panReport2.setBorder(true);$.panReport3.setBorder(true);$.cmb_product_code.setEmptyRow(true);$.cmb_cp_HH_fr.setEmptyRow(true);$.cmb_cp_MM_fr.setEmptyRow(true);$.cmb_cp_HH_to.setEmptyRow(true);$.cmb_cp_MM_to.setEmptyRow(true);$.txt_company_id.setVisible(false);$.txt_contact_id.setVisible(false);$.lbl_lect_bank_account.setVisible(false);$.txt_lect_bank_account.setVisible(false);$.spe_etc_expense_sum.setVisible(false);$.lbl_cp_advice_date1.setVisible(false);$.dte_cp_advice_date1.setVisible(false);$.bte_contact_name.setAllowBlank(false,"자문자");$.txt_contact_id.setAllowBlank(false,"자문자아이디");$.cmb_product_code.setAllowBlank(false,"해당품목");$.txt_cp_place.setAllowBlank(false,"자문장소");$.dte_cp_start_date.setAllowBlank(false,"계약기간 시작일");$.dte_cp_end_date.setAllowBlank(false,"계약기간 종료일");$.mem_advice_desc1_1.setAllowBlank(false,"자문안건");$.txt_cp_advice_subject.setAllowBlank(false,"자문주제");$.mem_cp_choice_desc.setAllowBlank(false,"선정사유");$.dte_cp_advice_date2.setAllowBlank(false,"자문일시");$.cmb_cp_HH_fr.setAllowBlank(false,"시작시");$.cmb_cp_MM_fr.setAllowBlank(false,"시작분");$.cmb_cp_HH_to.setAllowBlank(false,"종료시");$.cmb_cp_MM_to.setAllowBlank(false,"종료분");$.mem_advice_desc2_1.setAllowBlank(false,"자문내용");$.mem_advice_desc2_2.setAllowBlank(false,"활용방안");$.spe_trans_amt.setAllowBlank(false,"교통비");$.spe_stay_amt.setAllowBlank(false,"숙박비");$.spe_meal_amt.setAllowBlank(false,"식음료비");$.spel_advice_amt.setValue(0);$.spe_trans_amt.setValue(0);$.spe_stay_amt.setValue(0);$.spe_meal_amt.setValue(0);$.txt_company_name.setReadOnly(true);$.mem_advice_desc1_2.setReadOnly(true);$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("contact_name",100,"left","string","자문자"),new FingerDataGridColumn("company_name",200,"left","string","소속"),new FingerDataGridColumn("cp_start_date",100,"left","string","시작일",{format:"ymd"}),new FingerDataGridColumn("cp_end_date",130,"left","string","종료일",{format:"ymd"}),new FingerDataGridColumn("cp_advice_subject",455,"left","string","자문주제"),new FingerDataGridColumn("advice_amt",200,"right","int","자문비",{format:"int"}),new FingerDataGridColumn("contact_id",280,"left","string","자문자아이디",{hidden:true}),new FingerDataGridColumn("company_id",280,"left","string","소속아이디",{hidden:true}),new FingerDataGridColumn("product_code",280,"left","string","품목",{hidden:true}),new FingerDataGridColumn("cp_advice_date1",280,"left","string","자문일",{hidden:true}),new FingerDataGridColumn("cp_place",280,"left","string","장소",{hidden:true}),new FingerDataGridColumn("advice_desc1_1",280,"left","string","자문안건",{hidden:true}),new FingerDataGridColumn("advice_desc1_2",280,"left","string","자문내역",{hidden:true}),new FingerDataGridColumn("cp_etc1",280,"left","string","기타사항",{hidden:true}),new FingerDataGridColumn("advice_desc1_3",280,"left","string","자문내역사후활용계획",{hidden:true}),new FingerDataGridColumn("cp_choice_desc",280,"left","string","선정사유",{hidden:true}),new FingerDataGridColumn("cp_advice_date2",280,"left","string","자문일시",{hidden:true}),new FingerDataGridColumn("cp_HH_fr",280,"left","string","시",{hidden:true}),new FingerDataGridColumn("cp_MM_fr",280,"left","string","분",{hidden:true}),new FingerDataGridColumn("cp_HH_to",280,"left","string","시",{hidden:true}),new FingerDataGridColumn("cp_MM_to",280,"left","string","분",{hidden:true}),new FingerDataGridColumn("advice_desc2_1",280,"left","string","자문내용",{hidden:true}),new FingerDataGridColumn("advice_desc2_2",280,"left","string","자문내역활용방안",{hidden:true}),new FingerDataGridColumn("cp_etc2",280,"left","string","기타2",{hidden:true}),new FingerDataGridColumn("trans_yn",280,"left","checkbox","교통비여부",{hidden:true}),new FingerDataGridColumn("stay_yn",280,"left","checkbox","숙박비여부",{hidden:true}),new FingerDataGridColumn("meal_yn",280,"left","checkbox","식음료비여부",{hidden:true}),new FingerDataGridColumn("trans_amt",280,"left","string","교통여비",{hidden:true}),new FingerDataGridColumn("stay_amt",280,"left","string","숙박비",{hidden:true}),new FingerDataGridColumn("meal_amt",280,"left","string","식음료비",{hidden:true}),new FingerDataGridColumn("advisor_bank_account",280,"left","string","계좌번호",{hidden:true}),new FingerDataGridColumn("etc_expense_sum",280,"left","string","자문여비",{hidden:true})]);$.grdList.init({panel:$.panList,isFilter:false,nonExcel:true});$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panInfo);$.panMain.add($.panBottom);$.panMain.add($.panReport);$.panMain.add($.panReport1);$.panMain.add($.panReport2);$.panMain.add($.panReport3);$.panList.add($.grdList);$.panInfo.add($.spel_advice_amt);$.panInfo.add($.lbl_advice_amt);$.panInfo.add($.txt_company_id);$.panInfo.add($.txt_company_name);$.panInfo.add($.lbl_company_name);$.panInfo.add($.bte_contact_name);$.panInfo.add($.lbl_contact_name);$.panInfo.add($.txt_contact_id);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panReport.add($.mem_advice_desc1_3);$.panReport.add($.lbl_advice_desc1_3);$.panReport.add($.mem_cp_etc1);$.panReport.add($.lbl_cp_etc1);$.panReport.add($.mem_advice_desc1_2);$.panReport.add($.lbl_advice_desc1_2);$.panReport.add($.mem_advice_desc1_1);$.panReport.add($.lbl_advice_desc1_1);$.panReport.add($.dte_cp_end_date);$.panReport.add($.dte_cp_start_date);$.panReport.add($.lbl_cp_date);$.panReport.add($.txt_cp_place);$.panReport.add($.lbl_cp_place);$.panReport.add($.dte_cp_advice_date1);$.panReport.add($.lbl_cp_advice_date1);$.panReport.add($.cmb_product_code);$.panReport.add($.lbl_product_code);$.panReport.add($.lbl_Txt1);$.panReport1.add($.mem_cp_etc2);$.panReport1.add($.lbl_cp_etc2);$.panReport1.add($.mem_advice_desc2_2);$.panReport1.add($.lbl_advice_desc2_2);$.panReport1.add($.mem_advice_desc2_1);$.panReport1.add($.lbl_advice_desc2_1);$.panReport1.add($.cmb_cp_MM_to);$.panReport1.add($.cmb_cp_HH_to);$.panReport1.add($.cmb_cp_MM_fr);$.panReport1.add($.cmb_cp_HH_fr);$.panReport1.add($.dte_cp_advice_date2);$.panReport1.add($.lbl_cp_advice_date2);$.panReport1.add($.mem_cp_choice_desc);$.panReport1.add($.lbl_cp_choice_dexc);$.panReport1.add($.txt_cp_advice_subject);$.panReport1.add($.lbl_cp_advice_subject);$.panReport1.add($.lbl_Txt2);$.panReport1.add($.lbl_Txt3);$.panReport1.add($.lbl_Txt4);$.panReport2.add($.txt_lect_bank_account);$.panReport2.add($.lbl_lect_bank_account);$.panReport2.add($.spe_meal_amt);$.panReport2.add($.lbl_meal_amt);$.panReport2.add($.spe_stay_amt);$.panReport2.add($.lbl_stay_amt);$.panReport2.add($.spe_trans_amt);$.panReport2.add($.lbl_trans_amt);$.panReport2.add($.spe_etc_expense_sum);$.panReport3.add($.chk_trans_yn);$.panReport3.add($.chk_stay_yn);$.panReport3.add($.chk_meal_yn);relocateChildIndexInPanel([$.panInfo,$.panReport,$.panReport1,$.panReport2,$.panReport3]);var ds=bizComponentData2($,"Q1","L_CRM0084|L_COM017|L_COM018|L_COM017|L_COM018");$.cmb_product_code.setColumn("product_code","product_name");setComboBind([$.cmb_product_code,$.cmb_cp_HH_fr,$.cmb_cp_MM_fr,$.cmb_cp_HH_to,$.cmb_cp_MM_to],ds);if($.p_argument){if($.p_argument.source.length>0){setDataGrid([$.grdList],$.p_argument.source,true);$.grdList.selectRow(0)}if($.p_argument.cp_code!=""){$.strcp_code=$.p_argument.cp_code}if($.p_argument.save_mode!=null&&$.p_argument.save_mode=="N"){fnEnableSet(false)}else{if($.grdList.getRowCount()<1){$.grdList.addRow({});$.bChange=true}else{$.bChange=false}}}if($.strcp_code=="CP04"){$.panReport2.setVisible(true);$.panReport3.setVisible(false);$.lbl_cp_advice_date1.setVisible(true);$.dte_cp_advice_date1.setVisible(true);$.dte_cp_advice_date1.setAllowBlank(false,"자문일자")}else{if($.strcp_code=="CP20"){$.lbl_advice_desc1_3.setVisible(false);$.mem_advice_desc1_3.setVisible(false);$.panReport2.setVisible(false);$.panReport3.setVisible(true);$.lbl_cp_advice_date1.setVisible(false);$.dte_cp_advice_date1.setVisible(false);$.dte_cp_advice_date1.setAllowBlank(true,"자문일자");$.panReport.setText("자문내용")}}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){if(!gridValidator($.grdList,"contact_name")){return}if($.bChange){MessageBoxShow("변경사항이 있습니다. 저장 후 확인버튼을 눌러주세요");return}else{for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"contact_name")==""){MessageBoxShow("자문자 은(는) 필수입력항목입니다.");return}}var rows=[];rows=copyArray($.grdList.getAllRows());var share={confirm_yn:"Y",source:rows};g_popupStack.setData(share);g_popupStack.close()}}else{if(id=="btnCancel"){g_popupStack.close()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bte_contact_name"){var param={contact_name:$.bte_contact_name.getText()||"",check_yn:"N",base_date:"20131201",inquiry_type:"advice"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){$.bChange=true};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){$.bChange=true};$.fingercombobox_change=function(id,value){$.bChange=true};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){$.bChange=true};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.txt_contact_id.setValue($.grdList.getValue(rId,"contact_id")||"");$.bte_contact_name.setText($.grdList.getValue(rId,"contact_name")||"");$.txt_company_id.setValue($.grdList.getValue(rId,"company_id")||"");$.txt_company_name.setValue($.grdList.getValue(rId,"company_name")||"");$.spel_advice_amt.setValue($.grdList.getValue(rId,"advice_amt")||0);$.cmb_product_code.setValue($.grdList.getValue(rId,"product_code")||"");$.dte_cp_advice_date1.setValue($.grdList.getValue(rId,"cp_advice_date1")||"");$.txt_cp_place.setValue($.grdList.getValue(rId,"cp_place")||"");$.dte_cp_start_date.setValue(getFormatDate($.grdList.getValue(rId,"cp_start_date"),"yyyyMMdd"));$.dte_cp_end_date.setValue(getFormatDate($.grdList.getValue(rId,"cp_end_date"),"yyyyMMdd"));$.mem_advice_desc1_1.setValue($.grdList.getValue(rId,"advice_desc1_1")||"");$.mem_advice_desc1_2.setValue($.grdList.getValue(rId,"advice_desc1_2")||"");$.mem_cp_etc1.setValue($.grdList.getValue(rId,"cp_etc1")||"");$.mem_advice_desc1_3.setValue($.grdList.getValue(rId,"advice_desc1_3")||"");$.txt_cp_advice_subject.setValue($.grdList.getValue(rId,"cp_advice_subject")||"");$.mem_cp_choice_desc.setValue($.grdList.getValue(rId,"cp_choice_desc")||"");$.dte_cp_advice_date2.setValue($.grdList.getValue(rId,"cp_advice_date2")||"");$.cmb_cp_HH_fr.setValue($.grdList.getValue(rId,"cp_HH_fr")||"");$.cmb_cp_MM_fr.setValue($.grdList.getValue(rId,"cp_MM_fr")||"");$.cmb_cp_HH_to.setValue($.grdList.getValue(rId,"cp_HH_to")||"");$.cmb_cp_MM_to.setValue($.grdList.getValue(rId,"cp_MM_to")||"");$.mem_advice_desc2_1.setValue($.grdList.getValue(rId,"advice_desc2_1")||"");$.mem_advice_desc2_2.setValue($.grdList.getValue(rId,"advice_desc2_2")||"");$.mem_cp_etc2.setValue($.grdList.getValue(rId,"cp_etc2")||"");$.chk_trans_yn.setValue($.grdList.getValue(rId,"trans_yn")||"N");$.chk_stay_yn.setValue($.grdList.getValue(rId,"stay_yn")||"N");$.chk_meal_yn.setValue($.grdList.getValue(rId,"meal_yn")||"N");$.spe_trans_amt.setValue($.grdList.getValue(rId,"trans_amt")||0);$.spe_stay_amt.setValue($.grdList.getValue(rId,"stay_amt")||0);$.spe_meal_amt.setValue($.grdList.getValue(rId,"meal_amt")||0);$.txt_lect_bank_account.setValue($.grdList.getValue(rId,"advisor_bank_account")||"");$.spe_etc_expense_sum.setValue($.grdList.getValue(rId,"etc_expense_sum")||0);$.bChange=false}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){$.bChange=true;if(id=="spe_meal_amt"){$.spe_etc_expense_sum.setValue(Number($.spe_trans_amt.getValue())+Number($.spe_stay_amt.getValue())+Number($.spe_meal_amt.getValue()))}else{if(id=="spe_trans_amt"){$.spe_etc_expense_sum.setValue(Number($.spe_trans_amt.getValue())+Number($.spe_stay_amt.getValue())+Number($.spe_meal_amt.getValue()))}else{if(id=="spe_stay_amt"){$.spe_etc_expense_sum.setValue(Number($.spe_trans_amt.getValue())+Number($.spe_stay_amt.getValue())+Number($.spe_meal_amt.getValue()))}else{if(id=="mem_advice_desc2_1"){if(value==null){return}$.mem_advice_desc1_2.setValue(value)}}}}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){$.panInfo.clear();$.panReport.clear();$.panReport1.clear();$.panReport2.clear();$.panReport3.clear();$.grdList.addRow({});$.bte_contact_name.setFocus();$.bChange=true}else{if(btnId=="btnDelete"){if(!$.grdList.getSelectedRowIdx()){return}$.grdList.deleteRow($.grdList.getSelectedRowIdx());$.grdList.selectRow(0);$.bChange=false}else{if(btnId=="btnSave"){if(saveClick()){MessageBoxShow("저장되었습니다.");$.bChange=false}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="bte_contact_name"){$.txt_contact_id.setValue(popResult.popRows.contact_id);$.bte_contact_name.setText(popResult.popRows.contact_name);$.txt_company_id.setValue(popResult.popRows.company_id);$.txt_company_name.setValue(popResult.popRows.company_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>