<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.panContact=null;$.panCard=null;$.panInfo=null;$.lblCPNo=null;$.lblLeader=null;$.lblEmp=null;$.lblPM=null;$.lblProduct=null;$.lblTheme=null;$.lblContact=null;$.lblEnterEmp=null;$.lblAgenda=null;$.lblDescr=null;$.lblBillType=null;$.txtCPNo=null;$.cmbLeader=null;$.cmbEmp=null;$.cmbPM=null;$.cmbProduct=null;$.cmbTheme=null;$.rdoContact=null;$.grdContact=null;$.grdCard=null;$.rdoBillType=null;$.memEnterEmp=null;$.memAgenda=null;$.memDescr=null;$.img1=null;$.img2=null;$.img3=null;$.panRight=null;$.lblPicture=null;$.grdList=null;$.cmbStatus=null;$.lblstartDate=null;$.lblReportDate=null;$.lblApprovarName=null;$.dteStartDate=null;$.dteReportDate=null;$.txtApprovalName=null;$.btnSearch=null;$.grdContact2=null;$.grdEsero=null;$.varCPId="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmCPAuditDetail_Q",[workType]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPDetailAfter_Q",[workType,$.varCPId]);return json}function searchList(){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function searchDetail(){if($.varCPId==""){return}var json=createJSON_Q2("Q");callQuery(["req",json],"Q_D",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,700);$.panMain.setText("제품디테일링 - 사후");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,255,650);$.panList.setText("");$.panList.setBottomLine(true);$.panContact=new FingerPanel(host,"panContact",0,130,530,150);$.panContact.setText("제품디테일링 고객");$.panContact.setBottomLine(true);$.panCard=new FingerPanel(host,"panCard",0,295,530,150);$.panCard.setText("법인카드내역");$.panCard.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",265,0,765,650);$.panInfo.setText("");$.panInfo.setBottomLine(true);$.lblCPNo=new FingerLabel(host,"lblCPNo",0,10,100,20);$.lblCPNo.setText("문서번호");$.lblLeader=new FingerLabel(host,"lblLeader",275,10,100,20);$.lblLeader.setText("영업소장");$.lblEmp=new FingerLabel(host,"lblEmp",0,40,100,20);$.lblEmp.setText("담당자");$.lblPM=new FingerLabel(host,"lblPM",275,40,100,20);$.lblPM.setText("PM");$.lblProduct=new FingerLabel(host,"lblProduct",0,70,100,20);$.lblProduct.setText("품목");$.lblTheme=new FingerLabel(host,"lblTheme",275,70,100,20);$.lblTheme.setText("디테일링 테마");$.lblContact=new FingerLabel(host,"lblContact",0,100,100,20);$.lblContact.setText("고객구분");$.lblEnterEmp=new FingerLabel(host,"lblEnterEmp",0,465,100,20);$.lblEnterEmp.setText("참가직원");$.lblAgenda=new FingerLabel(host,"lblAgenda",15,515,85,20);$.lblAgenda.setText("Agenda 및 기타사항");$.lblDescr=new FingerLabel(host,"lblDescr",0,565,100,20);$.lblDescr.setText("설명회 내용");$.lblBillType=new FingerLabel(host,"lblBillType",220,-37,100,20);$.lblBillType.setText("영수증구분");$.txtCPNo=new FingerEdit(host,"txtCPNo",105,10,140,20);$.cmbLeader=new FingerComboBox(host,"cmbLeader",380,10,140,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",105,40,140,20);$.cmbPM=new FingerComboBox(host,"cmbPM",380,40,140,20);$.cmbProduct=new FingerComboBox(host,"cmbProduct",105,70,140,20);$.cmbTheme=new FingerComboBox(host,"cmbTheme",380,70,140,20);$.rdoContact=new FingerRadioBox(host,"rdoContact",105,100,180,20);$.grdContact=new FingerDataGrid(host,"grdContact",0,0,530,105);$.grdCard=new FingerDataGrid(host,"grdCard",0,0,530,105);$.rdoBillType=new FingerRadioBox(host,"rdoBillType",325,-37.5,205,20);$.memEnterEmp=new FingerMemoEdit(host,"memEnterEmp",105,465,420,40);$.memAgenda=new FingerMemoEdit(host,"memAgenda",105,515,420,40);$.memDescr=new FingerMemoEdit(host,"memDescr",105,565,420,70);$.img1=new FingerImage(host,"img1",550,50,205,190);$.img2=new FingerImage(host,"img2",550,250,205,190);$.img3=new FingerImage(host,"img3",550,450,205,190);$.panRight=new FingerPanel(host,"panRight",1040,0,160,650);$.panRight.setText("");$.panRight.setBottomLine(true);$.lblPicture=new FingerLabel(host,"lblPicture",600,10,100,20);$.lblPicture.setText("영수증 내역서");$.grdList=new FingerDataGrid(host,"grdList",0,0,255,650);$.cmbStatus=new FingerComboBox(host,"cmbStatus",10,10,140,20);$.lblstartDate=new FingerLabel(host,"lblstartDate",0,55,160,20);$.lblstartDate.setText("개최일시");$.lblReportDate=new FingerLabel(host,"lblReportDate",0,130,160,20);$.lblReportDate.setText("보고일자");$.lblApprovarName=new FingerLabel(host,"lblApprovarName",0,205,160,20);$.lblApprovarName.setText("승인자");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",10,80,140,20);$.dteReportDate=new FingerDateEdit(host,"dteReportDate",10,155,140,20);$.txtApprovalName=new FingerEdit(host,"txtApprovalName",10,230,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,-37.5,80,20);$.btnSearch.setText("조회");$.grdContact2=new FingerDataGrid(host,"grdContact2",0,0,530,105);$.grdEsero=new FingerDataGrid(host,"grdEsero",0,0,530,105);$.panList.setBorder(true);$.panRight.setBorder(true);$.panMain.setBorder(false);$.panInfo.setBorder(true);$.panList.addButtons(["btnDelete","btnSave","btnNew"]);$.grdList.setColumns([new FingerDataGridColumn("cp_id",99,"left","string","CPID",{hidden:true}),new FingerDataGridColumn("DeptCode",120,"left","string","부서명"),new FingerDataGridColumn("EmpCode",80,"left","string","부서원"),new FingerDataGridColumn("use_amt",80,"left","string","금액",{format:"int"})]);$.grdList.init({scroll:"xy"});$.grdList.setBorder(false);$.grdContact.setColumns([new FingerDataGridColumn("company_id",99,"left","string","거래처아이디",{hidden:true}),new FingerDataGridColumn("company_name",150,"left","string","병원명"),new FingerDataGridColumn("company_addr",190,"left","string","병원주소"),new FingerDataGridColumn("speciality_code",99,"left","string","진료과목코드",{hidden:true}),new FingerDataGridColumn("speciality",90,"left","string","진료과목"),new FingerDataGridColumn("contact_num",80,"right","string","인원"),new FingerDataGridColumn("channel1",99,"left","string","채널",{hidden:true}),new FingerDataGridColumn("business_no",99,"left","string","사업자번호",{hidden:true})]);$.grdContact.init();$.grdContact.setBorder(false);$.grdContact2.setColumns([new FingerDataGridColumn("contact_area",250,"left","string","지역"),new FingerDataGridColumn("speciality2_code",99,"left","string","진료과목코드",{hidden:true}),new FingerDataGridColumn("speciality2",160,"left","string","진료과목"),new FingerDataGridColumn("contact_num2",100,"right","string","인원",{format:"int"})]);$.grdContact2.init();$.grdContact2.setBorder(false);$.grdCard.setColumns([new FingerDataGridColumn("APPDAT",120,"left","string","승인시간"),new FingerDataGridColumn("CARDNO",120,"left","string","카드정보"),new FingerDataGridColumn("APPRNO",99,"left","string","승인번호",{hidden:true}),new FingerDataGridColumn("APPAMT",100,"right","string","승인금액",{format:"int"}),new FingerDataGridColumn("VENKNM",100,"left","string","가맹점"),new FingerDataGridColumn("VENADD",150,"left","string","가맹점 주소"),new FingerDataGridColumn("VENGRP",80,"left","string","업태")]);$.grdCard.init({scroll:"xy"});$.grdCard.setBorder(false);$.grdEsero.setColumns([new FingerDataGridColumn("appdat",150,"left","string","발행일자"),new FingerDataGridColumn("bizname",99,"left","string","상호"),new FingerDataGridColumn("appamt",80,"left","string","공급가액",{format:"int"}),new FingerDataGridColumn("product",80,"left","string","품목"),new FingerDataGridColumn("product1",80,"left","string","품목1"),new FingerDataGridColumn("apprno",80,"left","string","승인번호")]);$.grdEsero.init();$.grdEsero.setBorder(false);$.lblstartDate.setAlign("center");$.lblReportDate.setAlign("center");$.lblApprovarName.setAlign("center");$.rdoContact.addButtons([{code_name:"종병.SH",sub_code:"10"},{code_name:"개업의",sub_code:"20"}]);$.rdoBillType.addButtons([{code_name:"법인카드",sub_code:"Card"},{code_name:"전자세금계산서",sub_code:"Esero"}]);$.txtCPNo.setReadOnly(true);$.cmbLeader.setEnable(false);$.cmbEmp.setEnable(false);$.cmbPM.setEnable(false);$.cmbProduct.setEnable(false);$.cmbTheme.setEnable(false);$.memEnterEmp.setReadOnly(true);$.memAgenda.setReadOnly(true);$.memDescr.setReadOnly(true);$.cmbStatus.setEnable(false);$.dteStartDate.setEnable(false);$.dteReportDate.setEnable(false);$.txtApprovalName.setReadOnly(true);$.grdEsero.setVisible(false);var info=g_main.session.obj;if(info.DeptCode!=info.CPDeptCode&&info.SystemDeveloper!="Y"&&info.UserID!="ka971025"&&info.UserID!="ka971022"){$.btnSearch.setEnable(false)}$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panInfo);$.panMain.add($.panRight);$.panMain.add($.btnSearch);$.panList.add($.grdList);$.panContact.add($.grdContact);$.panContact.add($.grdContact2);$.panCard.add($.grdCard);$.panCard.add($.grdEsero);$.panCard.add($.lblBillType);$.panCard.add($.rdoBillType);$.panInfo.add($.panContact);$.panInfo.add($.panCard);$.panInfo.add($.lblCPNo);$.panInfo.add($.lblLeader);$.panInfo.add($.lblEmp);$.panInfo.add($.lblPM);$.panInfo.add($.lblProduct);$.panInfo.add($.lblTheme);$.panInfo.add($.lblContact);$.panInfo.add($.lblEnterEmp);$.panInfo.add($.lblAgenda);$.panInfo.add($.lblDescr);$.panInfo.add($.txtCPNo);$.panInfo.add($.cmbLeader);$.panInfo.add($.cmbEmp);$.panInfo.add($.cmbPM);$.panInfo.add($.cmbProduct);$.panInfo.add($.cmbTheme);$.panInfo.add($.rdoContact);$.panInfo.add($.memEnterEmp);$.panInfo.add($.memAgenda);$.panInfo.add($.memDescr);$.panInfo.add($.img3);$.panInfo.add($.img2);$.panInfo.add($.img1);$.panInfo.add($.lblPicture);$.panRight.add($.cmbStatus);$.panRight.add($.lblstartDate);$.panRight.add($.lblReportDate);$.panRight.add($.lblApprovarName);$.panRight.add($.dteStartDate);$.panRight.add($.dteReportDate);$.panRight.add($.txtApprovalName);$.cmbEmp.setEmptyRow(true);$.cmbLeader.setEmptyRow(true);$.cmbProduct.setEmptyRow(true);$.cmbPM.setEmptyRow(true);$.cmbTheme.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);var ds=bizComponentData2($,"Q1","L_CRM0051|L_CRM0219|L_CRM0052|L_CRM0108|L_CRM0131|L_CRM192|L_CRM0109|L_CRM0111");$.grdList.setColumnDropDownList("DeptCode",ds.resultList[0],{key:"dept_code",name:"dept_name"});$.grdList.setColumnDropDownList("EmpCode",ds.resultList[1],{key:"employee_id",name:"emp_name"});$.cmbEmp.setColumn("employee_id","emp_name");$.cmbLeader.setColumn("line1empno","line1empname");$.cmbProduct.setColumn("product_code","product_name");$.cmbPM.setColumn("employee_id","emp_name");setComboBind([null,null,$.cmbEmp,$.cmbLeader,$.cmbProduct,$.cmbPM,$.cmbTheme,$.cmbStatus],ds)};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdList],ds)}else{if(type=="Q_D"){var rs=ds.resultList[0][0];$.varCpId=rs.cp_id;$.txtCPNo.setValue(rs.cp_doc_no);$.cmbLeader.setValue(rs.team_leader);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbPM.setValue(rs.cp_emp_pm);$.cmbProduct.setValue(rs.product_code);$.cmbTheme.setValue(rs.report_theme);$.rdoContact.setValue(rs.contact_type);$.rdoBillType.setValue(rs.bill_type);$.memEnterEmp.setValue(rs.cp_enter_emp);$.memAgenda.setValue(rs.agenda);$.memDescr.setValue(rs.cp_desc);$.cmbStatus.setValue(rs.cp_status);$.dteStartDate.setValue(rs.cp_start_date);$.dteReportDate.setValue(rs.report_date);$.txtApprovalName.setValue(rs.approval_name);setDataGrid([null,null,$.grdContact,$.grdContact2,$.grdCard,$.grdEsero],ds);if($.grdContact.getRowCount()>0){$.grdContact.setVisible(true);$.grdContact2.setVisible(false);$.rdoContact.setValue("10")}else{$.grdContact.setVisible(false);$.grdContact2.setVisible(true);$.rdoContact.setValue("20")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){$.varCPId=$.grdList.getValue(rId,"cp_id");searchDetail()}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>