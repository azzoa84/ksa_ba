<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panFile=null;$.grdFile=null;$.lblcp_doc_no=null;$.txtcp_doc_no=null;$.lblcp_emp_id=null;$.cmbcp_emp_id=null;$.lblEx9=null;$.cmbStatus=null;$.lblad_host=null;$.lblproduct=null;$.txtproduct=null;$.lblapp_date=null;$.dteapp_date=null;$.lblcp_start_date=null;$.dteymdcp_start_date=null;$.lbldateline=null;$.dteymdcp_end_date=null;$.lblnumcp_days=null;$.lblEx8=null;$.lblevent_title=null;$.txtevent_title=null;$.lbltype=null;$.rbotype=null;$.lblbooth_cnt=null;$.spebooth_cnt=null;$.lblbooth_amt=null;$.spebooth_amt=null;$.lblad_media=null;$.txtad_media=null;$.txtad_detail=null;$.lblad_navi=null;$.cmbadType1=null;$.cmbadType2=null;$.cmbadType3=null;$.lblnumad_amt=null;$.spenumad_amt=null;$.lblad_purpose=null;$.memad_purpose=null;$.lblPay_date=null;$.dtePay_date=null;$.chkDateModified=null;$.chkCanceled=null;$.lblcp_total_amt=null;$.specp_total_amt=null;$.lblad_detail=null;$.chkFileAttach=null;$.txtcp_id=null;$.txtcp_code=null;$.txtbefore_cp_id=null;$.lblTx1=null;$.lblTx2=null;$.lblTx3=null;$.lblTx4=null;$.btnConfirm=null;$.btnCancel=null;$.memcp_descr=null;$.btnDateModified=null;$.btnDPADCancel=null;$.btnMemoSave=null;$.btnPicReject=null;$.btnPicEdit=null;$.panBottom=null;$.txtnumcp_days=null;$.txtad_host_biznum=null;$.txtad_host_cardcode=null;$.btead_host=null;$.lblcp_emp_pm=null;$.cbocp_emp_pm=null;$.bAllReport=false;$.bMyReport=false;$.bConfirm=false;$.bSave=false;$.radioChk=false;function createJson_Q(workType){var json=createExecuteParamInfo("P_crmCPDPADBefore_Q",[workType,$.txtbefore_cp_id.getValue()||"",""]);return json}function createJson_S(workType){var json;var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if(workType=="N"||workType=="U"||workType=="Pic"){if($.grdFile.getRowCount()<1){MessageBoxShow("공문, 전시/광고된 사진은 필수 첨부 파일입니다.");return false}else{var check1="",check2="";for(var i=0;i<$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"local_fname")==""){MessageBoxShow("파일명은 필수 항목입니다.");return false}if($.grdFile.getValue(i,"file_type")=="006"){check1="006"}else{if($.grdFile.getValue(i,"file_type")=="031"){check2="031"}}if(check1=="006"&&check2=="031"){break}}if(check1!="006"){MessageBoxShow("공문은 필수 첨부파일입니다.");return false}else{if(check2!="031"){MessageBoxShow("전시/광고된 사진(웹사이트 광고 시 캡쳐화면)은 필수 첨부파일입니다.");return false}}}if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}}if(workType!="Pic"){json=createExecuteParamInfo("P_crmCPDPADAfter_S",[workType,$.txtcp_id.getValue()||"",$.txtcp_doc_no.getValue()||"",$.cmbcp_emp_id.getValue(),"#DeptCode#",$.cbocp_emp_pm.getValue(),$.btead_host.getText(),$.txtad_host_biznum.getValue(),$.txtad_host_cardcode.getValue(),$.txtproduct.getValue(),$.dteymdcp_start_date.getValue(),$.dteymdcp_end_date.getValue(),parseInt($.txtnumcp_days.getValue()),$.txtevent_title.getValue(),$.rbotype.getValue(),Number($.spebooth_cnt.getValue()),Number($.spebooth_amt.getValue()),$.txtad_media.getValue(),$.txtad_detail.getValue(),$.cmbadType1.getValue(),$.cmbadType2.getValue(),$.cmbadType3.getValue()||"",Number($.spenumad_amt.getValue()),Number($.specp_total_amt.getValue()),$.memad_purpose.getValue(),$.dteapp_date.getValue(),$.txtbefore_cp_id.getValue()||"","CP23","#UserID#",$.dtePay_date.getValue(),$.chkFileAttach.getValue()=="Y"?"N":"Y",strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname])}else{if(workType=="Pic"){json=createExecuteParamInfo("P_crmCPDPADAfter_S",[workType,$.txtcp_id.getValue()||"",$.txtcp_doc_no.getValue()||"",$.cmbcp_emp_id.getValue(),"#DeptCode#","","","","","","","",parseInt(0),"","",parseInt(0),parseInt(0),"","","","","",parseInt(0),parseInt(0),"","",$.txtbefore_cp_id.getValue()||"","CP23","#UserID#","",$.chkFileAttach.getValue()=="Y"?"N":"Y",strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname])}}return json}function createJson_S1(workType){var json;if(workType=="CANCEL"){json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txtcp_id.getValue()||"",$.chkCanceled.getValue(),"#UserID#"])}else{if(workType=="DATE"){json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txtcp_id.getValue()||"",$.chkDateModified.getValue(),"#UserID#"])}}return json}function searchCPDPADBefore(workType){var json=createJson_Q(workType);callQuery(["req",json],workType,$)}function saveCPExtraFunction(workType){var json=createJson_S1(workType);callExecute(["req",json],workType,$)}function saveCPDPADAfter(workType){if(!validateControls([$.rbotype,$.txtproduct,$.dtePay_date,$.dteymdcp_start_date,$.memad_purpose,$.dteymdcp_end_date,$.btead_host,$.txtevent_title,$.cmbadType1,$.cmbadType2,$.txtad_media,$.txtad_detail])){return}var json=createJson_S(workType);if(!json){return}$.workType=workType;callExecute(["req",json],"CPDPADA",$)}function newClick(){$.panQuery.clear();$.grdFile.clear();$.memcp_descr.setValue("");$.memcp_descr.setReadOnly(true);$.panQuery.enableButton(["btnDelete","btnSave"]);$.panFile.enableButton(["btnDelete","btnAdd"]);$.panBottom.setVisible(false);fnEnableSet(true);$.cmbcp_emp_id.setValue(g_main.session.obj.EmpCode);$.cmbStatus.setValue("10");$.dteapp_date.setValue(getToday(""));$.panBottom.setVisible(false);$.panQuery.disableButton(["btnDelete"]);$.dteapp_date.setReadOnly(false);$.txtad_media.setValue(null);$.txtproduct.setValue(null);$.txtad_detail.setValue(null)}function saveClick(){fnSumAmt();saveCPDPADAfter($.txtcp_id.getValue()==""?"N":"U")}function deleteClick(){if($.txtcp_id.getValue()==""){return}confirmBoxShow("["+$.txtcp_doc_no.getValue()+"] 전시/광고(사후)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveCPDPADAfter("D")}})}function fnSumAmt(){if($.spebooth_cnt.getValue()==null||$.spebooth_amt.getValue()==null||$.spenumad_amt.getValue()==null){return}$.specp_total_amt.setValue((Number($.spebooth_cnt.getValue())*Number($.spebooth_amt.getValue()))+Number($.spenumad_amt.getValue()))}function fnEnableSet(bo){if(bo){$.panQuery.enableButton(["btnDelete","btnSave"]);$.panFile.enableButton(["btnAdd","btnDelete"])}else{$.panQuery.disableButton(["btnDelete","btnSave"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.grdFile.setEditable(bo);$.cbocp_emp_pm.setReadOnly(!bo);$.btead_host.setReadOnly(!bo);$.dteymdcp_start_date.setReadOnly(!bo);$.dteymdcp_end_date.setReadOnly(!bo);$.txtevent_title.setReadOnly(!bo);$.spebooth_cnt.setEnable(bo);$.spebooth_amt.setEnable(bo);$.txtad_media.setReadOnly(!bo);$.txtad_detail.setReadOnly(!bo);$.memad_purpose.setReadOnly(!bo);$.spenumad_amt.setEnable(bo);$.txtnumcp_days.setReadOnly(!bo);$.dtePay_date.setReadOnly(!bo);$.chkFileAttach.setEnable(bo);$.cmbadType1.setEnable(bo);$.cmbadType2.setEnable(bo);$.rbotype.setEnable(bo)}function radioCheck(){if($.rbotype.getValue()=="AD"){$.spebooth_cnt.setAllowBlank(true,"부스");$.spebooth_cnt.setEnable(false);$.spebooth_cnt.setValue(0);$.spebooth_amt.setAllowBlank(true,"부스비");$.spebooth_amt.setEnable(false);$.spebooth_amt.setValue(0);$.spenumad_amt.setEnable(true);$.spenumad_amt.setAllowBlank(false,"광고비");$.spenumad_amt.setValue(0);$.cmbadType1.setAllowBlank(false,"광고위치1");$.cmbadType2.setAllowBlank(false,"광고위치2");$.txtad_media.setAllowBlank(false,"광고항목");$.txtad_detail.setAllowBlank(false,"광고내용")}else{if($.rbotype.getValue()=="DP"){$.spebooth_cnt.setEnable(true);$.spebooth_cnt.setAllowBlank(false,"부스");$.spebooth_cnt.setValue(0);$.spebooth_amt.setEnable(true);$.spebooth_amt.setAllowBlank(false,"부스비");$.spebooth_amt.setValue(0);$.spenumad_amt.setAllowBlank(true,"광고비");$.spenumad_amt.setEnable(false);$.spenumad_amt.setValue(0);$.cmbadType1.setValue("00");$.cmbadType2.setValue("00");$.cmbadType1.setAllowBlank(true,"광고위치1");$.cmbadType2.setAllowBlank(true,"광고위치2");$.txtad_media.setAllowBlank(true,"광고항목");$.txtad_detail.setAllowBlank(true,"광고내용");$.cmbadType1.setBackgroundColor("white");$.cmbadType2.setBackgroundColor("white")}else{if($.rbotype.getValue()=="DPAD"){$.spebooth_cnt.setEnable(true);$.spebooth_cnt.setAllowBlank(false,"부스");$.spebooth_cnt.setValue(0);$.spebooth_amt.setEnable(true);$.spebooth_amt.setAllowBlank(false,"부스비");$.spebooth_amt.setValue(0);$.spenumad_amt.setEnable(true);$.spenumad_amt.setAllowBlank(false,"광고비");$.spenumad_amt.setValue(0);$.cmbadType1.setAllowBlank(false,"광고위치1");$.cmbadType2.setAllowBlank(false,"광고위치2");$.txtad_media.setAllowBlank(false,"광고항목");$.txtad_detail.setAllowBlank(false,"광고내용")}}}$.specp_total_amt.setValue(0)}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,735);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,390);$.panQuery.setText("전시/광고(사전) 정보");$.panQuery.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,400,1200,205);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,160);$.lblcp_doc_no=new FingerLabel(host,"lblcp_doc_no",10,10,100,20);$.lblcp_doc_no.setText("문서번호");$.txtcp_doc_no=new FingerEdit(host,"txtcp_doc_no",115,10,235,20);$.lblcp_emp_id=new FingerLabel(host,"lblcp_emp_id",510,10,100,20);$.lblcp_emp_id.setText("담당자");$.cmbcp_emp_id=new FingerComboBox(host,"cmbcp_emp_id",615,10,140,20);$.lblEx9=new FingerLabel(host,"lblEx9",915,275,100,20);$.lblEx9.setText("승인상태");$.cmbStatus=new FingerComboBox(host,"cmbStatus",1020,275,140,20);$.lblad_host=new FingerLabel(host,"lblad_host",0,40,110,20);$.lblad_host.setText("주최단체/광고주");$.lblproduct=new FingerLabel(host,"lblproduct",510,40,100,20);$.lblproduct.setText("품목");$.txtproduct=new FingerEdit(host,"txtproduct",615,40,250,20);$.lblapp_date=new FingerLabel(host,"lblapp_date",915,305,100,20);$.lblapp_date.setText("승인요청일");$.dteapp_date=new FingerDateEdit(host,"dteapp_date",1020,305,140,20);$.lblcp_start_date=new FingerLabel(host,"lblcp_start_date",10,70,100,20);$.lblcp_start_date.setText("전시/광고 기간");$.dteymdcp_start_date=new FingerDateEdit(host,"dteymdcp_start_date",115,70,140,20);$.lbldateline=new FingerLabel(host,"lbldateline",255,70,20,20);$.lbldateline.setText("~");$.dteymdcp_end_date=new FingerDateEdit(host,"dteymdcp_end_date",280,70,140,20);$.lblnumcp_days=new FingerLabel(host,"lblnumcp_days",480,70,40,20);$.lblnumcp_days.setText("일간");$.lblEx8=new FingerLabel(host,"lblEx8",540,70,595,20);$.lblEx8.setText('- 전시광고하신 내용이 "품목"이 아닌 "기업광고"이신 경우 기업광고라고 기입하시기 바랍니다. -');$.lblevent_title=new FingerLabel(host,"lblevent_title",0,100,110,20);$.lblevent_title.setText("부스 학술행사명");$.txtevent_title=new FingerEdit(host,"txtevent_title",115,100,370,20);$.lbltype=new FingerLabel(host,"lbltype",0,130,100,20);$.lbltype.setText("유형");$.rbotype=new FingerRadioBox(host,"rbotype",115,130,275,20);$.lblbooth_cnt=new FingerLabel(host,"lblbooth_cnt",510,130,100,20);$.lblbooth_cnt.setText("부스");$.spebooth_cnt=new FingerSpinEdit(host,"spebooth_cnt",615,130,140,20);$.lblbooth_amt=new FingerLabel(host,"lblbooth_amt",915,130,100,20);$.lblbooth_amt.setText("부스비");$.spebooth_amt=new FingerSpinEdit(host,"spebooth_amt",1020,130,140,20);$.lblad_media=new FingerLabel(host,"lblad_media",10,160,100,20);$.lblad_media.setText("광고항목");$.txtad_media=new FingerEdit(host,"txtad_media",115,160,245,20);$.txtad_detail=new FingerEdit(host,"txtad_detail",615,160,545,20);$.lblad_navi=new FingerLabel(host,"lblad_navi",10,190,100,20);$.lblad_navi.setText("광고위치");$.cmbadType1=new FingerComboBox(host,"cmbadType1",115,190,190,20);$.cmbadType2=new FingerComboBox(host,"cmbadType2",310,190,190,20);$.cmbadType3=new FingerComboBox(host,"cmbadType3",505,190,140,20);$.lblnumad_amt=new FingerLabel(host,"lblnumad_amt",915,190,100,20);$.lblnumad_amt.setText("광고비");$.spenumad_amt=new FingerSpinEdit(host,"spenumad_amt",1020,190,140,20);$.lblad_purpose=new FingerLabel(host,"lblad_purpose",10,220,100,20);$.lblad_purpose.setText("광고목적");$.memad_purpose=new FingerMemoEdit(host,"memad_purpose",115,220,745,75);$.lblPay_date=new FingerLabel(host,"lblPay_date",915,220,100,20);$.lblPay_date.setText("예상지급일");$.dtePay_date=new FingerDateEdit(host,"dtePay_date",1020,220,140,20);$.chkDateModified=new FingerCheckBox(host,"chkDateModified",650,305,140,20);$.chkDateModified.setText("개최일자변경");$.chkCanceled=new FingerCheckBox(host,"chkCanceled",770,305,140,20);$.chkCanceled.setText("개최취소");$.lblcp_total_amt=new FingerLabel(host,"lblcp_total_amt",10,305,100,20);$.lblcp_total_amt.setText("전시/광고 총액");$.specp_total_amt=new FingerSpinEdit(host,"specp_total_amt",115,305,140,20);$.lblad_detail=new FingerLabel(host,"lblad_detail",510,160,100,20);$.lblad_detail.setText("광고내용");$.chkFileAttach=new FingerCheckBox(host,"chkFileAttach",1015,40,140,20);$.chkFileAttach.setText("추후 사진 첨부");$.txtcp_id=new FingerEdit(host,"txtcp_id",115,12,145,20);$.txtcp_code=new FingerEdit(host,"txtcp_code",645,-38,70,20);$.txtbefore_cp_id=new FingerEdit(host,"txtbefore_cp_id",720,-38,70,20);$.lblTx1=new FingerLabel(host,"lblTx1",755,130,20,20);$.lblTx1.setText("개");$.lblTx2=new FingerLabel(host,"lblTx2",1160,130,20,20);$.lblTx2.setText("원");$.lblTx3=new FingerLabel(host,"lblTx3",1160,190,20,20);$.lblTx3.setText("원");$.lblTx4=new FingerLabel(host,"lblTx4",255,305,25,20);$.lblTx4.setText("원");$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.memcp_descr=new FingerMemoEdit(host,"memcp_descr",135,625,850,90);$.btnDateModified=new FingerButton(host,"btnDateModified",1010,5,120,20);$.btnDateModified.setText("개최일자변경");$.btnDPADCancel=new FingerButton(host,"btnDPADCancel",1010,75,120,20);$.btnDPADCancel.setText("개최취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",1120,5,90,95);$.btnMemoSave.setText("메모저장");$.btnPicReject=new FingerButton(host,"btnPicReject",875,-40,95,30);$.btnPicReject.setText("사진 불량");$.btnPicEdit=new FingerButton(host,"btnPicEdit",955,-40,95,30);$.btnPicEdit.setText("사진 수정");$.panBottom=new FingerPanel(host,"panBottom",0,620,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.txtnumcp_days=new FingerSpinEdit(host,"txtnumcp_days",425,70,60,20);$.txtad_host_biznum=new FingerEdit(host,"txtad_host_biznum",355,40,130,20);$.txtad_host_cardcode=new FingerEdit(host,"txtad_host_cardcode",295,305,140,20);$.btead_host=new FingerButtonEdit(host,"btead_host",115,40,220,20);$.btead_host.setText("");$.lblcp_emp_pm=new FingerLabel(host,"lblcp_emp_pm",915,10,100,20);$.lblcp_emp_pm.setText("PM");$.cbocp_emp_pm=new FingerComboBox(host,"cbocp_emp_pm",1020,10,140,20);$.panQuery.setBorder(true);$.panQuery.addButtons(["btnDelete","btnSave"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.txtcp_id.setReadOnly(true);$.txtad_host_biznum.setReadOnly(true);$.txtcp_id.setVisible(true);$.txtcp_code.setVisible(false);$.txtbefore_cp_id.setVisible(false);$.txtcp_doc_no.setVisible(false);$.txtad_host_cardcode.setVisible(false);$.cmbcp_emp_id.setEnable(false);$.cmbStatus.setEnable(false);$.cmbadType3.setVisible(false);$.specp_total_amt.setEnable(false);$.txtproduct.setPlaceholder("예시 : 엑스탄디, 베타미가");$.txtad_media.setPlaceholder("예시 : 초록집, 홈페이지배너, 정기간행물");$.txtad_detail.setPlaceholder("예시 : 엑스탄디 보험 관련, 베타미가 적응증 관련");$.chkDateModified.setVisible(false);$.chkCanceled.setVisible(false);$.btnPicReject.setVisible(false);$.btnPicEdit.setVisible(false);$.rbotype.addButtons([{sub_code:"DP",code_name:"전시(부스)"},{sub_code:"AD",code_name:"광고"},{sub_code:"DPAD",code_name:"전시 및 광고"}]);$.cmbadType1.setEmptyRow(true);$.cmbadType2.setEmptyRow(true);$.cmbcp_emp_id.setAllowBlank(false,"담당자");$.btead_host.setAllowBlank(false,"주최단체/광고주");$.txtproduct.setAllowBlank(false,"품목");$.dteapp_date.setAllowBlank(false,"승인요청일");$.dteymdcp_start_date.setAllowBlank(false,"전시/광고 시작일");$.dteymdcp_end_date.setAllowBlank(false,"전시/광고 종료일");$.txtnumcp_days.setAllowBlank(false,"일간");$.txtevent_title.setAllowBlank(false,"부스 학술행사명");$.memad_purpose.setAllowBlank(false,"광고목적");$.dtePay_date.setAllowBlank(false,"예상지급일");$.specp_total_amt.setAllowBlank(false,"전시/광고 총액");$.spenumad_amt.setAllowBlank(false,"광고비");$.rbotype.setAllowBlank(false,"유형");$.spebooth_cnt.setAllowBlank(false,"부스");$.spebooth_amt.setAllowBlank(false,"부스비");$.spenumad_amt.setAllowBlank(false,"광고비");$.cmbadType1.setAllowBlank(false,"광고위치1");$.cmbadType2.setAllowBlank(false,"광고위치2");$.txtad_media.setAllowBlank(false,"광고항목");$.txtad_detail.setAllowBlank(false,"광고내용");$.cbocp_emp_pm.setAllowBlank(false,"PM");$.grdFile.setColumns([new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",800,"left","string","파일명",{hidden:true})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(false);$.grdFile.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.memcp_descr);$.panQuery.add($.lblcp_doc_no);$.panQuery.add($.txtcp_doc_no);$.panQuery.add($.lblcp_emp_id);$.panQuery.add($.cmbcp_emp_id);$.panQuery.add($.lblEx9);$.panQuery.add($.cmbStatus);$.panQuery.add($.lblad_host);$.panQuery.add($.lblproduct);$.panQuery.add($.txtproduct);$.panQuery.add($.lblapp_date);$.panQuery.add($.dteapp_date);$.panQuery.add($.lblcp_start_date);$.panQuery.add($.dteymdcp_start_date);$.panQuery.add($.lbldateline);$.panQuery.add($.dteymdcp_end_date);$.panQuery.add($.lblnumcp_days);$.panQuery.add($.lblEx8);$.panQuery.add($.lblevent_title);$.panQuery.add($.txtevent_title);$.panQuery.add($.lbltype);$.panQuery.add($.rbotype);$.panQuery.add($.lblbooth_cnt);$.panQuery.add($.spebooth_cnt);$.panQuery.add($.lblbooth_amt);$.panQuery.add($.spebooth_amt);$.panQuery.add($.lblad_media);$.panQuery.add($.txtad_media);$.panQuery.add($.txtad_detail);$.panQuery.add($.lblad_navi);$.panQuery.add($.cmbadType1);$.panQuery.add($.cmbadType2);$.panQuery.add($.cmbadType3);$.panQuery.add($.lblnumad_amt);$.panQuery.add($.spenumad_amt);$.panQuery.add($.lblad_purpose);$.panQuery.add($.memad_purpose);$.panQuery.add($.lblPay_date);$.panQuery.add($.dtePay_date);$.panQuery.add($.chkDateModified);$.panQuery.add($.chkCanceled);$.panQuery.add($.lblcp_total_amt);$.panQuery.add($.specp_total_amt);$.panQuery.add($.lblad_detail);$.panQuery.add($.chkFileAttach);$.panQuery.add($.txtcp_id);$.panQuery.add($.txtcp_code);$.panQuery.add($.txtbefore_cp_id);$.panQuery.add($.lblTx1);$.panQuery.add($.lblTx2);$.panQuery.add($.lblTx3);$.panQuery.add($.lblTx4);$.panQuery.add($.txtnumcp_days);$.panQuery.add($.txtad_host_biznum);$.panQuery.add($.txtad_host_cardcode);$.panQuery.add($.btead_host);$.panQuery.add($.cbocp_emp_pm);$.panQuery.add($.lblcp_emp_pm);$.panFile.add($.grdFile);$.panFile.add($.btnPicReject);$.panFile.add($.btnPicEdit);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnDateModified);$.panBottom.add($.btnDPADCancel);$.panBottom.add($.btnMemoSave);relocateChildIndexInPanel([$.panQuery]);var ds=bizComponentData2($,"Q1","L_CRM0225|L_CRM0225|L_CRM0225|L_CRM0052|L_CRM0111|L_CRM192");$.cmbcp_emp_id.setColumn("employee_id","emp_name");$.cbocp_emp_pm.setColumn("employee_id","emp_name");setComboBind([$.cmbadType1,$.cmbadType2,$.cmbadType3,$.cmbcp_emp_id,$.cmbStatus,$.cbocp_emp_pm],ds);var subQuery=" AND extra_field1 LIKE '%CP23%'";var ds1=bizComponentData2($,"Q4","L_CRM0110",subQuery);$.grdFile.setColumnDropDownList("file_type",ds1.resultList[0],null,true);if($.p_argument){$.cmbStatus.setValue($.p_argument[0][0].cp_status);$.memcp_descr.setValue($.p_argument[0][0].cp_descr);$.bAllReport=$.p_argument[0][0].AllReport;$.bMyReport=$.p_argument[0][0].MyReport;$.bConfirm=$.p_argument[0][0].Confirm;if(!$.bConfirm){$.panBottom.setVisible(false);$.memcp_descr.setReadOnly(true)}else{$.panBottom.setVisible(true);$.btnPicReject.setVisible(true);$.memcp_descr.setReadOnly(false)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false);$.panQuery.disableButton(["btnSave","btnDelete"])}if($.chkFileAttach.getValue()=="N"){$.grdFile.setEditable(true);$.panFile.enableButton(["btnAdd","btnDelete"]);$.btnPicEdit.setVisible(true)}$.dteapp_date.setEnable(false);$.rbotype.setValue($.p_argument[0][0].dpad_type);radioCheck();$.txtcp_doc_no.setValue($.p_argument[0][0].cp_doc_no);$.cmbcp_emp_id.setValue($.p_argument[0][0].cp_emp_id);$.cbocp_emp_pm.setValue($.p_argument[0][0].cp_emp_pm);$.cmbStatus.setValue($.p_argument[0][0].cp_status);$.btead_host.setValue($.p_argument[0][0].ad_host_cardcode);$.btead_host.setText($.p_argument[0][0].ad_host);$.txtad_host_biznum.setValue($.p_argument[0][0].ad_host_biznum);$.txtad_host_cardcode.setValue($.p_argument[0][0].ad_host_cardcode);$.txtproduct.setValue($.p_argument[0][0].product);$.dteapp_date.setValue($.p_argument[0][0].app_date);$.dteymdcp_start_date.setValue($.p_argument[0][0].cp_start_date);$.dteymdcp_end_date.setValue($.p_argument[0][0].cp_end_date);$.txtnumcp_days.setValue($.p_argument[0][0].cp_days);$.txtevent_title.setValue($.p_argument[0][0].event_title);$.spebooth_cnt.setValue($.p_argument[0][0].booth_cnt);$.spebooth_amt.setValue($.p_argument[0][0].booth_amt);$.txtad_media.setValue($.p_argument[0][0].ad_media);$.txtad_detail.setValue($.p_argument[0][0].ad_detail);$.cmbadType1.setValue($.p_argument[0][0].ad_type1);$.cmbadType2.setValue($.p_argument[0][0].ad_type2);$.cmbadType3.setValue($.p_argument[0][0].ad_type3);$.spenumad_amt.setValue($.p_argument[0][0].ad_amt);$.memad_purpose.setValue($.p_argument[0][0].ad_purpose);$.dtePay_date.setValue($.p_argument[0][0].expect_pay_date);$.specp_total_amt.setValue($.p_argument[0][0].cp_total_amt);$.txtcp_id.setValue($.p_argument[0][0].cp_id);$.txtcp_code.setValue($.p_argument[0][0].cp_code);$.txtbefore_cp_id.setValue($.p_argument[0][0].cp_id);$.chkFileAttach.setValue($.p_argument[0][0].pic_attach_yn=="Y"?"N":"Y");$.chkDateModified.setValue($.p_argument[0][0].date_modify_yn);$.chkCanceled.setValue($.p_argument[0][0].cancel_yn);searchCPDPADBefore("Q");if($.cmbStatus.getValue()=="10"){$.btnConfirm.setEnable(true);if(!$.bSave){$.panQuery.disableButton(["btnDelete"])}}else{if($.cmbStatus.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true)}}if(g_main.session.obj.SystemDeveloper=="Y"||g_main.session.obj.DeptCode==g_main.session.obj.CPDeptCode){$.chkDateModified.setVisible(true);$.chkCanceled.setVisible(true)}}else{newClick();$.panBottom.setVisible(false);$.memcp_descr.setVisible(false)}};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdFile],ds.resultList[1],true);$.grdFile.selectRow(0)}else{if(type=="DATE"||type=="CANCEL"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(type=="DATE"){MessageBoxShow("정상적으로 개최일자변경이 완료되었습니다.")}else{if(type=="CANCEL"){MessageBoxShow("정상적으로 개체취소 되었습니다.")}}}}}else{if(type=="CPDPADA"){if(ds){if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){MessageBoxShow(ds.errorCode+"</br>"+ds.errorMsg)}else{if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txtcp_id.setValue(id[0]);$.txtcp_doc_no.setValue(id[1])}}MessageBoxShow("정상적으로 저장되었습니다.");$.dteapp_date.setEnable(false)}else{if(ds.errorCode=="MSG0004"){MessageBoxShow("정상적으로 수정되었습니다.");if($.workType=="U"){$.dteapp_date.setEnable(false)}}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제되었습니다.");newClick();if($.p_argument){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}else{if(ds.errorCode=="MSG0030"){MessageBoxShow("수정된 레코드가 없습니다.")}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPicEdit"){saveCPDPADAfter("Pic")}else{if(id=="btnPicReject"){saveCPDPADAfter("Reject")}else{if(id=="btnDateModified"){confirmBoxShow("개최일자변경 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveCPExtraFunction("DATE")}})}else{if(id=="btnDPADCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){saveCPExtraFunction("CANCEL")}})}else{if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){log("123");$.popUpCallId=id;if(id=="btead_host"){var param={};g_main.openPopup("popAccountCompany.html","popAccountCompany","회계거래처 리스트",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteymdcp_start_date"||id=="dteymdcp_end_date"){if($.dteymdcp_start_date.getValue()==null){return}else{if($.dteymdcp_end_date.getValue()==null){$.dteymdcp_end_date.setValue($.dteymdcp_start_date.getValue())}}if($.dteymdcp_start_date.getValue()>$.dteymdcp_end_date.getValue()){MessageBoxShow("전시/광고 기간 종료일이 시작일 보다 빠를수 없습니다.");$.dteymdcp_end_date.setValue($.dteymdcp_start_date.getValue());$.txtnumcp_days.setValue("1");return}var endDay=$.dteymdcp_end_date.getValue();var tsDays=getCalcDate(endDay,1);var diff=tsDays-$.dteymdcp_start_date.getValue();var stDate=new Date($.dteymdcp_start_date.getValue().substr(0,4),($.dteymdcp_start_date.getValue().substr(4,2)-1),$.dteymdcp_start_date.getValue().substr(6,2));var endDate=new Date(tsDays.substr(0,4),(tsDays.substr(4,2)-1),tsDays.substr(6,2));var btMs=endDate.getTime()-stDate.getTime();var btDay=btMs/(1000*60*60*24);$.txtnumcp_days.setValue(btDay)}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="spebooth_cnt"||id=="spebooth_amt"||id=="spenumad_amt"){fnSumAmt()}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panQuery"){if(btnId=="btnSave"){saveClick()}else{if(btnId=="btnDelete"){deleteClick()}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){fileList[i].file_type="";fileList[i].seq=seq+i;for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);$.grdFile.selectRow(0)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popAccountCompany"){if($.popUpCallId=="btead_host"){$.btead_host.setValue(popResult.card_code);$.btead_host.setText(popResult.card_name);$.txtad_host_biznum.setText(popResult.VATRegNum);$.txtad_host_cardcode.setText(popResult.card_code)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){if(id=="rbotype"){radioCheck()}};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>