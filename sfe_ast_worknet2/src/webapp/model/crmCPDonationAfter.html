<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.panFile=null;$.panBottom=null;$.grdFile=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.memcp_descr=null;$.lbl_cp_doc_no=null;$.txt_cp_doc_no=null;$.lbl_emp_nm=null;$.cmb_emp_nm=null;$.lbl_emp_pm=null;$.cmb_emp_pm=null;$.lbl_cp_re_no=null;$.txt_cp_re_no=null;$.lbl_app_date=null;$.dte_app_date=null;$.lbl_app=null;$.cmb_app=null;$.lbl_cp_don_title=null;$.txt_cp_don_title=null;$.lbl_cp_don_org=null;$.txt_cp_don_org=null;$.lbl_cp_don_emp=null;$.txt_cp_don_emp=null;$.lbl_cp_don_tel=null;$.txt_cp_don_tel=null;$.lbl_cp_don_email=null;$.txt_cp_don_email=null;$.lbl_numcp_vote_amt=null;$.txt_numcp_vote_amt=null;$.lbl_day=null;$.dteStart=null;$.dteEnd=null;$.lblWave=null;$.lbl_numcp_don_amt=null;$.txt_numcp_don_amt=null;$.lbl_limit_date=null;$.dte_limit_date=null;$.lbl_cp_don_date=null;$.dte_cp_don_date=null;$.lbl_target=null;$.mem_target=null;$.lbl_reason=null;$.mem_reason=null;$.chk_c=null;$.lbl_doc_no=null;$.txt_doc_no=null;$.lbl_chk=null;$.txt_cp_id=null;$.btnReSave=null;$.btnOpenCancel=null;$.chkRe=null;$.txt_before_cp_id=null;$.txt_before_cp_code=null;$.btnViewBfCP=null;$.cp_code="";function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.cp_code]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.txt_before_cp_id.getValue()])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.txt_before_cp_id.getValue(),"#UserID#"])}return json}function saveList(workType){if(workType=="N"||workType=="U"){if(!validateControls([$.txt_cp_re_no,$.cmb_emp_nm,$.dte_app_date,$.txt_cp_don_title,$.txt_cp_don_org,$.txt_cp_don_emp,$.txt_cp_don_tel,$.txt_cp_don_email,$.txt_numcp_vote_amt,$.dteStart,$.dteEnd,$.txt_numcp_don_amt,$.dte_limit_date,$.dte_cp_don_date,$.mem_target,$.mem_reason,$.txt_doc_no])){return false}if($.grdFile.getRowCount()==""){MessageBoxShow("규약심의(캡쳐화면),제약협회 기부대상 선정결과 통지서, 입금확인증은 필수 첨부파일 입니다.");return}else{var check1="";var check2="";var check3="";for(var i=0;i<=$.grdFile.getRowCount();i++){if($.grdFile.getValue(i,"file_type")=="020"){check1="020"}if($.grdFile.getValue(i,"file_type")=="003"){check2="003"}if($.grdFile.getValue(i,"file_type")=="055"){check3="055"}if(check1=="020"&&check2=="003"&&check3=="055"){break}}if(check1!="020"||check2!="003"||check3!="055"){MessageBoxShow("규약심의(캡쳐화면),제약협회 기부대상 선정결과 통지서, 입금확인증은 필수 첨부파일 입니다.");return}}var dt1=getToday();var dt2=$.dte_cp_don_date.getValue();var dt3=getCompareDate(dt1,dt2);if(dt3>27){MessageBoxShow("기부일로부터 27일 이내에만 신청가능합니다.");return}}var strfileYn="N";var strfile_type="";var strseq="";var strserver_path="";var strserver_fname="";var strlocal_fname="";if($.grdFile.getSelectedRowIdx()!=-1){for(var i=0;i<$.grdFile.getRowCount();i++){if(i>0){strseq+="|";strfile_type+="|";strserver_path+="|";strserver_fname+="|";strlocal_fname+="|"}strseq+=$.grdFile.getValue(i,"seq");strfile_type+=$.grdFile.getValue(i,"file_type");strserver_path+=$.grdFile.getValue(i,"server_path");strserver_fname+=$.grdFile.getValue(i,"server_fname");strlocal_fname+=$.grdFile.getValue(i,"local_fname")}strfileYn="Y"}var json=createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname);var ds=callExecute(["req",json],workType,$,false)}function createJSON_S(workType,strfileYn,strfile_type,strseq,strserver_path,strserver_fname,strlocal_fname){var json=createExecuteParamInfo("P_crmCPDonationAfter_S",[workType,$.txt_cp_id.getValue()||"",$.txt_cp_doc_no.getValue()||"",$.cmb_emp_nm.getValue(),g_main.session.obj.DeptCode,$.cmb_emp_pm.getValue(),$.txt_cp_re_no.getValue(),$.txt_cp_don_title.getValue(),$.txt_doc_no.getValue(),$.chk_c.getValue(),$.txt_cp_don_org.getValue(),$.txt_cp_don_emp.getValue(),$.txt_cp_don_tel.getValue(),$.txt_cp_don_email.getValue(),Number($.txt_numcp_vote_amt.getValue()),$.dteStart.getValue(),$.dteEnd.getValue(),Number($.txt_numcp_don_amt.getValue()),$.dte_limit_date.getValue(),$.dte_cp_don_date.getValue(),$.mem_target.getValue(),$.mem_reason.getValue(),$.dte_app_date.getValue(),"CP10","",g_main.session.obj.EmpCode,$.txt_before_cp_id.getValue()||"",$.txt_before_cp_code.getValue()||"",strfileYn,strseq,strserver_path,strserver_fname,strlocal_fname,strfile_type]);return json}function assign(workType){var json=createJson_S1(workType);callQuery(["req",json],workType,$)}function createJson_S1(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.txt_cp_id.getValue(),$.chkRe.getValue(),g_main.session.obj.EmpCode]);return json}function deleteClick(){if($.txt_cp_doc_no.getValue()==""){MessageBoxShow("사전 데이터가 없습니다.");return}confirmBoxShow("["+$.txt_cp_doc_no.getValue()+"] 기부집행내역(사후)정보를 삭제 하시겠습니까?",function(){if(g_main.msgShare==true){saveList("D")}})}function newClick(){$.panList.clear();$.grdFile.clear();$.panList.enableButton(["btnSave","btnDelete"]);$.panFile.enableButton(["btnAdd","btnDelete"]);$.panBottom.setVisible(false);fnEnableSet(true);$.cmb_emp_nm.setValue(g_main.session.obj.EmpCode);$.cmb_app.setValue("10");$.dte_app_date.setValue(getToday(""));$.dte_app_date.setReadOnly(false)}function fnEnableSet(bo){$.grdFile.setEditable(bo);$.txt_cp_don_title.setReadOnly(!bo);$.txt_cp_don_email.setReadOnly(!bo);$.txt_doc_no.setReadOnly(!bo);$.txt_numcp_vote_amt.setReadOnly(!bo);$.dte_limit_date.setReadOnly(!bo);$.txt_cp_re_no.setReadOnly(!bo);$.txt_cp_don_org.setReadOnly(!bo);$.txt_numcp_don_amt.setReadOnly(!bo);$.dte_cp_don_date.setReadOnly(!bo);$.txt_cp_don_emp.setReadOnly(!bo);$.txt_cp_don_tel.setReadOnly(!bo);$.mem_target.setReadOnly(!bo);$.mem_reason.setReadOnly(!bo);$.cmb_emp_pm.setReadOnly(!bo);$.dte_app_date.setReadOnly(!bo);$.dteStart.setReadOnly(!bo);$.dteEnd.setReadOnly(!bo)}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,1200,425);$.panList.setText("기부집행내역-사후");$.panList.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,435,1200,210);$.panFile.setText("첨부파일");$.panFile.setBottomLine(false);$.panBottom=new FingerPanel(host,"panBottom",0,660,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,165);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",1005,5,90,95);$.btnMemoSave.setText("메모저장");$.memcp_descr=new FingerMemoEdit(host,"memcp_descr",135,665,855,90);$.lbl_cp_doc_no=new FingerLabel(host,"lbl_cp_doc_no",5,15,100,20);$.lbl_cp_doc_no.setText("문서번호");$.txt_cp_doc_no=new FingerEdit(host,"txt_cp_doc_no",0,0,140,20);$.lbl_emp_nm=new FingerLabel(host,"lbl_emp_nm",395,15,100,20);$.lbl_emp_nm.setText("담당자");$.cmb_emp_nm=new FingerComboBox(host,"cmb_emp_nm",500,15,140,20);$.lbl_emp_pm=new FingerLabel(host,"lbl_emp_pm",790,15,100,20);$.lbl_emp_pm.setText("PM");$.cmb_emp_pm=new FingerComboBox(host,"cmb_emp_pm",895,15,140,20);$.lbl_cp_re_no=new FingerLabel(host,"lbl_cp_re_no",5,45,100,20);$.lbl_cp_re_no.setText("심의번호");$.txt_cp_re_no=new FingerEdit(host,"txt_cp_re_no",110,45,140,20);$.lbl_app_date=new FingerLabel(host,"lbl_app_date",395,45,100,20);$.lbl_app_date.setText("승인요청일");$.dte_app_date=new FingerDateEdit(host,"dte_app_date",500,45,140,20);$.lbl_app=new FingerLabel(host,"lbl_app",790,45,100,20);$.lbl_app.setText("승인상태");$.cmb_app=new FingerComboBox(host,"cmb_app",895,45,140,20);$.lbl_cp_don_title=new FingerLabel(host,"lbl_cp_don_title",5,75,100,20);$.lbl_cp_don_title.setText("대상 사업명");$.txt_cp_don_title=new FingerEdit(host,"txt_cp_don_title",110,75,530,20);$.lbl_cp_don_org=new FingerLabel(host,"lbl_cp_don_org",5,105,100,20);$.lbl_cp_don_org.setText("기부대상");$.txt_cp_don_org=new FingerEdit(host,"txt_cp_don_org",110,105,140,20);$.lbl_cp_don_emp=new FingerLabel(host,"lbl_cp_don_emp",390,105,105,20);$.lbl_cp_don_emp.setText("기부대상담당자");$.txt_cp_don_emp=new FingerEdit(host,"txt_cp_don_emp",500,105,230,20);$.lbl_cp_don_tel=new FingerLabel(host,"lbl_cp_don_tel",0,135,105,20);$.lbl_cp_don_tel.setText("기부대상연락처");$.txt_cp_don_tel=new FingerEdit(host,"txt_cp_don_tel",110,135,140,20);$.lbl_cp_don_email=new FingerLabel(host,"lbl_cp_don_email",390,135,105,20);$.lbl_cp_don_email.setText("기부대상이메일");$.txt_cp_don_email=new FingerEdit(host,"txt_cp_don_email",500,135,230,20);$.lbl_numcp_vote_amt=new FingerLabel(host,"lbl_numcp_vote_amt",5,165,100,20);$.lbl_numcp_vote_amt.setText("의결금액");$.txt_numcp_vote_amt=new FingerSpinEdit(host,"txt_numcp_vote_amt",110,165,140,20);$.lbl_day=new FingerLabel(host,"lbl_day",395,165,100,20);$.lbl_day.setText("사업기간");$.dteStart=new FingerDateEdit(host,"dteStart",500,165,140,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",660,165,140,20);$.lblWave=new FingerLabel(host,"lblWave",640,165,20,20);$.lblWave.setText("~");$.lbl_numcp_don_amt=new FingerLabel(host,"lbl_numcp_don_amt",5,195,100,20);$.lbl_numcp_don_amt.setText("AKR 기부금액");$.txt_numcp_don_amt=new FingerSpinEdit(host,"txt_numcp_don_amt",110,195,140,20);$.lbl_limit_date=new FingerLabel(host,"lbl_limit_date",395,195,100,20);$.lbl_limit_date.setText("공고기한");$.dte_limit_date=new FingerDateEdit(host,"dte_limit_date",500,195,140,20);$.lbl_cp_don_date=new FingerLabel(host,"lbl_cp_don_date",790,195,100,20);$.lbl_cp_don_date.setText("기부일자");$.dte_cp_don_date=new FingerDateEdit(host,"dte_cp_don_date",895,195,140,20);$.lbl_target=new FingerLabel(host,"lbl_target",5,245,100,20);$.lbl_target.setText("사업내용");$.mem_target=new FingerMemoEdit(host,"mem_target",110,225,920,60);$.lbl_reason=new FingerLabel(host,"lbl_reason",5,315,100,20);$.lbl_reason.setText("기부목적");$.mem_reason=new FingerMemoEdit(host,"mem_reason",110,295,920,60);$.chk_c=new FingerCheckBox(host,"chk_c",895,105,140,20);$.chk_c.setText("심의완료");$.lbl_doc_no=new FingerLabel(host,"lbl_doc_no",770,75,120,20);$.lbl_doc_no.setText("심의받은문서번호");$.txt_doc_no=new FingerEdit(host,"txt_doc_no",895,75,140,20);$.lbl_chk=new FingerLabel(host,"lbl_chk",790,105,100,20);$.lbl_chk.setText("KPMA심의여부");$.txt_cp_id=new FingerEdit(host,"txt_cp_id",110,15,140,20);$.btnReSave=new FingerButton(host,"btnReSave",1090,5,120,20);$.btnReSave.setText("신고상태저장");$.btnOpenCancel=new FingerButton(host,"btnOpenCancel",1090,75,120,20);$.btnOpenCancel.setText("개최취소");$.chkRe=new FingerCheckBox(host,"chkRe",1090,40,120,20);$.chkRe.setText("협회신고");$.txt_before_cp_id=new FingerEdit(host,"txt_before_cp_id",0,0,140,20);$.txt_before_cp_code=new FingerEdit(host,"txt_before_cp_code",0,0,140,20);$.btnViewBfCP=new FingerButton(host,"btnViewBfCP",1045,15,120,30);$.btnViewBfCP.setText("사전CP보기");$.panBottom.setBorder(true);$.panList.addButtons(["btnLoad","btnDelete","btnSave","btnNew"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.txt_cp_doc_no.setVisible(false);$.txt_before_cp_id.setVisible(false);$.txt_before_cp_code.setVisible(false);$.txt_cp_id.setReadOnly(true);$.cmb_emp_nm.setEnable(false);$.cmb_app.setEnable(false);$.cmb_emp_pm.setEmptyRow(true);$.cmb_app.setEmptyRow(true);$.cmb_emp_nm.setAllowBlank(false,"담당자");$.txt_cp_re_no.setAllowBlank(false,"심의번호");$.dte_app_date.setAllowBlank(false,"승인요청일");$.txt_cp_don_title.setAllowBlank(false,"대상사업명");$.txt_cp_don_org.setAllowBlank(false,"기부대상");$.txt_cp_don_emp.setAllowBlank(false,"기부대상담당자");$.txt_cp_don_tel.setAllowBlank(false,"기부대상연락처");$.txt_cp_don_email.setAllowBlank(false,"기부대상이메일");$.txt_numcp_vote_amt.setAllowBlank(false,"의결금액");$.dteStart.setAllowBlank(false,"사업시작일");$.dteEnd.setAllowBlank(false,"사업종료일");$.txt_numcp_don_amt.setAllowBlank(false,"AKR기부금액");$.dte_limit_date.setAllowBlank(false,"공고기한");$.dte_cp_don_date.setAllowBlank(false,"기부희망일");$.mem_target.setAllowBlank(false,"사업내용");$.mem_reason.setAllowBlank(false,"기부목적");$.txt_doc_no.setAllowBlank(false,"심의받은문서번호");$.grdFile.setColumns([new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",400,"left","string","자료유형"),new FingerDataGridColumn("local_fname",800,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({isFilter:false});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.memcp_descr);$.panList.add($.lbl_cp_doc_no);$.panList.add($.txt_cp_doc_no);$.panList.add($.lbl_emp_nm);$.panList.add($.cmb_emp_nm);$.panList.add($.lbl_emp_pm);$.panList.add($.cmb_emp_pm);$.panList.add($.lbl_cp_re_no);$.panList.add($.txt_cp_re_no);$.panList.add($.lbl_app_date);$.panList.add($.dte_app_date);$.panList.add($.lbl_app);$.panList.add($.cmb_app);$.panList.add($.lbl_cp_don_title);$.panList.add($.txt_cp_don_title);$.panList.add($.lbl_cp_don_org);$.panList.add($.txt_cp_don_org);$.panList.add($.lbl_cp_don_emp);$.panList.add($.txt_cp_don_emp);$.panList.add($.lbl_cp_don_tel);$.panList.add($.txt_cp_don_tel);$.panList.add($.lbl_cp_don_email);$.panList.add($.txt_cp_don_email);$.panList.add($.lbl_numcp_vote_amt);$.panList.add($.txt_numcp_vote_amt);$.panList.add($.lbl_day);$.panList.add($.dteStart);$.panList.add($.dteEnd);$.panList.add($.lblWave);$.panList.add($.lbl_numcp_don_amt);$.panList.add($.txt_numcp_don_amt);$.panList.add($.lbl_limit_date);$.panList.add($.dte_limit_date);$.panList.add($.lbl_cp_don_date);$.panList.add($.dte_cp_don_date);$.panList.add($.lbl_target);$.panList.add($.mem_target);$.panList.add($.lbl_reason);$.panList.add($.mem_reason);$.panList.add($.chk_c);$.panList.add($.lbl_doc_no);$.panList.add($.txt_doc_no);$.panList.add($.lbl_chk);$.panList.add($.txt_cp_id);$.panList.add($.txt_before_cp_id);$.panList.add($.txt_before_cp_code);$.panList.add($.btnViewBfCP);$.panFile.add($.grdFile);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnReSave);$.panBottom.add($.btnOpenCancel);$.panBottom.add($.chkRe);var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0111|L_CRM192");$.cmb_emp_nm.setColumn("employee_id","emp_name");$.cmb_app.setColumn("sub_code","code_name");$.cmb_emp_pm.setColumn("employee_id","emp_name");setComboBind([$.cmb_emp_nm,$.cmb_app,$.cmb_emp_pm],ds);$.cmb_emp_nm.setValue(g_main.session.obj.EmpCode);var subQuery=" AND extra_field1 LIKE '%CP10%' OR extra_field1 like '%{0}%'";var ds1=bizComponentData2($,"Q4","L_CRM0110",subQuery);$.grdFile.setColumnDropDownList("file_type",ds1.resultList[0],null,true);if($.p_argument){$.cmb_app.setValue($.p_argument[0][0].cp_status);$.memcp_descr.setValue($.p_argument[0][0].cp_descr);$.bConfirm=$.p_argument[0][0].Confirm;$.chkRe.setValue("Y");if(!$.bConfirm){$.panBottom.setVisible(false);$.memcp_descr.setReadOnly(true)}else{$.panBottom.setVisible(true);$.memcp_descr.setReadOnly(false)}if($.p_argument[0][0].save_yn=="Y"){$.bSave=true}if(!$.bSave){fnEnableSet(false);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}$.txt_cp_id.setValue($.p_argument[0][0].cp_id);$.txt_cp_doc_no.setValue($.p_argument[0][0].cp_doc_no);$.cmb_emp_nm.setValue($.p_argument[0][0].cp_emp_id);$.cmb_emp_pm.setValue($.p_argument[0][0].cp_emp_pm);$.txt_cp_don_org.setValue($.p_argument[0][0].cp_don_org);$.txt_cp_don_title.setValue($.p_argument[0][0].cp_don_title);$.dte_cp_don_date.setValue($.p_argument[0][0].cp_don_date);$.txt_cp_don_emp.setValue($.p_argument[0][0].cp_don_emp);$.txt_cp_don_tel.setValue($.p_argument[0][0].cp_don_tel);$.txt_cp_don_email.setValue($.p_argument[0][0].cp_don_email);$.dteStart.setValue($.p_argument[0][0].cp_start_date);$.dteEnd.setValue($.p_argument[0][0].cp_end_date);$.txt_numcp_vote_amt.setValue($.p_argument[0][0].cp_vote_amt);$.txt_numcp_don_amt.setValue($.p_argument[0][0].cp_don_amt);$.mem_target.setValue($.p_argument[0][0].cp_don_target);$.mem_reason.setValue($.p_argument[0][0].cp_don_reason);$.txt_cp_re_no.setValue($.p_argument[0][0].cp_review_no);$.dte_limit_date.setValue($.p_argument[0][0].limit_date);$.dte_app_date.setValue($.p_argument[0][0].app_date);$.txt_before_cp_id.setValue($.p_argument[0][0].before_cp_id);$.txt_doc_no.setValue($.p_argument[0][0].cp_review_doc_no);$.chk_c.setValue($.p_argument[0][0].report_yn);if($.p_argument[1].length>0){setDataGrid([$.grdFile],$.p_argument[1],true)}if($.cmb_app.getValue()=="10"){$.btnConfirm.setEnable(true);if(!$.bSave){$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"]);$.btnCancel.setEnable(false)}}else{if($.cmb_app.getValue()=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panList.disableButton(["btnSave","btnDelete"]);$.panFile.disableButton(["btnAdd","btnDelete"])}}}else{newClick();$.panBottom.setVisible(false);$.memcp_descr.setVisible(false)}};$.callback=function(type,ds){if(type=="N"||type=="U"||type=="D"){var bResult=false;var workType=type;if(ds!=null){if(workType=="N"){if(ds.errorCode=="MSG0002"){if(ds.returnStr!=""){var id=ds.returnStr.split("|");if(id.length>1){$.txt_cp_id.setValue(id[0]);$.txt_cp_doc_no.setValue(id[1])}}}}if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"){bResult=true}else{if(ds.errorCode=="MSG0003"){MessageBoxShow("정상적으로 삭제가 되었습니다.");newClick();if($.p_argument){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}}else{if(ds.errorCode=="P_crmCPMaster_S_001"){MessageBoxShow("승인요청일 상태만 수정,삭제가 가능합니다.")}else{MessageBoxShow(ds.errorCode)}}}}return bResult}else{if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="BUCall";param[0][0].Confirm=false;param[0][0].cp_descr=param.cp_desc;param[0][0].cp_status="90";param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memcp_descr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnReSave"){assign("REPORT")}else{if(id=="btnOpenCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){assign("CANCEL");g_popupStack.close()}else{return}})}else{if(id=="btnViewBfCP"){if($.txt_before_cp_id.getValue()!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.txt_before_cp_id.getValue()+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";$.cp_code=ds.resultList[0][0].cp_type;searchCPInfo("FORM")}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnLoad"){$.popUpCallId=btnId;var param={cp_type:"CP09"};g_main.openPopup("popCPDonationBf.html","popCPDonationBf","심의문서 정보",900,640,"","",param,"","")}else{if(btnId=="btnDelete"){deleteClick()}else{if(btnId=="btnSave"){if($.txt_before_cp_id.getValue()==""){MessageBoxShow("사전 데이터가 없습니다.");return}var workType=$.txt_cp_id.getValue()==""?"N":"U";if(saveList(workType)){$.dte_app_date.setReadOnly(true)}}else{if(btnId=="btnNew"){newClick()}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList);for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});confirmBoxShow("정말 삭제하시겠습니까? 삭제하시려면 예를 클릭하세요",function(){if(g_main.msgShare==true){if(result){MessageBoxShow("파일 삭제 되었습니다.");$.grdFile.deleteRow(rId);if($.grdFile.getRowCount()>0){for(var i=0;i<$.grdFile.getRowCount();i++){$.grdFile.setValue(i,"seq",i+1)}}}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}})}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPDonationBf"){if($.popUpCallId=="btnLoad"){$.cmb_emp_nm.setValue(popResult[0][0].cp_emp_id);$.cmb_emp_pm.setValue(popResult[0][0].cp_emp_pm);$.txt_cp_re_no.setValue(popResult[0][0].cp_review_no);$.dte_app_date.setValue(popResult[0][0].app_date);$.txt_cp_don_title.setValue(popResult[0][0].cp_don_title);$.txt_cp_don_org.setValue(popResult[0][0].cp_don_org);$.txt_cp_don_emp.setValue(popResult[0][0].cp_don_emp);$.txt_cp_don_tel.setValue(popResult[0][0].cp_don_tel);$.txt_cp_don_email.setValue(popResult[0][0].cp_don_email);$.txt_numcp_vote_amt.setValue(popResult[0][0].cp_vote_amt);$.dteStart.setValue(popResult[0][0].cp_start_date);$.dteEnd.setValue(popResult[0][0].cp_end_date);$.txt_numcp_don_amt.setValue(popResult[0][0].cp_don_amt);$.dte_limit_date.setValue(popResult[0][0].limit_date);$.dte_cp_don_date.setValue(popResult[0][0].cp_don_date);$.mem_target.setValue(popResult[0][0].cp_don_target);$.mem_reason.setValue(popResult[0][0].cp_don_reason);$.txt_before_cp_id.setValue(popResult[0][0].before_cp_id);$.txt_before_cp_code.setValue(popResult[0][0].before_cp_code);setDataGrid([$.grdFile],popResult[1],true)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>