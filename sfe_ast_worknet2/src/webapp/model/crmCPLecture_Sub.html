<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panList=null;$.grdList=null;$.panInfo=null;$.panBottom=null;$.panReport=null;$.lbl_contact_name=null;$.bte_contact_name=null;$.lbl_company_name=null;$.txt_company_name=null;$.txt_company_id=null;$.lbl_cp_lect_amt=null;$.spe_cp_lect_amt=null;$.txt_contact_id=null;$.panReport1=null;$.panReport2=null;$.lbl_cp_lect_subject1=null;$.txt_cp_lect_subject1=null;$.lbl_cp_lect_date=null;$.dte_cp_lect_date=null;$.lbl_employee_id=null;$.cmb_employee_id=null;$.lbl_lect_time=null;$.cmb_cp_HH_fr=null;$.cmb_cp_MM_fr=null;$.cmb_cp_HH_to=null;$.cmb_cp_MM_to=null;$.txt_cp_HH2=null;$.lbl_cp_HH2=null;$.txt_cp_MM2=null;$.lbl_cp_MM2=null;$.lbl_agenda=null;$.mem_agenda=null;$.lbl_cp_desc=null;$.mem_cp_desc=null;$.lbl_cp_desc2=null;$.mem_cp_desc2=null;$.lbl_Txt1=null;$.lbl_Txt2=null;$.lbl_Txt3=null;$.lbl_cp_lect_subject2=null;$.txt_cp_lect_subject2=null;$.lbl_cp_choice_desc=null;$.mem_cp_choice_desc=null;$.lbl_contact_cnt=null;$.spe_contact_cnt=null;$.lbl_trans_amt=null;$.spe_trans_amt=null;$.lbl_stay_amt=null;$.spe_stay_amt=null;$.lbl_meal_amt=null;$.spe_meal_amt=null;$.lbl_lect_bank_account=null;$.txt_lect_bank_account=null;$.btnConfirm=null;$.btnCancel=null;$.panReport3=null;$.panBefore=null;$.chk_trans_yn=null;$.chk_stay_yn=null;$.chk_meal_yn=null;$.pic_cp_picture1=null;$.pic_cp_picture2=null;$.pic_cp_picture3=null;$.lbl_contact_cnt2=null;$.spe_contact_cnt2=null;$.strLect_Type="";$.strCP_Code="";$.lect_date="";$.bChange=false;$.bNew=false;function newClick(){$.bNew=true;$.panInfo.clear();$.panReport.clear();$.panReport1.clear();$.panReport2.clear();$.panReport3.clear();addTableRow();$.bte_contact_name.setFocus();$.bNew=false}function fnEnableSet(bo){if(bo){$.panInfo.enableButton(["btnDelete","btnSave","btnNew"]);$.pic_cp_picture1.setMode("N");$.pic_cp_picture2.setMode("N");$.pic_cp_picture3.setMode("N")}else{$.panInfo.disableButton(["btnDelete","btnSave","btnNew"]);$.pic_cp_picture1.setMode("R");$.pic_cp_picture2.setMode("R");$.pic_cp_picture3.setMode("R")}$.btnConfirm.setEnable(bo);$.bte_contact_name.setEnable(bo);$.spe_cp_lect_amt.setEnable(bo);$.dte_cp_lect_date.setEnable(bo);$.txt_cp_lect_subject1.setReadOnly(!bo);$.cmb_cp_HH_fr.setEnable(bo);$.cmb_cp_MM_fr.setEnable(bo);$.cmb_cp_HH_to.setEnable(bo);$.cmb_cp_MM_to.setEnable(bo);$.txt_cp_HH2.setReadOnly(!bo);$.txt_cp_MM2.setReadOnly(!bo);$.mem_agenda.setReadOnly(!bo);$.mem_cp_desc.setReadOnly(!bo);$.mem_cp_desc2.setReadOnly(!bo);$.txt_cp_lect_subject2.setReadOnly(!bo);$.mem_cp_choice_desc.setReadOnly(!bo);$.spe_contact_cnt.setEnable(bo);$.spe_contact_cnt2.setEnable(bo);$.chk_trans_yn.setEnable(bo);$.chk_stay_yn.setEnable(bo);$.chk_meal_yn.setEnable(bo);$.spe_trans_amt.setEnable(bo);$.spe_stay_amt.setEnable(bo);$.spe_meal_amt.setEnable(bo);$.txt_lect_bank_account.setReadOnly(!bo)}function calcLectTime(){var hour_fr=$.cmb_cp_HH_fr.getText();var minute_fr=$.cmb_cp_MM_fr.getText();var hour_to=$.cmb_cp_HH_to.getText();var minute_to=$.cmb_cp_MM_to.getText();if(parseInt(minute_to)>=parseInt(minute_fr)){$.txt_cp_HH2.setValue(parseInt(hour_to)-parseInt(hour_fr));$.txt_cp_MM2.setValue(parseInt(minute_to)-parseInt(minute_fr))}else{if(parseInt(minute_fr)>parseInt(minute_to)){$.txt_cp_HH2.setValue(parseInt(hour_to)-(parseInt(hour_fr)+1));$.txt_cp_MM2.setValue((parseInt(minute_to)+60)-parseInt(minute_fr))}}}function fnExistCheck(fieldname,contact_id){var strEXISTyn="N";if($.grdList.getRowCount()<=1){}else{for(var i=0;i<$.grdList.getRowCount();i++){if(contact_id==""){break}if(contact_id==$.grdList.getValue(i,fieldname)){strEXISTyn="Y";break}}}if(strEXISTyn=="Y"){return false}else{return true}}function addTableRow(){$.grdList.addRow({contact_name:"",company_name:"",cp_lect_date:"",time:"",cp_lect_subject2:"",cp_lect_amt:0,contact_id:"",company_id:"",cp_emp_id:"",cp_lect_subject1:"",cp_HH_fr:"",cp_MM_fr:"",cp_HH_to:"",cp_MM_to:"",cp_HH:"",cp_MM:"",agenda:"",cp_desc:"",cp_desc2:"",cp_choice_desc:"",contact_cnt:"",contact_cnt2:"",trans_yn:"N",stay_yn:"N",meal_yn:"N",trans_amt:0,stay_amt:0,meal_amt:0,lect_bank_account:"",cp_picture1:"",cp_picture2:"",cp_picture3:""},$.grdList.getRowCount())}function saveLecturer(){if(!validateControls([$.bte_contact_name,$.txt_company_name])){return false}if(!validateControls([$.txt_cp_lect_subject1,$.dte_cp_lect_date,$.cmb_cp_HH_fr,$.cmb_cp_MM_fr,$.cmb_cp_HH_to,$.cmb_cp_MM_to,$.txt_cp_HH2,$.txt_cp_MM2,$.mem_agenda,$.mem_cp_desc,$.mem_cp_desc2])){return false}if(!validateControls([$.txt_cp_lect_subject2,$.mem_cp_choice_desc,$.spe_contact_cnt])){return false}if($.strLect_Type!="50"){if(!spinEditValidation([$.spe_trans_amt,$.spe_stay_amt,$.spe_meal_amt])){return false}}if(Number($.cmb_cp_HH_fr.getText())>Number($.cmb_cp_HH_to.getText())){MessageBoxShow("시작 시간은 종료 시간보다 빨라야합니다.");$.cmb_cp_HH_to.setValue("23")}else{if($.cmb_cp_HH_fr.getValue()==$.cmb_cp_HH_to.getValue()&&Number($.cmb_cp_MM_fr.getText())>=Number($.cmb_cp_MM_to.getText())){MessageBoxShow("시작 시간은 종료 시간보다 빨라야합니다.");$.cmb_cp_HH_to.setValue("23");$.cmb_cp_MM_to.setValue("50")}}var rId=$.grdList.getSelectedRowIdx();if($.grdList.getRowStatus(rId)=="N"){if(!fnExistCheck("contact_id",$.txt_contact_id.getValue())){MessageBoxShow("중복된 자문자가 있습니다.");return false}}$.grdList.setValue(rId,"contact_id",$.txt_contact_id.getValue());$.grdList.setValue(rId,"contact_name",$.bte_contact_name.getText());$.grdList.setValue(rId,"company_id",$.txt_company_id.getValue());$.grdList.setValue(rId,"company_name",$.txt_company_name.getValue());$.grdList.setValue(rId,"cp_emp_id",g_main.session.obj.EmpCode);$.grdList.setValue(rId,"cp_lect_date",extFormat($.dte_cp_lect_date.getValue(),"yyyyMMdd"));$.grdList.setValue(rId,"cp_lect_subject1",$.txt_cp_lect_subject1.getValue());$.grdList.setValue(rId,"cp_lect_amt",Number($.spe_cp_lect_amt.getValue()));$.grdList.setValue(rId,"time",$.cmb_cp_HH_fr.getValue()+" : "+$.cmb_cp_MM_fr.getValue()+" ~ "+$.cmb_cp_HH_to.getValue()+" : "+$.cmb_cp_MM_to.getValue());$.grdList.setValue(rId,"cp_HH_fr",$.cmb_cp_HH_fr.getValue());$.grdList.setValue(rId,"cp_MM_fr",$.cmb_cp_MM_fr.getValue());$.grdList.setValue(rId,"cp_HH_to",$.cmb_cp_HH_to.getValue());$.grdList.setValue(rId,"cp_MM_to",$.cmb_cp_MM_to.getValue());$.grdList.setValue(rId,"cp_HH",$.txt_cp_HH2.getValue());$.grdList.setValue(rId,"cp_MM",$.txt_cp_MM2.getValue());$.grdList.setValue(rId,"agenda",$.mem_agenda.getValue());$.grdList.setValue(rId,"cp_desc",$.mem_cp_desc.getValue());$.grdList.setValue(rId,"cp_desc2",$.mem_cp_desc2.getValue());$.grdList.setValue(rId,"cp_lect_subject2",$.txt_cp_lect_subject2.getValue());$.grdList.setValue(rId,"cp_choice_desc",$.mem_cp_choice_desc.getValue());$.grdList.setValue(rId,"contact_cnt",$.spe_contact_cnt.getValue());$.grdList.setValue(rId,"contact_cnt2",$.spe_contact_cnt2.getValue());$.grdList.setValue(rId,"trans_yn",$.chk_trans_yn.getValue());$.grdList.setValue(rId,"stay_yn",$.chk_stay_yn.getValue());$.grdList.setValue(rId,"meal_yn",$.chk_meal_yn.getValue());$.grdList.setValue(rId,"trans_amt",$.spe_trans_amt.getValue());$.grdList.setValue(rId,"stay_amt",$.spe_stay_amt.getValue());$.grdList.setValue(rId,"meal_amt",$.spe_meal_amt.getValue());$.grdList.setValue(rId,"lect_bank_account",$.txt_lect_bank_account.getValue());$.grdList.setValue(rId,"cp_picture1",$.pic_cp_picture1.getValue());$.grdList.setValue(rId,"cp_picture2",$.pic_cp_picture2.getValue());$.grdList.setValue(rId,"cp_picture3",$.pic_cp_picture3.getValue());return true}function spinEditValidation(controls){for(var i in controls){if(controls[i]!=null){if(controls[i].getAllowBlank()==false&&String(controls[i].getValue())==""){MessageBoxShow(controls[i].getFieldName()+" 은(는) 필수입력 항목 입니다.");controls[i].setFocus();return false}}}return true}function gridValidator(){if(arguments.length<2){return false}var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<=arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}function imageInit(param){}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,945);$.panMain.setText("");$.panMain.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,0,1200,235);$.panList.setText("강연자리스트");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,190);$.panInfo=new FingerPanel(host,"panInfo",0,245,1200,100);$.panInfo.setText("강연자정보");$.panInfo.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,870,1200,75);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.panReport=new FingerPanel(host,"panReport",0,360,605,495);$.panReport.setText("강연결과보고서");$.panReport.setBottomLine(true);$.lbl_contact_name=new FingerLabel(host,"lbl_contact_name",0,15,100,20);$.lbl_contact_name.setText("강연자");$.bte_contact_name=new FingerButtonEdit(host,"bte_contact_name",105,15,140,20);$.bte_contact_name.setText("");$.lbl_company_name=new FingerLabel(host,"lbl_company_name",230,15,100,20);$.lbl_company_name.setText("소속");$.txt_company_name=new FingerEdit(host,"txt_company_name",335,15,445,20);$.txt_company_id=new FingerEdit(host,"txt_company_id",1155,15,35,20);$.lbl_cp_lect_amt=new FingerLabel(host,"lbl_cp_lect_amt",785,15,100,20);$.lbl_cp_lect_amt.setText("강연료");$.spe_cp_lect_amt=new FingerSpinEdit(host,"spe_cp_lect_amt",890,15,140,20);$.txt_contact_id=new FingerEdit(host,"txt_contact_id",1110,15,40,20);$.panReport1=new FingerPanel(host,"panReport1",615,360,585,300);$.panReport1.setText("강연위촉선정사유서");$.panReport1.setBottomLine(true);$.panReport2=new FingerPanel(host,"panReport2",615,675,585,180);$.panReport2.setText("여비정보");$.panReport2.setBottomLine(true);$.lbl_cp_lect_subject1=new FingerLabel(host,"lbl_cp_lect_subject1",0,10,100,20);$.lbl_cp_lect_subject1.setText("강의제목");$.txt_cp_lect_subject1=new FingerEdit(host,"txt_cp_lect_subject1",105,10,490,20);$.lbl_cp_lect_date=new FingerLabel(host,"lbl_cp_lect_date",0,40,100,20);$.lbl_cp_lect_date.setText("강의일");$.dte_cp_lect_date=new FingerDateEdit(host,"dte_cp_lect_date",105,40,140,20);$.lbl_employee_id=new FingerLabel(host,"lbl_employee_id",235,40,100,20);$.lbl_employee_id.setText("보고자");$.cmb_employee_id=new FingerComboBox(host,"cmb_employee_id",340,40,140,20);$.lbl_lect_time=new FingerLabel(host,"lbl_lect_time",0,70,100,20);$.lbl_lect_time.setText("강의시간");$.cmb_cp_HH_fr=new FingerComboBox(host,"cmb_cp_HH_fr",105,70,55,20);$.cmb_cp_MM_fr=new FingerComboBox(host,"cmb_cp_MM_fr",180,70,55,20);$.cmb_cp_HH_to=new FingerComboBox(host,"cmb_cp_HH_to",260,70,55,20);$.cmb_cp_MM_to=new FingerComboBox(host,"cmb_cp_MM_to",335,70,55,20);$.txt_cp_HH2=new FingerEdit(host,"txt_cp_HH2",430,70,45,20);$.lbl_cp_HH2=new FingerLabel(host,"lbl_cp_HH2",475,70,40,20);$.lbl_cp_HH2.setText("시간");$.txt_cp_MM2=new FingerEdit(host,"txt_cp_MM2",525,70,45,20);$.lbl_cp_MM2=new FingerLabel(host,"lbl_cp_MM2",575,70,25,20);$.lbl_cp_MM2.setText("분");$.lbl_agenda=new FingerLabel(host,"lbl_agenda",0,115,100,20);$.lbl_agenda.setText("Agenda");$.mem_agenda=new FingerMemoEdit(host,"mem_agenda",105,100,485,50);$.lbl_cp_desc=new FingerLabel(host,"lbl_cp_desc",0,175,100,20);$.lbl_cp_desc.setText("강연내용");$.mem_cp_desc=new FingerMemoEdit(host,"mem_cp_desc",105,160,485,50);$.lbl_cp_desc2=new FingerLabel(host,"lbl_cp_desc2",0,0,100,20);$.lbl_cp_desc2.setText("QA 및 free Discussion 내용");$.mem_cp_desc2=new FingerMemoEdit(host,"mem_cp_desc2",105,0,485,50);$.lbl_Txt1=new FingerLabel(host,"lbl_Txt1",160,70,15,20);$.lbl_Txt1.setText(":");$.lbl_Txt2=new FingerLabel(host,"lbl_Txt2",235,70,20,20);$.lbl_Txt2.setText("~");$.lbl_Txt3=new FingerLabel(host,"lbl_Txt3",315,70,15,20);$.lbl_Txt3.setText(":");$.lbl_cp_lect_subject2=new FingerLabel(host,"lbl_cp_lect_subject2",0,10,100,20);$.lbl_cp_lect_subject2.setText("강연주제");$.txt_cp_lect_subject2=new FingerEdit(host,"txt_cp_lect_subject2",105,10,470,20);$.lbl_cp_choice_desc=new FingerLabel(host,"lbl_cp_choice_desc",0,40,100,20);$.lbl_cp_choice_desc.setText("선정사유");$.mem_cp_choice_desc=new FingerMemoEdit(host,"mem_cp_choice_desc",105,40,465,170);$.lbl_contact_cnt=new FingerLabel(host,"lbl_contact_cnt",-5,220,110,20);$.lbl_contact_cnt.setText("예상 HCP 청중수");$.spe_contact_cnt=new FingerSpinEdit(host,"spe_contact_cnt",105,220,175,20);$.lbl_trans_amt=new FingerLabel(host,"lbl_trans_amt",0,10,100,20);$.lbl_trans_amt.setText("교통여비");$.spe_trans_amt=new FingerSpinEdit(host,"spe_trans_amt",105,10,225,20);$.lbl_stay_amt=new FingerLabel(host,"lbl_stay_amt",0,40,100,20);$.lbl_stay_amt.setText("숙박비");$.spe_stay_amt=new FingerSpinEdit(host,"spe_stay_amt",105,40,225,20);$.lbl_meal_amt=new FingerLabel(host,"lbl_meal_amt",0,70,100,20);$.lbl_meal_amt.setText("식음료비");$.spe_meal_amt=new FingerSpinEdit(host,"spe_meal_amt",105,70,225,20);$.lbl_lect_bank_account=new FingerLabel(host,"lbl_lect_bank_account",0,100,100,20);$.lbl_lect_bank_account.setText("계좌번호");$.txt_lect_bank_account=new FingerEdit(host,"txt_lect_bank_account",105,100,470,20);$.btnConfirm=new FingerButton(host,"btnConfirm",555,15,95,45);$.btnConfirm.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",635,15,95,45);$.btnCancel.setText("취소");$.panReport3=new FingerPanel(host,"panReport3",615,675,585,180);$.panReport3.setText("여비정보");$.panReport3.setBottomLine(true);$.panBefore=new FingerPanel(host,"panBefore",0,630,605,230);$.panBefore.setText("");$.panBefore.setBottomLine(true);$.chk_trans_yn=new FingerCheckBox(host,"chk_trans_yn",215,50,140,20);$.chk_trans_yn.setText("교통");$.chk_stay_yn=new FingerCheckBox(host,"chk_stay_yn",415,50,140,20);$.chk_stay_yn.setText("숙박");$.chk_meal_yn=new FingerCheckBox(host,"chk_meal_yn",25,50,140,20);$.chk_meal_yn.setText("식음료");$.pic_cp_picture1=new FingerImage(host,"pic_cp_picture1",10,65,165,148);$.pic_cp_picture2=new FingerImage(host,"pic_cp_picture2",220,65,165,148);$.pic_cp_picture3=new FingerImage(host,"pic_cp_picture3",425,65,165,148);$.lbl_contact_cnt2=new FingerLabel(host,"lbl_contact_cnt2",295,220,100,20);$.lbl_contact_cnt2.setText("실 HCP 청중수");$.spe_contact_cnt2=new FingerSpinEdit(host,"spe_contact_cnt2",400,220,175,20);$.panList.setBorder(true);$.panInfo.setBorder(true);$.panInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panReport.setBorder(true);$.panReport1.setBorder(true);$.panReport2.setBorder(true);$.panReport3.setBorder(true);$.panBottom.setBorder(true);$.txt_company_id.setVisible(false);$.txt_contact_id.setVisible(false);$.lbl_lect_bank_account.setVisible(false);$.txt_lect_bank_account.setVisible(false);$.cmb_cp_HH_fr.setEmptyRow(true);$.cmb_cp_MM_fr.setEmptyRow(true);$.cmb_cp_HH_to.setEmptyRow(true);$.cmb_cp_MM_to.setEmptyRow(true);$.bte_contact_name.setAllowBlank(false,"강연자");$.txt_company_name.setAllowBlank(false,"소속");$.spe_cp_lect_amt.setAllowBlank(false,"강연료");$.txt_cp_lect_subject1.setAllowBlank(false,"강의제목");$.dte_cp_lect_date.setAllowBlank(false,"강의일");$.lbl_employee_id.setVisible(false);$.cmb_employee_id.setVisible(false);$.cmb_cp_HH_fr.setAllowBlank(false,"강의시작시간");$.cmb_cp_MM_fr.setAllowBlank(false,"강의시작시간");$.cmb_cp_HH_to.setAllowBlank(false,"강의종료시간");$.cmb_cp_MM_to.setAllowBlank(false,"강의종료시간");$.txt_cp_HH2.setAllowBlank(false,"시간");$.txt_cp_MM2.setAllowBlank(false,"분");$.mem_agenda.setAllowBlank(false,"Agenda");$.mem_cp_desc.setAllowBlank(false,"강연내용");$.txt_cp_lect_subject2.setAllowBlank(false,"강연주제");$.mem_cp_choice_desc.setAllowBlank(false,"선정사유");$.spe_contact_cnt.setAllowBlank(false,"예상 HCP 청중수");$.spe_contact_cnt2.setAllowBlank(false,"실 HCP 청중수");$.mem_cp_desc2.setAllowBlank(false,"QA 및 free Discussion 내용");$.txt_company_name.setReadOnly(true);$.imgGroup=new FingerImageGroup([$.pic_cp_picture1,$.pic_cp_picture2,$.pic_cp_picture3]);$.pic_cp_picture1.setMode("N");$.pic_cp_picture2.setMode("N");$.pic_cp_picture3.setMode("N");$.pic_cp_picture1.setZooming(true,true,false);$.pic_cp_picture2.setZooming(true,true,false);$.pic_cp_picture3.setZooming(true,true,false);$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("contact_name",100,"left","string","강연자"),new FingerDataGridColumn("company_name",200,"left","string","소속"),new FingerDataGridColumn("cp_lect_date",100,"left","string","강연일",{format:"ymd"}),new FingerDataGridColumn("time",130,"left","string","강연시간"),new FingerDataGridColumn("cp_lect_subject2",455,"left","string","강연주제"),new FingerDataGridColumn("cp_lect_amt",200,"right","int","강연비",{format:"int"}),new FingerDataGridColumn("contact_id",280,"left","string","강연자아이디",{hidden:true}),new FingerDataGridColumn("company_id",280,"left","string","소속아이디",{hidden:true}),new FingerDataGridColumn("cp_emp_id",280,"left","string","보고자",{hidden:true}),new FingerDataGridColumn("cp_lect_subject1",280,"left","string","강의제목",{hidden:true}),new FingerDataGridColumn("cp_HH_fr",280,"left","string","시작시",{hidden:true}),new FingerDataGridColumn("cp_MM_fr",280,"left","string","시작분",{hidden:true}),new FingerDataGridColumn("cp_HH_to",280,"left","string","종료시",{hidden:true}),new FingerDataGridColumn("cp_MM_to",280,"left","string","종료분",{hidden:true}),new FingerDataGridColumn("cp_HH",280,"left","string","강의시간",{hidden:true}),new FingerDataGridColumn("cp_MM",280,"left","string","강의분",{hidden:true}),new FingerDataGridColumn("agenda",280,"left","string","Agenda",{hidden:true}),new FingerDataGridColumn("cp_desc",280,"left","string","강연내용 요약",{hidden:true}),new FingerDataGridColumn("cp_desc2",280,"left","string","Q&A 및 free Discussion 내용",{hidden:true}),new FingerDataGridColumn("cp_choice_desc",280,"left","string","선정사유",{hidden:true}),new FingerDataGridColumn("contact_cnt",280,"left","string","예상참여인원수",{hidden:true}),new FingerDataGridColumn("contact_cnt2",280,"left","string","실제참여인원수",{hidden:true}),new FingerDataGridColumn("cp_picture1",280,"left","string","사진1",{hidden:true}),new FingerDataGridColumn("cp_picture2",280,"left","string","사진2",{hidden:true}),new FingerDataGridColumn("cp_picture3",280,"left","string","사진3",{hidden:true}),new FingerDataGridColumn("trans_yn",280,"left","checkbox","교통비여부",{hidden:true}),new FingerDataGridColumn("stay_yn",280,"left","checkbox","숙박비여부",{hidden:true}),new FingerDataGridColumn("meal_yn",280,"left","checkbox","식음료비여부",{hidden:true}),new FingerDataGridColumn("trans_amt",280,"left","string","교통여비",{hidden:true}),new FingerDataGridColumn("stay_amt",280,"left","string","숙박비",{hidden:true}),new FingerDataGridColumn("meal_amt",280,"left","string","식음료비",{hidden:true}),new FingerDataGridColumn("lect_bank_account",280,"left","string","계좌번호",{hidden:true})]);$.grdList.init({panel:$.panList,isFilter:false,nonExcel:true});$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panList);$.panMain.add($.panInfo);$.panMain.add($.panBottom);$.panMain.add($.panReport);$.panMain.add($.panReport1);$.panMain.add($.panReport2);$.panMain.add($.panReport3);$.panMain.add($.panBefore);$.panList.add($.grdList);$.panInfo.add($.spe_cp_lect_amt);$.panInfo.add($.lbl_cp_lect_amt);$.panInfo.add($.txt_company_id);$.panInfo.add($.txt_company_name);$.panInfo.add($.lbl_company_name);$.panInfo.add($.bte_contact_name);$.panInfo.add($.lbl_contact_name);$.panInfo.add($.txt_contact_id);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panReport.add($.lbl_cp_lect_subject1);$.panReport.add($.txt_cp_lect_subject1);$.panReport.add($.lbl_cp_lect_date);$.panReport.add($.dte_cp_lect_date);$.panReport.add($.lbl_employee_id);$.panReport.add($.cmb_employee_id);$.panReport.add($.lbl_lect_time);$.panReport.add($.cmb_cp_HH_fr);$.panReport.add($.cmb_cp_MM_fr);$.panReport.add($.cmb_cp_HH_to);$.panReport.add($.cmb_cp_MM_to);$.panReport.add($.txt_cp_HH2);$.panReport.add($.lbl_cp_HH2);$.panReport.add($.txt_cp_MM2);$.panReport.add($.lbl_cp_MM2);$.panReport.add($.lbl_agenda);$.panReport.add($.mem_agenda);$.panReport.add($.lbl_cp_desc);$.panReport.add($.mem_cp_desc);$.panReport.add($.lbl_Txt1);$.panReport.add($.lbl_Txt2);$.panReport.add($.lbl_Txt3);$.panReport1.add($.lbl_cp_lect_subject2);$.panReport1.add($.txt_cp_lect_subject2);$.panReport1.add($.lbl_cp_choice_desc);$.panReport1.add($.mem_cp_choice_desc);$.panReport1.add($.lbl_contact_cnt);$.panReport1.add($.spe_contact_cnt);$.panReport1.add($.lbl_contact_cnt2);$.panReport1.add($.spe_contact_cnt2);$.panReport2.add($.txt_lect_bank_account);$.panReport2.add($.lbl_lect_bank_account);$.panReport2.add($.spe_meal_amt);$.panReport2.add($.lbl_meal_amt);$.panReport2.add($.spe_stay_amt);$.panReport2.add($.lbl_stay_amt);$.panReport2.add($.spe_trans_amt);$.panReport2.add($.lbl_trans_amt);$.panReport3.add($.chk_trans_yn);$.panReport3.add($.chk_stay_yn);$.panReport3.add($.chk_meal_yn);$.panBefore.add($.lbl_cp_desc2);$.panBefore.add($.mem_cp_desc2);$.panBefore.add($.pic_cp_picture3);$.panBefore.add($.pic_cp_picture2);$.panBefore.add($.pic_cp_picture1);relocateChildIndexInPanel([$.panInfo,$.panReport,$.panBefore,$.panReport1,$.panReport2,$.panReport3]);var ds=bizComponentData2($,"Q1","L_COM017|L_COM018_2|L_COM017|L_COM018_2");setComboBind([$.cmb_cp_HH_fr,$.cmb_cp_MM_fr,$.cmb_cp_HH_to,$.cmb_cp_MM_to],ds);if($.p_argument){$.cmb_cp_HH_fr.setValue("09");$.cmb_cp_MM_fr.setValue("00");$.cmb_cp_HH_to.setValue("18");$.cmb_cp_MM_to.setValue("00");if($.p_argument.source.length!=0){setDataGrid([$.grdList],$.p_argument.source,true);$.grdList.selectRow(0)}if($.p_argument.save_mode=="N"){fnEnableSet(false)}else{if(!$.grdList.getSelectedRowIdx()){newClick();$.bChange=true}else{$.bChange=false}}if($.p_argument.lect_type=="50"){$.strLect_Type=$.p_argument.lect_type;$.panReport2.setVisible(false);$.panReport3.setVisible(false)}else{if($.strCP_Code=="CP05"){$.panReport2.setVisible(true);$.panReport3.setVisible(false)}else{if($.strCP_Code=="CP19"){$.panReport2.setVisible(false);$.panReport3.setVisible(true)}}}if($.p_argument.lect_type=="60"||$.p_argument.lect_type=="70"){$.lbl_contact_cnt.setText("예상 청중수");$.lbl_contact_cnt2.setText("실 청중수")}if($.p_argument.cp_code!=""){$.strCP_Code=$.p_argument.cp_code;$.panReport2.setVisible(false);$.panReport3.setVisible(true);if($.strCP_Code=="CP19"){$.panBefore.setVisible(false);$.mem_cp_desc2.setAllowBlank(true,"QA 및 free Discussion 내용");$.panReport.setText("강연정보");$.spe_contact_cnt2.setReadOnly(true);$.spe_contact_cnt2.setValue(0);$.lbl_contact_cnt2.setVisible(false);$.spe_contact_cnt2.setVisible(false)}else{$.spe_contact_cnt.setReadOnly(true)}}$.lect_date=$.p_argument.lect_date}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){if(!gridValidator($.grdList,"contact_name")){return}if($.bChange){MessageBoxShow("변경사항이 있습니다. 저장 후 확인버튼을 눌러주세요");return}else{for(var i=0;i<$.grdList.getRowCount();i++){$.grdList.getItem(i).rowType=""}var rows=[];rows=copyArray($.grdList.getAllRows());var share={confirm_yn:"Y",source:rows};g_popupStack.setData(share);g_popupStack.close()}}else{if(id=="btnCancel"){g_popupStack.close()}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bte_contact_name"){var param={contact_name:$.bte_contact_name.getText()||"",check_yn:"N",base_date:$.lect_date,inquiry_type:"lecture"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){$.bChange=true};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){$.bChange=true};$.fingercombobox_change=function(id,value){$.bChange=true;if($.cmb_cp_HH_fr.getValue()!=""&&$.cmb_cp_MM_fr.getValue()!=""&&$.cmb_cp_HH_to.getValue()!=""&&$.cmb_cp_MM_to.getValue()!=""){calcLectTime()}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){$.bChange=true};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.bte_contact_name.setText($.grdList.getValue(rId,"contact_name"));$.txt_company_name.setValue($.grdList.getValue(rId,"company_name"));$.txt_company_id.setValue($.grdList.getValue(rId,"company_id"));$.spe_cp_lect_amt.setValue($.grdList.getValue(rId,"cp_lect_amt"));$.txt_contact_id.setValue($.grdList.getValue(rId,"contact_id"));$.txt_cp_lect_subject1.setValue($.grdList.getValue(rId,"cp_lect_subject1"));$.dte_cp_lect_date.setValue(getFormatDate($.grdList.getValue(rId,"cp_lect_date"),"yyyyMMdd"));$.cmb_employee_id.setValue($.grdList.getValue(rId,"cp_emp_id"));$.cmb_cp_HH_fr.setValue($.grdList.getValue(rId,"cp_HH_fr"));$.cmb_cp_MM_fr.setValue($.grdList.getValue(rId,"cp_MM_fr"));$.cmb_cp_HH_to.setValue($.grdList.getValue(rId,"cp_HH_to"));$.cmb_cp_MM_to.setValue($.grdList.getValue(rId,"cp_MM_to"));$.txt_cp_HH2.setValue($.grdList.getValue(rId,"cp_HH"));$.txt_cp_MM2.setValue($.grdList.getValue(rId,"cp_MM"));$.mem_agenda.setValue($.grdList.getValue(rId,"agenda"));$.mem_cp_desc.setValue($.grdList.getValue(rId,"cp_desc"));$.mem_cp_desc2.setValue($.grdList.getValue(rId,"cp_desc2"));$.txt_cp_lect_subject2.setValue($.grdList.getValue(rId,"cp_lect_subject2"));$.mem_cp_choice_desc.setValue($.grdList.getValue(rId,"cp_choice_desc"));$.spe_contact_cnt.setValue($.grdList.getValue(rId,"contact_cnt"));$.spe_contact_cnt2.setValue($.grdList.getValue(rId,"contact_cnt2"));$.spe_trans_amt.setValue($.grdList.getValue(rId,"trans_amt"));$.spe_stay_amt.setValue($.grdList.getValue(rId,"stay_amt"));$.spe_meal_amt.setValue($.grdList.getValue(rId,"meal_amt"));$.txt_lect_bank_account.setValue($.grdList.getValue(rId,"lect_bank_account"));$.chk_trans_yn.setValue($.grdList.getValue(rId,"trans_yn"));$.chk_stay_yn.setValue($.grdList.getValue(rId,"stay_yn"));$.chk_meal_yn.setValue($.grdList.getValue(rId,"meal_yn"));$.grdList.getValue(rId,"cp_picture1")==""?$.pic_cp_picture1.fileRemove():$.pic_cp_picture1.setValue($.grdList.getValue(rId,"cp_picture1"));$.grdList.getValue(rId,"cp_picture2")==""?$.pic_cp_picture2.fileRemove():$.pic_cp_picture2.setValue($.grdList.getValue(rId,"cp_picture2"));$.grdList.getValue(rId,"cp_picture3")==""?$.pic_cp_picture3.fileRemove():$.pic_cp_picture3.setValue($.grdList.getValue(rId,"cp_picture3"));$.bChange=false}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){$.bChange=true};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){newClick();$.bChange=true}else{if(btnId=="btnSave"){if(saveLecturer()){MessageBoxShow("저장되었습니다.");$.bChange=false}}else{if(btnId=="btnDelete"){if(!$.grdList.getSelectedRowIdx()){return}$.grdList.deleteRow($.grdList.getSelectedRowIdx());$.grdList.selectRow(0);$.bChange=false}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="bte_contact_name"){$.txt_contact_id.setValue(popResult.popRows.contact_id);$.bte_contact_name.setText(popResult.popRows.contact_name);$.txt_company_id.setValue(popResult.popRows.company_id);$.txt_company_name.setValue(popResult.popRows.company_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>