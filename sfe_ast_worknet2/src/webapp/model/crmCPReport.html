<script>function Main(){var $=this;$.host=null;$.panMain=null;$.tabMain=null;$.panTab1=null;$.lbl_year=null;$.cmb_year=null;$.panTab2=null;$.panQuery=null;$.panInfo=null;$.panDetail=null;$.panQuery2=null;$.lbl_year2=null;$.cmb_year2=null;$.panProduct=null;$.grdList1=null;$.grdList2=null;$.grdList3=null;$.btnSearch=null;$.btnSearch2=null;function searchList(workType){if(workType=="Q"){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}else{if(workType=="Q1"){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}else{if(workType=="Q2"){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}}}}function createJSON_Q(workType){var json="";var dtData=[];var rId=$.grdList1.getSelectedRowIdx();if(workType=="Q"){dtData.push([workType,$.cmb_year.getValue(),""])}else{if(workType=="Q1"){dtData.push([workType,$.cmb_year.getValue(),$.grdList1.getValue(rId,"contact_id")])}else{if(workType=="Q2"){dtData.push([workType,$.cmb_year2.getValue(),""])}}}json=createExecuteParamInfo("P_crmCPReport_Q",dtData);return json}function searchCrmCPAdviceAfter(){var json=createJSON_Q1("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q1(workType){var json=createExecuteParamInfo("P_crmCPAdviceAfter_Q",[workType,$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPLectureAfter(){var json=createJSON_Q2("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPLectureAfter_Q",[workType,$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"cp_id"),""]);return json}function searchCrmCPAbroadSpeaker(){var json=createJSON_Q3("Q");return callQuerySync(["req",json],"Q")}function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmCPAbroadSpeaker_Q",[workType,$.grdList2.getValue($.grdList2.getSelectedRowIdx(),"cp_id"),""]);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,715);$.panMain.setText("");$.panMain.setBottomLine(true);$.tabMain=new FingerTab(host,"tabMain",0,0,1200,715);$.panTab1=new FingerPanel(host,"panTab1",0,0,1200,685);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.lbl_year=new FingerLabel(host,"lbl_year",0,15,100,20);$.lbl_year.setText("연도");$.cmb_year=new FingerComboBox(host,"cmb_year",105,15,140,20);$.panTab2=new FingerPanel(host,"panTab2",0,0,1200,685);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,65,1200,375);$.panInfo.setText("요약정보");$.panInfo.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",0,450,1200,235);$.panDetail.setText("세부내역");$.panDetail.setBottomLine(true);$.panQuery2=new FingerPanel(host,"panQuery2",0,0,1200,55);$.panQuery2.setText("");$.panQuery2.setBottomLine(true);$.lbl_year2=new FingerLabel(host,"lbl_year2",0,15,100,20);$.lbl_year2.setText("연도");$.cmb_year2=new FingerComboBox(host,"cmb_year2",105,15,140,20);$.panProduct=new FingerPanel(host,"panProduct",0,65,1200,620);$.panProduct.setText("현황");$.panProduct.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,1200,330);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,185);$.grdList3=new FingerDataGrid(host,"grdList3",0,0,1200,570);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.btnSearch2=new FingerButton(host,"btnSearch2",1095,15,100,20);$.btnSearch2.setText("조회");$.cmb_year.setEmptyRow(true);$.cmb_year2.setEmptyRow(true);$.cmb_year.setAllowBlank(false,"연도1");$.cmb_year2.setAllowBlank(false,"연도2");$.grdList1.setColumns([new FingerDataGridColumn("contact_name",80,"left","string",[{text:"",colspan:2},"성명"],{readonly:true}),new FingerDataGridColumn("contact_id",80,"left","string",["","고객코드"],{hidden:true}),new FingerDataGridColumn("company_name",180,"left","string",["","소속"],{readonly:true}),new FingerDataGridColumn("company_id",80,"left","string",["","소속코드"],{hidden:true}),new FingerDataGridColumn("lect_cnt_domestic",80,"right","string",[{text:"강연(국내)",colspan:2},"횟수"],{format:"int",readonly:true}),new FingerDataGridColumn("lect_amt_sum_domestic",150,"right","string",["","누적금액"],{format:"int",readonly:true}),new FingerDataGridColumn("lect_cnt_abroad",80,"right","string",[{text:"강연(해외)",colspan:2},"횟수"],{format:"int",readonly:true}),new FingerDataGridColumn("lect_amt_sum_abroad",150,"right","string",["","누적금액"],{format:"int",readonly:true}),new FingerDataGridColumn("advice_cnt_domestic",80,"right","string",[{text:"자문(국내)",colspan:2},"횟수"],{format:"int",readonly:true}),new FingerDataGridColumn("advice_amt_sum_domestic",150,"right","string",["","누적금액"],{format:"int",readonly:true}),new FingerDataGridColumn("advice_cnt_abroad",80,"right","string",[{text:"자문(해외)",colspan:2},"횟수"],{format:"int",readonly:true}),new FingerDataGridColumn("advice_amt_sum_abroad",150,"right","string",["","누적금액"],{format:"int",readonly:true})]);$.grdList1.init({panel:$.panInfo,scroll:"xy"});$.grdList1.setBorder(false);$.grdList2.setColumns([new FingerDataGridColumn("base_date",120,"left","string","진행일자",{readonly:true,format:"s_ymd"}),new FingerDataGridColumn("cp_type",120,"left","string","유형",{readonly:true}),new FingerDataGridColumn("cp_id",120,"left","string","CP번호",{readonly:true,isLink:true}),new FingerDataGridColumn("amount",120,"right","string","금액",{readonly:true,format:"int"}),new FingerDataGridColumn("paid_yn",120,"left","string","지급여부",{readonly:true})]);$.grdList2.init({panel:$.panDetail,scroll:"xy"});$.grdList2.setBorder(false);$.grdList3.setColumns([new FingerDataGridColumn("cp_id",120,"left","string","CP번호",{readonly:true}),new FingerDataGridColumn("cp_type",180,"left","string","유형",{readonly:true}),new FingerDataGridColumn("employee_id",80,"left","string","담당자",{readonly:true}),new FingerDataGridColumn("start_date",100,"left","string","시작일자",{readonly:true,format:"s_ymd"}),new FingerDataGridColumn("end_date",100,"left","string","종료일자",{readonly:true,format:"s_ymd"}),new FingerDataGridColumn("before_cp_amt",120,"right","string","금액(사전)",{readonly:true,format:"int"}),new FingerDataGridColumn("cp_amt",120,"right","string","금액(사후)",{readonly:true,format:"int"}),new FingerDataGridColumn("before_wf_doc_id",120,"left","string","기안문서(사전)",{readonly:true,isLink:true}),new FingerDataGridColumn("wf_doc_id",120,"left","string","기안문서(사후)",{readonly:true,isLink:true}),new FingerDataGridColumn("cp_id_after",125,"left","string","CP번호(사후)",{readonly:true}),new FingerDataGridColumn("cp_code",120,"left","string","CP코드",{readonly:true}),new FingerDataGridColumn("Memo",120,"left","string","메모",{readonly:true})]);$.grdList3.init({panel:$.panProduct,scroll:"xy"});$.grdList3.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.tabMain);$.panTab1.add($.panQuery);$.panTab1.add($.panDetail);$.panTab1.add($.panInfo);$.panTab2.add($.panQuery2);$.panTab2.add($.panProduct);$.panQuery.add($.lbl_year);$.panQuery.add($.cmb_year);$.panQuery.add($.btnSearch);$.panInfo.add($.grdList1);$.panDetail.add($.grdList2);$.panQuery2.add($.lbl_year2);$.panQuery2.add($.cmb_year2);$.panQuery2.add($.btnSearch2);$.panProduct.add($.grdList3);$.tabMain.addTab([{text:"강연/자문 현황",body:$.panTab1,width:150},{text:"자사제품설명회 현황",body:$.panTab2,width:180}]);if((g_main.session.obj.DeptCode!=g_main.session.obj.CPDeptCode)&&(g_main.session.obj.SystemDeveloper!="Y")){$.tabMain.hideTab(1)}var ds=bizComponentData2($,"Q2","L_CRM0119|L_CRM0119");$.cmb_year.setColumn("sub_code","code_name");$.cmb_year2.setColumn("sub_code","code_name");setComboBind([$.cmb_year,$.cmb_year2],ds)};$.callback=function(type,ds){if(type=="Q"){setDataGrid([$.grdList1],ds);$.grdList1.selectRow(0)}else{if(type=="Q1"){setDataGrid([$.grdList2],ds);$.grdList2.selectRow(0)}else{if(type=="Q2"){setDataGrid([$.grdList3],ds);$.grdList3.selectRow(0)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("Q")}else{if(id=="btnSearch2"){searchList("Q2")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){var rId=$.grdList3.getSelectedRowIdx();var rId2=$.grdList2.getSelectedRowIdx();var param="";if(g_main.session.DeptCode==g_main.session.CPDeptCode||g_main.session.DeptCode==g_main.session.SystemDeveloper){if(id=="grdList3"){if(cInd=="before_wf_doc_id"){if($.grdList3.getValue(rId,"cp_code")=="CP01"&&$.grdList3.getValue(rId,"before_wf_doc_id")!=""){var param={wf_doc_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"before_wf_doc_id"),cp_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_id"),cp_code:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_code")};g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if($.grdList3.getValue(rId,"cp_code")=="CP21"&&$.grdList3.getValue(rId,"before_wf_doc_id")!=""){var param={wf_doc_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"wf_doc_id"),cp_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_id"),cp_code:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_code")};g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}}}else{if(cInd=="wf_doc_id"){if($.grdList3.getValue(rId,"cp_code")=="CP01"&&$.grdList3.getValue(rId,"wf_doc_id")!=""){var param={wf_doc_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"wf_doc_id"),cp_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_id_after"),cp_code:"CP02"};g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}else{if($.grdList3.getValue(rId,"cp_code")=="CP21"&&$.grdList3.getValue(rId,"wf_doc_id")!=""){var param={wf_doc_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"wf_doc_id"),cp_id:$.grdList3.getValue($.grdList3.getSelectedRowIdx(),"cp_id_after"),cp_code:"CP22"};g_main.openPopup("popWFViewer.html","popWFViewer","결재문서조회",0,0,"","",param,"","")}}}}}else{if(id=="grdList2"){if(cInd=="cp_id"){if($.grdList2.getValue(rId2,"cp_type")=="자문"){var ds=searchCrmCPAdviceAfter();param=ds.resultList;param[0][0].Confirm=false;param[0][0].AllReport=false;param[0][0].MyReport=false;param[0][0].cp_status="90";param[0][0].cp_descr="";param[0][0].save_yn="N";g_main.openPopup("crmCPAdvice.html","crmCPAdvice","자문(사후)",1200,1080,"","",param,"","")}else{if($.grdList2.getValue(rId2,"cp_type")=="강연"){var ds=searchCrmCPLectureAfter();param=ds.resultList;param[0][0].Confirm=false;param[0][0].AllReport=false;param[0][0].MyReport=false;param[0][0].cp_status="90";param[0][0].cp_descr="";param[0][0].save_yn="N";g_main.openPopup("crmCPLecture.html","crmCPLecture","강연(사후)",1200,1060,"","",param,"","")}else{if($.grdList2.getValue(rId2,"cp_type")=="자문(해외)"||$.grdList2.getValue(rId2,"cp_type")=="강연(해외)"){var ds=searchCrmCPAbroadSpeaker();param=ds.resultList;param[0][0].Confirm=false;param[0][0].AllReport=false;param[0][0].MyReport=false;param[0][0].cp_status="90";param[0][0].cp_descr="";param[0][0].save_yn="N";g_main.openPopup("crmCPAbroadSpeaker.html","crmCPAbroadSpeaker","국내연자 해외초청",1200,1200,"","",param,"","")}}}}}}}};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList1"){searchList("Q1")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>