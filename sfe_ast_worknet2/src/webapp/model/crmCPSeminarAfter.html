<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panInfo=null;$.panContact=null;$.panCard=null;$.panFile=null;$.panBottom=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.memPreDescr=null;$.memCPDescr=null;$.lblCPDocNo=null;$.lblTeamLeader=null;$.lblEmp=null;$.lblPM=null;$.lblGift=null;$.lblProduct=null;$.lblCPDate=null;$.lblSupportTotal=null;$.lblTheme=null;$.lblLect=null;$.lblAcademy=null;$.lblEnterEmp=null;$.lblPlace=null;$.lblAgenda=null;$.lblDesc=null;$.lblDesc2=null;$.lblChange=null;$.lblReportDate=null;$.txtCPDocNo=null;$.cmbTeamLeader=null;$.cmbEmp=null;$.cmbPM=null;$.cmbGift=null;$.cmbProduct=null;$.dteStart=null;$.dteEnd=null;$.cmbTheme=null;$.chkStayModify=null;$.chkDateModify=null;$.rdoLect=null;$.rdoAcademy=null;$.memEnterEmp=null;$.memPlace=null;$.memAgenda=null;$.memDesc=null;$.memChange=null;$.memDesc2=null;$.dteReportDate=null;$.cmbStatus=null;$.imgPicture1=null;$.imgPicture2=null;$.imgPicture3=null;$.imgPicture4=null;$.grdCard=null;$.grdContact=null;$.grdFile=null;$.lblWave=null;$.speSupportTotal=null;$.cboFromHH=null;$.cboFromMM=null;$.cboToHH=null;$.cboToMM=null;$.lblColon1=null;$.lblColon2=null;$.btnUpload=null;$.btnView=null;$.lblMealPlace=null;$.txtMealPlace=null;$.lblSeminarPlace=null;$.txtSeminarPlace=null;$.btnUploadList=null;$.btnMAConfirm=null;$.btnMACancel=null;$.lblPrivateRoomYN=null;$.lblAgencyYN=null;$.rdoPrivateRoomYN=null;$.rdoAgencyYN=null;$.lblAgencyDocuYN=null;$.rdoAgencyDocuYN=null;$.btnBatchUpload=null;$.lblSupportTotal2=null;$.btnViewBfCP=null;$.varCPId="";$.varCPBeforeId="";$.varCPCode="";$.varWFDocId="";$.varCPDeptCode="";$.varCPDocNo="";$.varBfcpcode="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmCPSeminarBefore_Q",[workType,$.varCPBeforeId,""]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmCPInfo_Q",[workType,$.varBfcpcode]);return json}function createJSON_Q2_1(cpFormId,cpProcName){if(cpProcName=="P_crmCPDetailAfter_Q"||cpProcName=="P_crmCPExternalAct_Q"){var json=createExecuteParamInfo(cpProcName,["Q",$.varCPBeforeId])}else{var json=createExecuteParamInfo(cpProcName,["Q",$.varCPBeforeId,"#UserID#"])}return json}function createJSON_S(workType){var con_id="",com_id="",sup_amt="",cp_food="",cp_food_amt="",cp_gift="",cp_gift_amt="",cp_stay="",cp_stay_amt="",cp_trans="",cp_trans_amt="",file_path="",file_name="";var f_seq="",f_type="",f_s_path="",f_s_fname="",f_l_fname="";var APPRNO="",APPDAT="",CARDNO="",APPAMT="",VENKNM="",VENADD="",VENGRP="";for(var i=0;i<$.grdContact.getRowCount();i++){com_id+=$.grdContact.getValue(i,"company_id")+"|";con_id+=$.grdContact.getValue(i,"contact_id")+"|";sup_amt+=$.grdContact.getValue(i,"support_amt")+"|";cp_food+=$.grdContact.getValue(i,"cp_food_yn")+"|";cp_food_amt+=$.grdContact.getValue(i,"food_amt")+"|";cp_gift+=$.grdContact.getValue(i,"cp_gift_yn")+"|";cp_gift_amt+=$.grdContact.getValue(i,"gift_amt")+"|";cp_stay+="N|";cp_stay_amt+="0|";cp_trans+=$.grdContact.getValue(i,"cp_trans_yn")+"|";cp_trans_amt+=$.grdContact.getValue(i,"trans_amt")+"|";file_path+=$.grdContact.getValue(i,"file_path")+"|";file_name+=$.grdContact.getValue(i,"file_name")+"|"}if($.grdContact.getRowCount()>0){com_id=com_id.substring(0,com_id.length-1);con_id=con_id.substring(0,con_id.length-1);sup_amt=sup_amt.substring(0,sup_amt.length-1);cp_food=cp_food.substring(0,cp_food.length-1);cp_food_amt=cp_food_amt.substring(0,cp_food_amt.length-1);cp_gift=cp_gift.substring(0,cp_gift.length-1);cp_gift_amt=cp_gift_amt.substring(0,cp_gift_amt.length-1);cp_stay=cp_stay.substring(0,cp_stay.length-1);cp_stay_amt=cp_stay_amt.substring(0,cp_stay_amt.length-1);cp_trans=cp_trans.substring(0,cp_trans.length-1);cp_trans_amt=cp_trans_amt.substring(0,cp_trans_amt.length-1);file_path=file_path.substring(0,file_path.length-1);file_name=file_name.substring(0,file_name.length-1)}var fileRow=$.grdFile.getAllRows();var fileYN=fileRow.length>0?"Y":"N";if(fileYN=="Y"){for(var i in fileRow){if(i>0){f_seq+="|";f_type+="|";f_s_path+="|";f_s_fname+="|";f_l_fname+="|"}f_seq+=Number(i)+1;f_type+=fileRow[i].file_type||"";f_s_path+=fileRow[i].server_path||"";f_s_fname+=fileRow[i].server_fname||"";f_l_fname+=fileRow[i].local_fname||""}}var cardRow=$.grdCard.getAllRows();var cardYN=cardRow.length>0?"Y":"N";for(var i in cardRow){APPRNO+=(APPRNO?"|":"")+cardRow[i].APPRNO;APPDAT+=(APPDAT?"|":"")+cardRow[i].APPDAT;CARDNO+=(CARDNO?"|":"")+cardRow[i].CARDNO;APPAMT+=(APPAMT?"|":"")+cardRow[i].APPAMT;VENKNM+=(VENKNM?"|":"")+cardRow[i].VENKNM;VENADD+=(VENADD?"|":"")+cardRow[i].VENADD;VENGRP+=(VENGRP?"|":"")+cardRow[i].VENGRP}var json=createExecuteParamInfo("P_crmCPSeminarAfter_S_B64",[workType,$.varCPId||"",$.varCPDocNo||"",$.memChange.getValue(),$.dteReportDate.getValue(),$.varCPDeptCode,$.cmbTeamLeader.getValue(),$.cmbEmp.getValue(),$.cmbPM.getValue(),$.dteStart.getValue(),$.cboFromHH.getValue(),$.cboFromMM.getValue(),$.dteEnd.getValue(),$.cboToHH.getValue(),$.cboToMM.getValue(),$.cmbProduct.getValue(),$.cmbTheme.getValue(),$.memEnterEmp.getValue(),$.memAgenda.getValue(),$.memDesc.getValue(),$.memDesc2.getValue()||" ",$.txtSeminarPlace.getValue(),$.txtMealPlace.getValue(),$.speSupportTotal.getValue(),$.imgPicture1.getValue()!=""?$.imgPicture1.getUploadParam().image_base64:"",$.imgPicture2.getValue()!=""?$.imgPicture2.getUploadParam().image_base64:"",$.imgPicture3.getValue()!=""?$.imgPicture3.getUploadParam().image_base64:"",$.imgPicture4.getValue()!=""?$.imgPicture4.getUploadParam().image_base64:"",$.varCPBeforeId,$.varCPCode,$.varWFDocId,"#UserID#",$.chkStayModify.getValue(),$.chkDateModify.getValue(),$.rdoLect.getValue(),$.cmbGift.getValue(),$.rdoAcademy.getValue(),$.rdoPrivateRoomYN.getValue(),$.rdoAgencyYN.getValue(),$.rdoAgencyDocuYN.getValue(),"Y",con_id,com_id,sup_amt,cp_food,cp_food_amt,cp_gift,cp_gift_amt,cp_stay,cp_stay_amt,cp_trans,cp_trans_amt,file_path,file_name,cardYN,APPRNO,APPDAT,CARDNO,APPAMT,VENKNM,VENADD,VENGRP,fileYN,f_type,f_seq,f_s_path,f_s_fname,f_l_fname]);return json}function saveSeminar(workType){if(workType=="N1"||workType=="N2"||workType=="U1"||workType=="U2"||workType=="NT"||workType=="UT"){if(!$.imgPicture1.getValue()&&!$.imgPicture2.getValue()&&!$.imgPicture3.getValue()&&!$.imgPicture4.getValue()){MessageBoxShow("사진은 한장 이상 등록 되어야 합니다.");return}if($.grdContact.getRowCount()<=0){MessageBoxShow("참석자가없습니다.");return}}var json=createJSON_S(workType);if(json){callExecute(["req",json],workType,$,false)}}function searchContact(){var json=createJSON_Q("CONTACT");callQuery(["req",json],"CONTACT",$)}function setAllowBlank(){$.cmbPM.setAllowBlank(false,"PM");$.cmbGift.setAllowBlank(false,"기념품구매");$.memEnterEmp.setAllowBlank(false,"사진촬영자");$.memPlace.setAllowBlank(false,"개최지");$.memAgenda.setAllowBlank(false,"Agenda");$.memDesc.setAllowBlank(false,"내용요약");$.memChange.setAllowBlank(false,"기타사항");$.dteStart.setAllowBlank(false,"개최기간 시작일");$.dteEnd.setAllowBlank(false,"개최기간 종료일");$.cboFromHH.setAllowBlank(false,"시작 시간");$.cboFromMM.setAllowBlank(false,"시작 시간");$.cboToHH.setAllowBlank(false,"종료 시간");$.cboToMM.setAllowBlank(false,"종료 시간");$.txtMealPlace.setAllowBlank(false,"식사 장소");$.txtSeminarPlace.setAllowBlank(false,"설명회 장소")}function initControl(){$.panInfo.clear();$.rdoLect.setValue("N");$.rdoAcademy.setValue("Y");$.rdoPrivateRoomYN.setValue("Y");$.rdoAgencyYN.setValue("N");$.rdoAgencyDocuYN.setValue("N");$.txtCPDocNo.setReadOnly(true);$.cmbTeamLeader.setEnable(false);$.cmbEmp.setEnable(false);$.cmbProduct.setEnable(false);$.speSupportTotal.setReadOnly(true);$.memPlace.setReadOnly(true);$.cmbTheme.setEnable(false);$.chkStayModify.setEnable(false);$.chkDateModify.setEnable(false);$.dteReportDate.setEnable(false);$.cmbStatus.setEnable(false);$.cmbGift.setValue("90")}function calcSupportAmt(){var aRow=$.grdContact.getAllRows();var sum=0;for(var i in aRow){sum+=Number(aRow[i].support_amt)}$.speSupportTotal.setValue(sum)}function setSupportYN(){for(var i=0;i<$.grdContact.getRowCount();i++){if(Number($.grdContact.getValue(i,"food_amt"))>0){$.grdContact.setValue(i,"cp_food_yn","Y")}else{$.grdContact.setValue(i,"cp_food_yn","N")}if(Number($.grdContact.getValue(i,"gift_amt"))>0){$.grdContact.setValue(i,"cp_gift_yn","Y")}else{$.grdContact.setValue(i,"cp_gift_yn","N")}if(Number($.grdContact.getValue(i,"trans_amt"))>0){$.grdContact.setValue(i,"cp_trans_yn","Y")}else{$.grdContact.setValue(i,"cp_trans_yn","N")}$.grdContact.setValue(i,"support_amt",(Number($.grdContact.getValue(i,"food_amt"))+Number($.grdContact.getValue(i,"gift_amt"))+Number($.grdContact.getValue(i,"trans_amt"))))}}function getCompanyCode(){for(var i=0;i<$.grdContact.getRowCount();i++){var strQuery=" where x.contact_id = '"+$.grdContact.getValue(i,"contact_id")+"'";var ds=bizComponentData2($,"Q4","L_CRM0292",strQuery);if($.grdContact.getValue(i,"contact_name")!=ds.resultList[0][0].contact_name){$.grdContact.setValue(i,"contact_name","X"+$.grdContact.getValue(i,"contact_name"))}else{$.grdContact.setValue(i,"contact_name",ds.resultList[0][0].contact_name)}$.grdContact.setValue(i,"company_id",ds.resultList[0][0].company_id);$.grdContact.setValue(i,"company_name",ds.resultList[0][0].company_name)}}function chkAggrementList(){var chkAggrement=true;for(var i=0;i<$.grdContact.getRowCount();i++){if(($.grdContact.getValue(i,"contact_id").substr(0,2)!="ka"&&$.grdContact.getValue(i,"contact_id").substr(0,3)!="YPC")&&$.grdContact.getValue(i,"upload_yn")=="N"){chkAggrement=false}}return chkAggrement}function gridValidator(){if(arguments.length<2){return false}var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<=arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}function chkContactList(){var chkList=true;for(var i=0;i<$.grdContact.getRowCount();i++){for(var j=i+1;j<$.grdContact.getRowCount();j++){if($.grdContact.getValue(i,"contact_id")==$.grdContact.getValue(j,"contact_id")){chkList=false}}}return chkList}function searchCPInfo(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"CP_INFO",$)}function searchCPData(cpFormId,cpProcName){var json=createJSON_Q2_1(cpFormId,cpProcName);callQuery(["req",json],"CP_DATA",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1260);$.panMain.setText("");$.panMain.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,0,1200,600);$.panInfo.setText("자사제품설명회 - 사후");$.panInfo.setBottomLine(true);$.panContact=new FingerPanel(host,"panContact",0,610,1200,330);$.panContact.setText("자사제품설명회 참석자 - 사후");$.panContact.setBottomLine(false);$.panCard=new FingerPanel(host,"panCard",0,950,595,190);$.panCard.setText("법인카드내역");$.panCard.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",605,950,595,190);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,1150,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",990,5,105,95);$.btnMemoSave.setText("메모저장");$.memPreDescr=new FingerMemoEdit(host,"memPreDescr",120,1155,400,90);$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",535,1155,440,90);$.lblCPDocNo=new FingerLabel(host,"lblCPDocNo",5,10,70,20);$.lblCPDocNo.setText("문서번호");$.lblTeamLeader=new FingerLabel(host,"lblTeamLeader",380,10,70,20);$.lblTeamLeader.setText("영업소장");$.lblEmp=new FingerLabel(host,"lblEmp",5,40,70,20);$.lblEmp.setText("담당자");$.lblPM=new FingerLabel(host,"lblPM",380,40,70,20);$.lblPM.setText("PM");$.lblGift=new FingerLabel(host,"lblGift",-5,70,80,20);$.lblGift.setText("기념품구매");$.lblProduct=new FingerLabel(host,"lblProduct",380,70,70,20);$.lblProduct.setText("품목");$.lblCPDate=new FingerLabel(host,"lblCPDate",5,100,70,20);$.lblCPDate.setText("개최기간");$.lblSupportTotal=new FingerLabel(host,"lblSupportTotal",5,130,70,20);$.lblSupportTotal.setText("지원총액");$.lblTheme=new FingerLabel(host,"lblTheme",0,160,80,20);$.lblTheme.setText("설명회테마");$.lblLect=new FingerLabel(host,"lblLect",365,190,90,20);$.lblLect.setText("HCP강연유무");$.lblAcademy=new FingerLabel(host,"lblAcademy",0,220,170,20);$.lblAcademy.setText("해당기간 관련학회 (모임 등)");$.lblEnterEmp=new FingerLabel(host,"lblEnterEmp",0,295,80,20);$.lblEnterEmp.setText("사진촬영자");$.lblPlace=new FingerLabel(host,"lblPlace",380,220,70,20);$.lblPlace.setText("개최지");$.lblAgenda=new FingerLabel(host,"lblAgenda",5,385,70,20);$.lblAgenda.setText("Agenda");$.lblDesc=new FingerLabel(host,"lblDesc",375,385,80,20);$.lblDesc.setText("내용요약");$.lblDesc2=new FingerLabel(host,"lblDesc2",610,475,100,20);$.lblDesc2.setText("Q&A 및 free Discussion 내용");$.lblChange=new FingerLabel(host,"lblChange",5,480,70,20);$.lblChange.setText("기타사항");$.lblReportDate=new FingerLabel(host,"lblReportDate",720,10,100,20);$.lblReportDate.setText("보고일자");$.txtCPDocNo=new FingerEdit(host,"txtCPDocNo",80,10,150,20);$.cmbTeamLeader=new FingerComboBox(host,"cmbTeamLeader",455,10,155,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",80,40,155,20);$.cmbPM=new FingerComboBox(host,"cmbPM",455,40,155,20);$.cmbGift=new FingerComboBox(host,"cmbGift",80,70,200,20);$.cmbProduct=new FingerComboBox(host,"cmbProduct",455,70,155,20);$.dteStart=new FingerDateEdit(host,"dteStart",80,100,110,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",330,100,110,20);$.cmbTheme=new FingerComboBox(host,"cmbTheme",80,160,535,20);$.chkStayModify=new FingerCheckBox(host,"chkStayModify",615,105,85,20);$.chkStayModify.setText("개최지 변경");$.chkDateModify=new FingerCheckBox(host,"chkDateModify",615,130,105,20);$.chkDateModify.setText("개최일정 변경");$.rdoLect=new FingerRadioBox(host,"rdoLect",460,190,140,20);$.rdoAcademy=new FingerRadioBox(host,"rdoAcademy",180,220,140,20);$.memEnterEmp=new FingerMemoEdit(host,"memEnterEmp",80,280,300,50);$.memPlace=new FingerMemoEdit(host,"memPlace",455,220,285,20);$.memAgenda=new FingerMemoEdit(host,"memAgenda",80,340,300,100);$.memDesc=new FingerMemoEdit(host,"memDesc",460,340,285,100);$.memChange=new FingerMemoEdit(host,"memChange",80,450,450,90);$.memDesc2=new FingerMemoEdit(host,"memDesc2",720,450,450,90);$.dteReportDate=new FingerDateEdit(host,"dteReportDate",825,10,100,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",1035,10,140,20);$.imgPicture1=new FingerImage(host,"imgPicture1",765,45,200,160);$.imgPicture2=new FingerImage(host,"imgPicture2",975,45,200,160);$.imgPicture3=new FingerImage(host,"imgPicture3",765,215,200,160);$.imgPicture4=new FingerImage(host,"imgPicture4",975,215,200,160);$.grdCard=new FingerDataGrid(host,"grdCard",0,0,595,145);$.grdContact=new FingerDataGrid(host,"grdContact",0,0,1200,285);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,595,145);$.lblWave=new FingerLabel(host,"lblWave",305,100,20,20);$.lblWave.setText("~");$.speSupportTotal=new FingerSpinEdit(host,"speSupportTotal",80,130,140,20);$.cboFromHH=new FingerComboBox(host,"cboFromHH",195,100,55,20);$.cboFromMM=new FingerComboBox(host,"cboFromMM",255,100,55,20);$.cboToHH=new FingerComboBox(host,"cboToHH",445,100,55,20);$.cboToMM=new FingerComboBox(host,"cboToMM",505,100,55,20);$.lblColon1=new FingerLabel(host,"lblColon1",235,100,20,20);$.lblColon1.setText(":");$.lblColon2=new FingerLabel(host,"lblColon2",485,100,20,20);$.lblColon2.setText(":");$.btnUpload=new FingerButton(host,"btnUpload",655,-40,120,30);$.btnUpload.setText("동의서 업로드");$.btnView=new FingerButton(host,"btnView",765,-40,120,30);$.btnView.setText("동의서 보기");$.lblMealPlace=new FingerLabel(host,"lblMealPlace",390,310,70,20);$.lblMealPlace.setText("식사장소");$.txtMealPlace=new FingerEdit(host,"txtMealPlace",460,310,290,20);$.lblSeminarPlace=new FingerLabel(host,"lblSeminarPlace",380,280,80,20);$.lblSeminarPlace.setText("설명회장소");$.txtSeminarPlace=new FingerEdit(host,"txtSeminarPlace",460,280,290,20);$.btnUploadList=new FingerButton(host,"btnUploadList",365,-40,150,30);$.btnUploadList.setText("참석자 일괄 업로드");$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1090,5,120,45);$.btnMAConfirm.setText("MA승인");$.btnMACancel=new FingerButton(host,"btnMACancel",1090,55,120,45);$.btnMACancel.setText("MA승인취소");$.lblPrivateRoomYN=new FingerLabel(host,"lblPrivateRoomYN",85,190,80,20);$.lblPrivateRoomYN.setText("단독룸 유무");$.lblAgencyYN=new FingerLabel(host,"lblAgencyYN",375,220,80,20);$.lblAgencyYN.setText("대행사 유무");$.rdoPrivateRoomYN=new FingerRadioBox(host,"rdoPrivateRoomYN",180,190,140,20);$.rdoAgencyYN=new FingerRadioBox(host,"rdoAgencyYN",460,220,140,20);$.lblAgencyDocuYN=new FingerLabel(host,"lblAgencyDocuYN",255,250,200,20);$.lblAgencyDocuYN.setText("대행사 지출 관련 서류 보관 자료");$.rdoAgencyDocuYN=new FingerRadioBox(host,"rdoAgencyDocuYN",460,250,140,20);$.btnBatchUpload=new FingerButton(host,"btnBatchUpload",505,-40,160,30);$.btnBatchUpload.setText("동의서 일괄 업로드");$.lblSupportTotal2=new FingerLabel(host,"lblSupportTotal2",220,130,20,20);$.lblSupportTotal2.setText("원");$.btnViewBfCP=new FingerButton(host,"btnViewBfCP",635,10,120,30);$.btnViewBfCP.setText("사전CP보기");$.panInfo.addButtons(["btnLoad","btnDelete","btnTemp","btnSave"]);$.panContact.addButtons(["btnDelete","btnAdd"]);$.panCard.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.grdContact.setColumns([new FingerDataGridColumn("contact_id",95,"left","string","참석자ID",{readonly:true}),new FingerDataGridColumn("contact_name",90,"left","string","참석자",{readonly:true}),new FingerDataGridColumn("company_id",95,"left","string","소속ID",{readonly:true}),new FingerDataGridColumn("company_name",240,"left","string","소속",{readonly:true}),new FingerDataGridColumn("support_amt",100,"right","string","총 지원금액",{readonly:true,format:"int"}),new FingerDataGridColumn("cp_food_yn",70,"center","checkbox","식음료 유무",{readonly:true}),new FingerDataGridColumn("food_amt",90,"right","string","식음료비",{format:"int"}),new FingerDataGridColumn("cp_gift_yn",70,"center","checkbox","기념품 유무",{readonly:true}),new FingerDataGridColumn("gift_amt",90,"right","string","기념품비",{format:"int"}),new FingerDataGridColumn("cp_trans_yn",70,"center","checkbox","교통비 유무",{readonly:true}),new FingerDataGridColumn("trans_amt",90,"right","string","교통비",{format:"int"}),new FingerDataGridColumn("cp_stay_yn",70,"center","checkbox","숙박비 유무",{hidden:true}),new FingerDataGridColumn("stay_amt",90,"right","string","숙박비",{format:"int",hidden:true}),new FingerDataGridColumn("upload_yn",100,"center","string","동의서",{readonly:true}),new FingerDataGridColumn("file_path",120,"center","string","동의서 파일 경로",{hidden:true}),new FingerDataGridColumn("file_name",120,"center","string","동의서 파일명",{hidden:true})]);$.grdContact.init({panel:$.panContact,scroll:"xy"});$.grdContact.setEditable(true);$.grdContact.setBorder(false);$.grdCard.setColumns([new FingerDataGridColumn("APPRNO",99,"left","string","승인번호",{hidden:true}),new FingerDataGridColumn("APPDAT",110,"left","string","승인시간"),new FingerDataGridColumn("APPAMT",90,"right","string","승인금액",{format:"int"}),new FingerDataGridColumn("CARDNO",130,"left","string","카드번호"),new FingerDataGridColumn("EMPNO",80,"left","string","소유자"),new FingerDataGridColumn("VENKNM",120,"left","checkBox","가맹점"),new FingerDataGridColumn("VENADD",150,"left","checkBox","가맹점 주소"),new FingerDataGridColumn("VENGRP",150,"left","checkBox","업태")]);$.grdCard.init({scroll:"xy"});$.grdCard.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("seq",99,"left","string","연번",{hidden:true}),new FingerDataGridColumn("file_type",150,"left","string","자료유형"),new FingerDataGridColumn("server_path",99,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",99,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",425,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init();$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.rdoLect.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoAcademy.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoPrivateRoomYN.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoAgencyYN.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.rdoAgencyDocuYN.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);relocateChildIndexInPanel([$.panInfo]);initControl();setAllowBlank();$.imgGroup=new FingerImageGroup([$.imgPicture1,$.imgPicture2,$.imgPicture3,$.imgPicture4]);$.imgPicture1.setMode("N");$.imgPicture2.setMode("N");$.imgPicture3.setMode("N");$.imgPicture4.setMode("N");$.imgPicture1.setZooming(true,true,true);$.imgPicture2.setZooming(true,true,true);$.imgPicture3.setZooming(true,true,true);$.imgPicture4.setZooming(true,true,true);$.lblPlace.setVisible(false);$.memPlace.setVisible(false);$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);var session=g_main.session.obj;if(session.SystemDeveloper=="Y"||session.DeptCode==session.CPDeptCode){$.chkStayModify.setVisible(true);$.chkDateModify.setVisible(true)}else{$.chkStayModify.setVisible(false);$.chkDateModify.setVisible(false)}$.host=host;$.args=args};$.start=function(){$.panMain.add($.panInfo);$.panMain.add($.panContact);$.panMain.add($.panCard);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.memPreDescr);$.panMain.add($.memCPDescr);$.panInfo.add($.lblCPDocNo);$.panInfo.add($.lblTeamLeader);$.panInfo.add($.lblEmp);$.panInfo.add($.lblPM);$.panInfo.add($.lblGift);$.panInfo.add($.lblProduct);$.panInfo.add($.lblCPDate);$.panInfo.add($.lblSupportTotal);$.panInfo.add($.lblTheme);$.panInfo.add($.lblLect);$.panInfo.add($.lblAcademy);$.panInfo.add($.lblEnterEmp);$.panInfo.add($.lblPlace);$.panInfo.add($.lblAgenda);$.panInfo.add($.lblDesc);$.panInfo.add($.lblDesc2);$.panInfo.add($.lblChange);$.panInfo.add($.lblReportDate);$.panInfo.add($.txtCPDocNo);$.panInfo.add($.cmbTeamLeader);$.panInfo.add($.cmbEmp);$.panInfo.add($.cmbPM);$.panInfo.add($.cmbGift);$.panInfo.add($.cmbProduct);$.panInfo.add($.dteStart);$.panInfo.add($.dteEnd);$.panInfo.add($.cmbTheme);$.panInfo.add($.chkStayModify);$.panInfo.add($.chkDateModify);$.panInfo.add($.rdoLect);$.panInfo.add($.rdoAcademy);$.panInfo.add($.memEnterEmp);$.panInfo.add($.memPlace);$.panInfo.add($.memAgenda);$.panInfo.add($.memDesc);$.panInfo.add($.memChange);$.panInfo.add($.memDesc2);$.panInfo.add($.dteReportDate);$.panInfo.add($.cmbStatus);$.panInfo.add($.imgPicture1);$.panInfo.add($.imgPicture2);$.panInfo.add($.imgPicture3);$.panInfo.add($.imgPicture4);$.panInfo.add($.lblWave);$.panInfo.add($.speSupportTotal);$.panInfo.add($.cboFromHH);$.panInfo.add($.cboFromMM);$.panInfo.add($.cboToHH);$.panInfo.add($.cboToMM);$.panInfo.add($.lblColon1);$.panInfo.add($.lblColon2);$.panInfo.add($.txtMealPlace);$.panInfo.add($.lblMealPlace);$.panInfo.add($.lblSeminarPlace);$.panInfo.add($.txtSeminarPlace);$.panInfo.add($.lblPrivateRoomYN);$.panInfo.add($.lblAgencyYN);$.panInfo.add($.rdoPrivateRoomYN);$.panInfo.add($.rdoAgencyYN);$.panInfo.add($.lblAgencyDocuYN);$.panInfo.add($.rdoAgencyDocuYN);$.panInfo.add($.lblSupportTotal2);$.panInfo.add($.btnViewBfCP);$.panContact.add($.grdContact);$.panContact.add($.btnUpload);$.panContact.add($.btnView);$.panContact.add($.btnUploadList);$.panContact.add($.btnBatchUpload);$.panCard.add($.grdCard);$.panFile.add($.grdFile);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnMAConfirm);$.panBottom.add($.btnMACancel);$.cmbTeamLeader.setEmptyRow(true);$.cmbEmp.setEmptyRow(true);$.cmbPM.setEmptyRow(true);$.cmbProduct.setEmptyRow(true);$.cmbTheme.setEmptyRow(true);$.cmbGift.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbTeamLeader.setColumn("employee_id","emp_name");$.cmbEmp.setColumn("employee_id","emp_name");$.cmbPM.setColumn("employee_id","emp_name");$.cmbProduct.setColumn("product_code","product_name");$.cmbTheme.setColumn("theme_id","call_message");var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM0052|L_CRM192|L_CRM0258|L_CRM0084|L_CRM0259|L_CRM0111");setComboBind([$.cmbTeamLeader,$.cmbEmp,$.cmbPM,$.cmbGift,$.cmbProduct,$.cmbTheme,$.cmbStatus],ds);var ds=bizComponentData2($,"Q4","L_CRM0110","and extra_field1 LIKE '%CP02%' or extra_field1 = 'ALL'");$.grdFile.setColumnDropDownList("file_type",ds.resultList[0],null,true);var ds=bizComponentData2($,"Q1","L_COM017|L_COM018|L_COM017|L_COM018");setComboBind([$.cboFromHH,$.cboFromMM,$.cboToHH,$.cboToMM],ds);var ds2=bizComponentData2($,"Q1","L_CRM0219");$.grdCard.setColumnDropDownList("EMPNO",ds2.resultList[0],{key:"employee_id",name:"emp_name"});$.panBottom.setVisible(false);if($.p_argument){$.panBottom.setVisible(true);$.panInfo.disableButton(["btnLoad"]);var rs=$.p_argument[0][0];$.varCPId=rs.cp_id;$.varCPDocNo=rs.cp_doc_no;$.varCPDeptCode=rs.cp_dept_code;$.varCPBeforeId=rs.before_cp_id;$.varCPCode=rs.cp_code;$.varWFDocId=rs.wf_doc_id;$.txtCPDocNo.setValue(rs.cp_id);$.memChange.setValue(rs.change_desc);$.dteReportDate.setValue(rs.report_date);$.cmbTeamLeader.setValue(rs.team_leader);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbPM.setValue(rs.cp_emp_pm);$.dteStart.setValue(rs.cp_start_date);$.cboFromHH.setValue(rs.cp_start_date_hh);$.cboFromMM.setValue(rs.cp_start_date_mm);$.dteEnd.setValue(rs.cp_end_date);$.cboToHH.setValue(rs.cp_end_date_hh);$.cboToMM.setValue(rs.cp_end_date_mm);$.cmbProduct.setValue(rs.product_code);$.rdoAcademy.setValue(rs.academy_yn);$.cmbTheme.setValue(rs.report_theme);$.memEnterEmp.setValue(rs.cp_enter_emp);$.memAgenda.setValue(rs.agenda);$.memDesc.setValue(rs.cp_desc);$.memDesc2.setValue(rs.cp_desc2);$.txtSeminarPlace.setValue(rs.cp_place);$.txtMealPlace.setValue(rs.meal_place);$.speSupportTotal.setValue(rs.support_total);$.chkStayModify.setValue(rs.area_modify_yn);$.chkDateModify.setValue(rs.date_modify_yn);$.rdoLect.setValue(rs.lect_yn);$.memPreDescr.setValue(rs.PreDescr);$.cmbGift.setValue(rs.gift_buy);$.memCPDescr.setValue(rs.cp_descr);$.cmbStatus.setValue(rs.cp_status);$.rdoPrivateRoomYN.setValue(rs.private_room_yn);$.rdoAgencyYN.setValue(rs.agency_yn);$.rdoAgencyDocuYN.setValue(rs.agency_docu_yn);if(rs.cp_picture1){$.imgPicture1.setValue(rs.cp_picture1)}if(rs.cp_picture2){$.imgPicture2.setValue(rs.cp_picture2)}if(rs.cp_picture3){$.imgPicture3.setValue(rs.cp_picture3)}if(rs.cp_picture4){$.imgPicture4.setValue(rs.cp_picture4)}setDataGrid([$.grdContact],$.p_argument[1],true);setDataGrid([$.grdCard],$.p_argument[2],true);setDataGrid([$.grdFile],$.p_argument[3],true);if(rs.Confirm){$.btnConfirm.setVisible(true);$.btnCancel.setVisible(true);$.btnMemoSave.setVisible(true)}else{$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnMemoSave.setVisible(false)}if(rs.save_yn=="N"){$.panInfo.disableButton(["btnDelete","btnSave","btnTemp"]);$.panContact.disableButton(["btnDelete","btnAdd"]);$.panCard.disableButton(["btnDelete","btnAdd"]);$.panFile.disableButton(["btnDelete","btnAdd"]);$.btnUpload.setEnable(false);$.btnUploadList.setEnable(false);$.btnBatchUpload.setEnable(false);$.dteStart.setReadOnly(true);$.dteEnd.setReadOnly(true);$.cmbPM.setReadOnly(true);$.cmbGift.setReadOnly(true);$.cboFromHH.setReadOnly(true);$.cboFromMM.setReadOnly(true);$.cboToHH.setReadOnly(true);$.cboToMM.setReadOnly(true);$.memEnterEmp.setReadOnly(true);$.memAgenda.setReadOnly(true);$.memDesc.setReadOnly(true);$.memChange.setReadOnly(true);$.memDesc2.setReadOnly(true);$.txtMealPlace.setReadOnly(true);$.txtSeminarPlace.setReadOnly(true);$.rdoLect.setEnable(false);$.rdoAcademy.setEnable(false);$.rdoPrivateRoomYN.setEnable(false);$.rdoAgencyYN.setEnable(false);$.rdoAgencyDocuYN.setEnable(false);$.imgPicture1.setMode("R");$.imgPicture2.setMode("R");$.imgPicture3.setMode("R");$.imgPicture4.setMode("R")}else{$.panInfo.enableButton(["btnDelete","btnSave","btnTemp"]);$.panContact.enableButton(["btnDelete","btnAdd"]);$.panCard.enableButton(["btnDelete","btnAdd"]);$.panFile.enableButton(["btnDelete","btnAdd"]);if(!$.imgPicture1.getValue()){$.imgPicture1.setMode("N")}if(!$.imgPicture2.getValue()){$.imgPicture2.setMode("N")}if(!$.imgPicture3.getValue()){$.imgPicture3.setMode("N")}if(!$.imgPicture4.getValue()){$.imgPicture4.setMode("N")}if(g_main.session.obj.SalesEmpYN=="Y"&&rs.cp_status=="10"){$.panInfo.disableButton(["btnDelete","btnSave","btnTemp"]);$.panContact.disableButton(["btnDelete","btnAdd"]);$.panCard.disableButton(["btnDelete","btnAdd"]);$.panFile.disableButton(["btnDelete","btnAdd"])}}if(rs.cp_status=="05"&&g_main.session.obj.UserID==$.cmbTeamLeader.getValue()){$.panBottom.setVisible(true);$.btnConfirm.setEnable(true);$.btnConfirm.setVisible(true);$.memCPDescr.setReadOnly(true)}else{if(rs.cp_status=="10"){if(g_main.session.obj.UserID==$.cmbTeamLeader.getValue()){$.panBottom.setVisible(true);$.btnCancel.setVisible(true);$.btnCancel.setEnable(true)}else{$.btnConfirm.setEnable(true)}}else{if(rs.cp_status=="90"){var ds=bizComponentData2($,"Q1","L_CRM0219");setComboBind([$.cmbPM],ds);$.cmbPM.setValue(rs.cp_emp_pm);$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panInfo.disableButton(["btnTemp","btnDelete"]);$.btnUpload.setEnable(false);$.btnUploadList.setEnable(false);$.btnBatchUpload.setEnable(false);$.grdContact.setEditable(false);$.memPreDescr.setReadOnly(true);$.memCPDescr.setReadOnly(true);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}}if(g_main.session.obj.SalesEmpYN=="Y"){$.rdoLect.setEnable(false);$.rdoAgencyYN.setEnable(false)}}else{$.memPreDescr.setVisible(false);$.memCPDescr.setVisible(false)}};$.callback=function(type,ds){if(type=="CONTACT"){setDataGrid([$.grdContact],ds)}else{if(type=="N1"||type=="N2"||type=="NT"){$.varCPId=ds.returnStr;$.txtCPDocNo.setValue(ds.returnStr);if($.varCPId!=""){MessageBoxShow("정상적으로 저장되었습니다.")}else{var workType=($.varCPId?"UT":"NT");saveSeminar(workType);MessageBoxShow("오류가 발생했습니다. 관리자에게 문의하시기 바랍니다.")}}else{if(type=="U1"||type=="U2"||type=="UT"){MessageBoxShow("정상적으로 저장되었습니다.")}else{if(type=="D"){var share={save_mode:"DEL"};g_popupStack.setData(share);g_popupStack.close()}else{if(type=="CP_INFO"){$.varFormId=ds.resultList[0][0]["cp_form_id"];$.cp_name=ds.resultList[0][0]["cp_name"];$.varFormHeightSize=Number(ds.resultList[0][0]["form_height"]);$.varFormWidthSize=Number(ds.resultList[0][0]["form_width"]);var cpFormId=ds.resultList[0][0]["cp_form_id"];var cpProcName=ds.resultList[0][0]["query_name"];searchCPData(cpFormId,cpProcName)}else{if(type=="CP_DATA"){if(ds==null||ds.resultList[0].length<1){return}var param=ds.resultList;param[0][0].CallType="BUCall";param[0][0].Confirm=false;param[0][0].cp_descr=param.cp_desc;param[0][0].cp_status="90";param[0][0].save_yn="N";var popName=$.varFormId;var popHtml=popName+".html";g_main.openPopup(popHtml,popName,$.cp_name,$.varFormWidthSize,$.varFormHeightSize,"","",param,"","")}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnConfirm"){if($.cmbStatus.getValue()=="05"){var share={save_mode:"CPCONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if($.cmbStatus.getValue()=="10"){var share={save_mode:"CONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){if($.cmbStatus.getValue()=="10"){var share={save_mode:"CANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if($.cmbStatus.getValue()=="90"){var share={save_mode:"CPCANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}else{if(id=="btnViewBfCP"){if($.varCPBeforeId!=""){var sql="SELECT cp_type FROM crmCPMaster WHERE cp_id = '"+$.varCPBeforeId+"'";var ds=commExecuteSQL(sql);$.popUpCallId=id;var param="";$.varBfcpcode=ds.resultList[0][0].cp_type;searchCPInfo("FORM")}}else{if(id=="btnUpload"){if($.grdContact.getValue($.grdContact.getSelectedRowIdx(),"contact_id").substr(0,2)!="ka"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];$.grdContact.setValue($.grdContact.getSelectedRowIdx(),"file_path",ds.resultList[0][0].server_path);$.grdContact.setValue($.grdContact.getSelectedRowIdx(),"file_name",ds.resultList[0][0].server_fname);$.grdContact.setValue($.grdContact.getSelectedRowIdx(),"upload_yn","Y")})}}else{if(id=="btnView"){if($.grdContact.getValue($.grdContact.getSelectedRowIdx(),"upload_yn")=="Y"){g_fileBrowser.download(getServerFileUrl($.grdContact.getValue($.grdContact.getSelectedRowIdx(),"file_path")+$.grdContact.getValue($.grdContact.getSelectedRowIdx(),"file_name")))}}else{if(id=="btnUploadList"){$.grdContact.clear();$.popUpCallId=id;var param={};param.placeHolder="내용만 복사해서 붙여넣으세요.";param.cId=["contact_id","contact_name","food_amt","trans_amt"];g_main.openPopup("popPaste.html","popPaste","엑셀자료삽입",600,355,"","",param,"","")}else{if(id=="btnMAConfirm"){var share={save_mode:"MACONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMACancel"){var share={save_mode:"MACANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnBatchUpload"){if($.grdContact.getRowCount()<1){MessageBoxShow("고객이 추가 되어야 업로드가 가능합니다.");return}OpenPdfFileUploader("CPFiles",function(ds){hideToast();if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}if(ds.resultList[0]&&ds.resultList[0].length){var param="";$.popUpCallId="btnUpload";if(ds.resultList[0].length>1){var fileArray=ds.resultList[0];var imgUrlList=[],imgNameList=[];for(var i=0;i<fileArray.length;i++){imgUrlList.push(fileArray[i].file_url);imgNameList.push(fileArray[i].server_fname)}param={imgUrlList:imgUrlList,imgNameList:imgNameList,contactList:$.grdContact.getAllRows(),serverPath:fileArray[0].server_path}}else{var fileList=ds.resultList[0][0];param={imgUrlList:fileList.img_url_list,imgNameList:fileList.img_name_list,contactList:$.grdContact.getAllRows(),serverPath:fileList.server_path}}g_main.openPopup("popCPAgreementImgView.html","popCPAgreementImgView","",0,0,"","",param,"","")}})}}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdContact"){if(cInd=="food_amt"||cInd=="gift_amt"||cInd=="trans_amt"){$.grdContact.setValue(rId,"gift_amt",0);$.grdContact.setValue(rId,"support_amt",(Number($.grdContact.getValue(rId,"food_amt"))+Number($.grdContact.getValue(rId,"gift_amt"))+Number($.grdContact.getValue(rId,"trans_amt"))));calcSupportAmt();setSupportYN()}else{if(cInd=="contact_id"){}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnSave"){if(!$.varCPBeforeId){MessageBoxShow("사전 데이터가 없습니다.");return}if(!validateControls([$.cmbPM,$.cmbGift,$.dteStart,$.dteEnd,$.memEnterEmp,$.cboFromHH,$.cboFromMM,$.cboToHH,$.cboToMM,$.memAgenda,$.memDesc,$.memChange,$.txtMealPlace,$.txtSeminarPlace,$.rdoPrivateRoomYN,$.rdoAgencyYN,$.rdoAgencyDocuYN,$.rdoAcademy,$.rdoLect])){return}if(!gridValidator($.grdContact,"contact_id","company_id","support_amt")){return}var docuCheck=false;docuCheck=chkAggrementList();var fileRow=$.grdFile.getAllRows();if(fileRow.length>0){for(var i in fileRow){if(fileRow[i].file_type=="036"){docuCheck=true;break}}}calcSupportAmt();if(!chkContactList()){MessageBoxShow("중복입력 된 고객이 있습니다. 확인하시기 바랍니다.");return}if($.cboFromHH.getValue()=="00"||$.cboToHH.getValue()=="00"){MessageBoxShow("시각이 올바르게 설정되지 않았습니다.");return}if(docuCheck){if(g_main.session.obj.SalesEmpYN=="Y"){saveSeminar($.varCPId==""?"N1":"U1")}else{if(g_main.session.obj.SalesEmpYN=="N"){if(g_main.session.obj.DeptCode=="J120"){saveSeminar($.varCPId==""?"N1":"U1")}else{saveSeminar($.varCPId==""?"N2":"U2")}}}}else{MessageBoxShow("개인정보 활용동의서는 필수 첨부 파일입니다.");return}}else{if(btnId=="btnTemp"){if(!$.varCPBeforeId){MessageBoxShow("사전 데이터가 없습니다.");return}if(!validateControls([$.cmbPM,$.cmbGift,$.dteStart,$.dteEnd,$.memEnterEmp,$.cboFromHH,$.cboFromMM,$.cboToHH,$.cboToMM,$.memAgenda,$.memDesc,$.memChange,$.txtMealPlace,$.txtSeminarPlace,$.rdoPrivateRoomYN,$.rdoAgencyYN,$.rdoAgencyDocuYN,$.rdoAcademy,$.rdoLect])){return}if(!gridValidator($.grdContact,"contact_id","company_id","support_amt")){return}var docuCheck=false;docuCheck=chkAggrementList();var fileRow=$.grdFile.getAllRows();if(fileRow.length>0){for(var i in fileRow){if(fileRow[i].file_type=="036"){docuCheck=true;break}}}calcSupportAmt();if(docuCheck){var workType=($.varCPId==""?"NT":"UT");saveSeminar(workType)}else{MessageBoxShow("개인정보 활용동의서는 필수 첨부 파일입니다.");return}}else{if(btnId=="btnDelete"){confirmBoxShow("["+$.txtCPDocNo.getValue()+"] 자사제품설명회(사후)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveSeminar("D")}})}else{if(btnId=="btnLoad"){$.popUpCallId="btnLoad";var param={cp_type:"CP01",cp_case:"Query"};g_main.openPopup("popCPBefore.html","popCPBefore","",0,0,"","",param,"","")}}}}}else{if(panelId=="panContact"){if(btnId=="btnAdd"){$.popUpCallId="contact_btnAdd";var param={contact_name:"",check_yn:"Y"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){$.grdContact.deleteCurrentRow();calcSupportAmt()}}}else{if(panelId=="panCard"){if(btnId=="btnAdd"){$.popUpCallId="card_btnAdd";var param={};g_main.openPopup("popCardApprovalSub.html","popCardApprovalSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){$.grdCard.deleteCurrentRow()}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="contact_btnAdd"){var popRows=popResult.popRows;if($.grdContact.getRowCount()>0){var aRow=$.grdContact.getAllRows();for(var i in aRow){for(var j in popRows){if(aRow[i].contact_id==popRows[j].contact_id){MessageBoxShow("이미 추가된 참석자가 있습니다.");return}}}}for(var i in popRows){$.grdContact.addRow({contact_id:popRows[i].contact_id,contact_name:popRows[i].contact_name,company_id:popRows[i].company_id,company_name:popRows[i].company_name,cp_food_yn:"N",food_amt:0,cp_gift_yn:"N",gift_amt:0,cp_stay_yn:"N",stay_amt:0,cp_trans_yn:"N",trans_amt:0,support_amt:0,upload_yn:"N",file_path:" ",file_name:" "})}}}else{if(id=="popCPBefore"){if($.popUpCallId=="btnLoad"){var rs=popResult.rs;$.varCPDocNo=rs.cp_doc_no;$.varCPBeforeId=rs.cp_id;$.varCPDeptCode=rs.cp_dept_code;$.cmbTeamLeader.setValue(rs.team_leader);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbPM.setValue(rs.cp_emp_pm);$.cmbGift.setValue(rs.gift_buy);$.cmbProduct.setValue(rs.product_code);$.dteStart.setValue(rs.cp_start_date);$.dteEnd.setValue(rs.cp_end_date);$.cmbTheme.setValue(rs.report_theme);$.chkStayModify.setValue(rs.area_modify_yn);$.chkDateModify.setValue(rs.date_modify_yn);$.rdoLect.setValue(rs.lect_yn);$.rdoAcademy.setValue(rs.academy_yn);$.speSupportTotal.setValue(rs.support_total);$.txtMealPlace.setValue(rs.cp_place);$.txtSeminarPlace.setValue(rs.cp_place);$.dteReportDate.setValue(rs.report_date);$.rdoPrivateRoomYN.setValue(rs.private_room_yn);$.rdoAgencyYN.setValue(rs.agency_yn);if($.varCPBeforeId!=""){searchContact()}}}else{if(id=="popCardApprovalSub"){if($.popUpCallId=="card_btnAdd"){var rs=popResult;for(var i in rs){$.grdCard.addRow({APPRNO:rs[i].APPRNO,APPDAT:rs[i].APPDAT,APPAMT:rs[i].APPAMT,VENKNM:rs[i].VENKNM,CARDNO:rs[i].CARDNO,VENADD:rs[i].VENADD,VENGRP:rs[i].VENGRP,EMPNO:rs[i].EMPNUM})}}}else{if(id=="popPaste"){if($.popUpCallId=="btnUploadList"){if(popResult!=null){$.grdContact.addRows(popResult.paste);var rowCount=$.grdContact.getRowCount();$.grdContact.setDisplayPanelRowCount(rowCount)}}for(var i=0;i<$.grdContact.getRowCount();i++){$.grdContact.setValue(i,"gift_amt",0);$.grdContact.setValue(i,"upload_yn","N");$.grdContact.setValue(i,"file_path"," ");$.grdContact.setValue(i,"file_name"," ")}setSupportYN();getCompanyCode()}else{if(id=="popCPAgreementImgView"){webix.alert({ok:"확인",text:'동의서에 대한 의료인 연결이 완료 되었습니다.<br>실제 동의서는 "저장"시에 최종 저장됩니다.',width:"290px"});var dt=popResult.saveContactList;if(dt.length){for(var i=0;i<dt.length;i++){for(var j=0;j<$.grdContact.getRowCount();j++){var rowData=$.grdContact.getValue(j);if(dt[i].contactId==rowData.contact_id){$.grdContact.setValue(j,"file_path",dt[i].serverPath);$.grdContact.setValue(j,"file_name",dt[i].fileName);$.grdContact.setValue(j,"upload_yn","Y")}}}}}}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>