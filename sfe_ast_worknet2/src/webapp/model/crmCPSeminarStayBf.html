<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panInfo=null;$.panFile=null;$.panBottom=null;$.lblDocNo=null;$.lblEmp=null;$.lblPM=null;$.lblType=null;$.lblProduct=null;$.lblTheme=null;$.lblCPDate=null;$.lblWave=null;$.lblTerm=null;$.lblLectYn=null;$.lblPlace=null;$.lblStayPlace=null;$.lblAppDate=null;$.lblTarget=null;$.lblContact=null;$.lblContactOrgan=null;$.lblContactCnt=null;$.lblStay=null;$.lblStayOrgan=null;$.lblStayCnt=null;$.lblTrans=null;$.lblTransAmt=null;$.lblMeal=null;$.lblMealAmt=null;$.lblMemento=null;$.lblMementoAmt=null;$.lblRoom=null;$.lblRoom1Day=null;$.lblRoomContact=null;$.lblRoomCnt=null;$.lblSupport=null;$.lblSupportAmt=null;$.lblAgency=null;$.lblMementoQty=null;$.txtDocNo=null;$.cmbEmp=null;$.cmbPM=null;$.cmbStatus=null;$.cmbType=null;$.cmbProduct=null;$.cmbTheme=null;$.dteStart=null;$.dteEnd=null;$.speTerm=null;$.rdoLectYn=null;$.txtPlace=null;$.txtStayPlace=null;$.dteAppDate=null;$.memTarget=null;$.speContactOrgan=null;$.speContactCnt=null;$.speStayOrgan=null;$.speStayCnt=null;$.speTransAmt=null;$.speMealAmt=null;$.speMementoAmt=null;$.speRoomAmt=null;$.speRoomContact=null;$.speRoomCnt=null;$.speSupportAmt=null;$.txtAgency=null;$.speMementoQty=null;$.grdFile=null;$.btnConfirm=null;$.btnCancel=null;$.btnMemoSave=null;$.btnReportYnSave=null;$.btnSeminarCancel=null;$.memCPDescr=null;$.chkReportYN=null;$.lblLabel1=null;$.lblLabel2=null;$.lblLabel3=null;$.panList=null;$.grdList=null;$.cboFromHH=null;$.cboFromMM=null;$.cboToHH=null;$.cboToMM=null;$.lblcolon1=null;$.lblcolon2=null;$.btnMAConfirm=null;$.btnMACancel=null;$.btnLimitFree=null;$.txtcp_id=null;$.varCPId="";$.varPopupType="N";$.varModify="N";function createJSON_S(workType){var fRow=$.grdFile.getAllRows();var fSeq="",fFileType="",fServerPath="",fServerFname="",fLocalFname="";for(var i in fRow){fSeq+=(fSeq?"|":"")+Number(i)+1;fFileType+=(fFileType?"|":"")+fRow[i].file_type;fServerPath+=(fServerPath?"|":"")+fRow[i].server_path;fServerFname+=(fServerFname?"|":"")+fRow[i].server_fname;fLocalFname+=(fLocalFname?"|":"")+fRow[i].local_fname}var aRow=$.grdList.getAllRows();var contactId="",companyId="",supportDesc="",supportAmt="",cpFoodYn="",cpGiftYn="",cpStayYn="",cpTransYn="",cpLectureYn="";for(var i in aRow){contactId+=(contactId?"|":"")+aRow[i].contact_id;companyId+=(companyId?"|":"")+aRow[i].company_id;supportDesc+=(supportDesc?"|":"")+aRow[i].support_desc||"|";supportAmt+=(supportAmt?"|":"")+aRow[i].support_amt;cpFoodYn+=(cpFoodYn?"|":"")+(aRow[i].cp_food_yn=="Y"||aRow[i].cp_food_yn==true?"Y":"N");cpGiftYn+=(cpGiftYn?"|":"")+(aRow[i].cp_gift_yn=="Y"||aRow[i].cp_gift_yn==true?"Y":"N");cpStayYn+=(cpStayYn?"|":"")+(aRow[i].cp_stay_yn=="Y"||aRow[i].cp_stay_yn==true?"Y":"N");cpTransYn+=(cpTransYn?"|":"")+(aRow[i].cp_trans_yn=="Y"||aRow[i].cp_trans_yn==true?"Y":"N");cpLectureYn+=(cpLectureYn?"|":"")+(aRow[i].cp_lecture_yn=="Y"||aRow[i].cp_lecture_yn==true?"Y":"N")};var json=createExecuteParamInfo("P_crmCPSeminarStayBefore_S",[workType,$.varCPId,$.txtDocNo.getValue(),$.cmbEmp.getValue(),"#DeptCode#",$.cmbPM.getValue(),$.cmbProduct.getValue(),$.cmbTheme.getValue(),$.dteStart.getValue(),$.cboFromHH.getValue(),$.cboFromMM.getValue(),$.dteEnd.getValue(),$.cboToHH.getValue(),$.cboToMM.getValue(),$.speTerm.getValue(),$.txtPlace.getValue(),$.txtStayPlace.getValue(),$.memTarget.getValue(),$.speContactOrgan.getValue(),$.speContactCnt.getValue(),$.speStayOrgan.getValue(),$.speStayCnt.getValue(),$.speSupportAmt.getValue(),$.speTransAmt.getValue(),$.speMealAmt.getValue(),$.speMementoAmt.getValue(),$.speRoomAmt.getValue(),$.speRoomContact.getValue(),$.speRoomCnt.getValue(),$.cmbType.getValue(),$.txtAgency.getValue(),"",$.speMementoQty.getValue(),$.dteAppDate.getValue(),"",0,"CP21","#UserID#",$.rdoLectYn.getValue(),"Y",fFileType,fSeq,fServerPath,fServerFname,fLocalFname,"Y",contactId,companyId,supportDesc||"",supportAmt||0,cpFoodYn,cpGiftYn,cpStayYn,cpTransYn,cpLectureYn]);return json}function createJSON_S3(workType){var json=createExecuteParamInfo("P_crmCPExtraFunction_S",[workType,$.varCPId,$.chkReportYN.getValue(),"#UserID#"]);return json}function saveSeminar(workType){if(workType=="N"||workType=="U"||workType=="NT"||workType=="UT"){if($.grdFile.getRowCount<3){MessageBoxShow("파일유형 3가지는 필수 입니다.");return}if($.grdList.getRowCount()<=0){MessageBoxShow("참석자가없습니다.");return}var chk1="",chk2="",chk3="";var fRow=$.grdFile.getAllRows();for(var i in fRow){if(fRow[i].file_type=="019"){chk1="019"}else{if(fRow[i].file_type=="021"){chk2="021"}else{if(fRow[i].file_type=="023"){chk3="023"}}}if(chk1=="019"&&chk2=="021"&&chk3=="023"){break}}if(chk1!="019"){MessageBoxShow("심의비(수수료) 입금 확인증은 필수 첨부 파일 입니다.");return}else{if(chk2!="021"){MessageBoxShow("진행계획서(프로그램 및 세부계획서, 지출예산서 포함)은 필수 첨부 파일 입니다.");return}else{if(chk3!="023"){MessageBoxShow("대행사(Agency)지출계획서는 필수 첨부 파일 입니다.");return}}}}var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);if(ds){if(ds.errorCode=="MSG0002"){var rStr=ds.returnStr.split("|");$.varCPId=rStr[0];$.txtcp_id.setValue(rStr[0]);$.txtDocNo.setValue(rStr[1])}return true}else{return true}}}function saveExtraFunction(workType){var json=createJSON_S3(workType);if(json){var ds=callExecuteSync(["req",json],workType,$,false);if(ds){if(ds.errorCode=="MSG0004"){return true}}else{return true}}}function calcSupportAmt(){var transAmt=0,mealAmt=0,stayAmt=0;transAmt=$.speContactCnt.getValue()*$.speTransAmt.getValue();mealAmt=$.speContactCnt.getValue()*$.speMealAmt.getValue();stayAmt=$.speStayCnt.getValue()*$.speRoomAmt.getValue();mementoAmt=$.speContactCnt.getValue()*$.speMementoAmt.getValue();$.speSupportAmt.setValue(transAmt+mealAmt+stayAmt+mementoAmt)}function setControlEnable(bo){if(bo){$.panFile.enableButton(["btnAdd","btnDelete"]);$.panList.enableButton(["btnAdd","btnDelete"]);$.panInfo.enableButton(["btnSave","btnDelte"])}else{$.panFile.disableButton(["btnAdd","btnDelete"]);$.panList.disableButton(["btnAdd","btnDelete"]);$.panInfo.disableButton(["btnSave","btnDelte"])}$.dteStart.setEnable(bo);$.cboFromHH.setEnable(bo);$.cboFromMM.setEnable(bo);$.dteEnd.setEnable(bo);$.cboToHH.setEnable(bo);$.cboToMM.setEnable(bo);$.speTerm.setReadOnly(!bo);$.txtPlace.setReadOnly(!bo);$.speContactCnt.setReadOnly(!bo);$.cmbProduct.setEnable(bo);$.memTarget.setReadOnly(!bo);$.cmbTheme.setEnable(bo);$.cmbPM.setEnable(bo);$.cmbType.setEnable(bo);$.txtStayPlace.setReadOnly(!bo);$.speContactCnt.setReadOnly(!bo);$.speContactOrgan.setReadOnly(!bo);$.speStayCnt.setReadOnly(!bo);$.speStayOrgan.setReadOnly(!bo);$.speTransAmt.setReadOnly(!bo);$.speMealAmt.setReadOnly(!bo);$.speMementoAmt.setReadOnly(!bo);$.speRoomAmt.setReadOnly(!bo);$.speRoomCnt.setReadOnly(!bo);$.speRoomContact.setReadOnly(!bo);$.speSupportAmt.setReadOnly(!bo);$.txtAgency.setReadOnly(!bo);$.speMementoQty.setReadOnly(!bo);$.dteAppDate.setReadOnly(!bo)}function setAllowBlank(){$.cmbEmp.setAllowBlank(false,"담당자");$.cmbPM.setAllowBlank(false,"PM");$.cmbType.setAllowBlank(false,"구분");$.cmbProduct.setAllowBlank(false,"품목");$.dteStart.setAllowBlank(false,"계최시작일");$.dteEnd.setAllowBlank(false,"계최종료일");$.cboFromHH.setAllowBlank(false,"시작 시간");$.cboFromMM.setAllowBlank(false,"시작 시간");$.cboToHH.setAllowBlank(false,"종료 시간");$.cboToMM.setAllowBlank(false,"종료 시간");$.speTerm.setAllowBlank(false,"일간");$.txtPlace.setAllowBlank(false,"행사장소");$.txtStayPlace.setAllowBlank(false,"숙박장소");$.dteAppDate.setAllowBlank(false,"승인요청일");$.memTarget.setAllowBlank(false,"개최목적");$.speContactOrgan.setAllowBlank(false,"총 참가 기관수");$.speContactCnt.setAllowBlank(false,"총 참가 인원수");$.speStayOrgan.setAllowBlank(false,"숙박인원 기관수");$.speStayCnt.setAllowBlank(false,"숙박인원수");$.speTransAmt.setAllowBlank(false,"교통비(1인)");$.speMealAmt.setAllowBlank(false,"숙박비(1인)");$.speMementoAmt.setAllowBlank(false,"기념품(1인)");$.speRoomAmt.setAllowBlank(false,"숙박비");$.speRoomContact.setAllowBlank(false,"숙박인원");$.speRoomCnt.setAllowBlank(false,"숙박실 수");$.speSupportAmt.setAllowBlank(false,"지원총액")}function calcCPTerm(){var start_dt=extFormat($.dteStart.getText(),"yyyyMMdd").split("-");var end_dt=extFormat($.dteEnd.getText(),"yyyyMMdd").split("-");var today=getToday("-").split("-");start_dt[1]=(Number(start_dt[1])-1)+"";end_dt[1]=(Number(end_dt[1])-1)+"";today[1]=(Number(today[1])-1)+"";var from_dt=new Date(start_dt[0],start_dt[1],start_dt[2]);var to_dt=new Date(end_dt[0],end_dt[1],end_dt[2]);var to2_dt=new Date(today[0],today[1],today[2]);return{val1:(to_dt.getTime()-from_dt.getTime())/1000/60/60/24,val2:(from_dt.getTime()-to2_dt.getTime())/1000/60/60/24}}function openCPContact(id){$.popUpCallId=id;var param={contact_name:""};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}function calc_date(start,end){if(!start||!end||start.length!=8||end.length!=8){return}var dt1=new Date(start.substr(0,4),(start.substr(4,2)-1),start.substr(6,2));var dt2=new Date(end.substr(0,4),(end.substr(4,2)-1),end.substr(6,2));var btMs=dt2.getTime()-dt1.getTime();var btDay=btMs/(1000*60*60*24);return btDay}function initControl(){$.panInfo.clear();$.varCPId="";$.grdList.setData("");$.grdFile.setData("");setControlEnable(true);setAllowBlank();$.dteAppDate.setValue(getToday(""));$.dteStart.setValue(getToday(""));$.dteEnd.setValue(getToday(""));$.cmbEmp.setValue(g_main.session.obj.UserID);$.cmbStatus.setValue("10");$.rdoLectYn.setValue("Y");$.panInfo.enableButton(["btnSave","btnTemp"]);$.panInfo.disableButton(["btnDelete"]);$.panBottom.setVisible(false)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,950);$.panMain.setText("");$.panMain.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",0,0,1200,390);$.panInfo.setText("자사제품 설명회 숙박(사전)");$.panInfo.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,600,1200,200);$.panFile.setText("첨부파일");$.panFile.setBottomLine(true);$.panBottom=new FingerPanel(host,"panBottom",0,820,1200,110);$.panBottom.setText("");$.panBottom.setBottomLine(true);$.lblDocNo=new FingerLabel(host,"lblDocNo",0,10,100,20);$.lblDocNo.setText("문서번호");$.lblEmp=new FingerLabel(host,"lblEmp",360,10,100,20);$.lblEmp.setText("담당자");$.lblPM=new FingerLabel(host,"lblPM",720,10,100,20);$.lblPM.setText("PM");$.lblType=new FingerLabel(host,"lblType",0,40,100,20);$.lblType.setText("구분");$.lblProduct=new FingerLabel(host,"lblProduct",360,40,100,20);$.lblProduct.setText("품목");$.lblTheme=new FingerLabel(host,"lblTheme",720,40,100,20);$.lblTheme.setText("테마");$.lblCPDate=new FingerLabel(host,"lblCPDate",0,70,100,20);$.lblCPDate.setText("개최일시");$.lblWave=new FingerLabel(host,"lblWave",315,70,20,20);$.lblWave.setText("~");$.lblTerm=new FingerLabel(host,"lblTerm",610,70,40,20);$.lblTerm.setText("일간");$.lblLectYn=new FingerLabel(host,"lblLectYn",715,70,100,20);$.lblLectYn.setText("HCP 강연유무");$.lblPlace=new FingerLabel(host,"lblPlace",0,100,100,20);$.lblPlace.setText("행사장소");$.lblStayPlace=new FingerLabel(host,"lblStayPlace",360,100,100,20);$.lblStayPlace.setText("숙박장소");$.lblAppDate=new FingerLabel(host,"lblAppDate",720,100,100,20);$.lblAppDate.setText("승인요청일");$.lblTarget=new FingerLabel(host,"lblTarget",30,130,70,20);$.lblTarget.setText("개최목적(제품명)");$.lblContact=new FingerLabel(host,"lblContact",0,190,100,20);$.lblContact.setText("총 참가인원");$.lblContactOrgan=new FingerLabel(host,"lblContactOrgan",180,190,40,20);$.lblContactOrgan.setText("기관");$.lblContactCnt=new FingerLabel(host,"lblContactCnt",300,190,20,20);$.lblContactCnt.setText("명");$.lblStay=new FingerLabel(host,"lblStay",360,190,100,20);$.lblStay.setText("숙박인원수");$.lblStayOrgan=new FingerLabel(host,"lblStayOrgan",540,190,40,20);$.lblStayOrgan.setText("기관");$.lblStayCnt=new FingerLabel(host,"lblStayCnt",660,190,20,20);$.lblStayCnt.setText("명");$.lblTrans=new FingerLabel(host,"lblTrans",0,220,100,20);$.lblTrans.setText("교통비(1인)");$.lblTransAmt=new FingerLabel(host,"lblTransAmt",300,220,20,20);$.lblTransAmt.setText("원");$.lblMeal=new FingerLabel(host,"lblMeal",360,220,100,20);$.lblMeal.setText("식사비(1인)");$.lblMealAmt=new FingerLabel(host,"lblMealAmt",660,220,20,20);$.lblMealAmt.setText("원");$.lblMemento=new FingerLabel(host,"lblMemento",720,220,100,20);$.lblMemento.setText("기념품(1인)");$.lblMementoAmt=new FingerLabel(host,"lblMementoAmt",1020,220,20,20);$.lblMementoAmt.setText("원");$.lblRoom=new FingerLabel(host,"lblRoom",0,250,100,20);$.lblRoom.setText("숙박비");$.lblRoom1Day=new FingerLabel(host,"lblRoom1Day",200,250,45,20);$.lblRoom1Day.setText("원/박");$.lblRoomContact=new FingerLabel(host,"lblRoomContact",300,250,20,20);$.lblRoomContact.setText("인");$.lblRoomCnt=new FingerLabel(host,"lblRoomCnt",380,250,20,20);$.lblRoomCnt.setText("실");$.lblSupport=new FingerLabel(host,"lblSupport",720,250,100,20);$.lblSupport.setText("지원총액");$.lblSupportAmt=new FingerLabel(host,"lblSupportAmt",1020,250,20,20);$.lblSupportAmt.setText("원");$.lblAgency=new FingerLabel(host,"lblAgency",0,280,100,20);$.lblAgency.setText("대행사");$.lblMementoQty=new FingerLabel(host,"lblMementoQty",720,280,100,20);$.lblMementoQty.setText("답례품 수량");$.txtDocNo=new FingerEdit(host,"txtDocNo",310,10,10,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",465,10,200,20);$.cmbPM=new FingerComboBox(host,"cmbPM",825,10,160,20);$.cmbStatus=new FingerComboBox(host,"cmbStatus",1065,10,100,20);$.cmbType=new FingerComboBox(host,"cmbType",105,40,200,20);$.cmbProduct=new FingerComboBox(host,"cmbProduct",465,40,200,20);$.cmbTheme=new FingerComboBox(host,"cmbTheme",825,40,340,20);$.dteStart=new FingerDateEdit(host,"dteStart",105,70,100,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",340,70,100,20);$.speTerm=new FingerSpinEdit(host,"speTerm",575,70,40,20);$.rdoLectYn=new FingerRadioBox(host,"rdoLectYn",825,70,200,20);$.txtPlace=new FingerEdit(host,"txtPlace",105,100,200,20);$.txtStayPlace=new FingerEdit(host,"txtStayPlace",465,100,200,20);$.dteAppDate=new FingerDateEdit(host,"dteAppDate",825,100,100,20);$.memTarget=new FingerMemoEdit(host,"memTarget",105,130,555,50);$.speContactOrgan=new FingerSpinEdit(host,"speContactOrgan",105,190,80,20);$.speContactCnt=new FingerSpinEdit(host,"speContactCnt",225,190,80,20);$.speStayOrgan=new FingerSpinEdit(host,"speStayOrgan",465,190,80,20);$.speStayCnt=new FingerSpinEdit(host,"speStayCnt",585,190,80,20);$.speTransAmt=new FingerSpinEdit(host,"speTransAmt",105,220,200,20);$.speMealAmt=new FingerSpinEdit(host,"speMealAmt",465,220,200,20);$.speMementoAmt=new FingerSpinEdit(host,"speMementoAmt",825,220,200,20);$.speRoomAmt=new FingerSpinEdit(host,"speRoomAmt",105,250,100,20);$.speRoomContact=new FingerSpinEdit(host,"speRoomContact",245,250,60,20);$.speRoomCnt=new FingerSpinEdit(host,"speRoomCnt",325,250,60,20);$.speSupportAmt=new FingerSpinEdit(host,"speSupportAmt",825,250,200,20);$.txtAgency=new FingerEdit(host,"txtAgency",105,280,560,20);$.speMementoQty=new FingerSpinEdit(host,"speMementoQty",825,280,200,20);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,1200,155);$.btnConfirm=new FingerButton(host,"btnConfirm",10,5,120,40);$.btnConfirm.setText("승인");$.btnCancel=new FingerButton(host,"btnCancel",10,60,120,40);$.btnCancel.setText("승인취소");$.btnMemoSave=new FingerButton(host,"btnMemoSave",905,5,90,45);$.btnMemoSave.setText("메모저장");$.btnReportYnSave=new FingerButton(host,"btnReportYnSave",985,5,120,25);$.btnReportYnSave.setText("신고상태저장");$.btnSeminarCancel=new FingerButton(host,"btnSeminarCancel",985,75,120,25);$.btnSeminarCancel.setText("개최취소");$.memCPDescr=new FingerMemoEdit(host,"memCPDescr",120,825,770,90);$.chkReportYN=new FingerCheckBox(host,"chkReportYN",985,40,115,20);$.chkReportYN.setText("협회신고");$.lblLabel1=new FingerLabel(host,"lblLabel1",825,135,360,20);$.lblLabel1.setText("* 자사제품설명회(숙박) 개최 63일전까지");$.lblLabel2=new FingerLabel(host,"lblLabel2",835,155,240,20);$.lblLabel2.setText("신청서를 제출하여 주시기 바랍니다.");$.lblLabel3=new FingerLabel(host,"lblLabel3",835,175,240,20);$.lblLabel3.setText("현재 개최일로부터 0일전 입니다.");$.panList=new FingerPanel(host,"panList",0,395,1200,210);$.panList.setText("참석자");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,160);$.cboFromHH=new FingerComboBox(host,"cboFromHH",210,70,55,20);$.cboFromMM=new FingerComboBox(host,"cboFromMM",270,70,55,20);$.cboToHH=new FingerComboBox(host,"cboToHH",445,70,55,20);$.cboToMM=new FingerComboBox(host,"cboToMM",510,70,55,20);$.lblcolon1=new FingerLabel(host,"lblcolon1",250,70,20,20);$.lblcolon1.setText(":");$.lblcolon2=new FingerLabel(host,"lblcolon2",490,70,20,20);$.lblcolon2.setText(":");$.btnMAConfirm=new FingerButton(host,"btnMAConfirm",1095,5,120,45);$.btnMAConfirm.setText("MA승인");$.btnMACancel=new FingerButton(host,"btnMACancel",1095,55,120,45);$.btnMACancel.setText("MA승인취소");$.btnLimitFree=new FingerButton(host,"btnLimitFree",905,55,90,45);$.btnLimitFree.setText("기한해제");$.txtcp_id=new FingerEdit(host,"txtcp_id",105,10,200,20);$.panInfo.addButtons(["btnDelete","btnTemp","btnSave","btnNew"]);$.panList.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.grdList.setColumns([new FingerDataGridColumn("contact_id",99,"left","string","참석자ID",{readonly:true}),new FingerDataGridColumn("contact_name",100,"left","string","참석자",{readonly:true}),new FingerDataGridColumn("company_id",99,"left","string","소속ID",{readonly:true}),new FingerDataGridColumn("company_name",340,"left","string","소속",{readonly:true}),new FingerDataGridColumn("cp_food_yn",100,"center","checkbox","식음료"),new FingerDataGridColumn("cp_gift_yn",100,"center","checkbox","기념품"),new FingerDataGridColumn("cp_stay_yn",100,"center","checkbox","숙박비"),new FingerDataGridColumn("cp_trans_yn",100,"center","checkbox","교통비"),new FingerDataGridColumn("cp_lecture_yn",99,"center","checkbox","강연비",{hidden:true}),new FingerDataGridColumn("support_desc",99,"left","string","지원내역",{hidden:true}),new FingerDataGridColumn("support_amt",130,"right","string","지원금액",{format:"int"})]);$.grdList.init({panel:$.panList,isFilter:false});$.grdList.setEditable(true);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_type",300,"left","string","자료유형"),new FingerDataGridColumn("seq",99,"left","string","연번",{hidden:true}),new FingerDataGridColumn("server_path",99,"left","string","서버경로",{hidden:true}),new FingerDataGridColumn("server_fname",99,"left","string","서버파일명",{hidden:true}),new FingerDataGridColumn("local_fname",880,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]})]);$.grdFile.init({panel:$.panFile,scroll:"xy",isFilter:false,nonExcel:true});$.grdFile.setEditable(true);$.grdFile.setBorder(false);$.txtDocNo.setVisible(false);$.cmbEmp.setEnable(false);$.cmbStatus.setEnable(false);$.dteAppDate.setEnable(false);$.dteAppDate.setReadOnly(true);$.btnMAConfirm.setVisible(false);$.btnMACancel.setVisible(false);$.txtcp_id.setEnable(false);$.rdoLectYn.addButtons([{code_name:"있음",sub_code:"Y"},{code_name:"없음",sub_code:"N"}]);$.cmbEmp.setEmptyRow(true);$.cmbPM.setEmptyRow(true);$.cmbStatus.setEmptyRow(true);$.cmbType.setEmptyRow(true);$.cmbProduct.setEmptyRow(true);$.cmbTheme.setEmptyRow(true);$.lblLabel1.setAlign("left");$.lblLabel2.setAlign("left");$.lblLabel3.setAlign("left");setAllowBlank();$.rdoLectYn.setValue("Y");$.memCPDescr.setReadOnly(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panInfo);$.panMain.add($.panFile);$.panMain.add($.panBottom);$.panMain.add($.memCPDescr);$.panMain.add($.panList);$.panInfo.add($.lblDocNo);$.panInfo.add($.lblEmp);$.panInfo.add($.lblPM);$.panInfo.add($.lblType);$.panInfo.add($.lblProduct);$.panInfo.add($.lblTheme);$.panInfo.add($.lblCPDate);$.panInfo.add($.lblWave);$.panInfo.add($.lblTerm);$.panInfo.add($.lblLectYn);$.panInfo.add($.lblPlace);$.panInfo.add($.lblStayPlace);$.panInfo.add($.lblAppDate);$.panInfo.add($.lblTarget);$.panInfo.add($.lblContact);$.panInfo.add($.lblContactOrgan);$.panInfo.add($.lblContactCnt);$.panInfo.add($.lblStay);$.panInfo.add($.lblStayOrgan);$.panInfo.add($.lblStayCnt);$.panInfo.add($.lblTrans);$.panInfo.add($.lblTransAmt);$.panInfo.add($.lblMeal);$.panInfo.add($.lblMealAmt);$.panInfo.add($.lblMemento);$.panInfo.add($.lblMementoAmt);$.panInfo.add($.lblRoom);$.panInfo.add($.lblRoom1Day);$.panInfo.add($.lblRoomContact);$.panInfo.add($.lblRoomCnt);$.panInfo.add($.lblSupport);$.panInfo.add($.lblSupportAmt);$.panInfo.add($.lblAgency);$.panInfo.add($.lblMementoQty);$.panInfo.add($.txtDocNo);$.panInfo.add($.cmbEmp);$.panInfo.add($.cmbPM);$.panInfo.add($.cmbStatus);$.panInfo.add($.cmbType);$.panInfo.add($.cmbProduct);$.panInfo.add($.cmbTheme);$.panInfo.add($.dteStart);$.panInfo.add($.dteEnd);$.panInfo.add($.speTerm);$.panInfo.add($.rdoLectYn);$.panInfo.add($.txtPlace);$.panInfo.add($.txtStayPlace);$.panInfo.add($.dteAppDate);$.panInfo.add($.memTarget);$.panInfo.add($.speContactOrgan);$.panInfo.add($.speContactCnt);$.panInfo.add($.speStayOrgan);$.panInfo.add($.speStayCnt);$.panInfo.add($.speTransAmt);$.panInfo.add($.speMealAmt);$.panInfo.add($.speMementoAmt);$.panInfo.add($.speRoomAmt);$.panInfo.add($.speRoomContact);$.panInfo.add($.speRoomCnt);$.panInfo.add($.speSupportAmt);$.panInfo.add($.txtAgency);$.panInfo.add($.speMementoQty);$.panInfo.add($.lblLabel2);$.panInfo.add($.lblLabel3);$.panInfo.add($.lblLabel1);$.panInfo.add($.cboFromHH);$.panInfo.add($.cboFromMM);$.panInfo.add($.cboToHH);$.panInfo.add($.cboToMM);$.panInfo.add($.lblcolon1);$.panInfo.add($.lblcolon2);$.panInfo.add($.txtcp_id);$.panFile.add($.grdFile);$.panBottom.add($.btnConfirm);$.panBottom.add($.btnCancel);$.panBottom.add($.btnMemoSave);$.panBottom.add($.btnReportYnSave);$.panBottom.add($.btnSeminarCancel);$.panBottom.add($.chkReportYN);$.panBottom.add($.btnMAConfirm);$.panBottom.add($.btnMACancel);$.panBottom.add($.btnLimitFree);$.panList.add($.grdList);$.cmbEmp.setColumn("employee_id","emp_name");$.cmbPM.setColumn("employee_id","emp_name");$.cmbProduct.setColumn("product_code","product_name");var ds=bizComponentData2($,"Q1","L_CRM0052|L_CRM192|L_CRM0111|L_CRM0161|L_CRM0131");setComboBind([$.cmbEmp,$.cmbPM,$.cmbStatus,$.cmbType,$.cmbProduct],ds);$.cmbEmp.setValue(g_main.session.obj.UserID);$.cmbStatus.setValue("10");var ds=bizComponentData2($,"Q4","L_CRM0110"," and extra_field1 LIKE '%CP21%' or extra_field1 = 'ALL'");$.grdFile.setColumnDropDownList("file_type",ds.resultList[0],null,true);var ds=bizComponentData2($,"Q1","L_COM017|L_COM018|L_COM017|L_COM018");setComboBind([$.cboFromHH,$.cboFromMM,$.cboToHH,$.cboToMM],ds);$.panBottom.setVisible(false);var userId=g_main.session.obj.EmpCode;if($.p_argument&&$.p_argument.length>0){var rs=$.p_argument[0][0];$.varCPId=rs.cp_id;$.varPopupType="Y";$.varModify=rs.modify_yn;$.txtcp_id.setValue(rs.cp_id);$.txtDocNo.setValue(rs.cp_doc_no);$.cmbEmp.setValue(rs.cp_emp_id);$.cmbPM.setValue(rs.cp_emp_pm);$.cmbStatus.setValue(rs.cp_status);$.cmbType.setValue(rs.seminar_type);$.cmbProduct.setValue(rs.product_code);if(rs.report_theme!=""){var ds=bizComponentData2($,"Q3","L_CRM0107",rs.product_code);setComboBind([$.cmbTheme],ds);$.cmbTheme.setValue(rs.report_theme)}$.dteStart.setValue(rs.cp_start_date);$.cboFromHH.setValue(rs.cp_start_date_hh);$.cboFromMM.setValue(rs.cp_start_date_mm);$.dteEnd.setValue(rs.cp_end_date);$.cboToHH.setValue(rs.cp_end_date_hh);$.cboToMM.setValue(rs.cp_end_date_mm);$.speTerm.setValue(rs.seminar_term);$.rdoLectYn.setValue(rs.lect_yn);$.txtPlace.setValue(rs.cp_place);$.txtStayPlace.setValue(rs.cp_stay_place);$.dteAppDate.setValue(rs.app_date);$.memTarget.setValue(rs.open_target);$.speContactOrgan.setValue(rs.contact_organ_cnt);$.speContactCnt.setValue(rs.contact_cnt);$.speStayOrgan.setValue(rs.stay_organ_cnt);$.speStayCnt.setValue(rs.stay_cnt);$.speTransAmt.setValue(rs.trans_cost_each_amt);$.speMealAmt.setValue(rs.meal_each_amt);$.speMementoAmt.setValue(rs.memento_each_amt);$.speRoomAmt.setValue(rs.room_1day_amt);$.speRoomContact.setValue(rs.room_contact_cnt);$.speRoomCnt.setValue(rs.room_cnt);$.speSupportAmt.setValue(rs.support_total);$.txtAgency.setValue(rs.agency);$.speMementoQty.setValue(rs.memento_qty);$.memCPDescr.setValue(rs.cp_descr);$.chkReportYN.setValue(rs.report_yn);if(rs.Confirm){$.panBottom.setVisible(true);$.memCPDescr.setReadOnly(false)}else{$.panBottom.setVisible(false)}if(rs.save_yn=="N"){setControlEnable(false);$.panInfo.disableButton(["btnDelete","btnSave"]);$.panList.disableButton(["btnAdd","btnDelete"])}else{setControlEnable(true);$.panInfo.enableButton(["btnDelete","btnSave"]);$.panList.enableButton(["btnAdd","btnDelete"])}setDataGrid([$.grdFile],$.p_argument[1],true);setDataGrid([$.grdList],$.p_argument[2],true);if(rs.cp_status=="10"){$.btnConfirm.setEnable(true)}else{if(rs.cp_status=="90"){$.btnConfirm.setEnable(false);$.btnCancel.setEnable(true);$.panInfo.disableButton(["btnTemp"]);$.grdList.setEditable(false);if(g_main.session.getValue("EmpCode")=="ka951012"){$.panBottom.setVisible(true);$.btnConfirm.setVisible(false);$.btnCancel.setVisible(false);$.btnLimitFree.setVisible(false);$.btnReportYnSave.setVisible(false);$.btnSeminarCancel.setVisible(false);$.chkReportYN.setVisible(false);$.btnMemoSave.setVisible(false);$.btnMAConfirm.setVisible(true);$.btnMACancel.setVisible(true)}}}var value=calcCPTerm();$.speTerm.setValue(value.val1+1);$.lblLabel3.setText("현재 개최일로부터 "+value.val2+"일 전입니다.");$.memCPDescr.setVisible(true)}else{initControl();$.memCPDescr.setVisible(false)}};$.callback=function(type,ds){};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnFileDown"){var rId=$.grdFile.getSelectedRowIdx();var download_url=("/ServerFiles/CPFiles/"+$.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"));g_fileBrowser.download(download_url)}else{if(id=="btnConfirm"){var share={save_mode:"CONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnCancel"){var share={save_mode:"CANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMemoSave"){var share={save_mode:"MEMO",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnReportYnSave"){if(saveExtraFunction("REPORT")){MessageBoxShow("정상적으로 저장되었습니다.");return}}else{if(id=="btnSeminarCancel"){confirmBoxShow("개최취소 처리하시겠습니까?",function(){if(g_main.msgShare==true){if(saveExtraFunction("CANCEL")){MessageBoxShow("정상적으로 저장되었습니다.");return}}})}else{if(id=="btnLimitFree"){confirmBoxShow("입력 기한을 해제하시겠습니까?",function(){if(g_main.msgShare==true){if(saveExtraFunction("LimitFree")){MessageBoxShow("해제되었습니다.")}}})}else{if(id=="btnMAConfirm"){var share={save_mode:"MACONFIRM",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}else{if(id=="btnMACancel"){var share={save_mode:"MACANCEL",cp_descr:$.memCPDescr.getValue()};g_popupStack.setData(share);g_popupStack.close()}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbProduct"){$.cmbTheme.clear();if(value==""){return}var ds=bizComponentData2($,"Q3","L_CRM0107",value);setComboBind([$.cmbTheme],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){if(id=="dteStart"||id=="dteEnd"){if($.dteStart.getValue()==""||$.dteEnd.getValue()==""){return}if($.dteStart.getValue()>$.dteEnd.getValue()){MessageBoxShow("개최 종료일이 시작일 보다 빠를 수 없습니다.");if(id=="dteStart"){$.dteEnd.setValue(value)}else{$.dteStart.setValue(value)}return}var value=calcCPTerm();$.speTerm.setValue(value.val1+1);$.lblLabel3.setText("현재 개최일로부터 "+value.val2+"일 전입니다.")}};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){if(id=="speContactCnt"||id=="speStayCnt"||id=="speTransAmt"||id=="speMealAmt"||id=="speRoomAmt"||id=="speMementoAmt"){calcSupportAmt()}};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnNew"){initControl()}else{if(btnId=="btnSave"){if(!validateControls([$.cmbEmp,$.cmbPM,$.cmbType,$.cmbProduct,$.dteStart,$.dteEnd,$.speTerm,$.txtPlace,$.txtStayPlace,$.dteAppDate,$.memTarget,$.speContactOrgan,$.speContactCnt,$.speStayOrgan,$.speStayCnt,$.speTransAmt,$.speMealAmt,$.speRoomAmt,$.speRoomContact,$.speRoomCnt,$.speSupportAmt])){return}var dt1=getToday("");var dt2=$.dteStart.getValue();var dt3=$.dteEnd.getValue();var dt4=calc_date(dt1,dt2);var dt5=calc_date(dt2,dt3);if($.varModify=="Y"){if(saveSeminar($.varCPId!=""?"U":"N")){MessageBoxShow("정상적으로 저장되었습니다.");return}else{MessageBoxShow("저장 시 오류가 발생하였습니다.");return}}else{if($.varModify=="N"){if(dt5<0){MessageBoxShow("개최기간을 올바르게 설정하시기 바랍니다.");return}if(dt4<63){MessageBoxShow("개최일로부터 63일 이내에만 신청가능합니다.");return}if(saveSeminar($.varCPId!=""?"U":"N")){MessageBoxShow("정상적으로 저장되었습니다.");return}else{MessageBoxShow("저장 시 오류가 발생하였습니다.");return}}}}else{if(btnId=="btnTemp"){if(!validateControls([$.cmbEmp,$.cmbPM,$.cmbType,$.cmbProduct,$.dteStart,$.dteEnd,$.speTerm,$.txtPlace,$.txtStayPlace,$.dteAppDate,$.memTarget,$.speContactOrgan,$.speContactCnt,$.speStayOrgan,$.speStayCnt,$.speTransAmt,$.speMealAmt,$.speRoomAmt,$.speRoomContact,$.speRoomCnt,$.speSupportAmt])){return}var dt1=getToday("");var dt2=$.dteStart.getValue();var dt3=$.dteEnd.getValue();var dt4=calc_date(dt1,dt2);var dt5=calc_date(dt2,dt3);if(dt5<0){MessageBoxShow("개최기간을 올바르게 설정하시기 바랍니다.");return}if(dt4<63){MessageBoxShow("개최일로부터 63일 이내에만 신청가능합니다.");return}if(saveSeminar($.varCPId!=""?"UT":"NT")){MessageBoxShow("정상적으로 저장되었습니다.");return}}else{if(btnId=="btnDelete"){if($.varCPId==""){return}confirmBoxShow("["+$.txtcp_id.getValue()+"] 자사제품설명회 숙박(사전)을(를) 삭제하시겠습니까?",function(){if(g_main.msgShare==true){if(saveSeminar("D")){g_popupStack.close()}}})}}}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("CPFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){fileList[i].file_type="";for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panList"){if(btnId=="btnAdd"){$.popUpCallId="btnAdd";var param={contact_name:"",check_yn:"Y"};g_main.openPopup("popCPContact.html","popCPContact","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){$.grdList.deleteCurrentRow()}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCPContact"){if($.popUpCallId=="btnAdd"){var popRows=popResult.popRows;if($.grdList.getRowCount()>0){var aRow=$.grdList.getAllRows();for(var i in aRow){for(var j in popRows){if(aRow[i].contact_id==popRows[j].contact_id){MessageBoxShow("해당 참석자는 이미 추가되어 있습니다.");return}}}}for(var i in popRows){if(popRows[i].contact_id.substr(0,2)=="ka"){MessageBoxShow("자사직원 등록은 자사제품설명회 숙박(사후)에서만 가능합니다.");continue}$.grdList.addRow({contact_id:popRows[i].contact_id,contact_name:popRows[i].contact_name,company_id:popRows[i].company_id,company_name:popRows[i].company_name,cp_food_yn:"N",cp_gift_yn:"N",cp_stay_yn:"N",cp_trans_yn:"N",cp_lecture_yn:"N",support_desc:"",support_amt:0})}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>