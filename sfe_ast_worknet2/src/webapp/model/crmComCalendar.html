<script>function Main(){var $=this;$.host=null;$.panMain=null;$.scheYear=null;$.lblC1=null;$.lblC2=null;$.lblC3=null;$.lblC4=null;$.lblC5=null;$.panType=null;$.lblC6=null;$.chkType1=null;$.chkType2=null;$.chkType3=null;$.chkType4=null;$.chkType5=null;$.chkType6=null;$.btnDown=null;$.calStart="";$.calEnd="";$.evnetKey="";function createJSON_Q(workType){var type=[];if($.chkType1.getValue()=="Y"){type.push("10")}if($.chkType2.getValue()=="Y"){type.push("20")}if($.chkType3.getValue()=="Y"){type.push("30")}if($.chkType4.getValue()=="Y"){type.push("40")}if($.chkType5.getValue()=="Y"){type.push("50")}if($.chkType6.getValue()=="Y"){type.push("60")}var sType="";for(var i=0;i<type.length;i++){sType+=((sType!=""?",":"")+type[i])}var json=createExecuteParamInfo("P_crmCalendarManage_Q",[workType,"",sType,$.calStart||"",$.calEnd||""]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmCalendarManage_S",[workType,$.eventKey||"","","","","","#UserID#"]);return json}function searchCalendar(){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$,false)}function saveCalendar(){if($.eventKey==""){return}var json=createJSON_S("D");var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0001"){$.eventKey="";searchCalendar()}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1000);$.panMain.setText("");$.panMain.setBottomLine(false);$.scheYear=new FingerScheduler(host,"scheYear","workweek",["30"],[],0,55,1200,1350);$.lblC1=new FingerLabel(host,"lblC1",85,13,15,15);$.lblC1.setText("");$.lblC2=new FingerLabel(host,"lblC2",248,13,15,15);$.lblC2.setText("");$.lblC3=new FingerLabel(host,"lblC3",358,13,15,15);$.lblC3.setText("");$.lblC4=new FingerLabel(host,"lblC4",445,13,15,15);$.lblC4.setText("");$.lblC5=new FingerLabel(host,"lblC5",553,13,15,15);$.lblC5.setText("");$.panType=new FingerPanel(host,"panType",260,0,680,40);$.panType.setText("");$.panType.setBottomLine(true);$.lblC6=new FingerLabel(host,"lblC6",647,13,15,15);$.lblC6.setText("");$.chkType1=new FingerCheckBox(host,"chkType1",10,10,70,20);$.chkType1.setText("연간일정");$.chkType2=new FingerCheckBox(host,"chkType2",130,10,115,20);$.chkType2.setText("전사휴가/공휴일");$.chkType3=new FingerCheckBox(host,"chkType3",295,10,55,20);$.chkType3.setText("비뇨기");$.chkType4=new FingerCheckBox(host,"chkType4",405,10,45,20);$.chkType4.setText("SI");$.chkType5=new FingerCheckBox(host,"chkType5",490,10,55,20);$.chkType5.setText("개업의");$.chkType6=new FingerCheckBox(host,"chkType6",595,10,70,20);$.chkType6.setText("면역");$.btnDown=new FingerButton(host,"btnDown",1075,11,140,20);$.btnDown.setText("일정내보내기");$.varCalType="";$.panType.setBorder(true);$.lblC1.setStyle("backgroundColor",fingerSchedulerColors.CM10);$.lblC2.setStyle("backgroundColor",fingerSchedulerColors.CM20);$.lblC3.setStyle("backgroundColor",fingerSchedulerColors.CM30);$.lblC4.setStyle("backgroundColor",fingerSchedulerColors.CM40);$.lblC5.setStyle("backgroundColor",fingerSchedulerColors.CM50);$.lblC6.setStyle("backgroundColor",fingerSchedulerColors.CM60);$.chkType1.setValue("Y");$.chkType2.setValue("Y");$.chkType3.setValue("Y");$.chkType4.setValue("Y");$.chkType5.setValue("Y");$.chkType6.setValue("Y");$.host=host;$.args=args};$.start=function(){$.panMain.add($.scheYear);$.panMain.add($.panType);$.panMain.add($.btnDown);$.panType.add($.lblC1);$.panType.add($.lblC2);$.panType.add($.lblC3);$.panType.add($.lblC4);$.panType.add($.lblC5);$.panType.add($.lblC6);$.panType.add($.chkType1);$.panType.add($.chkType2);$.panType.add($.chkType3);$.panType.add($.chkType4);$.panType.add($.chkType5);$.panType.add($.chkType6)};$.callback=function(type,ds){if(type=="Q"){$.scheYear.removeEvents();$.scheYear.addEventSource(ds.resultList[0]);$.varEvents=ds.resultList[0]}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnDown"){var params={};params.events=$.varEvents;g_main.openPopup("popExportSchedule.html","popExportSchedule","일정내보내기",720,155,"","",params,"","")}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){searchCalendar()};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popSaveSchedule"){if($.popUpCallId=="saveCalendar"||$.popUpCallId=="btnUpdate"){$.eventKey="";searchCalendar()}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){if(id=="scheYear"){$.scheYear.showModButton(false);$.calendarDate=event_object.date;if(!event_object.data){return}$.eventKey=event_object.data.seq;var deptCode=g_main.session.getValue("DeptCode");var userId=g_main.session.getValue("UserID");if(deptCode=="A110"||deptCode=="A120"||deptCode=="F510"||deptCode=="F520"||deptCode=="J110"||g_main.session.obj.SystemDeveloper=="Y"){$.scheYear.showModButton(true)}else{$.scheYear.showModButton(false)}}};$.fingerscheduler_ready=function(id){if(id=="scheYear"){var deptCode=g_main.session.getValue("DeptCode");var userId=g_main.session.getValue("UserID");log(deptCode);if(deptCode=="A110"||deptCode=="A120"||deptCode=="F510"||deptCode=="F520"||deptCode=="J110"||g_main.session.obj.SystemDeveloper=="Y"){$.scheYear.showRegButton(true)}else{$.scheYear.showRegButton(false)}$.calStart=JSON.stringify($.scheYear.extObj.fullCalendar("getView").start).substr(1,10);$.calEnd=JSON.stringify($.scheYear.extObj.fullCalendar("getView").end).substr(1,10);searchCalendar()}};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){if(id=="scheYear"){}};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){if(id=="scheYear"){if(obj.action=="reg"){$.popUpCallId="saveCalendar";var param={save_type:"N",event_key:"",date:$.calendarDate||""};g_main.openPopup("popSaveSchedule.html","popSaveSchedule","일정 등록",350,270,"","",param,"","")}else{if(obj.action=="mod"){$.popUpCallId="btnUpdate";var param={save_type:"U",event_key:$.eventKey,date:$.calendarDate||""};g_main.openPopup("popSaveSchedule.html","popSaveSchedule","연간일정 수정",350,270,"","",param,"","")}else{if(obj.action=="rem"){confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare==true){saveCalendar()}})}}}}};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>