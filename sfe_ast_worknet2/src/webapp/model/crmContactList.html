<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panInfo=null;$.panDetail=null;$.tabDetail=null;$.panTab1=null;$.panTab2=null;$.grdList=null;$.lblQName=null;$.lblQRegion=null;$.lblQEmp=null;$.txtQName=null;$.txtQRegion=null;$.cmbQDept=null;$.cmbQEmp=null;$.btnCRM=null;$.btnSearch=null;$.lblDId=null;$.lblDName=null;$.lblDAddress=null;$.lblDMain=null;$.lblDTel=null;$.txtDId=null;$.txtDName=null;$.txtDZipCode=null;$.txtDAddress1=null;$.txtDAddress2=null;$.txtDMain=null;$.txtDTel=null;$.grdDetail1=null;$.grdDetail2=null;$.lblQCompanyName=null;$.txtQCompanyName=null;$.cmbQSP=null;$.lblDGender=null;$.lblDType=null;$.lblDCompanyName=null;$.lblDPosition=null;$.lblDSchool=null;$.lblDDesc=null;$.txtDGender=null;$.txtDType=null;$.txtDCompanyName=null;$.txtDSchool=null;$.txtDDesc=null;$.txtDPostion=null;$.lblDZipCod=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmContactList_Q",[workType,(workType=="Q"||workType=="C"?"":$.txtDId.getValue())||"",$.txtQName.getValue()||"",$.txtQCompanyName.getValue()||"",$.txtQRegion.getValue()||"",$.cmbQDept.getValue()||"",$.cmbQEmp.getValue()||"",$.cmbQSP.getValue()||""]);return json}function searchList(workType){var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,810);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,650,800);$.panQuery.setText("고객 리스트");$.panQuery.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",660,0,540,305);$.panInfo.setText("고객 정보");$.panInfo.setBottomLine(true);$.panDetail=new FingerPanel(host,"panDetail",660,315,540,485);$.panDetail.setText("연관 정보");$.panDetail.setBottomLine(true);$.tabDetail=new FingerTab(host,"tabDetail",0,0,540,440);$.panTab1=new FingerPanel(host,"panTab1",0,0,540,205);$.panTab1.setText("");$.panTab1.setBottomLine(true);$.panTab2=new FingerPanel(host,"panTab2",0,0,540,205);$.panTab2.setText("");$.panTab2.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,140,650,615);$.lblQName=new FingerLabel(host,"lblQName",0,10,100,20);$.lblQName.setText("고객명");$.lblQRegion=new FingerLabel(host,"lblQRegion",0,70,100,20);$.lblQRegion.setText("지역명");$.lblQEmp=new FingerLabel(host,"lblQEmp",0,100,100,20);$.lblQEmp.setText("담당자");$.txtQName=new FingerEdit(host,"txtQName",105,10,100,20);$.txtQRegion=new FingerEdit(host,"txtQRegion",105,70,280,20);$.cmbQDept=new FingerComboBox(host,"cmbQDept",105,100,180,20);$.cmbQEmp=new FingerComboBox(host,"cmbQEmp",290,100,95,20);$.btnCRM=new FingerButton(host,"btnCRM",465,100,120,20);$.btnCRM.setText("CRM고객");$.btnSearch=new FingerButton(host,"btnSearch",570,100,80,20);$.btnSearch.setText("조회");$.lblDId=new FingerLabel(host,"lblDId",10,10,100,20);$.lblDId.setText("고객코드");$.lblDName=new FingerLabel(host,"lblDName",280,10,100,20);$.lblDName.setText("고객명");$.lblDAddress=new FingerLabel(host,"lblDAddress",10,160,100,20);$.lblDAddress.setText("주소");$.lblDMain=new FingerLabel(host,"lblDMain",280,70,100,20);$.lblDMain.setText("진료과목");$.lblDTel=new FingerLabel(host,"lblDTel",270,100,110,20);$.lblDTel.setText("회사전화번호");$.txtDId=new FingerEdit(host,"txtDId",115,10,140,20);$.txtDName=new FingerEdit(host,"txtDName",385,10,140,20);$.txtDZipCode=new FingerEdit(host,"txtDZipCode",115,130,140,20);$.txtDAddress1=new FingerEdit(host,"txtDAddress1",115,160,410,20);$.txtDAddress2=new FingerEdit(host,"txtDAddress2",115,190,410,20);$.txtDMain=new FingerEdit(host,"txtDMain",385,70,140,20);$.txtDTel=new FingerEdit(host,"txtDTel",385,100,140,20);$.grdDetail1=new FingerDataGrid(host,"grdDetail1",0,0,540,410);$.grdDetail2=new FingerDataGrid(host,"grdDetail2",0,0,540,410);$.lblQCompanyName=new FingerLabel(host,"lblQCompanyName",0,40,100,20);$.lblQCompanyName.setText("병원명");$.txtQCompanyName=new FingerEdit(host,"txtQCompanyName",105,40,280,20);$.cmbQSP=new FingerComboBox(host,"cmbQSP",210,10,175,20);$.lblDGender=new FingerLabel(host,"lblDGender",10,40,100,20);$.lblDGender.setText("성별");$.lblDType=new FingerLabel(host,"lblDType",280,40,100,20);$.lblDType.setText("구분");$.lblDCompanyName=new FingerLabel(host,"lblDCompanyName",10,70,100,20);$.lblDCompanyName.setText("병원명");$.lblDPosition=new FingerLabel(host,"lblDPosition",10,100,100,20);$.lblDPosition.setText("직위");$.lblDSchool=new FingerLabel(host,"lblDSchool",10,220,100,20);$.lblDSchool.setText("출신학교");$.lblDDesc=new FingerLabel(host,"lblDDesc",280,220,100,20);$.lblDDesc.setText("비고");$.txtDGender=new FingerEdit(host,"txtDGender",115,40,140,20);$.txtDType=new FingerEdit(host,"txtDType",385,40,140,20);$.txtDCompanyName=new FingerEdit(host,"txtDCompanyName",115,70,140,20);$.txtDSchool=new FingerEdit(host,"txtDSchool",115,220,140,20);$.txtDDesc=new FingerEdit(host,"txtDDesc",385,220,140,20);$.txtDPostion=new FingerEdit(host,"txtDPostion",115,100,140,20);$.lblDZipCod=new FingerLabel(host,"lblDZipCod",10,130,100,20);$.lblDZipCod.setText("우편번호");$.panQuery.setBorder(true);$.grdList.setColumns([new FingerDataGridColumn("contact_id",0,"left","string","고객아이디",{hidden:false}),new FingerDataGridColumn("contact_name",90,"left","string","고객명"),new FingerDataGridColumn("contact_name_eng",99,"left","string","영문고객명",{hidden:true}),new FingerDataGridColumn("contact_pic",99,"left","string","고객사진",{hidden:true}),new FingerDataGridColumn("company_id",0,"left","string","거래처아이디",{hidden:false}),new FingerDataGridColumn("company_name",150,"left","string","병원"),new FingerDataGridColumn("channel",80,"left","string","채널"),new FingerDataGridColumn("ind_sp",100,"left","string","진료과목"),new FingerDataGridColumn("ind_title",100,"left","string","직위"),new FingerDataGridColumn("zip_code",99,"left","string","우편번호",{hidden:true}),new FingerDataGridColumn("address1",99,"left","string","주소1",{hidden:true}),new FingerDataGridColumn("address2",99,"left","string","주소2",{hidden:true}),new FingerDataGridColumn("mobile_phone",99,"left","string","핸드폰번호",{hidden:true}),new FingerDataGridColumn("home_phone",99,"left","string","집전화번호",{hidden:true}),new FingerDataGridColumn("office_phone",99,"left","string","회사전화번호",{hidden:true}),new FingerDataGridColumn("inter_phone",99,"left","string","내선번호",{hidden:true}),new FingerDataGridColumn("region_name1",100,"left","string","시/도"),new FingerDataGridColumn("region_name2",100,"left","string","시/군/구"),new FingerDataGridColumn("region_name3",99,"left","string","읍/면/동",{hidden:true}),new FingerDataGridColumn("gender",99,"left","string","성별",{hidden:true}),new FingerDataGridColumn("ind_sp",1,"left","string","진료과목",{hidden:false}),new FingerDataGridColumn("job_position",99,"left","string","구분",{hidden:true}),new FingerDataGridColumn("ind_university",99,"left","string","출신학교",{hidden:true}),new FingerDataGridColumn("contact_txt",100,"left","string","비고"),new FingerDataGridColumn("crm_yn",80,"left","string","CRM여부")]);$.grdList.init({panel:$.panQuery,scroll:"xy"});$.grdList.setBorder(false);$.grdDetail1.setColumns([new FingerDataGridColumn("product_code",120,"left","string","품목코드"),new FingerDataGridColumn("product_name",170,"left","string","품목명"),new FingerDataGridColumn("contact_level",100,"center","string","고객등급"),new FingerDataGridColumn("prec_qty",99,"left","string","처방량",{hidden:true}),new FingerDataGridColumn("patn_cnt",99,"left","string","대상환자수",{hidden:true}),new FingerDataGridColumn("emp_name",130,"left","string","담당자")]);$.grdDetail1.init();$.grdDetail1.setBorder(false);$.grdDetail2.setColumns([new FingerDataGridColumn("call_id",99,"left","string","콜id",{hidden:true}),new FingerDataGridColumn("call_date",150,"left","string","방문일",{format:"s_ymd"}),new FingerDataGridColumn("call_time",100,"center","string","방문시간"),new FingerDataGridColumn("emp_name",100,"left","string","방문자"),new FingerDataGridColumn("subject",99,"left","string","보고서",{hidden:true}),new FingerDataGridColumn("call_memo",99,"left","string","콜메모",{hidden:true})]);$.grdDetail2.init({scroll:"xy"});$.grdDetail2.setBorder(false);$.tabDetail.addTab([{text:"고객관련품목",body:$.panTab1,width:150},{text:"최근방문일",body:$.panTab2,width:150}]);$.txtDId.setEnable(false);$.txtDName.setEnable(false);$.txtDZipCode.setEnable(false);$.txtDAddress1.setEnable(false);$.txtDAddress2.setEnable(false);$.txtDMain.setEnable(false);$.txtDTel.setEnable(false);$.txtDGender.setEnable(false);$.txtDType.setEnable(false);$.txtDCompanyName.setEnable(false);$.txtDSchool.setEnable(false);$.txtDDesc.setEnable(false);$.txtDPostion.setEnable(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panInfo);$.panMain.add($.panDetail);$.panQuery.add($.grdList);$.panQuery.add($.lblQName);$.panQuery.add($.lblQRegion);$.panQuery.add($.lblQEmp);$.panQuery.add($.txtQName);$.panQuery.add($.txtQRegion);$.panQuery.add($.cmbQDept);$.panQuery.add($.cmbQEmp);$.panQuery.add($.btnCRM);$.panQuery.add($.btnSearch);$.panQuery.add($.cmbQSP);$.panQuery.add($.lblQCompanyName);$.panQuery.add($.txtQCompanyName);$.panInfo.add($.lblDId);$.panInfo.add($.lblDName);$.panInfo.add($.lblDAddress);$.panInfo.add($.lblDMain);$.panInfo.add($.lblDTel);$.panInfo.add($.txtDId);$.panInfo.add($.txtDName);$.panInfo.add($.txtDZipCode);$.panInfo.add($.txtDAddress1);$.panInfo.add($.txtDAddress2);$.panInfo.add($.txtDMain);$.panInfo.add($.txtDTel);$.panInfo.add($.lblDGender);$.panInfo.add($.lblDType);$.panInfo.add($.lblDCompanyName);$.panInfo.add($.lblDPosition);$.panInfo.add($.lblDSchool);$.panInfo.add($.lblDDesc);$.panInfo.add($.txtDCompanyName);$.panInfo.add($.txtDDesc);$.panInfo.add($.txtDGender);$.panInfo.add($.txtDSchool);$.panInfo.add($.txtDType);$.panInfo.add($.txtDPostion);$.panInfo.add($.lblDZipCod);$.panDetail.add($.tabDetail);$.panTab1.add($.grdDetail1);$.panTab2.add($.grdDetail2);relocateChildIndexInPanel([$.panQuery]);$.cmbQDept.setColumn("dept_code","dept_name");$.cmbQEmp.setColumn("employee_id","emp_name");$.cmbQSP.setColumn("a","b");$.cmbQDept.setEmptyRow(true);$.cmbQEmp.setEmptyRow(true);$.cmbQSP.setEmptyRow(true);var ds=bizComponentData2($,"Q1","L_CRM195_1|L_CRM0104|S_0222");setComboBind([$.cmbQDept,$.cmbQEmp,$.cmbQSP],ds);var session=g_main.session.obj;if(session.SalesEmpYN=="Y"){$.cmbQDept.setValue(session.DeptCode);$.cmbQEmp.setValue(session.UserID);$.cmbQDept.setEnable(true);$.cmbQEmp.setEnable(true)}else{$.cmbQEmp.clear();$.cmbQEmp.setEnable(true)}};$.callback=function(type,ds){if(type=="Q"||type=="C"){setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}else{if(type=="DETAIL"){setDataGrid([$.grdDetail1,null,null,null,$.grdDetail2],ds)}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("Q")}else{if(id=="btnCRM"){searchList("C")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbQDept"){if(!value||value==""){$.cmbQEmp.clear();$.cmbQEmp.setEnable(true);return}$.cmbQEmp.clear();$.cmbQEmp.setEnable(true);var ds=bizComponentData2($,"Q4","L_CRM0052","and dept_code = '"+value+"'");setComboBind([$.cmbQEmp],ds)}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.txtDId.setValue($.grdList.getValue(rId,"contact_id"));$.txtDName.setValue($.grdList.getValue(rId,"contact_name"));$.txtDZipCode.setValue($.grdList.getValue(rId,"zip_code"));$.txtDAddress1.setValue($.grdList.getValue(rId,"address1"));$.txtDAddress2.setValue($.grdList.getValue(rId,"address2"));$.txtDMain.setValue($.grdList.getValue(rId,"ind_sp"));$.txtDTel.setValue($.grdList.getValue(rId,"office_phone"));$.txtDGender.setValue($.grdList.getValue(rId,"gender"));$.txtDType.setValue($.grdList.getValue(rId,"job_position"));$.txtDCompanyName.setValue($.grdList.getValue(rId,"company_name"));$.txtDSchool.setValue($.grdList.getValue(rId,"ind_university"));$.txtDDesc.setValue($.grdList.getValue(rId,"contact_txt"));$.txtDPostion.setValue($.grdList.getValue(rId,"ind_title"));searchList("DETAIL")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(($.lblQName.getValue.txt!=""||$.lblQCompanyName.getValue.txt!="")&&(id=="txtQName"||id=="txtQId"||id=="txtQRegion"||id=="txtQCompanyName")&&value=="13"){searchList("Q")}else{if($.lblQName.getValue.txt==""||$.lblQCompanyName.getValue.txt==""){MessageBoxShow("고객명 또는 거래처명을 입력해주세요.");return}}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnSave"){saveCompany("U")}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>