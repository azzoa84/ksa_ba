<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.lblDate=null;$.dteDate=null;$.lblDeptCode=null;$.cmbDeptCode=null;$.lblTeamCode=null;$.cmbTeamCode=null;$.lblProductCode=null;$.cmbProductCode=null;$.btnSearch=null;$.panDetail=null;$.htmlCallResult=null;$.lblEmployee=null;$.cmbEmployee=null;$.radioId="AMT";$.loadingIdx=0;$.expireDate="";$.selectDate="";$.isDebug=false;function initData(){relocateChildIndexInPanel([$.panTop]);var ds="";var yyyymm=getToday().substr(0,6);if(!$.isDebug){ds=bizComponentData2($,"Q2","L_CRM0122");if(ds&&ds.resultList){ds.resultList[0].unshift({sub_code:"S030",code_name:"SR영업소"})}setComboBind([$.cmbDeptCode],ds);ds=bizComponentData2($,"Q1","L_CRM0202");setComboBind([$.cmbProductCode],ds);$.dteDate.setValue(yyyymm)}else{ds={errorCode:"",returnStr:"",errorMsg:"",resultList:[[{sub_code:"S030",code_name:"SR영업소"},{sub_code:"S400",code_name:"비뇨기1영업부"},{sub_code:"S500",code_name:"비뇨기2영업부"},{sub_code:"S300",code_name:"개업의영업부"},{sub_code:"T300",code_name:"SI영업부"},{sub_code:"T100",code_name:"면역영업부"}]]};setComboBind([$.cmbDeptCode],ds);ds={errorCode:"",returnStr:"",errorMsg:"",resultList:[[{product_code:"P01",product_name:"라우간"},{product_code:"P02",product_name:"올데카"},{product_code:"P04",product_name:"하루날"},{product_code:"P05",product_name:"베라실"},{product_code:"P06",product_name:"페르디핀"},{product_code:"P07",product_name:"나제아주사"},{product_code:"P08",product_name:"나제아OD"},{product_code:"P11",product_name:"프로그랍-TX"},{product_code:"P12",product_name:"프로그랍-AI"},{product_code:"P13",product_name:"프로토픽"},{product_code:"P15",product_name:"마이카민"},{product_code:"P16",product_name:"베시케어"},{product_code:"P17",product_name:"아드바그랍"},{product_code:"P18",product_name:"이리보"},{product_code:"P19",product_name:"라파뮨"},{product_code:"P20",product_name:"엑스탄디"},{product_code:"P21",product_name:"베타미가"},{product_code:"P22",product_name:"슈글렛"}],[{sub_code:"AMT",code_name:"금액"},{sub_code:"QTY",code_name:"수량"}]]};setComboBind([$.cmbProductCode],ds);$.dteDate.setValue(yyyymm)}}function createJson_Q(workType){var json="";if(!$.isDebug){json=createExecuteParamInfo("P_crmDSMCall_Q",[workType,$.dteDate.getValue(),$.cmbDeptCode.getValue()||"",$.cmbTeamCode.getValue()||"",$.cmbEmployee.getValue()||"",$.cmbProductCode.getValue()||"","#UserID#"])}else{json=createExecuteParamInfo("P_crmDSMCall_Q",[workType,$.dteDate.getValue(),"S500","S520","",$.cmbProductCode.getValue()||"","#UserID#"])}return json}function searchInitData(workType){var json=createJson_Q(workType);var ds=callQuerySync(["req",json],workType);if(ds&&ds.errorCode=="MSG0001"){$.dteDate.setValue(ds.resultList[0][0].yyyymm)}}function searchList(workType){var json=createJson_Q(workType);callQueryLoading(["req",json],workType,$)}function callResultSearch(){searchList("Q_CALL");searchList("Q_MED");searchList("Q_LEVEL");searchList("Q_PRODUCT")}function closeLoading(){$.loadingIdx++;if($.loadingIdx==4){$.loadingIdx=0;hideToast()}}function openNewTab(params,viewId){g_main.openModelWithBusiness(viewId,params,true,false)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,2900);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,55);$.panTop.setText("");$.panTop.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",0,15,100,20);$.lblDate.setText("년월");$.dteDate=new FingerDateEdit(host,"dteDate",105,15,115,20);$.lblDeptCode=new FingerLabel(host,"lblDeptCode",195,15,100,20);$.lblDeptCode.setText("부서");$.cmbDeptCode=new FingerComboBox(host,"cmbDeptCode",300,15,140,20);$.lblTeamCode=new FingerLabel(host,"lblTeamCode",425,15,100,20);$.lblTeamCode.setText("영업소");$.cmbTeamCode=new FingerComboBox(host,"cmbTeamCode",530,15,140,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",640,15,100,20);$.lblProductCode.setText("품목");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",745,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panDetail=new FingerPanel(host,"panDetail",0,65,1200,2800);$.panDetail.setText("");$.panDetail.setBottomLine(true);$.htmlCallResult=new FingerHTMLView(host,"htmlCallResult",0,0,1200,2800);$.lblEmployee=new FingerLabel(host,"lblEmployee",870,15,100,20);$.lblEmployee.setText("담당자");$.cmbEmployee=new FingerComboBox(host,"cmbEmployee",975,15,120,20);$.panTop.setBorder(true);$.dteDate.setDateFormat("yyyymm");$.cmbDeptCode.setEmptyRow(true);$.cmbTeamCode.setEmptyRow(true);$.cmbEmployee.setEmptyRow(true);$.cmbProductCode.setEmptyRow(true);$.cmbTeamCode.setColumn("dept_code","dept_name");$.cmbProductCode.setColumn("product_code","product_name");$.cmbEmployee.setColumn("employee_id","emp_name");$.dteDate.setAllowBlank(false,"년월");$.cmbDeptCode.setAllowBlank(false,"부서");$.dsmCallResult=new CustomDSMCallResult($,$.htmlCallResult,{onCallLinkClick:function(){var params={yyyymm:$.dteDate.getValue(),deptCode:$.cmbDeptCode.getValue()||"",teamCode:$.cmbTeamCode.getValue()||"",empoyeeId:$.cmbEmployee.getValue()||""};openNewTab(params,"crmSSAT_01")}});$.dsmCallResult.load();$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panDetail);$.panTop.add($.lblDate);$.panTop.add($.dteDate);$.panTop.add($.lblDeptCode);$.panTop.add($.cmbDeptCode);$.panTop.add($.lblTeamCode);$.panTop.add($.cmbTeamCode);$.panTop.add($.lblProductCode);$.panTop.add($.cmbProductCode);$.panTop.add($.btnSearch);$.panTop.add($.lblEmployee);$.panTop.add($.cmbEmployee);$.panDetail.add($.htmlCallResult);initData()};$.callback=function(type,ds){if(type=="Q_CALL"){$.dsmCallResult.chart.callResultChart(ds.resultList[0],"10");$.dsmCallResult.table.callResultTable(ds.resultList[0],"10",$.cmbTeamCode.getValue());$.dsmCallResult.chart.callResultChart(ds.resultList[1],"20");$.dsmCallResult.table.callResultTable(ds.resultList[1],"20",$.cmbTeamCode.getValue());$.dsmCallResult.chart.callResultChart(ds.resultList[2],"30");$.dsmCallResult.table.callResultTable(ds.resultList[2],"30",$.cmbTeamCode.getValue());$.dsmCallResult.setWeeklyTxt(ds.resultList[3][0]);closeLoading()}else{if(type=="Q_PRODUCT"){var deptCode=$.cmbDeptCode.getValue();$.dsmCallResult.chart.productBoxSettings(deptCode);if(deptCode!="S030"){$.dsmCallResult.chart.productChart(ds.resultList[0],"40",deptCode);$.dsmCallResult.chart.productChart(ds.resultList[1],"50",deptCode)}else{$.dsmCallResult.chart.productChart(ds.resultList[0],"50",deptCode)}closeLoading()}else{if(type=="Q_MED"){$.dsmCallResult.chart.medCallSharePieChart(ds.resultList[0],ds.resultList[1]?ds.resultList[1][0].ind_sp_cnt:0,"60");$.dsmCallResult.chart.medCallSharePieChart(ds.resultList[2],ds.resultList[3]?ds.resultList[3][0].ind_sp_cnt:0,"70");$.dsmCallResult.chart.medCallResultBarChart(ds.resultList[4],"80");closeLoading()}else{if(type=="Q_LEVEL"){$.dsmCallResult.chart.contactCallShareChart(ds.resultList[0],"90");closeLoading()}}}}};$.update=function(args){if(args){try{var params=args;$.dteDate.setValue(params.yyyymm);$.cmbDeptCode.setValue(params.deptCode||"");$.cmbTeamCode.setValue(params.teamCode||"");if(!$.panTop.validateControls()){return}drawToast("#LOADING#");callResultSearch()}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){if(!$.isDebug){if(!$.panTop.validateControls()){return}drawToast("#LOADING#");callResultSearch()}else{var deptCode=$.cmbTeamCode.getValue();deptCode="S410";var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{code:"Z9999",name:"영업부 평균",fx_call:256,exc_call:83,call_rate:32.4},{code:"S410",name:"비뇨기1강북영업소",fx_call:292,exc_call:159,call_rate:54.5},{code:"S420",name:"비뇨기1강남영업소",fx_call:292,exc_call:37,call_rate:12.7},{code:"S440",name:"비뇨기1서부영업소",fx_call:192,exc_call:77,call_rate:40.1},{code:"S450",name:"비뇨기1동부영업소",fx_call:250,exc_call:61,call_rate:24.4}],[{code:"Z9999",name:"영업부 평균",fx_call:1027,exc_call:811,call_rate:79},{code:"S410",name:"비뇨기1강북영업소",fx_call:1171,exc_call:1089,call_rate:93},{code:"S420",name:"비뇨기1강남영업소",fx_call:1170,exc_call:614,call_rate:52.5},{code:"S440",name:"비뇨기1서부영업소",fx_call:768,exc_call:654,call_rate:85.2},{code:"S450",name:"비뇨기1동부영업소",fx_call:1000,exc_call:889,call_rate:88.90000000000001}],[{code:"Z9999",name:"영업부 평균",fx_call:6163,exc_call:4908,call_rate:79.59999999999999},{code:"S410",name:"비뇨기1강북영업소",fx_call:7026,exc_call:6702,call_rate:95.40000000000001},{code:"S420",name:"비뇨기1강남영업소",fx_call:7020,exc_call:4261,call_rate:60.7},{code:"S440",name:"비뇨기1서부영업소",fx_call:4608,exc_call:3828,call_rate:83.09999999999999},{code:"S450",name:"비뇨기1동부영업소",fx_call:6000,exc_call:4841,call_rate:80.7}],[{day1:"20190318",day5:"20190322"}]]};$.dsmCallResult.chart.callResultChart(ds.resultList[0],"10");$.dsmCallResult.table.callResultTable(ds.resultList[0],"10",deptCode);$.dsmCallResult.chart.callResultChart(ds.resultList[1],"20");$.dsmCallResult.table.callResultTable(ds.resultList[1],"20",deptCode);$.dsmCallResult.chart.callResultChart(ds.resultList[2],"30");$.dsmCallResult.table.callResultTable(ds.resultList[2],"30",deptCode);$.dsmCallResult.setWeeklyTxt(ds.resultList[3][0]);var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{product_code:"P04",product_name:"하루날디",fx_call:1044},{product_code:"P05",product_name:"베라실",fx_call:12},{product_code:"P06",product_name:"페르디핀",fx_call:4},{product_code:"P07",product_name:"나제아주사",fx_call:180},{product_code:"P16",product_name:"베시케어",fx_call:596},{product_code:"P21",product_name:"베타미가",fx_call:888}],[{code:"ka110182",name:"변준석",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka130284",name:"김성민",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka140311",name:"김준회",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka170402",name:"서광식",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka120253",name:"이슬혜",product_code:"P02",product_name:"올데카",exc_call:1},{code:"S320",name:"영업소 평균",product_code:"P02",product_name:"올데카",exc_call:0},{code:"Z9999",name:"영업부 평균",product_code:"P02",product_name:"올데카",exc_call:0},{code:"ka110182",name:"변준석",product_code:"P04",product_name:"하루날",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P04",product_name:"하루날",exc_call:313},{code:"ka120253",name:"이슬혜",product_code:"P04",product_name:"하루날",exc_call:212},{code:"ka130284",name:"김성민",product_code:"P04",product_name:"하루날",exc_call:531},{code:"ka140311",name:"김준회",product_code:"P04",product_name:"하루날",exc_call:174},{code:"ka170402",name:"서광식",product_code:"P04",product_name:"하루날",exc_call:162},{code:"S320",name:"영업소 평균",product_code:"P04",product_name:"하루날",exc_call:278},{code:"Z9999",name:"영업부 평균",product_code:"P04",product_name:"하루날",exc_call:240},{code:"ka110182",name:"변준석",product_code:"P05",product_name:"베라실",exc_call:0},{code:"ka120253",name:"이슬혜",product_code:"P05",product_name:"베라실",exc_call:0},{code:"ka140311",name:"김준회",product_code:"P05",product_name:"베라실",exc_call:0},{code:"ka170402",name:"서광식",product_code:"P05",product_name:"베라실",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P05",product_name:"베라실",exc_call:3},{code:"ka130284",name:"김성민",product_code:"P05",product_name:"베라실",exc_call:88},{code:"S320",name:"영업소 평균",product_code:"P05",product_name:"베라실",exc_call:18},{code:"Z9999",name:"영업부 평균",product_code:"P05",product_name:"베라실",exc_call:29},{code:"ka110182",name:"변준석",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"ka130284",name:"김성민",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"ka140311",name:"김준회",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"ka170402",name:"서광식",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"ka120253",name:"이슬혜",product_code:"P06",product_name:"페르디핀",exc_call:3},{code:"S320",name:"영업소 평균",product_code:"P06",product_name:"페르디핀",exc_call:0},{code:"Z9999",name:"영업부 평균",product_code:"P06",product_name:"페르디핀",exc_call:3},{code:"ka110182",name:"변준석",product_code:"P07",product_name:"나제아주사",exc_call:0},{code:"ka130284",name:"김성민",product_code:"P07",product_name:"나제아주사",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P07",product_name:"나제아주사",exc_call:73},{code:"ka120253",name:"이슬혜",product_code:"P07",product_name:"나제아주사",exc_call:124},{code:"ka140311",name:"김준회",product_code:"P07",product_name:"나제아주사",exc_call:85},{code:"ka170402",name:"서광식",product_code:"P07",product_name:"나제아주사",exc_call:11},{code:"S320",name:"영업소 평균",product_code:"P07",product_name:"나제아주사",exc_call:58},{code:"Z9999",name:"영업부 평균",product_code:"P07",product_name:"나제아주사",exc_call:37},{code:"ka110182",name:"변준석",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka120253",name:"이슬혜",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka130284",name:"김성민",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka140311",name:"김준회",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka170402",name:"서광식",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"S320",name:"영업소 평균",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"Z9999",name:"영업부 평균",product_code:"P08",product_name:"나제아정",exc_call:0},{code:"ka110182",name:"변준석",product_code:"P16",product_name:"베시케어",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P16",product_name:"베시케어",exc_call:63},{code:"ka120253",name:"이슬혜",product_code:"P16",product_name:"베시케어",exc_call:24},{code:"ka130284",name:"김성민",product_code:"P16",product_name:"베시케어",exc_call:114},{code:"ka140311",name:"김준회",product_code:"P16",product_name:"베시케어",exc_call:119},{code:"ka170402",name:"서광식",product_code:"P16",product_name:"베시케어",exc_call:86},{code:"S320",name:"영업소 평균",product_code:"P16",product_name:"베시케어",exc_call:81},{code:"Z9999",name:"영업부 평균",product_code:"P16",product_name:"베시케어",exc_call:110},{code:"ka110182",name:"변준석",product_code:"P21",product_name:"베타미가",exc_call:0},{code:"ka110194",name:"박성빈",product_code:"P21",product_name:"베타미가",exc_call:30},{code:"ka120253",name:"이슬혜",product_code:"P21",product_name:"베타미가",exc_call:202},{code:"ka130284",name:"김성민",product_code:"P21",product_name:"베타미가",exc_call:76},{code:"ka140311",name:"김준회",product_code:"P21",product_name:"베타미가",exc_call:158},{code:"ka170402",name:"서광식",product_code:"P21",product_name:"베타미가",exc_call:111},{code:"S320",name:"영업소 평균",product_code:"P21",product_name:"베타미가",exc_call:115},{code:"Z9999",name:"영업부 평균",product_code:"P21",product_name:"베타미가",exc_call:206}]]};var deptCode=$.cmbDeptCode.getValue();$.dsmCallResult.chart.productBoxSettings(deptCode);if(deptCode!="S030"){$.dsmCallResult.chart.productChart(ds.resultList[0],"40",deptCode);$.dsmCallResult.chart.productChart(ds.resultList[1],"50",deptCode)}else{$.dsmCallResult.chart.productChart(ds.resultList[0],"50",deptCode)}var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{call_cnt:2404,ind_sp:"비뇨기과"},{call_cnt:84,ind_sp:"마취통증의학과"},{call_cnt:60,ind_sp:"산부인과"},{call_cnt:52,ind_sp:"정형외과"},{call_cnt:44,ind_sp:"내과"},{call_cnt:80,ind_sp:"기타"}],[{ind_sp_cnt:14}],[{call_cnt:2032,ind_sp:"비뇨기과"},{call_cnt:249,ind_sp:"산부인과"},{call_cnt:198,ind_sp:"마취통증의학과"},{call_cnt:169,ind_sp:"외과"},{call_cnt:144,ind_sp:"류마티스내과"},{call_cnt:595,ind_sp:"기타"}],[{ind_sp_cnt:23}],[{ind_sp:"비뇨기과",fx_call:2404,call_cnt:2032},{ind_sp:"산부인과",fx_call:60,call_cnt:249},{ind_sp:"마취통증의학과",fx_call:84,call_cnt:198},{ind_sp:"외과",fx_call:20,call_cnt:169},{ind_sp:"류마티스내과",fx_call:0,call_cnt:144},{ind_sp:"기타",fx_call:156,call_cnt:595}]]};$.dsmCallResult.chart.medCallSharePieChart(ds.resultList[0],ds.resultList[1]?ds.resultList[1][0].ind_sp_cnt:0,"60");$.dsmCallResult.chart.medCallSharePieChart(ds.resultList[2],ds.resultList[3]?ds.resultList[3][0].ind_sp_cnt:0,"70");$.dsmCallResult.chart.medCallResultBarChart(ds.resultList[4],"80");var ds={errorCode:"MSG0001",returnStr:"",errorMsg:"",resultList:[[{code:"Z9999",name:"영업부 평균",kcm_l:214,kcm_u:167,kcm_t:142,kcm_a:491,kcm_n:460,kcm_sum:1474,kcm_empty:38,fx_call:624,exe_call:645,call_rate:103.4,day_call:645,day:1},{code:"S320",name:"영업소 평균",kcm_l:155,kcm_u:137,kcm_t:138,kcm_a:424,kcm_n:289,kcm_sum:1143,kcm_empty:74,fx_call:544,exe_call:677,call_rate:124.4,day_call:677,day:1},{code:"ka110182",name:"변준석",kcm_l:94,kcm_u:187,kcm_t:96,kcm_a:238,kcm_n:148,kcm_sum:763,kcm_empty:0,fx_call:"",exe_call:624,call_rate:"",day_call:624,day:1},{code:"ka110194",name:"박성빈",kcm_l:157,kcm_u:116,kcm_t:81,kcm_a:384,kcm_n:298,kcm_sum:1036,kcm_empty:6,fx_call:456,exe_call:482,call_rate:105.7,day_call:482,day:1},{code:"ka120253",name:"이슬혜",kcm_l:25,kcm_u:24,kcm_t:100,kcm_a:666,kcm_n:100,kcm_sum:915,kcm_empty:32,fx_call:604,exe_call:566,call_rate:93.7,day_call:566,day:1},{code:"ka130284",name:"김성민",kcm_l:172,kcm_u:145,kcm_t:126,kcm_a:322,kcm_n:138,kcm_sum:903,kcm_empty:325,fx_call:540,exe_call:809,call_rate:149.8,day_call:809,day:1},{code:"ka140311",name:"김준회",kcm_l:139,kcm_u:149,kcm_t:180,kcm_a:214,kcm_n:513,kcm_sum:1195,kcm_empty:11,fx_call:640,exe_call:536,call_rate:83.8,day_call:536,day:1},{code:"ka170402",name:"서광식",kcm_l:188,kcm_u:64,kcm_t:109,kcm_a:298,kcm_n:251,kcm_sum:910,kcm_empty:0,fx_call:484,exe_call:370,call_rate:76.40000000000001,day_call:370,day:1}]]};$.dsmCallResult.chart.contactCallShareChart(ds.resultList[0],"90")}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDeptCode"){if($.isDebug){return}if(!value){$.cmbTeamCode.clear();return}if(value=="S030"){var ds={resultList:[[{dept_code:"S030",dept_name:"SR영업소"}]]};$.cmbTeamCode.clear();setComboBind([$.cmbTeamCode],ds);$.cmbTeamCode.setValue("S030");return}var strQuery=" and parent_dept_code = '"+value+"'";var ds=bizComponentData2($,"Q4","L_CRM0120",strQuery,"","");$.cmbTeamCode.clear();setComboBind([$.cmbTeamCode],ds)}else{if(id=="cmbTeamCode"){var strQuery=" and dept_code = '"+value+"'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery,"","");$.cmbEmployee.clear();setComboBind([$.cmbEmployee],ds)}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panMR"){if(!$.grdMR.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelData=[];$.grdMRExcel.clear();for(var i=0;i<$.excelMRData.length;i++){var rowData=$.excelMRData[i];var dt=rowData;dt.dept_name_excel="";dt.emp_name_excel="";dt.company_name_excel="";dt.product_name_excel=rowData.product_name;if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"&&rowData.key_id){dt.emp_name_excel=rowData.p_name}if(rowData.parent_id.indexOf("ka")>-1&&rowData.key_id){dt.company_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelData.push(dt)}setDataGrid([$.grdMRExcel],excelData,true);$.grdMRExcel.excelDownCustom("최근 6개월 소화실적 추이(MR 기준)")}else{if(panelId=="panCompany"){if(!$.grdCompany.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelCompanyData=[];$.grdCompanyExcel.clear();for(var i=0;i<$.excelCompanyData.length;i++){var rowData=$.excelCompanyData[i];var dt=rowData;dt.dept_name_excel="";dt.company_name_excel="";dt.product_name_excel=rowData.product_name;if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"&&rowData.key_id){dt.company_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelCompanyData.push(dt)}setDataGrid([$.grdCompanyExcel],excelCompanyData,true);$.grdCompanyExcel.excelDownCustom("최근 6개월 소화실적 추이(거래처 기준)")}else{if(panelId=="panProduct"){if(!$.grdProduct.getRowCount()){MessageBoxShow("엑셀로 출력할 데이터가 없습니다.");return}var excelProductData=[];$.grdProductExcel.clear();for(var i=0;i<$.excelProductData.length;i++){var rowData=$.excelProductData[i];var dt=rowData;dt.dept_name_excel="";dt.product_name_excel="";dt.company_name_excel=rowData.product_name||"";if(!rowData.parent_id){dt.dept_name_excel=rowData.p_name}if(rowData.parent_id=="ALL"){dt.product_name_excel=rowData.p_name}var rowObj=Object.keys(rowData);for(var j=0;j<rowObj.length;j++){if(rowObj[j].indexOf("res_diff")>-1){var value=dt[rowObj[j]];if(value>0){dt[rowObj[j]]="<span style='color: #FF0000; text-align: right;'>"+getNumberComma(value)+"</span>"}else{if(value<0){dt[rowObj[j]]="<span style='color: #0070C0; text-align: right;'>"+getNumberComma(value)+"</span>"}else{dt[rowObj[j]]=getNumberComma(value)}}}}excelProductData.push(dt)}setDataGrid([$.grdProductExcel],excelProductData,true);$.grdProductExcel.excelDownCustom("최근 6개월 소화실적 추이(품목 기준)")}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>