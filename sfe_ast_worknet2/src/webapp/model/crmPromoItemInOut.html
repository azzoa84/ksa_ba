<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTree=null;$.panInfo=null;$.panList=null;$.lblInoutDate=null;$.dteInoutDate=null;$.lblInoutSeq=null;$.speInoutSeq=null;$.lblPrItemCode=null;$.txtPrItemCode=null;$.lblPrItemName=null;$.txtPrItemName=null;$.lblInoutType=null;$.cmbInoutType=null;$.lblInoutQty=null;$.speInoutQty=null;$.lblDeptName=null;$.txtDeptName=null;$.lblEmpName=null;$.bteEmpName=null;$.lblWfDocName=null;$.bteWfDocName=null;$.grdPrList=null;$.grdList=null;function createJson_Q(workType){var json=createExecuteParamInfo("P_crmPromoItemInOut_Q",[workType,$.txtPrItemCode.getValue().length==0?"":$.txtPrItemCode.getValue()]);return json}function createJson_S(workType){var json=createExecuteParamInfo("P_crmPromoItemInOut_S",[workType,$.txtPrItemCode.getValue(),$.dteInoutDate.getValue(),Number($.speInoutSeq.getValue()),$.cmbInoutType.getValue(),Number($.speInoutQty.getValue()),$.varDeptCode,$.bteEmpName.getValue(),$.wfDocId,"#EmpCode#"]);return json}function searchList(workType){var json=createJson_Q(workType);callQuery(["req",json],workType,$)}function savePr(){if(!validateControls([$.dteInoutDate,$.txtPrItemCode,$.speInoutQty,$.bteEmpName])){return}if($.speInoutQty.getValue==0){MessageBoxShow("입출고수량 은(는) 필수입력항목입니다.");return}var json=createJson_S("N");callExecute(["req",json],"N",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,770);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTree=new FingerPanel(host,"panTree",0,0,660,760);$.panTree.setText("판촉물 리스트");$.panTree.setBottomLine(true);$.panInfo=new FingerPanel(host,"panInfo",670,0,530,215);$.panInfo.setText("입출고 정보");$.panInfo.setBottomLine(true);$.panList=new FingerPanel(host,"panList",670,225,530,535);$.panList.setText("입출고 내역");$.panList.setBottomLine(true);$.lblInoutDate=new FingerLabel(host,"lblInoutDate",0,10,100,20);$.lblInoutDate.setText("입출고일자");$.dteInoutDate=new FingerDateEdit(host,"dteInoutDate",105,10,140,20);$.lblInoutSeq=new FingerLabel(host,"lblInoutSeq",255,10,100,20);$.lblInoutSeq.setText("입출고순번");$.speInoutSeq=new FingerSpinEdit(host,"speInoutSeq",360,10,140,20);$.lblPrItemCode=new FingerLabel(host,"lblPrItemCode",0,40,100,20);$.lblPrItemCode.setText("판촉물코드");$.txtPrItemCode=new FingerEdit(host,"txtPrItemCode",105,40,140,20);$.lblPrItemName=new FingerLabel(host,"lblPrItemName",255,40,100,20);$.lblPrItemName.setText("판촉물");$.txtPrItemName=new FingerEdit(host,"txtPrItemName",360,40,140,20);$.lblInoutType=new FingerLabel(host,"lblInoutType",0,70,100,20);$.lblInoutType.setText("입출고구분");$.cmbInoutType=new FingerComboBox(host,"cmbInoutType",105,70,140,20);$.lblInoutQty=new FingerLabel(host,"lblInoutQty",255,70,100,20);$.lblInoutQty.setText("입출고수량");$.speInoutQty=new FingerSpinEdit(host,"speInoutQty",360,70,140,20);$.lblDeptName=new FingerLabel(host,"lblDeptName",0,100,100,20);$.lblDeptName.setText("수령부서");$.txtDeptName=new FingerEdit(host,"txtDeptName",105,100,140,20);$.lblEmpName=new FingerLabel(host,"lblEmpName",255,100,100,20);$.lblEmpName.setText("수령자");$.bteEmpName=new FingerButtonEdit(host,"bteEmpName",360,100,140,20);$.bteEmpName.setText("");$.lblWfDocName=new FingerLabel(host,"lblWfDocName",0,130,100,20);$.lblWfDocName.setText("승인결제문서");$.bteWfDocName=new FingerButtonEdit(host,"bteWfDocName",105,130,395,20);$.bteWfDocName.setText("");$.grdPrList=new FingerDataGrid(host,"grdPrList",0,0,660,715);$.grdList=new FingerDataGrid(host,"grdList",0,0,530,490);$.txtPrItemCode.setReadOnly(true);$.txtPrItemName.setReadOnly(true);$.txtDeptName.setReadOnly(true);$.bteWfDocName.setEnable(false);$.dteInoutDate.setAllowBlank(false,"입출고일자");$.txtPrItemCode.setAllowBlank(false,"판촉물코드");$.cmbInoutType.setAllowBlank(false,"입출고구분");$.speInoutQty.setAllowBlank(false,"입출고수량");$.bteEmpName.setAllowBlank(false,"수령자");$.panInfo.addButton("btnSave","저장");$.panInfo.setButtonAction("btnSave","save");$.grdListMap=$.grdPrList.setColumns([new FingerDataGridColumn("pr_item_code",0,"left","text","판촉물코드",{hidden:true}),new FingerDataGridColumn("pr_item_name",440,"left","text","판촉물명",{template:"tree"}),new FingerDataGridColumn("qty",100,"right","int","신청출고대기건수"),new FingerDataGridColumn("cur_stock",100,"right","int","잔고"),new FingerDataGridColumn("group_yn",80,"left","text","그룹여부",{hidden:true}),new FingerDataGridColumn("request_yn",80,"left","text","신청가능여부",{hidden:true})]);$.grdPrList.init({nonExcel:true,panel:$.panTree,scroll:"xy",view:"treetable",treeKey:{id:"KeyID",parent:"ParentKeyID"}});$.grdPrList.setBorder(false);$.grdList.colIdx=$.grdList.setColumns([new FingerDataGridColumn("pr_item_code",100,"left","string","판촉물코드",{hidden:true}),new FingerDataGridColumn("inout_date",100,"left","date","입출고일자",{format:"ymd"}),new FingerDataGridColumn("inout_seq",50,"right","int","순번"),new FingerDataGridColumn("inout_type",100,"left","string","구분",{hidden:true}),new FingerDataGridColumn("inout_type_name",100,"left","string","구분"),new FingerDataGridColumn("inout_qty",50,"right","int","수량"),new FingerDataGridColumn("dept_name",100,"left","string","수령부서"),new FingerDataGridColumn("emp_name",100,"left","string","수령자")]);$.grdList.init();$.lblInoutSeq.setVisible(false);$.speInoutSeq.setVisible(false);$.speInoutQty.setValue(0);$.bteEmpName.setDirectSearch("#EMP#",function(ds){if(ds&&ds.resultList&&ds.resultList[0]){var list=ds.resultList[0];if(list.length==1){$.bteEmpName.setValue(list[0]["value"]);$.bteEmpName.setText(list[0]["text"]);$.txtDeptName.setValue(list[0]["dept_name"]);$.varDeptCode=list[0]["dept_code"]}else{$.fingerbuttonedit_click("bteEmpName")}}});$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTree);$.panMain.add($.panInfo);$.panMain.add($.panList);$.panTree.add($.grdPrList);$.panInfo.add($.lblInoutDate);$.panInfo.add($.dteInoutDate);$.panInfo.add($.lblInoutSeq);$.panInfo.add($.speInoutSeq);$.panInfo.add($.lblPrItemCode);$.panInfo.add($.txtPrItemCode);$.panInfo.add($.lblPrItemName);$.panInfo.add($.txtPrItemName);$.panInfo.add($.lblInoutType);$.panInfo.add($.cmbInoutType);$.panInfo.add($.lblInoutQty);$.panInfo.add($.speInoutQty);$.panInfo.add($.lblDeptName);$.panInfo.add($.txtDeptName);$.panInfo.add($.lblEmpName);$.panInfo.add($.bteEmpName);$.panInfo.add($.lblWfDocName);$.panInfo.add($.bteWfDocName);$.panList.add($.grdList);$.wfDocId="";$.varDeptCode="";$.varEmployeeId="";searchList("ITEMTREE")};$.callback=function(type,ds){if(type=="ITEMTREE"){setDataGrid([$.grdPrList],ds);$.grdPrList.openNode("all")}else{if(type=="Q"){if(ds.resultList[0].length>0){var tempDate="";for(var i=0;i<ds.resultList[0].length;i++){tempDate=ds.resultList[0][i].inout_date;ds.resultList[0][i].inout_date=(tempDate.substring(0,4)+"-"+tempDate.substring(4,6)+"-"+tempDate.substring(6,8))}setDataGrid([$.grdList],ds)}else{$.grdList.extObj.clearAll()}}else{if(type=="N"){$.varDeptCode="";$.speInoutQty.setValue(0);$.cmbInoutType.setValue("");$.txtDeptName.setValue("");$.bteEmpName.setValue("");$.bteEmpName.setText("");searchList("Q")}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmpName"){var param={employee_id:$.bteEmpName.getValue()||"",emp_name:$.bteEmpName.getText()||""};g_main.openPopup("popEmp.html","popEmp","사원 조회",750,500,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdPrList"){$.varDeptCode="";$.bteEmpName.setValue("");$.panInfo.clear();$.speInoutQty.setValue(0);if($.grdPrList.getValue(rId,"group_yn")=="N"){$.dteInoutDate.setValue(getToday());$.txtPrItemCode.setValue($.grdPrList.getValue(rId,"pr_item_code"));$.txtPrItemName.setValue($.grdPrList.getValue(rId,"pr_item_name"));searchList("Q")}else{}$.cmbInoutType.clear();$.cmbInoutType.setEmptyRow(true);if($.grdPrList.getValue(rId,"request_yn")=="Y"){var ds=bizComponentData2($,"Q4","L_CRM0012");setComboBind([$.cmbInoutType],ds)}else{var ds=bizComponentData2($,"Q4","L_CRM0012"," and SUBSTRING(sub_code,1,1) ='I'");setComboBind([$.cmbInoutType],ds)}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panInfo"){if(btnId=="btnSave"){savePr()}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmpName"){if(!popResult.employee_id){$.bteEmpName.setValue("");$.bteEmpName.setText("");$.txtDeptName.setValue("");$.varDeptCode=""}else{$.bteEmpName.setValue(popResult.employee_id);$.bteEmpName.setText(popResult.emp_name);$.varDeptCode=popResult.dept_code;$.txtDeptName.setText(popResult.dept_name)}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>