<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.grdList=null;$.lblEx1=null;$.htmlEx1=null;$.fingerline=null;$.lbl_month=null;$.dte_start_month=null;$.lbl_Tx1=null;$.dte_end_month=null;$.lbl_dept=null;$.cmb_Dept=null;$.cmb_Employee=null;$.lbl_product_code=null;$.cmb_Product_code1=null;$.cmb_Product_code2=null;$.lbl_SaleType=null;$.cmb_SaleType=null;$.lbl_channel=null;$.cmb_channel=null;$.lbl_company=null;$.txt_company_id=null;$.bte_company_name=null;$.lbl_sido=null;$.cmb_sido=null;$.cmb_sigungu=null;$.rbo_viewType=null;$.lbl_wholesaler=null;$.txt_wholesaler_id=null;$.bte_wholesaler_name=null;$.btnSearch=null;$.btnDel1=null;$.btnDel2=null;$.chk_dept=null;$.chk_employee=null;$.chk_product1=null;$.chk_product2=null;$.chk_saletype=null;$.chk_company=null;$.chk_channel=null;$.chk_sido=null;$.chk_gu=null;$.chk_whole=null;$.chk_bed=null;$.cmb_AccountYear=null;$.btnClear=null;$.lblCompany2=null;$.txtCompany2=null;function createJson_Q(workType){var json=createExecuteParamInfo("P_crmSaleReportMonth_Q",[workType,$.cmb_Dept.getValue()||"",$.cmb_Employee.getValue()||"",$.cmb_Product_code1.getValue()||"",$.cmb_Product_code2.getValue()||"",$.cmb_SaleType.getValue("code_name")||"",$.txt_company_id.getValue()||"",$.cmb_channel.getValue()||"",$.cmb_sido.getValue("sidogu_name")||"",$.cmb_sigungu.getValue("sidogu_name")||"",$.txt_wholesaler_id.getValue()||"",$.dte_start_month.getValue(),$.dte_end_month.getValue(),$.rbo_viewType.getValue(),$.chk_dept.getValue()=="Y"?"O":"X",$.chk_employee.getValue()=="Y"?"O":"X",$.chk_product1.getValue()=="Y"?"O":"X",$.chk_product2.getValue()=="Y"?"O":"X",$.chk_saletype.getValue()=="Y"?"O":"X",$.chk_company.getValue()=="Y"?"O":"X",$.chk_channel.getValue()=="Y"?"O":"X",$.chk_sido.getValue()=="Y"?"O":"X",$.chk_gu.getValue()=="Y"?"O":"X",$.chk_whole.getValue()=="Y"?"O":"X",$.chk_bed.getValue()=="Y"?"O":"X",$.txtCompany2.getValue()||""]);return json}function searchSaleReportMonth(workType){if(!$.panQuery.validateControls()){return}var start=$.dte_start_month.getValue();var end=$.dte_end_month.getValue();if(Number(start)>Number(end)){MessageBoxShow("조회기간 시작일은 종료일보다 빠르거나 같아야 합니다.");return}var json=createJson_Q(workType);callQuery(["req",json],workType,$)}function newClick(){$.panQuery.clear();if(g_main.session.obj.UserID=="ka100136"){$.chk_product1.setValue("Y");$.chk_product2.setValue("Y");$.chk_saletype.setValue("Y");$.chk_company.setValue("Y");$.chk_whole.setValue("Y")}else{$.chk_dept.setValue("Y");$.chk_employee.setValue("Y");$.chk_product1.setValue("Y");$.chk_company.setValue("Y");$.chk_channel.setValue("Y");$.chk_bed.setValue("Y");$.chk_gu.setValue("N");$.chk_saletype.setValue("N");$.chk_sido.setValue("N");$.chk_whole.setValue("N");$.chk_product2.setValue("N")}$.rbo_viewType.setValue("A");$.dte_start_month.setValue($.cmb_AccountYear.getValue());if($.cmb_AccountYear.getValue()!=null||$.cmb_AccountYear.getValue()!=""){$.dte_end_month.setValue($.cmb_AccountYear.getValue())}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,700);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,165);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,175,1200,510);$.panList.setText("소화실적");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,465);$.lblEx1=new FingerLabel(host,"lblEx1",935,0,100,20);$.lblEx1.setText("조회필드구성");$.htmlEx1=new FingerHTMLView(host,"htmlEx1",940,18,260,15);$.fingerline=new FingerLine(host,"fingerline",940,0,1,166);$.lbl_month=new FingerLabel(host,"lbl_month",0,10,100,20);$.lbl_month.setText("조회기간");$.dte_start_month=new FingerDateEdit(host,"dte_start_month",105,10,120,20);$.lbl_Tx1=new FingerLabel(host,"lbl_Tx1",225,10,20,20);$.lbl_Tx1.setText("~");$.dte_end_month=new FingerDateEdit(host,"dte_end_month",250,10,120,20);$.lbl_dept=new FingerLabel(host,"lbl_dept",395,10,100,20);$.lbl_dept.setText("부서/담당자");$.cmb_Dept=new FingerComboBox(host,"cmb_Dept",500,10,180,20);$.cmb_Employee=new FingerComboBox(host,"cmb_Employee",680,10,140,20);$.lbl_product_code=new FingerLabel(host,"lbl_product_code",0,40,100,20);$.lbl_product_code.setText("품목그룹");$.cmb_Product_code1=new FingerComboBox(host,"cmb_Product_code1",105,40,145,20);$.cmb_Product_code2=new FingerComboBox(host,"cmb_Product_code2",250,40,275,20);$.lbl_SaleType=new FingerLabel(host,"lbl_SaleType",575,40,100,20);$.lbl_SaleType.setText("판매구분");$.cmb_SaleType=new FingerComboBox(host,"cmb_SaleType",680,40,140,20);$.lbl_channel=new FingerLabel(host,"lbl_channel",0,70,100,20);$.lbl_channel.setText("채널");$.cmb_channel=new FingerComboBox(host,"cmb_channel",105,70,145,20);$.lbl_company=new FingerLabel(host,"lbl_company",240,70,100,20);$.lbl_company.setText("거래처");$.txt_company_id=new FingerEdit(host,"txt_company_id",345,70,175,20);$.bte_company_name=new FingerButtonEdit(host,"bte_company_name",525,70,295,20);$.bte_company_name.setText("");$.lbl_sido=new FingerLabel(host,"lbl_sido",0,100,100,20);$.lbl_sido.setText("시도/시군구");$.cmb_sido=new FingerComboBox(host,"cmb_sido",105,100,145,20);$.cmb_sigungu=new FingerComboBox(host,"cmb_sigungu",250,100,175,20);$.rbo_viewType=new FingerRadioBox(host,"rbo_viewType",685,100,140,20);$.lbl_wholesaler=new FingerLabel(host,"lbl_wholesaler",0,130,100,20);$.lbl_wholesaler.setText("도매상");$.txt_wholesaler_id=new FingerEdit(host,"txt_wholesaler_id",105,130,140,20);$.bte_wholesaler_name=new FingerButtonEdit(host,"bte_wholesaler_name",250,130,170,20);$.bte_wholesaler_name.setText("");$.btnSearch=new FingerButton(host,"btnSearch",860,130,80,20);$.btnSearch.setText("조회");$.btnDel1=new FingerButton(host,"btnDel1",825,70,80,20);$.btnDel1.setText("지우개");$.btnDel2=new FingerButton(host,"btnDel2",425,130,80,20);$.btnDel2.setText("지우개");$.chk_dept=new FingerCheckBox(host,"chk_dept",970,35,100,20);$.chk_dept.setText("부서");$.chk_employee=new FingerCheckBox(host,"chk_employee",1090,35,100,20);$.chk_employee.setText("사원");$.chk_product1=new FingerCheckBox(host,"chk_product1",970,55,100,20);$.chk_product1.setText("품목그룹");$.chk_product2=new FingerCheckBox(host,"chk_product2",1090,55,100,20);$.chk_product2.setText("품목상세");$.chk_saletype=new FingerCheckBox(host,"chk_saletype",970,75,100,20);$.chk_saletype.setText("판매구분");$.chk_company=new FingerCheckBox(host,"chk_company",1090,75,100,20);$.chk_company.setText("거래처");$.chk_channel=new FingerCheckBox(host,"chk_channel",970,95,100,20);$.chk_channel.setText("채널");$.chk_sido=new FingerCheckBox(host,"chk_sido",1090,95,100,20);$.chk_sido.setText("대지역");$.chk_gu=new FingerCheckBox(host,"chk_gu",970,115,100,20);$.chk_gu.setText("중지역");$.chk_whole=new FingerCheckBox(host,"chk_whole",1090,115,100,20);$.chk_whole.setText("도매상");$.chk_bed=new FingerCheckBox(host,"chk_bed",970,135,100,20);$.chk_bed.setText("베드 수");$.cmb_AccountYear=new FingerComboBox(host,"cmb_AccountYear",595,150,140,20);$.btnClear=new FingerButton(host,"btnClear",910,-40,140,30);$.btnClear.setText("조회필드 초기화");$.lblCompany2=new FingerLabel(host,"lblCompany2",490,130,80,20);$.lblCompany2.setText("거래처이름");$.txtCompany2=new FingerEdit(host,"txtCompany2",580,130,150,20);$.panQuery.setBorder(true);$.dte_start_month.setDateFormat("yyyymm");$.dte_end_month.setDateFormat("yyyymm");$.dte_start_month.setAllowBlank(false,"시작일");$.dte_end_month.setAllowBlank(false,"종료일");$.cmb_sido.setEmptyRow(true);$.cmb_sigungu.setEmptyRow(true);$.cmb_Dept.setEmptyRow(true);$.cmb_Employee.setEmptyRow(true);$.cmb_Product_code1.setEmptyRow(true);$.cmb_Product_code2.setEmptyRow(true);$.cmb_channel.setEmptyRow(true);$.cmb_SaleType.setEmptyRow(true);$.txt_company_id.setReadOnly(true);$.txt_wholesaler_id.setReadOnly(true);$.rbo_viewType.addButtons([{sub_code:"A",code_name:"금액"},{sub_code:"Q",code_name:"수량"}]);$.cmb_AccountYear.setVisible(false);$.htmlEx1.setHTML("<hr style='border: solid 0.1px #dcdcdc;'>");$.fingerline.setColor("#dcdcdc");$.grdList.colIdx=$.grdList.setColumns([]);$.grdList.init({panel:$.panList,scroll:"xy",footer:true});$.grdList.setEditable(false);$.grdList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.cmb_AccountYear);$.panQuery.add($.lblEx1);$.panQuery.add($.htmlEx1);$.panQuery.add($.fingerline);$.panQuery.add($.lbl_month);$.panQuery.add($.dte_start_month);$.panQuery.add($.lbl_Tx1);$.panQuery.add($.dte_end_month);$.panQuery.add($.lbl_dept);$.panQuery.add($.cmb_Dept);$.panQuery.add($.cmb_Employee);$.panQuery.add($.lbl_product_code);$.panQuery.add($.cmb_Product_code1);$.panQuery.add($.cmb_Product_code2);$.panQuery.add($.lbl_SaleType);$.panQuery.add($.cmb_SaleType);$.panQuery.add($.lbl_channel);$.panQuery.add($.cmb_channel);$.panQuery.add($.lbl_company);$.panQuery.add($.txt_company_id);$.panQuery.add($.bte_company_name);$.panQuery.add($.lbl_sido);$.panQuery.add($.cmb_sido);$.panQuery.add($.cmb_sigungu);$.panQuery.add($.rbo_viewType);$.panQuery.add($.lbl_wholesaler);$.panQuery.add($.txt_wholesaler_id);$.panQuery.add($.bte_wholesaler_name);$.panQuery.add($.btnSearch);$.panQuery.add($.btnDel1);$.panQuery.add($.btnDel2);$.panQuery.add($.chk_dept);$.panQuery.add($.chk_employee);$.panQuery.add($.chk_product1);$.panQuery.add($.chk_product2);$.panQuery.add($.chk_saletype);$.panQuery.add($.chk_company);$.panQuery.add($.chk_channel);$.panQuery.add($.chk_sido);$.panQuery.add($.chk_gu);$.panQuery.add($.chk_whole);$.panQuery.add($.chk_bed);$.panQuery.add($.lblCompany2);$.panQuery.add($.txtCompany2);$.panList.add($.grdList);$.panList.add($.btnClear);relocateChildIndexInPanel([$.panQuery]);var ds=bizComponentData2($,"Q1","L_CRM0035|L_0146|L_CRM0131|L_CRM0132|L_CRM0015|L_CRM246");$.cmb_sido.setColumn("sidogu_code","sidogu_name");$.cmb_Dept.setColumn("dept_code","dept_name");$.cmb_Product_code1.setColumn("product_code","product_name");$.cmb_Product_code2.setColumn("PRODUCT_CODE","PRODUCT_NAME");$.cmb_AccountYear.setColumn("start_date","end_date");setComboBind([$.cmb_sido,$.cmb_Dept,$.cmb_Product_code1,$.cmb_Product_code2,$.cmb_channel,$.cmb_AccountYear],ds);var rs=ds.resultList[5];$.cmb_AccountYear.setValue(rs[rs.length-1].start_date);var ds2=bizComponentData2($,"Q2","L_CRM0105");setComboBind([$.cmb_SaleType],ds2);newClick();var ds=commCodeData2($,"COMM","#FY1#");$.dte_start_month.setValue(ds.resultList[0][0].yyyymm);$.dte_end_month.setValue(ds.resultList[0][0].yyyymm)};$.callback=function(type,ds){if(type=="Q"){if(ds){if(ds.errorCode=="ERR0006"){MessageBoxShow(ds.errorCode+"조회시 에러가 발생하였습니다.[][각 GROUP BY 식에는 외부 참조가 아닌 열이 적어도 하나 이상 있어야 합니다.]");return}$.grdList.removeColumns();var rs=ds.resultList[0];if(rs.length>0){var cols=[];var obj=Object.keys(rs[0]);for(var i=0;i<obj.length;i++){if(obj[i].length>4){if(obj[i].substring(2,3)=="년"){cols.push(new FingerDataGridColumn(obj[i],120,"right","int",obj[i],{format:"int",footer:{content:"summColumn"}}));continue}}if(obj[i]=="합계"){cols.push(new FingerDataGridColumn(obj[i],120,"right","int",obj[i],{format:"int",footer:{content:"summColumn"}}));continue}cols.push(new FingerDataGridColumn(obj[i],90,"left","string",obj[i]))}$.grdList.resetColumns(cols);setDataGrid([$.grdList],ds);$.grdList.selectRow(0)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchSaleReportMonth("Q")}else{if(id=="btnDel1"){$.txt_company_id.setValue("");$.bte_company_name.setText("")}else{if(id=="btnDel2"){$.txt_wholesaler_id.setValue("");$.bte_wholesaler_name.setText("")}else{if(id=="btnClear"){newClick()}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bte_company_name"){var param={company_name:$.bte_company_name.getText()||""};g_main.openPopup("popCompanyNew.html","popCompanyNew","",0,0,"","",param,"","")}else{if(id=="bte_wholesaler_name"){var param={wholesaler_name:$.bte_wholesaler_name.getText()||""};g_main.openPopup("popWholesaler.html","popWholesaler","",0,0,"","",param,"","")}}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){if(id=="bte_wholesaler_name"){if($.bte_wholesaler_name.getText()==""){$.txt_wholesaler_id.setValue("")}}else{if(id=="bte_company_name"){if($.bte_company_name.getText()==""){$.txt_company_id.setValue("")}}}};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmb_Dept"){if(value==null||value==""){$.cmb_Employee.setValue("");$.cmb_Employee.setEnable(false)}else{$.cmb_Employee.setEnable(true);$.cmb_Employee.clear();var subQuery=" where deptcode = '"+$.cmb_Dept.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0104",subQuery);$.cmb_Employee.setColumn("employee_id","emp_name");setComboBind([$.cmb_Employee],ds)}}else{if(id=="cmb_sido"){if(value==null||value==""){$.cmb_sigungu.setValue("");$.cmb_sigungu.setEnable(false)}else{$.cmb_sigungu.setEnable(true);$.cmb_sigungu.clear();var subQuery=" AND parent_sidogu = '"+$.cmb_sido.getValue()+"'";var ds=bizComponentData2($,"Q4","L_CRM0036",subQuery);$.cmb_sigungu.setColumn("sidogu_code","sidogu_name");setComboBind([$.cmb_sigungu],ds)}}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(id=="txtCompany2"&&value=="13"){searchSaleReportMonth("Q")}};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnNew"){newClick()}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popCompanyNew"){if($.popUpCallId=="bte_company_name"){$.txt_company_id.setValue(popResult.company_id);$.bte_company_name.setText(popResult.company_name)}}else{if(id=="popWholesaler"){if($.popUpCallId=="bte_wholesaler_name"){$.txt_wholesaler_id.setValue(popResult.wholesaler_id);$.bte_wholesaler_name.setText(popResult.wholesaler_name)}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>