<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList1=null;$.panList2=null;$.panList3=null;$.panList4=null;$.grdList1=null;$.grdList2=null;$.grdList3=null;$.grdList4=null;$.lblstart_month=null;$.cmbYearHalf=null;$.btnbeforeweek=null;$.btnafterWeek=null;$.btnSearch=null;$.rdoType=null;$.cmbWeek=null;$.varDeleteRows=[];$.varDeleteRows2=[];function QueryClick(){fnQRY_P_crmSystemProject_Q("Q")}function fnQRY_P_crmSystemProject_Q(workType){if(!validateControls([$.rdoType,$.cmbYearHalf])){return false}var json=createJSON_Q1("Q");callQuery(["req",json],workType,$)}function createJSON_Q1(workType){var json=createExecuteParamInfo("P_crmSystemProject_Q",[workType,$.rdoType.getValue(),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5)]);return json}function fnSET_P_crmSystemProject_S(workType){if(!gridValidator($.grdList1,"project_name")||!gridValidator($.grdList1,"weight")){return false}var json=createJSON_S1(workType);callExecute(["req",json],"S1",$)}function createJSON_S1(workType){var json="";var rows=[];var changedRows=$.grdList1.getChangedRows();var rId=$.grdList1.getSelectedRowIdx();if($.varDeleteRows.length>0){for(var i in $.varDeleteRows){rows.push($.varDeleteRows[i])}}if(workType.substring(0,4)=="FILE"){rows.push([workType,g_main.session.obj.EmpCode,$.grdList1.getValue(rId,"project_id"),$.grdList1.getValue(rId,"project_type"),$.grdList1.getValue(rId,"project_name"),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),$.grdList1.getValue(rId,"weight"),$.grdList1.getValue(rId,"month1_progress"),$.grdList1.getValue(rId,"month1_server_filepath"),$.grdList1.getValue(rId,"month2_progress"),$.grdList1.getValue(rId,"month2_server_filepath"),$.grdList1.getValue(rId,"month3_progress"),$.grdList1.getValue(rId,"month3_server_filepath"),$.grdList1.getValue(rId,"month4_progress"),$.grdList1.getValue(rId,"month4_server_filepath"),$.grdList1.getValue(rId,"month5_progress"),$.grdList1.getValue(rId,"month5_server_filepath"),$.grdList1.getValue(rId,"month6_progress"),$.grdList1.getValue(rId,"month6_server_filepath")])}else{for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,g_main.session.obj.EmpCode,changedRows[i].project_id,changedRows[i].project_type,changedRows[i].project_name,$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),changedRows[i].weight,changedRows[i].month1_progress,changedRows[i].month1_server_filepath,changedRows[i].month2_progress,changedRows[i].month2_server_filepath,changedRows[i].month3_progress,changedRows[i].month3_server_filepath,changedRows[i].month4_progress,changedRows[i].month4_server_filepath,changedRows[i].month5_progress,changedRows[i].month5_server_filepath,changedRows[i].month6_progress,changedRows[i].month6_server_filepath])}}json=createExecuteParamInfo("P_crmSystemProject_S",rows);return json}function fnQRY_P_crmSystemProject_LastActivity_Q(workType){if(!validateControls([$.rdoType,$.cmbYearHalf,$.cmbWeek])){return false}var json=createJSON_Q2("Q");callQuery(["req",json],workType,$)}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmSystemProject_LastActivity_Q",[workType,$.rdoType.getValue(),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),"",$.cmbWeek.getValue().substring(0,6)]);return json}function fnSET_P_crmSystemProject_LastActivity_S(workType){var changedRows=$.grdList2.getChangedRows();for(var i=0;i<changedRows.length;i++){if(changedRows[i].activity==null||changedRows[i].activity==""){MessageBoxShow("진행업무 은(는) 필수 입력항목입니다. ");return}}var json=createJSON_S2(workType);callExecute(["req",json],"S2",$)}function createJSON_S2(workType){var json="";var rows=[];var changedRows=$.grdList2.getChangedRows();if(changedRows.length==0){return}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,g_main.session.obj.EmpCode,changedRows[i].project_id,changedRows[i].yyyymm,changedRows[i].activity_id,changedRows[i].activity,changedRows[i].issue,changedRows[i].comment,changedRows[i].progress_rate])}json=createExecuteParamInfo("P_crmSystemProject_LastActivity_S",rows);return json}function fnQRY_P_crmSystemProject_NextActivity_Q(workType){if(!validateControls([$.rdoType,$.cmbYearHalf,$.cmbWeek])){return false}var json=createJSON_Q3("Q");callQuery(["req",json],workType,$)}function createJSON_Q3(workType){var json=createExecuteParamInfo("P_crmSystemProject_NextActivity_Q",[workType,$.rdoType.getValue(),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),"",$.cmbWeek.getValue().substring(0,6)]);return json}function fnSET_P_crmSystemProject_NextActivity_S(workType){var changedRows=$.grdList3.getChangedRows();for(var i=0;i<changedRows.length;i++){if(changedRows[0].activity==null||changedRows[0].activity==""){MessageBoxShow("진행업무 계획 은(는) 필수 입력항목입니다.");return}else{if(changedRows[0].progress_rate==null||changedRows[0].progress_rate==""){MessageBoxShow("진행계획 은(는) 필수 입력항목입니다.");return}}}var json=createJSON_S3(workType);callExecute(["req",json],"S3",$)}function createJSON_S3(workType){var json="";var rows=[];var changedRows=$.grdList3.getChangedRows();if(changedRows.length==0){return}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,g_main.session.obj.EmpCode,changedRows[i].project_id,changedRows[i].yyyymm,changedRows[i].activity_id,changedRows[i].activity,changedRows[i].progress_rate])}json=createExecuteParamInfo("P_crmSystemProject_NextActivity_S",rows);return json}function fnQRY_P_crmSystemProject_WeekTask_Q(workType){if(!validateControls([$.rdoType,$.cmbWeek])){return false}var json=createJSON_Q4("Q");callQuery(["req",json],workType,$)}function createJSON_Q4(workType){var json=createExecuteParamInfo("P_crmSystemProject_WeekTask_Q",[workType,$.rdoType.getValue(),$.cmbWeek.getValue().substring(0,6),$.cmbWeek.getValue().substring(6,7)]);return json}function fnSET_P_crmSystemProject_WeekTask_S(workType){if(!gridValidator($.grdList4,"yyyymm")||!gridValidator($.grdList4,"week")||!gridValidator($.grdList4,"task_type")||!gridValidator($.grdList4,"task")){return false}var json=createJSON_S4(workType);callExecute(["req",json],"S4",$)}function createJSON_S4(workType){var json="";var rows=[];var changedRows=$.grdList4.getChangedRows()||[];if($.varDeleteRows2.length>0){for(var i in $.varDeleteRows2){rows.push($.varDeleteRows2[i])}}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,g_main.session.obj.EmpCode,workType=="N"?"":changedRows[i].task_id,changedRows[i].yyyymm,changedRows[i].week,changedRows[i].task_type,changedRows[i].task])}log(rows);json=createExecuteParamInfo("P_crmSystemProject_WeekTask_S",rows);return json}function gridValidator(){if(arguments.length<2){return false}log(arguments[0]);var grdName=arguments[0];for(var i=0;i<grdName.getRowCount();i++){for(var j=1;j<arguments.length;j++){if(grdName.getValue(i,arguments[j])==""||grdName.getValue(i,arguments[j])==null){MessageBoxShow(grdName.getColumnText(arguments[j])+" 은(는) 필수 입력항목입니다");return false}}}return true}function fnQRY_P_crmSystemProject_REPORT_Q(workType){var json=createJSON_Q5(workType);callQuery(["req",json],workType,$)}function createJSON_Q5(workType){var json=createExecuteParamInfo("P_crmSystemProject_REPORT_Q",[workType,$.rdoType.getValue(),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),"",$.cmbWeek.getValue().substring(0,6),$.cmbWeek.getValue().substring(6,7)]);return json}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,710);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,55);$.panQuery.setText("");$.panQuery.setBottomLine();$.panList1=new FingerPanel(host,"panList1",0,60,1200,220);$.panList1.setText("프로젝트 계획");$.panList1.setBottomLine(true);$.panList2=new FingerPanel(host,"panList2",0,285,1200,220);$.panList2.setText("이번달 진행업무");$.panList2.setBottomLine(true);$.panList3=new FingerPanel(host,"panList3",0,510,600,190);$.panList3.setText("다음달 진행업무");$.panList3.setBottomLine(true);$.panList4=new FingerPanel(host,"panList4",605,510,595,190);$.panList4.setText("주간업무");$.panList4.setBottomLine(true);$.grdList1=new FingerDataGrid(host,"grdList1",0,0,1200,175);$.grdList2=new FingerDataGrid(host,"grdList2",0,0,1200,175);$.grdList3=new FingerDataGrid(host,"grdList3",0,0,600,145);$.grdList4=new FingerDataGrid(host,"grdList4",0,0,595,145);$.lblstart_month=new FingerLabel(host,"lblstart_month",0,15,100,20);$.lblstart_month.setText("년도/반기");$.cmbYearHalf=new FingerComboBox(host,"cmbYearHalf",105,15,140,20);$.btnbeforeweek=new FingerButton(host,"btnbeforeweek",250,17,50,20);$.btnbeforeweek.setText("◀");$.btnafterWeek=new FingerButton(host,"btnafterWeek",415,17,50,20);$.btnafterWeek.setText("▶");$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.rdoType=new FingerRadioBox(host,"rdoType",625,15,280,20);$.cmbWeek=new FingerComboBox(host,"cmbWeek",280,16,140,20);$.panQuery.setBorder(true);$.cmbYearHalf.setAllowBlank(false,"년도/반기");$.cmbWeek.setAllowBlank(false,"주차");$.panList1.addButtons(["btnDelete","btnSave","btnNew","btnPrint"]);$.panList2.addButtons(["btnSave"]);$.panList3.addButtons(["btnSave"]);$.panList4.addButtons(["btnDelete","btnSave","btnNew"]);$.grdList1.setColumns([new FingerDataGridColumn("project_id",100,"left","string","project_id",{hidden:true}),new FingerDataGridColumn("project_type",60,"left","string","구분"),new FingerDataGridColumn("project_name",200,"left","string",{text:"프로젝트명",css:"col_chk"}),new FingerDataGridColumn("base_yyyy",100,"left","string","년도",{hidden:true}),new FingerDataGridColumn("base_half",100,"left","string","반기",{hidden:true}),new FingerDataGridColumn("weight",80,"left","string",{text:"가중치",css:"col_chk"}),new FingerDataGridColumn("month1_progress",100,"left","string","4월"),new FingerDataGridColumn("month1_finish",60,"left","string",""),new FingerDataGridColumn("month1_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month2_progress",100,"left","string","5월"),new FingerDataGridColumn("month2_finish",60,"left","string",""),new FingerDataGridColumn("month2_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month3_progress",100,"left","string","6월"),new FingerDataGridColumn("month3_finish",60,"left","string",""),new FingerDataGridColumn("month3_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month4_progress",100,"left","string","7월"),new FingerDataGridColumn("month4_finish",60,"left","string",""),new FingerDataGridColumn("month4_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month5_progress",100,"left","string","8월"),new FingerDataGridColumn("month5_finish",60,"left","string",""),new FingerDataGridColumn("month5_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month6_progress",100,"left","string","9월"),new FingerDataGridColumn("month6_finish",60,"left","string",""),new FingerDataGridColumn("month6_server_filepath",60,"left","string","",{hidden:true})]);$.grdList1.init({panel:$.panList1,scroll:"xy",isFilter:false,nonExcel:true});$.grdList1.setEditable(true);$.grdList1.setBorder(false);$.grdList2.setColumns([new FingerDataGridColumn("project_id",100,"left","string","project_id",{hidden:true}),new FingerDataGridColumn("project_name",260,"left","string",{text:"프로젝트명",css:"col_chk"}),new FingerDataGridColumn("yyyymm",100,"left","string",{text:"년월",css:"col_chk"}),new FingerDataGridColumn("activity_id",100,"left","string","activity_id",{hidden:true}),new FingerDataGridColumn("activity",200,"left","string",{text:"진행업무",css:"col_chk"}),new FingerDataGridColumn("issue",200,"left","string","이슈사항"),new FingerDataGridColumn("comment",220,"left","string","comment"),new FingerDataGridColumn("progress_rate",200,"left","string","진행완료"),new FingerDataGridColumn("create_user",100,"left","string","등록자",{hidden:true}),new FingerDataGridColumn("create_time",100,"left","string","등록일자",{hidden:true}),new FingerDataGridColumn("update_user",100,"left","string","수정자",{hidden:true}),new FingerDataGridColumn("update_time",100,"left","string","수정일자",{hidden:true})]);$.grdList2.init({panel:$.panList2,scroll:"xy",isFilter:false,nonExcel:true,eventCellReadOnly:true});$.grdList2.setEditable(true);$.grdList2.setBorder(false);$.grdList3.setColumns([new FingerDataGridColumn("project_id",100,"left","string","project_id",{hidden:true}),new FingerDataGridColumn("project_name",220,"left","string",{text:"프로젝트명",css:"col_chk"}),new FingerDataGridColumn("yyyymm",80,"left","string",{text:"년월",css:"col_chk"}),new FingerDataGridColumn("activity_id",100,"left","string","activity_id",{hidden:true}),new FingerDataGridColumn("activity",180,"left","string",{text:"진행업무 계획",css:"col_chk"}),new FingerDataGridColumn("progress_rate",100,"left","string",{text:"진행계획",css:"col_chk"}),new FingerDataGridColumn("create_user",100,"left","string","등록자",{hidden:true}),new FingerDataGridColumn("create_time",100,"left","string","등록일자",{hidden:true}),new FingerDataGridColumn("update_user",100,"left","string","수정자",{hidden:true}),new FingerDataGridColumn("update_time",100,"left","string","수정일자",{hidden:true})]);$.grdList3.init({panel:$.panList3,scroll:"xy",isFilter:false,nonExcel:true});$.grdList3.setEditable(true);$.grdList3.setBorder(false);$.grdList4.setColumns([new FingerDataGridColumn("task_id",100,"left","string","task_id",{hidden:true}),new FingerDataGridColumn("yyyymm",100,"left","string",{text:"년월",css:"col_chk"}),new FingerDataGridColumn("week",80,"left","string",{text:"주",css:"col_chk"}),new FingerDataGridColumn("task_type",120,"left","string",{text:"구분",css:"col_chk"}),new FingerDataGridColumn("task",275,"left","string",{text:"진행업무",css:"col_chk"}),new FingerDataGridColumn("create_user",100,"left","string","등록자",{hidden:true}),new FingerDataGridColumn("create_time",100,"left","string","등록일자",{hidden:true}),new FingerDataGridColumn("update_user",100,"left","string","수정자",{hidden:true}),new FingerDataGridColumn("update_time",100,"left","string","수정일자",{hidden:true})]);$.grdList4.init({panel:$.panList4,scroll:"xy",isFilter:false,nonExcel:true});$.grdList4.setEditable(true);$.grdList4.setBorder(false);$.rdoType.addButtons([{sub_code:"ka070040",code_name:"이혜리"},{sub_code:"ka110192",code_name:"윤지영"},{sub_code:"ka120213",code_name:"서정진"},{sub_code:"ka130292",code_name:"유승민"}]);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList1);$.panMain.add($.panList2);$.panMain.add($.panList3);$.panMain.add($.panList4);$.panQuery.add($.lblstart_month);$.panQuery.add($.cmbYearHalf);$.panQuery.add($.btnbeforeweek);$.panQuery.add($.btnafterWeek);$.panQuery.add($.btnSearch);$.panQuery.add($.rdoType);$.panQuery.add($.cmbWeek);$.panList1.add($.grdList1);$.panList2.add($.grdList2);$.panList3.add($.grdList3);$.panList4.add($.grdList4);var ds=bizComponentData2($,"Q1","L_CRM0008_2");$.cmbYearHalf.setColumn("half_code","half_name");setComboBind([$.cmbYearHalf],ds);var strQuery=" where getdate() between start_date and end_date";var ds1=bizComponentData2($,"Q1","L_CRM0242",strQuery);$.cmbWeek.setColumn("week","week_name");setComboBind([$.cmbWeek],ds1);var ds=bizComponentData2($,"Q1","L_CRM0244|L_CRM0245|L_CRM0243");$.grdList1.setColumnDropDownList("project_type",ds.resultList[0],{key:"sub_code",name:"code_name"});$.grdList2.setColumnDropDownList("progress_rate",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList3.setColumnDropDownList("progress_rate",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList4.setColumnDropDownList("task_type",ds.resultList[2],{key:"sub_code",name:"code_name"});if(g_main.session.obj.EmpCode=="ka961015"){$.rdoType.setValue("ka070040")}else{if(g_main.session.obj.EmpCode=="ka070040"){$.rdoType.setValue("ka070040")}else{if(g_main.session.obj.EmpCode=="ka110192"){$.rdoType.setValue("ka110192")}else{if(g_main.session.obj.EmpCode=="ka120213"){$.rdoType.setValue("ka120213")}else{if(g_main.session.obj.EmpCode=="ka130292"){$.rdoType.setValue("ka130292")}}}}}QueryClick()};$.callback=function(type,ds){$.varDeleteRows=[];$.varDeleteRows2=[];if(type=="Q"){$.grdList1.removeColumns();if($.cmbYearHalf.getValue().substring(4,5)=="1"){$.grdList1.resetColumns([new FingerDataGridColumn("project_id",100,"left","string","project_id",{hidden:true}),new FingerDataGridColumn("project_type",70,"left","string","구분"),new FingerDataGridColumn("project_name",200,"left","string",{text:"프로젝트명",css:"col_chk"}),new FingerDataGridColumn("base_yyyy",100,"left","string","년도",{hidden:true}),new FingerDataGridColumn("base_half",100,"left","string","반기",{hidden:true}),new FingerDataGridColumn("weight",60,"left","string",{text:"가중치",css:"col_chk"}),new FingerDataGridColumn("month1_progress",100,"left","string","4월"),new FingerDataGridColumn("month1_finish",60,"left","string",""),new FingerDataGridColumn("month1_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month1_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month2_progress",100,"left","string","5월"),new FingerDataGridColumn("month2_finish",60,"left","string",""),new FingerDataGridColumn("month2_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month2_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month3_progress",100,"left","string","6월"),new FingerDataGridColumn("month3_finish",60,"left","string",""),new FingerDataGridColumn("month3_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month3_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month4_progress",100,"left","string","7월"),new FingerDataGridColumn("month4_finish",60,"left","string",""),new FingerDataGridColumn("month4_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month4_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month5_progress",100,"left","string","8월"),new FingerDataGridColumn("month5_finish",60,"left","string",""),new FingerDataGridColumn("month5_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month5_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month6_progress",100,"left","string","9월"),new FingerDataGridColumn("month6_finish",60,"left","string",""),new FingerDataGridColumn("month6_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month6_view",50,"center","string","보기",{readonly:true,isLink:true})])}else{if($.cmbYearHalf.getValue().substring(4,5)=="2"){$.grdList1.resetColumns([new FingerDataGridColumn("project_id",100,"left","string","project_id",{hidden:true}),new FingerDataGridColumn("project_type",70,"left","string","구분"),new FingerDataGridColumn("project_name",200,"left","string",{text:"프로젝트명",css:"col_chk"}),new FingerDataGridColumn("base_yyyy",100,"left","string","년도",{hidden:true}),new FingerDataGridColumn("base_half",100,"left","string","반기",{hidden:true}),new FingerDataGridColumn("weight",80,"left","string",{text:"가중치",css:"col_chk"}),new FingerDataGridColumn("month1_progress",100,"left","string","10월"),new FingerDataGridColumn("month1_finish",60,"left","string",""),new FingerDataGridColumn("month1_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month1_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month2_progress",100,"left","string","11월"),new FingerDataGridColumn("month2_finish",60,"left","string",""),new FingerDataGridColumn("month2_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month2_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month3_progress",100,"left","string","12월"),new FingerDataGridColumn("month3_finish",60,"left","string",""),new FingerDataGridColumn("month3_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month3_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month4_progress",100,"left","string","1월"),new FingerDataGridColumn("month4_finish",60,"left","string",""),new FingerDataGridColumn("month4_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month4_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month5_progress",100,"left","string","2월"),new FingerDataGridColumn("month5_finish",60,"left","string",""),new FingerDataGridColumn("month5_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month5_view",50,"center","string","보기",{readonly:true,isLink:true}),new FingerDataGridColumn("month6_progress",100,"left","string","3월"),new FingerDataGridColumn("month6_finish",60,"left","string",""),new FingerDataGridColumn("month6_server_filepath",60,"left","string","",{hidden:true}),new FingerDataGridColumn("month6_view",50,"center","string","보기",{readonly:true,isLink:true})])}}for(var i=0;i<ds.resultList[0].length;i++){if(ds.resultList[0][i].month1_server_filepath!=""){ds.resultList[0][i].month1_view="[보기]"}if(ds.resultList[0][i].month2_server_filepath!=""){ds.resultList[0][i].month2_view="[보기]"}if(ds.resultList[0][i].month3_server_filepath!=""){ds.resultList[0][i].month3_view="[보기]"}if(ds.resultList[0][i].month4_server_filepath!=""){ds.resultList[0][i].month4_view="[보기]"}if(ds.resultList[0][i].month5_server_filepath!=""){ds.resultList[0][i].month5_view="[보기]"}if(ds.resultList[0][i].month6_server_filepath!=""){ds.resultList[0][i].month6_view="[보기]"}}setDataGrid([$.grdList1],ds);$.grdList1.selectRow(0);var ds=bizComponentData2($,"Q1","L_CRM0244|L_CRM0245");$.grdList1.setColumnDropDownList("project_type",ds.resultList[0],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month1_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month2_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month3_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month4_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month5_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});$.grdList1.setColumnDropDownList("month6_progress",ds.resultList[1],{key:"sub_code",name:"code_name"});fnQRY_P_crmSystemProject_LastActivity_Q("Q1")}else{if(type=="Q1"){setDataGrid([$.grdList2],ds);$.grdList2.selectRow(0);var aRow=$.grdList2.getAllRows();for(var i in aRow){if(g_main.session.obj.EmpCode!="ka961015"){aRow[i].comment_readonly=true}}fnQRY_P_crmSystemProject_NextActivity_Q("Q2")}else{if(type=="Q2"){setDataGrid([$.grdList3],ds);$.grdList3.selectRow(0);fnQRY_P_crmSystemProject_WeekTask_Q("Q3")}else{if(type=="Q3"){setDataGrid([$.grdList4],ds);$.grdList4.selectRow(0)}else{if(type=="S1"){fnQRY_P_crmSystemProject_Q("Q");fnQRY_P_crmSystemProject_LastActivity_Q("Q1");fnQRY_P_crmSystemProject_NextActivity_Q("Q2")}else{if(type=="S2"){fnQRY_P_crmSystemProject_LastActivity_Q("Q1")}else{if(type=="S3"){fnQRY_P_crmSystemProject_NextActivity_Q("Q2")}else{if(type=="S4"){fnQRY_P_crmSystemProject_WeekTask_Q("Q3")}else{if(type=="PRINT"){var params={report:"report_crmSystemProject",isPrint:false};if(ds.resultList[4].length<1){var obj={};obj.yyyymm="";obj.week="";obj.task_type_name="";obj.task="";ds.resultList[4].push(obj)}params.data={Info:ds.resultList[0],Info2:ds.resultList[1],Info3:ds.resultList[2],Info4:ds.resultList[3],Info5:ds.resultList[4]};g_printBrowser.callPrint(params)}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){QueryClick()}else{if(id=="btnbeforeweek"){var strQuery=" where yyyymm+week = (select max(yyyymm+week) from crmSystemProject_Week where yyyymm+week < '"+$.cmbWeek.getValue()+"')";var ds=bizComponentData2($,"Q4","L_CRM0242",strQuery);$.cmbWeek.setColumn("week","week_name");$.cmbWeek.clear();setComboBind([$.cmbWeek],ds);QueryClick()}else{if(id=="btnafterWeek"){var strQuery=" where yyyymm+week = (select min(yyyymm+week) from crmSystemProject_Week where yyyymm+week > '"+$.cmbWeek.getValue()+"')";var ds=bizComponentData2($,"Q4","L_CRM0242",strQuery);$.cmbWeek.setColumn("week","week_name");$.cmbWeek.clear();setComboBind([$.cmbWeek],ds);QueryClick()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList1"){if(cInd=="month1_finish"||cInd=="month2_finish"||cInd=="month3_finish"||cInd=="month4_finish"||cInd=="month5_finish"||cInd=="month6_finish"){var rId=$.grdList1.getSelectedRowIdx();var strWorkType="";OpenFileUploader("SystemProjectFiles",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}if(ds.errorCode=="MSG0000"){for(var i=0;i<ds.resultList[0].length;i++){var filepath=ds.resultList[0][i].file_url;if(cInd=="month1_finish"){strWorkType="FILE1";$.grdList1.setValue(rId,"month1_server_filepath",filepath)}else{if(cInd=="month2_finish"){strWorkType="FILE2";$.grdList1.setValue(rId,"month2_server_filepath",filepath)}else{if(cInd=="month3_finish"){strWorkType="FILE3";$.grdList1.setValue(rId,"month3_server_filepath",filepath)}else{if(cInd=="month4_finish"){strWorkType="FILE4";$.grdList1.setValue(rId,"month4_server_filepath",filepath)}else{if(cInd=="month5_finish"){strWorkType="FILE5";$.grdList1.setValue(rId,"month5_server_filepath",filepath)}else{if(cInd=="month6_finish"){strWorkType="FILE6";$.grdList1.setValue(rId,"month6_server_filepath",filepath)}}}}}}}fnSET_P_crmSystemProject_S(strWorkType);MessageBoxShow("업로드 되었습니다.")}})}else{if(cInd=="month1_view"||cInd=="month2_view"||cInd=="month3_view"||cInd=="month4_view"||cInd=="month5_view"||cInd=="month6_view"){var rId=$.grdList1.getSelectedRowIdx();if(cInd=="month1_view"){if($.grdList1.getValue(rId,"month1_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month1_server_filepath"))}}else{if(cInd=="month2_view"){if($.grdList1.getValue(rId,"month2_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month2_server_filepath"))}}else{if(cInd=="month3_view"){if($.grdList1.getValue(rId,"month3_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month3_server_filepath"))}}else{if(cInd=="month4_view"){if($.grdList1.getValue(rId,"month4_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month4_server_filepath"))}}else{if(cInd=="month5_view"){if($.grdList1.getValue(rId,"month5_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month5_server_filepath"))}}else{if(cInd=="month6_view"){if($.grdList1.getValue(rId,"month6_server_filepath")!=""){g_fileBrowser.download($.grdList1.getValue(rId,"month6_server_filepath"))}}}}}}}}}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList1"){if(btnId=="btnNew"){$.grdList1.addRow({project_id:"",project_type:"",project_name:"",base_yyyy:$.cmbYearHalf.getValue().substring(0,4),base_half:$.cmbYearHalf.getValue().substring(4,5),weight:"",month1_progress:"",month1_finish:"",month1_server_filepath:"",month2_progress:"",month2_finish:"",month2_server_filepath:"",month3_progress:"",month3_finish:"",month3_server_filepath:"",month4_progress:"",month4_finish:"",month4_server_filepath:"",month5_progress:"",month5_finish:"",month5_server_filepath:"",month6_progress:"",month6_finish:"",month6_server_filepath:""})}else{if(btnId=="btnSave"){if($.grdList1.getChangedRows().length<=0&&$.varDeleteRows.length<=0){return}fnSET_P_crmSystemProject_S("")}else{if(btnId=="btnDelete"){if($.grdList1.getRowCount()!=0){var rId=$.grdList1.getSelectedRowIdx();if($.grdList1.getValue(rId,"rowType")=="N"){$.grdList1.deleteRow(rId)}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare){$.varDeleteRows.push(["D",g_main.session.obj.EmpCode,$.grdList1.getValue(rId,"project_id"),$.grdList1.getValue(rId,"project_type"),$.grdList1.getValue(rId,"project_name"),$.cmbYearHalf.getValue().substring(0,4),$.cmbYearHalf.getValue().substring(4,5),$.grdList1.getValue(rId,"weight"),$.grdList1.getValue(rId,"month1_progress"),$.grdList1.getValue(rId,"month1_server_filepath"),$.grdList1.getValue(rId,"month2_progress"),$.grdList1.getValue(rId,"month2_server_filepath"),$.grdList1.getValue(rId,"month3_progress"),$.grdList1.getValue(rId,"month3_server_filepath"),$.grdList1.getValue(rId,"month4_progress"),$.grdList1.getValue(rId,"month4_server_filepath"),$.grdList1.getValue(rId,"month5_progress"),$.grdList1.getValue(rId,"month5_server_filepath"),$.grdList1.getValue(rId,"month6_progress"),$.grdList1.getValue(rId,"month6_server_filepath")]);$.grdList1.deleteRow(rId);$.grdList1.selectRow(0);log($.varDeleteRows)}})}}}else{if(btnId=="btnPrint"){if($.grdList1.getRowCount()<1||$.grdList2.getRowCount()<1||$.grdList3.getRowCount()<1){return}fnQRY_P_crmSystemProject_REPORT_Q("PRINT")}}}}}else{if(panelId=="panList2"){if(btnId=="btnSave"){if($.grdList2.getChangedRows().length<=0){return}fnSET_P_crmSystemProject_LastActivity_S("")}}else{if(panelId=="panList3"){if(btnId=="btnSave"){if($.grdList3.getChangedRows().length<=0){return}fnSET_P_crmSystemProject_NextActivity_S("")}}else{if(panelId=="panList4"){if(btnId=="btnNew"){$.grdList4.addRow({yyyymm:$.cmbWeek.getValue().substring(0,6),week:$.cmbWeek.getValue().substring(6,7),task_type:"",task:""})}else{if(btnId=="btnSave"){if($.grdList4.getChangedRows().length<=0&&$.varDeleteRows2.length<=0){return}fnSET_P_crmSystemProject_WeekTask_S("")}else{if(btnId=="btnDelete"){if($.grdList4.getRowCount()!=0){var rId=$.grdList4.getSelectedRowIdx();if($.grdList4.getValue(rId,"rowType")=="N"){$.grdList4.deleteRow(rId)}else{confirmBoxShow("정말 삭제하시겠습니까?<br/>삭제하시려면 예를 클릭하세요.",function(){if(g_main.msgShare){$.varDeleteRows2.push(["D",g_main.session.obj.EmpCode,$.grdList4.getValue(rId,"task_id"),$.grdList4.getValue(rId,"yyyymm"),$.grdList4.getValue(rId,"week"),$.grdList4.getValue(rId,"task_type"),$.grdList4.getValue(rId,"task")]);$.grdList4.deleteRow(rId);$.grdList4.selectRow(0)}})}}}}}}}}}};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){if(id=="rdoType"){QueryClick()}};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>