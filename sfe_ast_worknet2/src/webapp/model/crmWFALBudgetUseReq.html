<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panWFMain=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.wbeWFDetail=null;$.panList=null;$.grdList=null;$.lblDept=null;$.lblEmp=null;$.lblALTitle=null;$.lblEduType=null;$.lblEduTitle=null;$.lblAgenda=null;$.lblAvalAmt=null;$.lblEduDate=null;$.lblWorkPlace=null;$.lblTelAddr=null;$.lblAttendence=null;$.lblLabel1=null;$.txtDept=null;$.txtEmp=null;$.txtALTitle=null;$.rdoEduType=null;$.txtEduTitle=null;$.memAgenda=null;$.speAvalAmt=null;$.dteStart=null;$.dteEnd=null;$.txtWorkPlace=null;$.txtTelAddr=null;$.txtAttendence=null;$.lblWave=null;$.lblLabel2=null;$.btnEsero=null;$.btnCard=null;$.grdFile=null;$.grdDoc=null;$.varWFDocId="";$.varBusinessId="";$.varWFType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFALBudgetUseReq"]);return json}function createJSON_Q2(workType){var json=createExecuteParamInfo("P_crmWFALBudgetUse_Q",[workType,"#UserID#","#DeptCode#"]);return json}function createJSON_S(workType){var sumAmt=0;for(var i=0;i<$.grdList.getRowCount();i++){sumAmt+=Number($.grdList.getValue(i,"use_amt"))}var json=createExecuteParamInfo("P_crmWFALBudgetUse_S",[workType,$.varWfDocId,$.rdoEduType.getValue(),$.txtEduTitle.getValue(),$.dteStart.getText(),$.dteEnd.getText(),$.memAgenda.getValue(),$.txtWorkPlace.getValue(),$.txtTelAddr.getValue(),$.txtAttendence.getValue(),$.speAvalAmt.getValue(),sumAmt,"#DeptCode#","#UserID#"]);return json}function createJSON_S1(){var json="";var changedRows=$.grdFile.getAllRows();if(changedRows.length<1){return false}var rows=[];for(var i in changedRows){rows.push(["S",$.varWfDocId,changedRows[i].seq||"",changedRows[i].file_type||"",changedRows[i].server_path||"",changedRows[i].local_fname||"",changedRows[i].server_fname||"","#UserID#"])}json=createExecuteParamInfo("P_crmWFALBudgetUseFile_S",rows);return json}function createJSON_S2(){var json="";var changedRows=$.grdList.getAllRows();if(changedRows.length<1){return false}var rows=[];for(var i in changedRows){rows.push(["S",$.varWfDocId,i||"",changedRows[i].receipt_type||"",changedRows[i].use_date||"",changedRows[i].use_amt||"",changedRows[i].tax_amt||"",changedRows[i].nodeduction_amt||"",changedRows[i].deposit_emp_code||"",changedRows[i].deposit_emp_name||"",changedRows[i].SAPCODE||"",changedRows[i].CARDNO||"",changedRows[i].APPRNO||""])}json=createExecuteParamInfo("P_crmWFALBudgetUseReceipt_S",rows);return json}function searchWFDocument(){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function searchActionLearning(workType){var json=createJSON_Q2(workType);callQuery(["req",json],"Q",$)}function saveActionLearning(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"S",$);if(ds.errorCode=="MSG0002"){saveBudgetUseReceipt()}}}function saveBudgetUseReceipt(){var json=createJSON_S2("S");if(json){var ds=callExecuteSync(["req",json],"S",$);if(ds){saveBudgetFile()}}}function saveBudgetFile(){var json=createJSON_S1("S");if(json){var ds=callExecuteSync(["req",json],"S",$);var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWfDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWfDocId=ds.returnStr}return true}function rowProperties(rId,val){switch(val){case"10":$.grdList.setValue(rId,"modify_yn","Y");$.grdList.setValue(rId,"use_date_readonly",false);$.grdList.setValue(rId,"use_amt_readonly",false);$.grdList.setValue(rId,"tax_amt_readonly",true);$.grdList.setValue(rId,"nodeduction_amt_readonly",true);break;case"20":$.grdList.setValue(rId,"modify_yn","N");$.grdList.setValue(rId,"use_date_readonly",true);$.grdList.setValue(rId,"use_amt_readonly",true);$.grdList.setValue(rId,"tax_amt_readonly",true);$.grdList.setValue(rId,"nodeduction_amt_readonly",true);break;case"30":$.grdList.setValue(rId,"modify_yn","Y");$.grdList.setValue(rId,"use_date_readonly",false);$.grdList.setValue(rId,"use_amt_readonly",false);$.grdList.setValue(rId,"tax_amt_readonly",false);$.grdList.setValue(rId,"nodeduction_amt_readonly",false);break;case"40":$.grdList.setValue(rId,"modify_yn","N");$.grdList.setValue(rId,"use_date_readonly",false);$.grdList.setValue(rId,"use_amt_readonly",false);$.grdList.setValue(rId,"tax_amt_readonly",true);$.grdList.setValue(rId,"nodeduction_amt_readonly",true);break;case"50":$.grdList.setValue(rId,"modify_yn","N");$.grdList.setValue(rId,"use_date_readonly",true);$.grdList.setValue(rId,"use_amt_readonly",true);$.grdList.setValue(rId,"tax_amt_readonly",false);$.grdList.setValue(rId,"nodeduction_amt_readonly",false);break}}function setSeq(grd,colId){var seq=0;if(grd.getRowCount()>0){for(var i=0;i<grd.getRowCount();i++){if(seq<grd.getValue(i,colId)){seq=grd.getValue(i,colId)}}}return(seq+1)}function filecheck(){var strcashchk="N";var strfilecheck1="N";var strfilecheck2="N";var strfilecheck3="N";var strfilecheck4="N";var receiptData=$.grdList.getAllRows();for(var i in receiptData){if(receiptData[i].receipt_type=="10"){strcashchk="Y"}}var fileData=$.grdFile.getAllRows();if($.rdoEduType.getValue()=="LECTURE"){for(var i in fileData){if(fileData[i].file_type=="10"){strfilecheck1="Y"}else{if(fileData[i].file_type=="20"){strfilecheck2="Y"}else{if(fileData[i].file_type=="30"){strfilecheck3="Y"}else{if(fileData[i].file_type=="40"){strfilecheck4="Y"}}}}}if(strfilecheck1=="N"||strfilecheck2=="N"||strfilecheck3=="N"||strfilecheck4=="N"){MessageBoxShow("강연계약서, 개인정보활용동의서, 강의사진, 강연자료는 필수 첨부파일입니다.");return false}else{return true}}else{if($.rdoEduType.getValue()=="OPENLECTURE"){if(strcashchk=="Y"){for(var i in fileData){if(fileData[i].file_type=="50"){strfilecheck1="Y"}}if(strfilecheck1=="N"){MessageBoxShow("입금증은 필수 첨부 파일입니다.");return false}else{return true}}else{return true}}else{if($.rdoEduType.getValue()=="SEMINAR"){if(strcashchk=="Y"){for(var i in fileData){if(fileData[i].file_type=="50"){strfilecheck1="Y"}}if(strfilecheck1=="N"){MessageBoxShow("입금증은 필수 첨부 파일입니다.");return false}else{return true}}else{return true}}else{if($.rdoEduType.getValue()=="BOOK"){for(var i in fileData){if(fileData[i].file_type=="60"){strfilecheck1="Y"}}if(strfilecheck1=="N"){MessageBoxShow("도서구입내역서는 필수 첨부파일입니다.");return false}else{return true}}else{if($.rdoEduType.getValue()=="ETC"){for(var i in fileData){if(fileData[i].file_type=="70"){strfilecheck1="Y"}}if(strfilecheck1=="N"){MessageBoxShow("구입내역서는 필수 첨부파일입니다.");return false}else{return true}}else{return true}}}}}}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1380);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine();$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panWFMain=new FingerPanel(host,"panWFMain",0,65,1200,285);$.panWFMain.setText("기안내용");$.panWFMain.setBottomLine(true);$.panWFDetail=new FingerPanel(host,"panWFDetail",0,690,1200,385);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,1090,440,280);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",450,1090,750,280);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.wbeWFDetail=new FingerWebEditor(host,"wbeWFDetail",0,0,1200,310);$.panList=new FingerPanel(host,"panList",0,365,1200,310);$.panList.setText("증빙내역");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,1200,265);$.lblDept=new FingerLabel(host,"lblDept",0,10,100,20);$.lblDept.setText("소속부서");$.lblEmp=new FingerLabel(host,"lblEmp",320,10,100,20);$.lblEmp.setText("신청인");$.lblALTitle=new FingerLabel(host,"lblALTitle",0,40,100,20);$.lblALTitle.setText("학습과제");$.lblEduType=new FingerLabel(host,"lblEduType",0,70,100,20);$.lblEduType.setText("교육유형");$.lblEduTitle=new FingerLabel(host,"lblEduTitle",0,140,100,20);$.lblEduTitle.setText("학회명");$.lblAgenda=new FingerLabel(host,"lblAgenda",0,170,100,20);$.lblAgenda.setText("Agenda");$.lblAvalAmt=new FingerLabel(host,"lblAvalAmt",585,10,100,20);$.lblAvalAmt.setText("잔여예산");$.lblEduDate=new FingerLabel(host,"lblEduDate",585,110,100,20);$.lblEduDate.setText("기간");$.lblWorkPlace=new FingerLabel(host,"lblWorkPlace",585,140,100,20);$.lblWorkPlace.setText("학회");$.lblTelAddr=new FingerLabel(host,"lblTelAddr",585,170,100,20);$.lblTelAddr.setText("연락처");$.lblAttendence=new FingerLabel(host,"lblAttendence",585,200,100,20);$.lblAttendence.setText("참석자");$.lblLabel1=new FingerLabel(host,"lblLabel1",620,45,560,20);$.lblLabel1.setText("");$.txtDept=new FingerEdit(host,"txtDept",105,10,225,20);$.txtEmp=new FingerEdit(host,"txtEmp",425,10,140,20);$.txtALTitle=new FingerEdit(host,"txtALTitle",105,40,460,20);$.rdoEduType=new FingerRadioBox(host,"rdoEduType",105,75,460,60);$.txtEduTitle=new FingerEdit(host,"txtEduTitle",105,140,460,20);$.memAgenda=new FingerMemoEdit(host,"memAgenda",105,170,455,50);$.speAvalAmt=new FingerSpinEdit(host,"speAvalAmt",690,10,140,20);$.dteStart=new FingerDateEdit(host,"dteStart",690,110,145,20);$.dteEnd=new FingerDateEdit(host,"dteEnd",860,110,145,20);$.txtWorkPlace=new FingerEdit(host,"txtWorkPlace",690,140,315,20);$.txtTelAddr=new FingerEdit(host,"txtTelAddr",690,170,315,20);$.txtAttendence=new FingerEdit(host,"txtAttendence",690,200,315,20);$.lblWave=new FingerLabel(host,"lblWave",835,110,20,20);$.lblWave.setText("~");$.lblLabel2=new FingerLabel(host,"lblLabel2",620,70,560,20);$.lblLabel2.setText("");$.btnEsero=new FingerButton(host,"btnEsero",720,-40,130,30);$.btnEsero.setText("전자세금계산서");$.btnCard=new FingerButton(host,"btnCard",835,-40,120,30);$.btnCard.setText("법인카드내역");$.grdFile=new FingerDataGrid(host,"grdFile",0,0,440,230);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,750,230);$.panTitle.setBorder(true);$.panList.addButtons(["btnDelete","btnAdd"]);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.txtDept.setReadOnly(true);$.txtEmp.setReadOnly(true);$.txtALTitle.setReadOnly(true);$.speAvalAmt.setReadOnly(true);$.txtTitle.setAllowBlank(false,"문서제목");$.txtDept.setAllowBlank(false,"소속부서");$.txtEmp.setAllowBlank(false,"신청인");$.txtALTitle.setAllowBlank(false,"학습과제");$.txtEduTitle.setAllowBlank(false,"강연명");$.memAgenda.setAllowBlank(false,"Agenda");$.speAvalAmt.setAllowBlank(false,"잔여예산");$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(false,"연락처");$.txtAttendence.setAllowBlank(false,"참석자");$.txtDept.setValue(g_main.session.obj.DeptName);$.txtEmp.setValue(g_main.session.obj.UserName);$.speAvalAmt.setValue(1000000);$.dteStart.setValue(getToday(""));$.dteEnd.setValue(getToday(""));$.lblLabel1.setAlign("left");$.lblLabel2.setAlign("left");$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("");$.lblLabel2.setText("");$.lblEduTitle.setText("강연명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("강연기관");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(true);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(true);$.txtAttendence.setVisible(true);$.rdoEduType.addButtons([{sub_code:"SPEECH",code_name:"강연(전문기관)"},{sub_code:"LECTURE",code_name:"강연(일반 전문가)"},{sub_code:"OPENLECTURE",code_name:"공개강좌"},{sub_code:"SEMINAR",code_name:"학회참석"},{sub_code:"WORKSHOP",code_name:"워크샵"},{sub_code:"BOOK",code_name:"도서"},{sub_code:"ETC",code_name:"기타"}]);$.rdoEduType.setValue("SPEECH");colMap=$.grdList.setColumns([new FingerDataGridColumn("seq",99,"left","string","시퀀스"),new FingerDataGridColumn("ref_wf_doc_id",99,"left","string","참조결재문서아이디"),new FingerDataGridColumn("modify_yn",99,"left","string","수정가능여부"),new FingerDataGridColumn("receipt_type",170,"center","string","영수증종류",{footer:{text:"총계:",colspan:2}}),new FingerDataGridColumn("use_date",120,"center","date","사용일자",{format:"ymd"}),new FingerDataGridColumn("use_amt",120,"right","string","사용금액",{format:"int",footer:{content:"summColumn"}}),new FingerDataGridColumn("tax_amt",120,"right","string","부가세",{format:"int",footer:{content:"summColumn"}}),new FingerDataGridColumn("nodeduction_amt",120,"right","string","불공제액",{format:"int",footer:{content:"summColumn"}}),new FingerDataGridColumn("deposit_emp_code",99,"left","string","입금처코드"),new FingerDataGridColumn("deposit_emp_name",170,"left","string","입금처",{readonly:true}),new FingerDataGridColumn("SAPCODE",170,"left","string","원천대상/기타 거래처",{readonly:true}),new FingerDataGridColumn("CARDNO",99,"left","string","카드번호"),new FingerDataGridColumn("APPRNO",190,"left","string","승인번호",{readonly:true})]);$.grdList.init({panel:$.panList,scroll:"xy",footer:true,eventCellReadOnly:true,isFilter:false});$.grdList.setEditable(true);$.grdList.setColumnHidden(["seq","ref_wf_doc_id","modify_yn","deposit_emp_code","CARDNO"],true);$.grdList.setBorder(false);$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("file_type",145,"left","string","자료유형"),new FingerDataGridColumn("local_fname",280,"left","string","파일명",{readonly:true,isLink:true,pathLinkCols:["server_path","server_fname"]}),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{hidden:true,format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdFile.setEditable(true);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panWFMain);$.panMain.add($.panWFDetail);$.panMain.add($.panFile);$.panMain.add($.panDoc);$.panMain.add($.panList);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panWFMain.add($.lblDept);$.panWFMain.add($.lblEmp);$.panWFMain.add($.lblALTitle);$.panWFMain.add($.lblEduType);$.panWFMain.add($.lblEduTitle);$.panWFMain.add($.lblAgenda);$.panWFMain.add($.lblAvalAmt);$.panWFMain.add($.lblEduDate);$.panWFMain.add($.lblWorkPlace);$.panWFMain.add($.lblTelAddr);$.panWFMain.add($.lblAttendence);$.panWFMain.add($.lblLabel1);$.panWFMain.add($.txtDept);$.panWFMain.add($.txtEmp);$.panWFMain.add($.txtALTitle);$.panWFMain.add($.rdoEduType);$.panWFMain.add($.txtEduTitle);$.panWFMain.add($.memAgenda);$.panWFMain.add($.speAvalAmt);$.panWFMain.add($.dteStart);$.panWFMain.add($.dteEnd);$.panWFMain.add($.txtWorkPlace);$.panWFMain.add($.txtTelAddr);$.panWFMain.add($.txtAttendence);$.panWFMain.add($.lblWave);$.panWFMain.add($.lblLabel2);$.panWFDetail.add($.wbeWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.panList.add($.grdList);$.panList.add($.btnCard);$.panList.add($.btnEsero);var ds=bizComponentData2($,"Q1","L_CRM0041|L_CRM0257");$.grdList.setColumnDropDownList("receipt_type",ds.resultList[0]);$.grdFile.setColumnDropDownList("file_type",ds.resultList[1]);relocateChildIndexInPanel([$.panWFMain]);searchWFDocument();searchActionLearning("Q")};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue(result.business_title)}else{if(type=="Q"){var result=ds.resultList[0][0];$.txtALTitle.setValue(result.al_title)}else{if(type=="N"){$.panWFMain.clear();$.wbeWFDetail.setValue("");$.rdoType.setValue("Rental");$.rdoLimitType.setValue("Perm");searchWFDocument();searchLimit();$.lblRentalDate.setVisible(true);$.lblRentalCard.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.cmbRentalCard.setVisible(true);$.lblWave.setVisible(true);$.lblLimitType.setVisible(false);$.lblLimit.setVisible(false);$.lblResiduaryLimit.setVisible(false);$.lblChangeLimit.setVisible(false);$.rdoLimitType.setVisible(false);$.speLimit.setVisible(false);$.speResiduaryLimit.setVisible(false);$.speChangeLimit.setVisible(false)}}}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWfDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.wbeWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);console.log(args);var md=args[6][0];if(md){}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!$.panWFMain.validateControls()){return}if($.grdList.getRowCount()<=0){MessageBoxShow("비용 내역이 등록되지 않았습니다.");return}if(!filecheck()){return}var param={wf_doc_id:$.varWfDocId,wf_form_id:"crmWFALBudgetUseReq"};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{if(id=="btnTmpSave"){if(!$.panWFMain.validateControls()){return}if($.grdList.getRowCount()<=0){MessageBoxShow("비용 내역이 등록되지 않았습니다.");return}if($.grdFile.getRowCount()<=0){MessageBoxShow("첨부 파일이 등록되지 않았습니다.");return}if(!filecheck()){return}if(saveWFDocument("","Y")){saveActionLearning("S")}}else{if(id=="btnEsero"){$.popUpCallId="btnEsero";var param={};g_main.openPopup("popEseroApprovalSub.html","popEseroApprovalSub","세금계산서&계산서 수신내역",905,435,"","",param,"","")}else{if(id=="btnCard"){$.popUpCallId="btnCard";var param={};g_main.openPopup("popCardApprovalSub.html","popCardApprovalSub","카드승인내역",905,435,"","",param,"","")}else{if(id=="btnDocAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(id=="btnDocDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}else{if(id=="btnFileAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(id=="btnFileDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){if(id=="grdList"){$.varRowIdx=rId;if(cInd=="deposit_emp_name"){if($.grdList.getValue(rId,"modify_yn")=="N"){return}$.popUpCallId="deposit_emp_name";var param={emp_name:""};g_main.openPopup("popEmp.html","popEmp","사원팝업",750,500,"","",param,"","")}else{if(cInd=="SAPCODE"){if($.grdList.getValue(rId,"modify_yn")=="N"){return}$.popUpCallId="SAPCODE";var param={};g_main.openPopup("popWithholdmentSub.html","popWithholdmentSub","원천대상 및 기타거래처",700,550,"","",param,"","")}}}};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdList"){if(cInd=="receipt_type"){if(oValue!=""){if(oValue=="20"||oValue=="50"){if(nValue=="10"||nValue=="30"||nValue=="40"){MessageBoxShow("영수증종류가 법인카드, 카드매입일경우 현금, 세금계산서, 계산서로 변경 할 수 없습니다.");$.grdList.setValue(rId,"receipt_type",oValue);rowProperties(rId,oValue);return}if(oValue=="50"&&nValue=="20"){if($.grdList.getValue(rId,"tax_amt")!=0||$.grdList.getValue(rId,"nodeduction_amt")!=0){MessageBoxShow("영수증종류가 법인카드일 경우 부가세가 0이어야 합니다.");$.grdList.setValue(rId,"tax_amt",0);$.grdList.setValue(rId,"nodeduction_amt",0)}$.grdList.setValue(rId,"account_comp_code","");$.grdList.setValue(rId,"account_comp_name","");rowProperties(rId,nValue)}else{if(oValue=="20"&&nValue=="50"){rowProperties(rId,nValue)}}}else{if(oValue=="10"||oValue=="30"||oValue=="40"){if(nValue=="20"||nValue=="50"){MessageBoxShow("영수증종류가 현금, 세금계산서, 계산서일경우 법인카드, 카드매입로 변경 할 수 없습니다.");$.grdList.setValue(rId,"receipt_type",oValue);rowProperties(rId,oValue);return}if(oValue!="30"&&nValue=="30"&&$.grdList.getValue(rId,"modify_yn")=="Y"){confirmBoxShow("전자세금계산서가 아닌지 다시 한번 확인해주십시오.<br><br>종이세금계산서가 맞다면 '예'를 눌러주시고,<br><br>전자세금계산서라면 '아니오'를 눌러주세요.",function(){if(g_main.msgShare==true){rowProperties(rId,"30");return}else{$.grdList.deleteCurrentRow();$.popUpCallId="btnEsero";var param={};g_main.openPopup("popEseroApprovalSub.html","popEseroApprovalSub","세금계산서&계산서 수신내역",905,435,"","",param,"","")}},230)}else{if(oValue=="30"&&nValue!="30"&&$.grdList.getValue(rId,"modify_yn")=="N"){MessageBoxShow("영수증종류가 전자세금계산서일 경우 그외 항목으로 변경 할 수 없습니다.");$.grdList.setValue(rId,"receipt_type",oValue);rowProperties(rId,oValue);return}}if(oValue=="30"&&nValue=="40"){$.grdList.setValue(rId,"tax_amt",0);$.grdList.setValue(rId,"nodeduction_amt",0);rowProperties(rId,nValue)}if((oValue=="30"||oValue=="40")&&nValue=="10"){$.grdList.setValue(rId,"APPRNO","");rowProperties(rId,nValue)}if(oValue=="30"&&nValue=="40"){$.grdList.setValue(rId,"deposit_emp_code","");$.grdList.setValue(rId,"deposit_emp_name","");rowProperties(rId,nValue)}}}}if(nValue=="10"){$.grdList.setValue(rId,"deposit_emp_code",g_main.session.obj.UserID);$.grdList.setValue(rId,"deposit_emp_name","["+g_main.session.obj.UserID+"]"+g_main.session.obj.UserName)}}else{if(cInd=="use_date"){if($.grdList.getValue(rId,"receipt_type")=="10"||$.grdList.getValue(rId,"receipt_type")=="30"||$.grdList.getValue(rId,"receipt_type")=="40"){if(nValue==""){return}var select=nValue.replace(/\-/g,"").substr(0,8);var system=getToday("");if(select>system){$.grdList.setValue(rId,"use_date",oValue);MessageBoxShow("현재일자보다 클 수 없습니다.")}}}else{if(cInd=="tax_amt"){if($.grdList.getValue(rId,"receipt_type")=="30"){if(nValue==0){return}$.grdList.setValue(rId,"nodeduction_amt",0)}}else{if(cInd=="nodeduction_amt"){if($.grdList.getValue(rId,"receipt_type")=="30"){if(nValue==0){return}$.grdList.setValue(rId,"tax_amt",0)}}}}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnAdd"){$.grdList.addRow({modify_yn:"Y",receipt_type:"10",use_date:getToday("-"),use_date_readonly:false,use_amt:0,use_amt_readonly:false,tax_amt:0,tax_amt_readonly:true,nodeduction_amt:0,nodeduction_amt_readonly:true,deposit_emp_code:g_main.session.obj.UserID,deposit_emp_name:"["+g_main.session.obj.UserID+"]"+g_main.session.obj.UserName})}else{if(btnId=="btnDelete"){$.grdList.deleteCurrentRow()}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();var seq=setSeq($.grdFile,"seq");for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}fileList[i].file_type="";fileList[i].seq=seq+i}log(fileList);$.grdFile.addRows(fileList)})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}else{if(panelId=="panDoc"){if(btnId=="btnAdd"){var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","",0,0,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWFDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){saveActionLearning("S")}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}else{if(id=="popWFGoAboardSub"){if($.popUpCallId=="bteSubject"){$.varSubWfDocId=popResult.wf_doc_id;$.bteSubject.setValue(popResult.subject)}}else{if(id=="popEseroApprovalSub"){if($.popUpCallId=="btnEsero"){$.varReceiptType="";var overlap=false;for(var i=0;i<$.grdList.getRowCount();i++){if($.grdList.getValue(i,"APPRNO")==popResult.APPRNO){overlap=true}}if(overlap==true){MessageBoxShow("MessageID: crmWFBgtAft_026");return}$.grdList.addRow({receipt_type:"30",use_date:popResult[i].APPDAT||"",use_date_readonly:true,use_amt:popResult[i].APPAMT||"",use_amt_readonly:true,tax_amt:(popResult[i].VAT_DEDUCT_YN=="Y"?popResult[i].TAXAMT:0),tax_amt_readonly:true,nodeduction_amt:(popResult[i].VAT_DEDUCT_YN=="N"?popResult[i].TAXAMT:0),nodeduction_amt_readonly:true,APPRNO:popResult[i].APPRNO,deposit_emp_name_readonly:true,SAPCODE_readonly:true,modify_yn:"N"})}}else{if(id=="popCardApprovalSub"){if($.popUpCallId=="btnCard"){$.varReceiptType="";var overlap=false;for(var i=0;i<popResult.length;i++){for(var j=0;j<$.grdList.getRowCount();j++){if($.grdList.getValue(j,"APPRNO")==popResult[i].APPRNO){overlap=true}}if(overlap==true){return}$.grdList.addRow({receipt_type:"20",use_date:extFormat(getToday("").substr(0,2)+popResult[i].APPDAT.replace(/\//g,"").substr(0,6),"yyyyMMdd","-"),use_date_readonly:true,use_amt:popResult[i].APPAMT||"",use_amt_readonly:true,tax_amt:0,tax_amt_readonly:true,nodeduction_amt:0,nodeduction_amt_readonly:true,deposit_emp_name:popResult[i].KNAME||"",deposit_emp_code:popResult[i].EMPNUM||"",CARDNO:popResult[i].CARDNO||"",APPRNO:popResult[i].APPRNO||"",modify_yn:"N"})}}}else{if(id=="popEmp"){if($.popUpCallId=="deposit_emp_name"){$.grdList.setValue($.varRowIdx,"deposit_emp_code",popResult.employee_id);$.grdList.setValue($.varRowIdx,"deposit_emp_name","["+popResult.employee_id+"]"+popResult.emp_name)}}else{if(id=="popWithholdmentSub"){if($.popUpCallId=="SAPCODE"){$.grdList.setValue($.varRowIdx,"SAPCODE",popResult.target_info)}}}}}}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerradiobox_change=function(id,value){if(id=="rdoEduType"){if(value=="SPEECH"){$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("");$.lblLabel2.setText("");$.lblEduTitle.setText("강연명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("강연기관");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(true);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(true);$.txtAttendence.setVisible(true);$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(false,"연락처");$.txtAttendence.setAllowBlank(false,"참석자")}else{if(value=="LECTURE"){$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("강연계약서, 개인정보활용동의서, 강의사진, 강연자료는 필수 첨부파일 입니다.");$.lblLabel2.setText("");$.lblEduTitle.setText("강연명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("강연자");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(true);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(true);$.txtAttendence.setVisible(true);$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(false,"연락처");$.txtAttendence.setAllowBlank(false,"참석자")}else{if(value=="OPENLECTURE"){$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("현금 비용처리인 경우 입금증은 필수 첨부파일이며,");$.lblLabel2.setText("영수증 원본을 교육담당자에게 제출해야 합니다.");$.lblEduTitle.setText("강연명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("강연기관");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(true);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(true);$.txtAttendence.setVisible(true);$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(false,"연락처");$.txtAttendence.setAllowBlank(false,"참석자")}else{if(value=="SEMINAR"){$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("현금 비용처리인 경우 입금증은 필수 첨부파일이며,");$.lblLabel2.setText("영수증 원본을 교육담당자에게 제출해야 합니다.");$.lblEduTitle.setText("학회명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("학회");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(true);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(true);$.txtAttendence.setVisible(true);$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(false,"연락처");$.txtAttendence.setAllowBlank(false,"참석자")}else{if(value=="WORKSHOP"){$.memAgenda.setPlaceHolder("Agenda란이 부족한 경우 문서로 첨부하여 주시기 바랍니다.");$.lblLabel1.setText("");$.lblLabel2.setText("");$.lblEduTitle.setText("워크샵명");$.lblAgenda.setText("Agenda");$.lblEduDate.setText("기간");$.lblWorkPlace.setText("장소");$.lblEduDate.setVisible(true);$.lblTelAddr.setVisible(false);$.lblAttendence.setVisible(true);$.dteStart.setVisible(true);$.dteEnd.setVisible(true);$.lblWave.setVisible(true);$.txtWorkPlace.setVisible(true);$.txtTelAddr.setVisible(false);$.txtAttendence.setVisible(true);$.dteStart.setAllowBlank(false,"시작기간");$.dteEnd.setAllowBlank(false,"종료기간");$.txtWorkPlace.setAllowBlank(false,"강연기관");$.txtTelAddr.setAllowBlank(true,"연락처");$.txtAttendence.setAllowBlank(false,"참석자")}else{if(value=="BOOK"){$.memAgenda.setPlaceHolder("과제와의 관련성에 대해 구체적으로 기술해주세요");$.lblLabel1.setText("구입내역란에 도서명/출판사/단가/수량/비용 을 기입해 주시기 바랍니다.");$.lblLabel2.setText("도서구입내역서(스캔본)는 필수 첨부파일 입니다.");$.lblEduTitle.setText("구입내역");$.lblAgenda.setText("목적");$.lblEduDate.setText("");$.lblWorkPlace.setText("");$.lblEduDate.setVisible(false);$.lblTelAddr.setVisible(false);$.lblAttendence.setVisible(false);$.dteStart.setVisible(false);$.dteEnd.setVisible(false);$.lblWave.setVisible(false);$.txtWorkPlace.setVisible(false);$.txtTelAddr.setVisible(false);$.txtAttendence.setVisible(false);$.dteStart.setAllowBlank(true,"시작기간");$.dteEnd.setAllowBlank(true,"종료기간");$.txtWorkPlace.setAllowBlank(true,"강연기관");$.txtTelAddr.setAllowBlank(true,"연락처");$.txtAttendence.setAllowBlank(true,"참석자")}else{if(value=="ETC"){$.memAgenda.setPlaceHolder("과제와의 관련성에 대해 구체적으로 기술해주세요");$.lblLabel1.setText("구입내역서는 필수 첨부파일 입니다.");$.lblLabel2.setText("");$.lblEduTitle.setText("사용내용");$.lblAgenda.setText("목적");$.lblEduDate.setText("");$.lblWorkPlace.setText("");$.lblEduDate.setVisible(false);$.lblTelAddr.setVisible(false);$.lblAttendence.setVisible(false);$.dteStart.setVisible(false);$.dteEnd.setVisible(false);$.lblWave.setVisible(false);$.txtWorkPlace.setVisible(false);$.txtTelAddr.setVisible(false);$.txtAttendence.setVisible(false);$.dteStart.setAllowBlank(true,"시작기간");$.dteEnd.setAllowBlank(true,"종료기간");$.txtWorkPlace.setAllowBlank(true,"강연기관");$.txtTelAddr.setAllowBlank(true,"연락처");$.txtAttendence.setAllowBlank(true,"참석자")}}}}}}}}};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>