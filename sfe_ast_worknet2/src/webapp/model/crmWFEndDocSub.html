<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQuery=null;$.panList=null;$.grdList=null;$.btnSearch=null;$.lblDocTitle=null;$.txtDocTitle=null;$.lblEmpName=null;$.bteEmpName=null;$.lblWfTime=null;$.lblWfTimeTerm=null;$.dteWfTimeFr=null;$.dteWfTimeTo=null;$.lblBusinessId=null;$.cmbBusinessId=null;$.panView=null;$.htmView1=null;$.btnOk=null;$.btnCancel=null;$.type="";function createJSON_Q(workType,wf_doc_id){var json=createExecuteParamInfo("P_crmWFEndDocSub_Q",[workType,wf_doc_id||"",$.txtDocTitle.getValue(),$.varEmployeeId,$.sessionUserId,$.cmbBusinessId.getValue()||"",$.dteWfTimeFr.getValue(),$.dteWfTimeTo.getValue()]);return json}function initControls(){$.sessionUserId=g_main.session.getValue("UserID");$.varEmployeeId=g_main.session.obj.UserID;$.bteEmpName.setText(g_main.session.obj.UserName);$.dteWfTimeFr.setValue(getToday().substr(0,6)+"01");$.dteWfTimeTo.setValue(getToday())}function searchList(){var json=createJSON_Q("Q");callQuery(["req",json],"Q",$)}function selectDoc(wf_doc_id){var json=createJSON_Q("Q1",wf_doc_id);callQuery(["req",json],"WF_DOC",$)}function dataSelect(){if($.grdList.getRowCount()<1){return}var data=$.grdList.getAllRows();var rows=[];var cnt=0;for(var i in data){if(data[i].chk_yn=="Y"){rows.push(data[i]);cnt++}}if(!rows.length){return}if($.type&&cnt>1){MessageBoxShow("문서는 하나만 선택할 수 있습니다.");return}g_popupStack.setData(rows);g_popupStack.close()}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1100,600);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQuery=new FingerPanel(host,"panQuery",0,0,390,150);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panList=new FingerPanel(host,"panList",0,155,390,450);$.panList.setText("");$.panList.setBottomLine(true);$.grdList=new FingerDataGrid(host,"grdList",0,0,390,400);$.btnSearch=new FingerButton(host,"btnSearch",310,111,80,20);$.btnSearch.setText("조회");$.lblDocTitle=new FingerLabel(host,"lblDocTitle",0,5,95,20);$.lblDocTitle.setText("문서명");$.txtDocTitle=new FingerEdit(host,"txtDocTitle",100,5,210,20);$.lblEmpName=new FingerLabel(host,"lblEmpName",0,40,95,20);$.lblEmpName.setText("기안자");$.bteEmpName=new FingerButtonEdit(host,"bteEmpName",100,40,210,20);$.bteEmpName.setText("");$.lblWfTime=new FingerLabel(host,"lblWfTime",0,75,95,20);$.lblWfTime.setText("기안일자");$.lblWfTimeTerm=new FingerLabel(host,"lblWfTimeTerm",198,75,20,20);$.lblWfTimeTerm.setText("~");$.dteWfTimeFr=new FingerDateEdit(host,"dteWfTimeFr",100,75,100,20);$.dteWfTimeTo=new FingerDateEdit(host,"dteWfTimeTo",220,75,100,20);$.lblBusinessId=new FingerLabel(host,"lblBusinessId",0,110,95,20);$.lblBusinessId.setText("결재문서유형");$.cmbBusinessId=new FingerComboBox(host,"cmbBusinessId",100,110,190,20);$.panView=new FingerPanel(host,"panView",400,0,700,600);$.panView.setText("");$.panView.setBottomLine(true);$.htmView1=new FingerHTMLView(host,"htmView1",0,0,700,590);$.btnOk=new FingerButton(host,"btnOk",220,413,100,20);$.btnOk.setText("확인");$.btnCancel=new FingerButton(host,"btnCancel",315,413,100,20);$.btnCancel.setText("취소");$.cmbBusinessId.setEmptyRow(true);$.cmbBusinessId.setColumn("business_id","business_name");$.panQuery.setBorder(true);$.panList.setBorder(false);$.panView.setBorder(false);$.wfDocView1=new CustomWfDocument($,$.htmView1);$.grdList.setColumns([new FingerDataGridColumn("wf_doc_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("doc_id",20,"left","string","문서번호",{hidden:true}),new FingerDataGridColumn("wf_status",80,"left","string","기안상태",{hidden:true}),new FingerDataGridColumn("chk_yn",40,"center","checkbox","masterCheckbox"),new FingerDataGridColumn("doc_title",190,"left","string","문서명"),new FingerDataGridColumn("emp_name",60,"left","string","기안자"),new FingerDataGridColumn("wf_time",80,"center","string","기안일",{format:"s_ymd"}),new FingerDataGridColumn("business_id",100,"left","string","문서유형",{hidden:false})]);$.grdList.init();$.grdList.setBorder(true);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panView);$.panQuery.add($.btnSearch);$.panQuery.add($.lblDocTitle);$.panQuery.add($.txtDocTitle);$.panQuery.add($.lblEmpName);$.panQuery.add($.bteEmpName);$.panQuery.add($.lblWfTime);$.panQuery.add($.lblWfTimeTerm);$.panQuery.add($.dteWfTimeFr);$.panQuery.add($.dteWfTimeTo);$.panQuery.add($.lblBusinessId);$.panQuery.add($.cmbBusinessId);$.panList.add($.grdList);$.panList.add($.btnOk);$.panList.add($.btnCancel);$.panView.add($.htmView1);initControls();var ds=commCodeData2($,"Q_BUSINESS","#BPTYPE#");setComboBind([$.cmbBusinessId],ds);if($.p_argument&&$.p_argument.type){$.type=$.p_argument.type}searchList()};$.callback=function(type,ds){if(type=="Q"){convertJavaDateToJs(ds.resultList);setDataGrid([$.grdList],ds)}else{if(type=="WF_DOC"){if(ds.resultList){convertJavaDateToJs(ds.resultList,"default_day");var wfResult=$.wfDocView1.load(ds.resultList)}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList()}else{if(id=="btnOk"){dataSelect()}else{if(id=="btnCancel"){g_popupStack.close()}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteEmpName"){var param={emp_name:$.bteEmpName.getText()||"",searchAll:"Y"};g_main.openPopup("popEmp.html","popEmp","사원 조회",0,0,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){if(id=="bteEmpName"){if(!value){$.varEmployeeId=""}}};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){$.wfDocView1.init(600);var wf_doc_id=$.grdList.getValue(rId,"wf_doc_id");if(wf_doc_id){selectDoc(wf_doc_id)}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){if(id=="grdList"){dataSelect()}};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtDocTitle")&&value=="13"){searchList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){if($.popUpCallId=="bteEmpName"){$.varEmployeeId=popResult.employee_id;$.bteEmpName.setText(popResult.emp_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>