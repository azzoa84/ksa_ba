<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTitle=null;$.lblTitle=null;$.txtTitle=null;$.btnSubmit=null;$.btnTmpSave=null;$.panContent=null;$.lblReqUser=null;$.txtReqUser=null;$.lblSeminarTitle=null;$.txtSeminarTitle=null;$.lblProductCode=null;$.cboProductCode=null;$.lblSeminarType=null;$.lblAttendeeType=null;$.txtAttendeeType=null;$.lblAttendeeNum=null;$.numAttendeeNum=null;$.lblSemiarDate=null;$.dteStartDate=null;$.dteEndDate=null;$.lblSeminarDate2=null;$.lblSeminarPlace=null;$.txtSeminarPlace=null;$.lblEtcDescr=null;$.memEtcDescr=null;$.lblAttendeeNum2=null;$.panWFDetail=null;$.panFile=null;$.panDoc=null;$.grdFile=null;$.grdDoc=null;$.webWFDetail=null;$.rdoseminar_type=null;$.rdoSeminarType=null;$.lblBudgetAmt=null;$.lblBudgetAmt2=null;$.numBudgetAmt=null;$.varWFDocId="";$.varBusinessId="";$.varWFType="";function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmWFDocument_Q",[workType,"","","crmWFSeminarPlan"]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmWFSeminarPlan_S",[workType,$.varWFDocId,$.txtSeminarTitle.getValue(),$.rdoSeminarType.getValue(),$.cboProductCode.getValue(),$.txtAttendeeType.getValue(),$.numAttendeeNum.getValue(),$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.txtSeminarPlace.getValue(),$.numBudgetAmt.getValue(),$.memEtcDescr.getValue(),"#UserID#","#DeptCode#"]);return json}function searchWFDocument(){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function saveWFSeminarPlan(workType){var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"N",$);if(ds){return true}}return false}function saveWFDocument(workType,docType,wfLine){var ds=commWFDocument(workType,docType,$.txtTitle.getValue(),$.varBusinessId,$.varOriginWfDocId,wfLine,$.grdFile,$.grdDoc,$.wbeWFDetail,$.varWFDocId);if(ds==null||ds.errorCode.substr(0,1)=="P"||ds.errorCode.substr(0,1)=="E"){return false}if(ds.returnStr!=""){$.varWFDocId=ds.returnStr}return true}function chkdoc(strwf_doc_id){for(var i=0;i<$.grdDoc.getRowCount();i++){if($.grdDoc.getValue(i,"wf_doc_id")==strwf_doc_id){return false}}return true}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,930);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTitle=new FingerPanel(host,"panTitle",0,0,1200,55);$.panTitle.setText("");$.panTitle.setBottomLine(true);$.lblTitle=new FingerLabel(host,"lblTitle",0,15,100,20);$.lblTitle.setText("문서제목");$.txtTitle=new FingerEdit(host,"txtTitle",105,15,500,20);$.btnSubmit=new FingerButton(host,"btnSubmit",1010,15,100,20);$.btnSubmit.setText("상신");$.btnTmpSave=new FingerButton(host,"btnTmpSave",1100,15,100,20);$.btnTmpSave.setText("임시저장");$.panContent=new FingerPanel(host,"panContent",0,55,1200,450);$.panContent.setText("기안 내용");$.panContent.setBottomLine(true);$.lblReqUser=new FingerLabel(host,"lblReqUser",20,20,100,20);$.lblReqUser.setText("소속/신청자");$.txtReqUser=new FingerEdit(host,"txtReqUser",130,20,140,20);$.lblSeminarTitle=new FingerLabel(host,"lblSeminarTitle",20,50,100,20);$.lblSeminarTitle.setText("명칭");$.txtSeminarTitle=new FingerEdit(host,"txtSeminarTitle",130,50,300,20);$.lblProductCode=new FingerLabel(host,"lblProductCode",20,110,100,20);$.lblProductCode.setText("판촉품목");$.cboProductCode=new FingerComboBox(host,"cboProductCode",130,110,140,20);$.lblSeminarType=new FingerLabel(host,"lblSeminarType",20,80,100,20);$.lblSeminarType.setText("분류");$.lblAttendeeType=new FingerLabel(host,"lblAttendeeType",20,140,100,20);$.lblAttendeeType.setText("참석대상");$.txtAttendeeType=new FingerEdit(host,"txtAttendeeType",130,140,300,20);$.lblAttendeeNum=new FingerLabel(host,"lblAttendeeNum",20,170,100,20);$.lblAttendeeNum.setText("예상인원");$.numAttendeeNum=new FingerSpinEdit(host,"numAttendeeNum",130,170,80,20);$.lblSemiarDate=new FingerLabel(host,"lblSemiarDate",20,200,100,20);$.lblSemiarDate.setText("날짜");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",130,200,140,20);$.dteEndDate=new FingerDateEdit(host,"dteEndDate",300,200,140,20);$.lblSeminarDate2=new FingerLabel(host,"lblSeminarDate2",275,200,20,20);$.lblSeminarDate2.setText("~");$.lblSeminarPlace=new FingerLabel(host,"lblSeminarPlace",20,230,100,20);$.lblSeminarPlace.setText("장소");$.txtSeminarPlace=new FingerEdit(host,"txtSeminarPlace",130,230,400,20);$.lblEtcDescr=new FingerLabel(host,"lblEtcDescr",20,320,100,20);$.lblEtcDescr.setText("기타설명");$.memEtcDescr=new FingerMemoEdit(host,"memEtcDescr",130,290,400,80);$.lblAttendeeNum2=new FingerLabel(host,"lblAttendeeNum2",210,170,20,20);$.lblAttendeeNum2.setText("명");$.panWFDetail=new FingerPanel(host,"panWFDetail",0,510,1200,240);$.panWFDetail.setText("기안 상세");$.panWFDetail.setBottomLine(true);$.panFile=new FingerPanel(host,"panFile",0,730,540,200);$.panFile.setText("첨부 파일");$.panFile.setBottomLine(true);$.panDoc=new FingerPanel(host,"panDoc",550,730,650,200);$.panDoc.setText("기결 문서");$.panDoc.setBottomLine(true);$.grdFile=new FingerDataGrid(host,"grdFile",0,0,540,150);$.grdDoc=new FingerDataGrid(host,"grdDoc",0,0,650,150);$.webWFDetail=new FingerWebEditor(host,"webWFDetail",0,0,1200,165);$.rdoseminar_type=new FingerRadioBox(host,"rdoseminar_type",0,0,140,20);$.rdoSeminarType=new FingerRadioBox(host,"rdoSeminarType",130,80,300,20);$.lblBudgetAmt=new FingerLabel(host,"lblBudgetAmt",20,260,100,20);$.lblBudgetAmt.setText("예상 예산금액");$.lblBudgetAmt2=new FingerLabel(host,"lblBudgetAmt2",260,260,30,20);$.lblBudgetAmt2.setText("원");$.numBudgetAmt=new FingerSpinEdit(host,"numBudgetAmt",130,260,140,20);$.panTitle.setBorder(true);$.panFile.addButtons(["btnDelete","btnAdd"]);$.panDoc.addButtons(["btnDelete","btnAdd"]);$.rdoSeminarType.addButtons([{sub_code:"stay",code_name:"숙박"},{sub_code:"oneday",code_name:"당일"},{sub_code:"oneday2",code_name:"당일(20%미만 숙박)"}]);$.rdoSeminarType.setValue("stay");$.txtTitle.setAllowBlank(false,"문서제목");$.txtReqUser.setAllowBlank(false,"소속/신청자");$.txtSeminarTitle.setAllowBlank(false,"명칭");$.cboProductCode.setAllowBlank(false,"판촉품목");$.txtAttendeeType.setAllowBlank(false,"참석대상");$.numAttendeeNum.setAllowBlank(false,"예상인원");$.dteStartDate.setAllowBlank(false,"시작일자");$.dteEndDate.setAllowBlank(false,"종료일자");$.txtSeminarPlace.setAllowBlank(false,"장소");$.rdoSeminarType.setAllowBlank(false,"유형");$.numBudgetAmt.setAllowBlank(false,"예상 예산금액");$.grdFile.setColumns([new FingerDataGridColumn("file_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_path",0,"left","string","",{hidden:true}),new FingerDataGridColumn("server_fname",0,"left","string","",{hidden:true}),new FingerDataGridColumn("local_fname",280,"left","string","파일명"),new FingerDataGridColumn("file_size",145,"left","string","파일크기",{format:"file_size"})]);$.grdFile.init({header:false,isFilter:false});$.grdFile.setBorder(false);$.grdDoc.setColumns([new FingerDataGridColumn("wf_doc_id",125,"left","string","문서아이디"),new FingerDataGridColumn("doc_id",105,"left","string","문서아이디"),new FingerDataGridColumn("doc_title",420,"left","string","기안명"),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true}),new FingerDataGridColumn("emp_name",90,"left","string","기안자")]);$.grdDoc.init({header:false,isFilter:false});$.grdDoc.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTitle);$.panMain.add($.panContent);$.panMain.add($.panFile);$.panMain.add($.panWFDetail);$.panMain.add($.panDoc);$.panTitle.add($.lblTitle);$.panTitle.add($.txtTitle);$.panTitle.add($.btnSubmit);$.panTitle.add($.btnTmpSave);$.panContent.add($.lblReqUser);$.panContent.add($.txtReqUser);$.panContent.add($.lblSeminarTitle);$.panContent.add($.txtSeminarTitle);$.panContent.add($.lblProductCode);$.panContent.add($.cboProductCode);$.panContent.add($.lblSeminarType);$.panContent.add($.lblAttendeeType);$.panContent.add($.txtAttendeeType);$.panContent.add($.lblAttendeeNum);$.panContent.add($.numAttendeeNum);$.panContent.add($.lblSemiarDate);$.panContent.add($.dteStartDate);$.panContent.add($.dteEndDate);$.panContent.add($.lblSeminarDate2);$.panContent.add($.lblSeminarPlace);$.panContent.add($.txtSeminarPlace);$.panContent.add($.memEtcDescr);$.panContent.add($.lblEtcDescr);$.panContent.add($.lblAttendeeNum2);$.panContent.add($.rdoseminar_type);$.panContent.add($.rdoSeminarType);$.panContent.add($.numBudgetAmt);$.panContent.add($.lblBudgetAmt);$.panContent.add($.lblBudgetAmt2);$.panWFDetail.add($.webWFDetail);$.panFile.add($.grdFile);$.panDoc.add($.grdDoc);$.txtReqUser.setValue(g_main.session.getValue("DeptName")+" / "+g_main.session.getValue("UserName"));$.txtReqUser.setReadOnly(true);var ds=bizComponentData2($,"Q1","L_CRM0224");setComboBind([$.cboProductCode],ds);;searchWFDocument()};$.callback=function(type,ds){if(type=="Q3"){var result=ds.resultList[0][0];$.varBusinessId=result.business_id;$.varWFType=result.wf_type;$.txtTitle.setValue(result.business_title)}};$.update=function(args){if(args&&args.length){try{var cs=args[0][0];if(cs.wf_status=="80"){$.varOriginWfDocId=cs.wf_doc_id}else{$.varWFDocId=cs.wf_doc_id}$.txtTitle.setValue(cs.doc_title);$.webWFDetail.setValue(cs.doc_comment);setDataGrid([$.grdFile],args[4],true);setDataGrid([$.grdDoc],args[5],true);var md=args[6][0];if(md){$.txtSeminarTitle.setValue(md.seminar_title);$.rdoSeminarType.setValue(md.seminar_type);$.txtAttendeeType.setValue(md.attendee_type);$.numAttendeeNum.setValue(md.attendee_num);$.cboProductCode.setValue(md.product_code);$.dteStartDate.setValue(md.start_date);$.dteEndDate.setValue(md.end_date);$.txtSeminarPlace.setValue(md.seminar_place);$.numBudgetAmt.setValue(md.budget_amt);$.memEtcDescr.setValue(md.etc_descr)}}catch(err){MessageBoxShow("데이터 불러오기 중 오류가 발생 하였습니다. ("+err.message+")")}}$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){$.popUpCallId=id;if(id=="btnSubmit"){if(!validateControls([$.txtTitle,$.txtReqUser,$.txtSeminarTitle,$.cboProductCode,$.txtAttendeeType,$.numAttendeeNum,$.dteStartDate,$.dteEndDate,$.txtSeminarPlace,$.rdoSeminarType,$.numBudgetAmt])){return}if($.dteStartDate.getValue()>$.dteEndDate.getValue()){MessageBoxShow("시작일은 종료일과 같거나 앞서야 합니다.");return}if(!$.varWFDocId){saveWFDocument("","N")}if(saveWFSeminarPlan("N")){var param={wf_doc_id:$.varWFDocId,wf_form_id:"crmWFSeminarPlan",new_line:true};g_main.openPopup("popModAppr.html","popModAppr","",0,0,"","",param,"","")}else{removeWFDocument($.varWfDocId)}}else{if(id=="btnTmpSave"){if(saveWFDocument("","N")){if(saveWFSeminarPlan("N")){var param={wf_doc_id:$.varWFDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWFDocId)}}else{removeWFDocument($.varWFDocId)}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panDoc"){if(btnId=="btnAdd"){$.popUpCallId="btnDocAdd";var param={};g_main.openPopup("crmWFEndDocSub.html","crmWFEndDocSub","기결문서",1100,735,"","",param,"","")}else{if(btnId=="btnDelete"){var rId=$.grdDoc.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 기결문서를 선택해 주시기 바랍니다.");return}$.grdDoc.deleteRow(rId)}}}else{if(panelId=="panFile"){if(btnId=="btnAdd"){OpenFileUploader("WFFileAttatch",function(ds){if(!ds||ds.errorCode=="ERR0000"){MessageBoxShow("파일 업로드가 실패 하였습니다.");return}var fileList=ds.resultList[0];var grdFileLen=$.grdFile.getRowCount();for(var i=0;i<fileList.length;i++){for(var j=0;j<grdFileLen;j++){if(fileList[i]["local_fname"]==$.grdFile.getValue(j,"local_fname")&&fileList[i]["file_size"]==$.grdFile.getSSSSValue(j,"file_size")){MessageBoxShow("중복된 파일이 있습니다. 리스트를 확인해 주세요.")}}}$.grdFile.addRows(ds.resultList[0])})}else{if(btnId=="btnDelete"){var rId=$.grdFile.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 파일을 선택해 주시기 바랍니다.");return}var result=removeSysAttachFile({file_path:($.grdFile.getValue(rId,"server_path")+$.grdFile.getValue(rId,"server_fname"))});if(result){$.grdFile.deleteRow(rId)}else{MessageBoxShow("파일을 삭제하는 도중 오류가 발생 하였습니다.");return}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popModAppr"){if($.popUpCallId=="btnSubmit"){if(popResult.isCancel){$.varWFDocId=popResult.wf_doc_id}else{if(saveWFDocument("","Y",popResult)){if(saveWFSeminarPlan("N")){var param={wf_doc_id:$.varWfDocId};g_main.openModelWithBusiness("crmWFGeneralProc",param)}else{removeWFDocument($.varWFDocId)}}else{removeWFDocument($.varWFDocId)}}}}else{if(id=="crmWFEndDocSub"){for(var i=0;i<popResult.length;i++){if(chkdoc(popResult[i]["wf_doc_id"])){$.grdDoc.addRow(popResult[i],$.grdDoc.getRowCount())}}}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>