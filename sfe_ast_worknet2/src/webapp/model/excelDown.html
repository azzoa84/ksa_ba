<script>function Main(){var $=this;$.host=null;$.panMain=null;$.grdConfTitle=null;$.panConfTitle=null;$.lblDate=null;$.lblConfName2=null;$.lblCreater=null;$.txtConfName2=null;$.bteCreater=null;$.btnSearch=null;$.dteStartDate=null;$.dteEndDate=null;$.lblWave=null;$.panQuery=null;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmConf_List_Q2",[workType,g_main.session.getValue("UserID"),$.dteStartDate.getValue(),$.dteEndDate.getValue(),$.txtConfName2.getText(),$.varEmployeeId]);return json}function initConditions(){$.varEmployeeId="";$.varConfId="";$.varConfMainId=""}function searchConfList(){if($.bteCreater.getText()==""){$.varEmployeeId=""}var json=createJSON_Q("Q2");callQuery(["req",json],"Q_C",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1400);$.panMain.setText("");$.panMain.setBottomLine(true);$.grdConfTitle=new FingerDataGrid(host,"grdConfTitle",0,0,1200,330);$.panConfTitle=new FingerPanel(host,"panConfTitle",0,65,1200,380);$.panConfTitle.setText("회의/보고 리스트");$.panConfTitle.setBottomLine(true);$.lblDate=new FingerLabel(host,"lblDate",15,20,80,20);$.lblDate.setText("일자");$.lblConfName2=new FingerLabel(host,"lblConfName2",695,20,80,20);$.lblConfName2.setText("회의/보고명");$.lblCreater=new FingerLabel(host,"lblCreater",370,20,80,20);$.lblCreater.setText("작성자");$.txtConfName2=new FingerEdit(host,"txtConfName2",780,20,240,20);$.bteCreater=new FingerButtonEdit(host,"bteCreater",455,20,180,20);$.bteCreater.setText("");$.btnSearch=new FingerButton(host,"btnSearch",1110,20,80,20);$.btnSearch.setText("조회");$.dteStartDate=new FingerDateEdit(host,"dteStartDate",100,20,110,20);$.dteEndDate=new FingerDateEdit(host,"dteEndDate",230,20,110,20);$.lblWave=new FingerLabel(host,"lblWave",210,20,20,20);$.lblWave.setText("~");$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,60);$.panQuery.setText("");$.panQuery.setBottomLine(true);$.panConfTitle.setBorder(true);$.panConfTitle.addButton("btnExcel","엑셀");$.panConfTitle.setButtonAction("btnExcel","excel_down");$.grdConfTitle.colIdx=$.grdConfTitle.setColumns([new FingerDataGridColumn("conf_id",100,"left","ro","회의ID"),new FingerDataGridColumn("conf_name",505,"left","ro","회의/보고명"),new FingerDataGridColumn("recent_do_date",120,"center","ro","최근회의일자","yyyy-MM-dd"),new FingerDataGridColumn("create_user",100,"left","ro","생성자"),new FingerDataGridColumn("emp_name",229,"center","ro","생성자"),new FingerDataGridColumn("conf_yyyy",100,"center","ro","기준년도","yyyy"),new FingerDataGridColumn("conf_gubn",100,"center","ro","구분")]);$.grdConfTitle.setColumnHidden([$.grdConfTitle.colIdx.conf_id,$.grdConfTitle.colIdx.create_user,$.grdConfTitle.colIdx.cont_yyyy,$.grdConfTitle.colIdx.conf_type],true);$.grdConfTitle.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panConfTitle);$.panMain.add($.panQuery);$.panConfTitle.add($.grdConfTitle);$.panQuery.add($.lblWave);$.panQuery.add($.dteEndDate);$.panQuery.add($.dteStartDate);$.panQuery.add($.bteCreater);$.panQuery.add($.txtConfName2);$.panQuery.add($.btnSearch);$.panQuery.add($.lblCreater);$.panQuery.add($.lblConfName2);$.panQuery.add($.lblDate);searchConfList();var ds=bizComponentData2($,"Q2","L_CRM212");setComboBind([$.cmbWhere],ds)};$.callback=function(type,ds){if(type=="Q_C"){setDataGrid([$.grdConfTitle],ds);if($.varConfId){$.grdConfTitle.selectRow($.grdConfTitle.getGridRowIndex($.grdConfTitle.colIdx.conf_id,$.varConfId))}else{$.grdConfTitle.selectRow(0)}}else{if(type=="Q_M"){setDataGrid([$.grdMember],ds)}else{if(type=="Q_C_M"){setDataGrid([$.grdConfMain],ds);$.grdConfMain.selectRow(0)}else{if(type=="Q_C_F"){setDataGrid([$.grdFile],ds)}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchConfList()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteCreater"){var param=[];param[0]=$.varEmployeeId||"";param[1]=$.bteCreater.getText()||"";param[2]="";param[3]="";param[4]="";g_main.openPopup("popEmp.html","popEmp","사원 조회",750,500,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if(value=="13"&&id=="txtConfName2"){searchConfList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panConfTitle"){if(btnId=="btnExcel"){var column=[{headertext:"회의ID",datatype:"number",datafield:"conf_id",ishidden:false},{headertext:"회의/보고명",datatype:"string",datafield:"conf_name",width:"100px"},{headertext:"최근회의일자",datatype:"string",datafield:"recent_do_date",ishidden:false,width:"100px"},{headertext:"생성자",datatype:"string",datafield:"emp_name",ishidden:false},{headertext:"기준년도",datatype:"date",format:"xxxx,xx,xx",datafield:"conf_yyyy",ishidden:false,width:"150px"},{headertext:"구분",datatype:"string",datafield:"conf_gubn",ishidden:false,width:"150px"}];excelDown($.grdConfTitle.getRows(),column)}}};$.fingerpopup_close=function(id){if(g_main.popShare!=null){var popResult=g_main.popShare;if(id=="popEmp"){if($.popUpCallId=="bteCreater"){$.varEmployeeId=popResult[0];$.bteCreater.setText(popResult[1])}}else{if(id=="popSaveConfReport"){if($.popUpCallId=="btnNewSave"){$.varConfId=popResult[0];searchConfList()}}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id){};$.fingertree_refresh=function(id){}};</script>