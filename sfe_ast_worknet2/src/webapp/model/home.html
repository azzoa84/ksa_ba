<script>function Main(){var $=this;$.host=null;$.panMain=null;$.htmHome=null;$.panSchedule=null;$.schWeek=null;$.lblC1=null;$.lblC2=null;$.lblC3=null;$.lblC4=null;$.lblC5=null;$.lblC6=null;$.chkType1=null;$.chkType2=null;$.chkType3=null;$.chkType4=null;$.chkType5=null;$.chkType6=null;$.panType=null;$.isSchWeek=false;function createJSON_Q(workType){var param1="";var param2="";var param3="";if(workType=="SCHEDULE"){param1=$.calStart;param2=$.calEnd;param3=$.calType}log(param1+" ~ "+param2);var json=createExecuteParamInfo("P_Home_Q",[workType,"#UserID#",param1||"",param2||"",param3||""]);return json}function searchMain(){var json=createJSON_Q("ALL");callQuery(["req",json],"ALL",$)}function saveCache(){var schType=($.chkType1.getValue()+"|"+$.chkType2.getValue()+"|"+$.chkType3.getValue()+"|"+$.chkType4.getValue()+"|"+$.chkType5.getValue()+"|"+$.chkType6.getValue());setStorage("home_sch_type",schType)}function searchSchedule(){$.calStart=JSON.stringify($.schWeek.extObj.fullCalendar("getView").start).substr(1,10);$.calEnd=JSON.stringify($.schWeek.extObj.fullCalendar("getView").end).substr(1,10);$.calStart=moment($.calStart).format("YYYYMMDD");$.calEnd=moment($.calEnd).format("YYYYMMDD");var type=[];if($.chkType1.getValue()=="Y"){type.push("10")}if($.chkType2.getValue()=="Y"){type.push("20")}if($.chkType3.getValue()=="Y"){type.push("30")}if($.chkType4.getValue()=="Y"){type.push("40")}if($.chkType5.getValue()=="Y"){type.push("50")}if($.chkType6.getValue()=="Y"){type.push("60")}var sType="";for(var i=0;i<type.length;i++){sType+=((sType!=""?",":"")+type[i])}$.calType=sType;var json=createJSON_Q("SCHEDULE");callQuery(["req",json],"SCHEDULE",$)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,760);$.panMain.setText("");$.panMain.setBottomLine(false);$.htmHome=new FingerHTMLView(host,"htmHome",0,10,1200,760);$.panSchedule=new FingerPanel(host,"panSchedule",0,403,1190,300);$.panSchedule.setText("");$.panSchedule.setBottomLine(true);$.schWeek=new FingerScheduler(host,"schWeek","workweek",["30"],[],5,0,1190,350);$.lblC1=new FingerLabel(host,"lblC1",85,13,15,15);$.lblC1.setText("");$.lblC2=new FingerLabel(host,"lblC2",248,13,15,15);$.lblC2.setText("");$.lblC3=new FingerLabel(host,"lblC3",358,13,15,15);$.lblC3.setText("");$.lblC4=new FingerLabel(host,"lblC4",445,13,15,15);$.lblC4.setText("");$.lblC5=new FingerLabel(host,"lblC5",553,13,15,15);$.lblC5.setText("");$.lblC6=new FingerLabel(host,"lblC6",647,13,15,15);$.lblC6.setText("");$.chkType1=new FingerCheckBox(host,"chkType1",10,10,70,20);$.chkType1.setText("연간일정");$.chkType2=new FingerCheckBox(host,"chkType2",130,10,115,20);$.chkType2.setText("전사휴가/공휴일");$.chkType3=new FingerCheckBox(host,"chkType3",295,10,55,20);$.chkType3.setText("비뇨기");$.chkType4=new FingerCheckBox(host,"chkType4",405,10,45,20);$.chkType4.setText("SI");$.chkType5=new FingerCheckBox(host,"chkType5",490,10,55,20);$.chkType5.setText("개업의");$.chkType6=new FingerCheckBox(host,"chkType6",595,10,70,20);$.chkType6.setText("면역");$.panType=new FingerPanel(host,"panType",260,348,680,40);$.panType.setText("");$.panType.setBottomLine(true);$.panType.setBorder(true);$.lblC1.setStyle("backgroundColor",fingerSchedulerColors.CM10);$.lblC2.setStyle("backgroundColor",fingerSchedulerColors.CM20);$.lblC3.setStyle("backgroundColor",fingerSchedulerColors.CM30);$.lblC4.setStyle("backgroundColor",fingerSchedulerColors.CM40);$.lblC5.setStyle("backgroundColor",fingerSchedulerColors.CM50);$.lblC6.setStyle("backgroundColor",fingerSchedulerColors.CM60);$.chkType1.setValue("Y");$.chkType2.setValue("Y");$.chkType3.setValue("Y");$.chkType4.setValue("Y");$.chkType5.setValue("Y");$.chkType6.setValue("Y");$.schWeek.setBasicWeek(true);$.schWeek.setHeight(350);$.reactive_after=function(){searchMain()};$.home=new CustomHome($,$.htmHome,{onApprClick:function(){var param={wf_doc_id:""};g_main.openModelWithBusiness("crmWFGeneralProc",param,false,false)},onDraftClick:function(){var param={wf_doc_id:""};g_main.openModelWithBusiness("crmWFGeneralProc",param,false,false)},onCardClick:function(){var param={nonFooter:true,home_yn:true};g_main.openPopup("popCardApprovalSub.html","popCardApprovalSub","카드승인내역",0,0,"","",param,"","")},onDCardClick:function(){var param={tab_index:"0"};g_main.openModelWithBusiness("crmBCARDMAS",param,true,false)},onEseroClick:function(){var param={nonFooter:true,home_yn:true};g_main.openPopup("popEseroApprovalSub.html","popEseroApprovalSub","세금계산서&계산서 수신내역",0,0,"","",param,"","")},onDEseroClick:function(){var param={tab_index:"1"};g_main.openModelWithBusiness("crmBCARDMAS",param,true,false)},onBoardTitleClick:function(jqObj){var param={linkUrl:"board011.do",menuId:jqObj.attr("menu_id"),boardGroup:jqObj.attr("board_group"),postId:jqObj.attr("post_id")};g_main.openModelWithBusiness("crmBoard",param,true,false)}});$.home.load();$.host=host;$.args=args};$.start=function(){$.panMain.add($.htmHome);$.panMain.add($.panSchedule);$.panMain.add($.panType);$.panSchedule.add($.schWeek);$.panType.add($.lblC1);$.panType.add($.lblC2);$.panType.add($.lblC3);$.panType.add($.lblC4);$.panType.add($.lblC5);$.panType.add($.lblC6);$.panType.add($.chkType1);$.panType.add($.chkType2);$.panType.add($.chkType3);$.panType.add($.chkType4);$.panType.add($.chkType5);$.panType.add($.chkType6);var schCache=getStorage("home_sch_type");if(schCache){var schType=schCache.split("|");for(var i=0;i<schType.length;i++){$[("chkType"+(i+1))].setValue(schType[i])}}searchMain()};$.callback=function(type,ds){if(type=="ALL"){var wf=ds.resultList[0][0];var card=ds.resultList[1][0];var bbs=ds.resultList[2];if(wf){$.home.bindWfCount(wf.approve_cnt,wf.draft_cnt)}if(card){$.home.bindPayCount(card.cardBill_cnt,card.electronictax_cnt,card.deliverybill_cnt,card.deliveryelectronictax_cnt)}if(bbs&&bbs.length){$.home.bindBoard(bbs)}}else{if(type=="SCHEDULE"){$.schWeek.removeEvents();$.schWeek.addEventSource(ds.resultList[0])}}};$.executeScript=function(script){eval(script)};$.update=function(args){$.args=args};$.fingerbutton_click=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){saveCache();searchSchedule()};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){if(id=="popCardApprovalSub"){searchMain()}else{if(id=="popEseroApprovalSub"){searchMain()}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){if(id=="schWeek"){$.isSchWeek=true;searchSchedule()}};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerscheduler_view_display=function(id,view){if(id=="schWeek"&&$.isSchWeek){searchSchedule()}};$.fingerscheduler_event_reg=function(id,obj){};$.fingertree_refresh=function(id){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>