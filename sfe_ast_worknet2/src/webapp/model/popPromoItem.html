<script>function Main(){var $=this;$.host=null;$.panMain=null;$.lblDept=null;$.lblEmp=null;$.lblProduct=null;$.lblProductName=null;$.lblQty=null;$.lblQty2=null;$.lblPrice=null;$.lblPrice2=null;$.lblIamge=null;$.lblDescr=null;$.lblStatus=null;$.lblMemo=null;$.cmbDept=null;$.cmbEmp=null;$.cmbProduct=null;$.txtProductName=null;$.speQty=null;$.spePrice=null;$.img1=null;$.img2=null;$.img3=null;$.memDescr=null;$.btnProc1=null;$.btnProc2=null;$.btnProc3=null;$.btnProc4=null;$.btnProc5=null;$.btnProc6=null;$.memMemo=null;$.lbl1=null;$.lbl2=null;$.lbl3=null;$.lbl4=null;$.lbl5=null;$.btnPervious=null;$.btnNext=null;$.btnCancel=null;$.btnPriceSave=null;$.varWfDocId="";$.varSeq="";$.varProcState="";$.popOpen=true;function createJSON_Q(workType){var json=createExecuteParamInfo("P_crmPromoItemMaster_Q",[workType,"","","","",$.varWfDocId,$.varSeq]);return json}function createJSON_S(workType){var json=createExecuteParamInfo("P_crmPromoItemMaster_S",[workType,$.varWfDocId,$.varSeq,$.varProcState,$.spePrice.getValue()||0,$.memMemo.getValue()||""]);return json}function searchPromoItem(workType){if($.varWfDocId==""){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function savePromoItem(workType){if($.varWfDocId==""){return}var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],workType,$);var share={save_yn:"Y"};g_popupStack.setData(share);searchPromoItem("Q1")}}function proccessState(val){$.btnProc1.setEnable(false);$.btnProc2.setEnable(false);$.btnProc3.setEnable(false);$.btnProc4.setEnable(false);$.btnProc5.setEnable(false);$.btnProc6.setEnable(false);switch(val){case"10":$.btnProc1.setEnable(true);break;case"25":$.btnProc2.setEnable(true);break;case"40":$.btnProc3.setEnable(true);break;case"55":$.btnProc4.setEnable(true);break;case"70":$.btnProc5.setEnable(true);break;case"90":$.btnProc6.setEnable(true);break}}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,850,600);$.panMain.setText("");$.panMain.setBottomLine(true);$.lblDept=new FingerLabel(host,"lblDept",0,10,100,20);$.lblDept.setText("소속부서");$.lblEmp=new FingerLabel(host,"lblEmp",230,10,100,20);$.lblEmp.setText("신청자");$.lblProduct=new FingerLabel(host,"lblProduct",0,40,100,20);$.lblProduct.setText("판촉 품목");$.lblProductName=new FingerLabel(host,"lblProductName",0,70,100,20);$.lblProductName.setText("판촉물 품명");$.lblQty=new FingerLabel(host,"lblQty",385,70,70,20);$.lblQty.setText("수량");$.lblQty2=new FingerLabel(host,"lblQty2",520,70,20,20);$.lblQty2.setText("개");$.lblPrice=new FingerLabel(host,"lblPrice",530,70,70,20);$.lblPrice.setText("단가");$.lblPrice2=new FingerLabel(host,"lblPrice2",665,70,20,20);$.lblPrice2.setText("원");$.lblIamge=new FingerLabel(host,"lblIamge",0,165,100,20);$.lblIamge.setText("판촉물 이미지");$.lblDescr=new FingerLabel(host,"lblDescr",0,330,100,20);$.lblDescr.setText("설명");$.lblStatus=new FingerLabel(host,"lblStatus",0,435,100,20);$.lblStatus.setText("진행 상황");$.lblMemo=new FingerLabel(host,"lblMemo",0,525,100,20);$.lblMemo.setText("관리자 메모");$.cmbDept=new FingerComboBox(host,"cmbDept",105,10,140,20);$.cmbEmp=new FingerComboBox(host,"cmbEmp",335,10,140,20);$.cmbProduct=new FingerComboBox(host,"cmbProduct",105,40,140,20);$.txtProductName=new FingerEdit(host,"txtProductName",105,70,290,20);$.speQty=new FingerSpinEdit(host,"speQty",460,70,65,20);$.spePrice=new FingerSpinEdit(host,"spePrice",605,70,65,20);$.img1=new FingerImage(host,"img1",105,100,237,153);$.img2=new FingerImage(host,"img2",347,100,237,153);$.img3=new FingerImage(host,"img3",590,100,237,153);$.memDescr=new FingerMemoEdit(host,"memDescr",105,260,718,150);$.btnProc1=new FingerButton(host,"btnProc1",105,435,120,20);$.btnProc1.setText("구매신청중");$.btnProc2=new FingerButton(host,"btnProc2",230,435,120,20);$.btnProc2.setText("신청승인");$.btnProc3=new FingerButton(host,"btnProc3",355,435,120,20);$.btnProc3.setText("비딩중");$.btnProc4=new FingerButton(host,"btnProc4",480,435,120,20);$.btnProc4.setText("발주완료");$.btnProc5=new FingerButton(host,"btnProc5",605,435,120,20);$.btnProc5.setText("입고");$.btnProc6=new FingerButton(host,"btnProc6",730,435,120,20);$.btnProc6.setText("전달완료");$.memMemo=new FingerMemoEdit(host,"memMemo",105,480,718,100);$.lbl1=new FingerLabel(host,"lbl1",204,433,20,20);$.lbl1.setText("▶");$.lbl2=new FingerLabel(host,"lbl2",329,433,20,20);$.lbl2.setText("▶");$.lbl3=new FingerLabel(host,"lbl3",454,433,20,20);$.lbl3.setText("▶");$.lbl4=new FingerLabel(host,"lbl4",579,433,20,20);$.lbl4.setText("▶");$.lbl5=new FingerLabel(host,"lbl5",704,433,20,20);$.lbl5.setText("▶");$.btnPervious=new FingerButton(host,"btnPervious",580,10,100,20);$.btnPervious.setText("이전단계로");$.btnNext=new FingerButton(host,"btnNext",665,10,100,20);$.btnNext.setText("다음단계로");$.btnCancel=new FingerButton(host,"btnCancel",750,10,100,20);$.btnCancel.setText("취소처리");$.btnPriceSave=new FingerButton(host,"btnPriceSave",750,70,100,20);$.btnPriceSave.setText("단가저장");$.btnPervious.setEnable(false);$.btnNext.setEnable(false);$.btnCancel.setEnable(false);$.btnPriceSave.setEnable(false);$.cmbDept.setEnable(false);$.cmbEmp.setEnable(false);$.cmbProduct.setEnable(false);$.txtProductName.setReadOnly(true);$.speQty.setEnable(false);$.spePrice.setEnable(false);$.memDescr.setReadOnly(true);$.btnProc1.setEnable(false);$.btnProc2.setEnable(false);$.btnProc3.setEnable(false);$.btnProc4.setEnable(false);$.btnProc5.setEnable(false);$.btnProc6.setEnable(false);$.memMemo.setReadOnly(true);$.img1.setMode("R");$.img2.setMode("R");$.img3.setMode("R");$.host=host;$.args=args};$.start=function(){$.panMain.add($.lblDept);$.panMain.add($.lblEmp);$.panMain.add($.lblProduct);$.panMain.add($.lblProductName);$.panMain.add($.lblQty);$.panMain.add($.lblQty2);$.panMain.add($.lblPrice);$.panMain.add($.lblPrice2);$.panMain.add($.lblIamge);$.panMain.add($.lblDescr);$.panMain.add($.lblStatus);$.panMain.add($.lblMemo);$.panMain.add($.cmbDept);$.panMain.add($.cmbEmp);$.panMain.add($.cmbProduct);$.panMain.add($.txtProductName);$.panMain.add($.speQty);$.panMain.add($.spePrice);$.panMain.add($.img1);$.panMain.add($.img2);$.panMain.add($.img3);$.panMain.add($.memDescr);$.panMain.add($.btnProc1);$.panMain.add($.btnProc2);$.panMain.add($.btnProc3);$.panMain.add($.btnProc4);$.panMain.add($.btnProc5);$.panMain.add($.btnProc6);$.panMain.add($.memMemo);$.panMain.add($.lbl1);$.panMain.add($.lbl2);$.panMain.add($.lbl3);$.panMain.add($.lbl4);$.panMain.add($.lbl5);$.panMain.add($.btnPervious);$.panMain.add($.btnNext);$.panMain.add($.btnCancel);$.panMain.add($.btnPriceSave);$.cmbDept.setColumn("dept_code","dept_name");$.cmbEmp.setColumn("employee_id","emp_name");var ds=bizComponentData2($,"Q1","L_CRM0224");setComboBind([$.cmbProduct],ds);var ds=commCodeData2($,"Q","#DEPT_LIST#");setComboBind([$.cmbDept],ds);var ds=commCodeData2($,"Q","#EMP_LIST#");setComboBind([$.cmbEmp],ds);if($.p_argument&&$.p_argument.wf_doc_id){$.varWfDocId=$.p_argument.wf_doc_id;$.varSeq=$.p_argument.seq;if($.varWfDocId){searchPromoItem("Q1")}}};$.callback=function(type,ds){if(type=="Q1"){var rs=ds.resultList[0][0];$.varProcState=rs.process_state;$.cmbDept.setValue(rs.Dept_code);$.cmbEmp.setValue(rs.Employee);$.cmbProduct.setValue(rs.Product);$.txtProductName.setValue(rs.item_name);$.speQty.setValue(rs.item_qty);$.spePrice.setValue(rs.item_price);$.memDescr.setValue(rs.descr);$.memMemo.setValue(rs.memo);$.img1.setValue(rs.Image1);$.img2.setValue(rs.Image2);$.img3.setValue(rs.Image3);if(rs.Image1){$.img1.setZooming(true)}if(rs.Image2){$.img2.setZooming(true)}if(rs.Image3){$.img3.setZooming(true)}proccessState($.varProcState);if($.popOpen){if(g_main.session.obj.UserID=="ka050002"){$.btnPervious.setEnable(true);$.btnNext.setEnable(true);$.btnCancel.setEnable(true);$.btnPriceSave.setEnable(true);$.spePrice.setEnable(true);$.memMemo.setReadOnly(false)}$.popOpen=false}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnPervious"){if($.varProcState=="10"){MessageBoxShow("최초 진행 단계입니다.");return}savePromoItem("S1")}else{if(id=="btnNext"){if($.varProcState=="90"){MessageBoxShow("더 이상 진행하실 수 없습니다.");return}savePromoItem("S2")}else{if(id=="btnCancel"){confirmBoxShow("신청내역을 취소하시겠습니까?",function(){if(g_main.msgShare==true){savePromoItem("S3");g_popupStack.close()}})}else{if(id=="btnPriceSave"){savePromoItem("S4")}}}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_click=function(id){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>