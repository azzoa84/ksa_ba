<script>function Main(){var $=this;$.host=null;$.panQuery=null;$.panList=null;$.panForm=null;$.grdList=null;$.btnSearch=null;$.lblDateQ=null;$.dteDateFrQ=null;$.dteDateToQ=null;$.lblTerm=null;$.lblStepQ=null;$.cmbStepQ=null;$.lblDeptNameQ=null;$.lblName=null;$.panMain=null;$.lblProduct=null;$.cmbProductQ=null;$.txtEmpName=null;$.lblObserveDate=null;$.txtObserveDate=null;$.lblReportType=null;$.cmbReportType=null;$.txtReportTypeDetail=null;$.lblCompanyName=null;$.txtCompanyName=null;$.lblSurveyYn=null;$.cmbSurveyYn=null;$.lblContactName=null;$.txtContactName=null;$.lblContactSex=null;$.cmbContactSex=null;$.lblContactAge=null;$.txtContactAge=null;$.lblProductName=null;$.cmbProductCode=null;$.lblIndication=null;$.txtIndication=null;$.lbldose=null;$.txtDose=null;$.lblStartTake=null;$.txtStartTake=null;$.lblEndTake=null;$.txtEndTake=null;$.txtActionTake=null;$.lblDetailMsg=null;$.panExtList=null;$.grdExtList=null;$.panMemoList=null;$.grdMemoList=null;$.cmbDeptQ=null;$.cmbEmpQ=null;$.meDetailMsg=null;$.lblActionTake=null;$.lblCompleteYn=null;$.cmbCompleteYn=null;$.lblDoubt=null;$.txtDoubt=null;var rowId=0;var returnType="";function initControl(){if($.cmbStepQ.getValue()=="Y"){$.dteDateFrQ.setReadOnly(false);$.dteDateToQ.setReadOnly(false);$.dteDateFrQ.setDateFormat("yyyymm");$.dteDateToQ.setDateFormat("yyyymm");$.dteDateFrQ.setValue(getTodayDate(-1));$.dteDateToQ.setValue(getTodayDate())}else{$.dteDateFrQ.setReadOnly(true);$.dteDateToQ.setReadOnly(true);$.dteDateFrQ.setValue("");$.dteDateToQ.setValue("")}}function initSearch(){var json=commJSON_Q("COMM_Q1");callQuery(["req",json],"COMM_LIST",$)}function getTodayDate(intMonth){intMonth=intMonth?intMonth:0;var tmp=new Date();tmp.setDate(tmp.getDate());var tmpYear=tmp.getFullYear();var tmpMonth=(tmp.getMonth()+1+intMonth)>=10?Number(tmp.getMonth()+1+intMonth):"0"+Number(tmp.getMonth()+1+intMonth);return tmpYear+"-"+tmpMonth}function commJSON_Q(workType){var json=createExecuteParamInfo("P_safeNoticeManage_commQ",[workType,"#UserID#"]);return json}function createJSON_Q(workType){var dept="";if(workType=="Q"){dept=$.cmbDept.getValue()}else{dept=g_main.session.obj.DeptCode}var json=createExecuteParamInfo("P_safeNoticeManage_Q",[workType,"#UserID#",$.varRowId||"",$.cmbStepQ.getValue()||"",$.dteDateFrQ.getValue()||"",$.dteDateToQ.getValue()||"",$.cmbProductQ.getValue()||"",dept,$.cmbEmpQ.getValue()||""]);return json}function createJSON_S(workType){if($.varRowId==""){MessageBoxShow("PV부작용 보고서가 선택되지 않았습니다.");return}var json=createExecuteParamInfo("P_safeNoticeManage_S",[workType,$.varRowId,$.cmbCompleteYn.getValue(),"#UserID#"]);return json}function createJSON_S1(workType){var json="";if(workType==""){var changedRows=$.grdMemoList.getChangedRows();if(changedRows.length<1){return}var rows=[];for(var i in changedRows){workType=changedRows[i].rowType;if(changedRows[i].comment==""){MessageBoxShow("메모가 입력되지 않았습니다.");return}rows.push([workType,"#UserID#",changedRows[i].safe_id||"",0,changedRows[i].comment||""])}json=createExecuteParamInfo("P_M_safeComment_S",rows)}else{if(workType=="D"){if($.varRowId==""){MessageBoxShow("PV부작용 보고서가 선택되지 않았습니다.");return}if($.varMemoSeq==""){MessageBoxShow("메모가 선택되지 않았습니다.");return}json=createExecuteParamInfo("P_M_safeComment_S",[workType,"#UserID#",$.varRowId,$.varMemoSeq,""])}}return json}function initConditions(){var today=getToday("");$.varRowId="";$.dteDateFrQ.setValue(getCalcMonth(today,-1));$.dteDateToQ.setValue(today);$.cmbStepQ.setValue("");$.varDeptCode=""}function initForm(){$.txtEmpName.setValue("");$.txtObserveDate.setValue("");$.cmbReportType.setValue("");$.txtReportTypeDetail.setValue("");$.cmbSurveyYn.setValue("");$.txtCompanyName.setValue("");$.txtContactName.setValue("");$.cmbContactSex.setValue("");$.txtContactAge.setValue("");$.cmbProductCode.setValue("");$.txtIndication.setValue("");$.txtDose.setValue("");$.txtStartTake.setValue("");$.txtEndTake.setValue("");$.txtActionTake.setValue("");$.meDetailMsg.setValue("");$.txtDoubt.setValue("");$.varRowId=0;$.varMemoFlag=0}function searchList(){if(!validateControls([$.dteDateFrQ,$.dteDateToQ])){return}var json=createJSON_Q("Q1");callQuery(["req",json],"Q1",$)}function searchBatchPrint(){var json=createJSON_Q("Q4");callQuery(["req",json],"Q4",$)}function searchExtCaseList(){var json=createJSON_Q("Q2");callQuery(["req",json],"Q2",$)}function searchMemoList(){var json=createJSON_Q("Q3");callQuery(["req",json],"Q3",$)}function saveForm(workType){returnType=workType;var json=createJSON_S(workType);if(json){var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"||ds.errorCode=="MSG0003"){initForm();searchList();MessageBoxShow("PV부작용 보고서가 성공적으로 저장되었습니다.")}}}function saveList(workType){var json=createJSON_S1(workType);if(json){var ds=callExecuteSync(["req",json],"S");if(ds.errorCode=="MSG0002"||ds.errorCode=="MSG0004"||ds.errorCode=="MSG0003"){$.varMemoFlag=0;searchMemoList()}}}$.init=function(host,args){$.panQuery=new FingerPanel(host,"panQuery",0,0,1200,50);$.panQuery.setText("");$.panQuery.setBottomLine(false);$.panList=new FingerPanel(host,"panList",0,60,1200,350);$.panList.setText("보고");$.panList.setBottomLine(false);$.panForm=new FingerPanel(host,"panForm",0,420,1200,430);$.panForm.setText("상세 정보");$.panForm.setBottomLine(false);$.grdList=new FingerDataGrid(host,"grdList",5,5,1190,295);$.btnSearch=new FingerButton(host,"btnSearch",1125,15,80,20);$.btnSearch.setText("조회");$.lblDateQ=new FingerLabel(host,"lblDateQ",180,15,100,20);$.lblDateQ.setText("보고일자");$.dteDateFrQ=new FingerDateEdit(host,"dteDateFrQ",285,15,100,20);$.dteDateToQ=new FingerDateEdit(host,"dteDateToQ",410,15,100,20);$.lblTerm=new FingerLabel(host,"lblTerm",388,15,20,20);$.lblTerm.setText("~");$.lblStepQ=new FingerLabel(host,"lblStepQ",25,15,70,20);$.lblStepQ.setText("처리상태");$.cmbStepQ=new FingerComboBox(host,"cmbStepQ",100,15,105,20);$.lblDeptNameQ=new FingerLabel(host,"lblDeptNameQ",740,15,70,20);$.lblDeptNameQ.setText("작성자");$.lblName=new FingerLabel(host,"lblName",0,15,100,20);$.lblName.setText("작성자");$.panMain=new FingerPanel(host,"panMain",0,0,1200,1400);$.panMain.setText("");$.panMain.setBottomLine(false);$.lblProduct=new FingerLabel(host,"lblProduct",510,15,70,20);$.lblProduct.setText("품목");$.cmbProductQ=new FingerComboBox(host,"cmbProductQ",590,15,160,20);$.txtEmpName=new FingerEdit(host,"txtEmpName",105,15,135,20);$.lblObserveDate=new FingerLabel(host,"lblObserveDate",430,15,100,20);$.lblObserveDate.setText("인지일자");$.txtObserveDate=new FingerEdit(host,"txtObserveDate",535,15,175,20);$.lblReportType=new FingerLabel(host,"lblReportType",0,55,100,20);$.lblReportType.setText("보고자 구분");$.cmbReportType=new FingerComboBox(host,"cmbReportType",105,55,140,15);$.txtReportTypeDetail=new FingerEdit(host,"txtReportTypeDetail",245,55,195,20);$.lblCompanyName=new FingerLabel(host,"lblCompanyName",430,55,100,20);$.lblCompanyName.setText("소속기관");$.txtCompanyName=new FingerEdit(host,"txtCompanyName",535,55,175,20);$.lblSurveyYn=new FingerLabel(host,"lblSurveyYn",750,55,120,20);$.lblSurveyYn.setText("추적조사 가능여부");$.cmbSurveyYn=new FingerComboBox(host,"cmbSurveyYn",875,55,140,20);$.lblContactName=new FingerLabel(host,"lblContactName",0,95,100,20);$.lblContactName.setText("환자 이니셜");$.txtContactName=new FingerEdit(host,"txtContactName",105,95,135,20);$.lblContactSex=new FingerLabel(host,"lblContactSex",430,95,100,20);$.lblContactSex.setText("성별");$.cmbContactSex=new FingerComboBox(host,"cmbContactSex",535,95,180,20);$.lblContactAge=new FingerLabel(host,"lblContactAge",770,95,100,20);$.lblContactAge.setText("나이");$.txtContactAge=new FingerEdit(host,"txtContactAge",875,95,135,20);$.lblProductName=new FingerLabel(host,"lblProductName",0,135,100,20);$.lblProductName.setText("제품");$.cmbProductCode=new FingerComboBox(host,"cmbProductCode",105,135,140,20);$.lblIndication=new FingerLabel(host,"lblIndication",425,135,100,20);$.lblIndication.setText("적응증");$.txtIndication=new FingerEdit(host,"txtIndication",535,135,175,20);$.lbldose=new FingerLabel(host,"lbldose",770,135,100,20);$.lbldose.setText("투여용량");$.txtDose=new FingerEdit(host,"txtDose",875,135,135,20);$.lblStartTake=new FingerLabel(host,"lblStartTake",0,175,100,20);$.lblStartTake.setText("복용시작일");$.txtStartTake=new FingerEdit(host,"txtStartTake",105,175,135,20);$.lblEndTake=new FingerLabel(host,"lblEndTake",425,175,100,20);$.lblEndTake.setText("마지막 복용일");$.txtEndTake=new FingerEdit(host,"txtEndTake",535,175,175,20);$.txtActionTake=new FingerEdit(host,"txtActionTake",875,175,135,20);$.lblDetailMsg=new FingerLabel(host,"lblDetailMsg",0,245,100,20);$.lblDetailMsg.setText("상세내용");$.panExtList=new FingerPanel(host,"panExtList",0,860,1200,265);$.panExtList.setText("안전성 정보");$.panExtList.setBottomLine(true);$.grdExtList=new FingerDataGrid(host,"grdExtList",0,0,1195,215);$.panMemoList=new FingerPanel(host,"panMemoList",0,1135,1200,250);$.panMemoList.setText("메모 이력");$.panMemoList.setBottomLine(true);$.grdMemoList=new FingerDataGrid(host,"grdMemoList",0,0,1200,200);$.cmbDeptQ=new FingerComboBox(host,"cmbDeptQ",815,15,120,20);$.cmbEmpQ=new FingerComboBox(host,"cmbEmpQ",935,15,120,20);$.meDetailMsg=new FingerMemoEdit(host,"meDetailMsg",105,245,1040,100);$.lblActionTake=new FingerLabel(host,"lblActionTake",750,175,115,20);$.lblActionTake.setText("약물에 대한 조치");$.lblCompleteYn=new FingerLabel(host,"lblCompleteYn",770,15,100,20);$.lblCompleteYn.setText("처리상태");$.cmbCompleteYn=new FingerComboBox(host,"cmbCompleteYn",875,15,140,20);$.lblDoubt=new FingerLabel(host,"lblDoubt",0,210,100,20);$.lblDoubt.setText("추가약물정보");$.txtDoubt=new FingerEdit(host,"txtDoubt",105,210,905,20);$.cmbStepQ.setFieldName("처리상태");$.cmbStepQ.setAllowBlank(false);$.cmbProductQ.setFieldName("품목");$.cmbProductQ.setAllowBlank(true);$.cmbProductQ.setEmptyRow(true);$.cmbStepQ.setEmptyRow(true);$.cmbDeptQ.setEmptyRow(true);$.cmbEmpQ.setEmptyRow(true);$.panQuery.setBorder(true);$.panList.addButton("btnPrint","출력");$.panList.setButtonAction("btnPrint","print");$.panForm.addButton("btnSave","저장");$.panForm.setButtonAction("btnSave","save");$.panMemoList.addButton("btnDelete","삭제");$.panMemoList.addButton("btnAdd","추가");$.panMemoList.addButton("btnSave","저장");$.panMemoList.setButtonAction("btnSave","save");$.panMemoList.setButtonAction("btnAdd","add");$.panMemoList.setButtonAction("btnDelete","delete");$.txtEmpName.setReadOnly(true);$.txtObserveDate.setReadOnly(true);$.cmbReportType.setReadOnly(true);$.txtReportTypeDetail.setReadOnly(true);$.txtCompanyName.setReadOnly(true);$.cmbSurveyYn.setReadOnly(true);$.txtContactName.setReadOnly(true);$.cmbContactSex.setReadOnly(true);$.txtContactAge.setReadOnly(true);$.cmbProductCode.setReadOnly(true);$.txtIndication.setReadOnly(true);$.txtDose.setReadOnly(true);$.txtStartTake.setReadOnly(true);$.txtEndTake.setReadOnly(true);$.txtActionTake.setReadOnly(true);$.meDetailMsg.setReadOnly(true);$.txtDoubt.setReadOnly(true);$.grdList.setColumns([new FingerDataGridColumn("safe_id",80,"right","ro","연번"),new FingerDataGridColumn("report_type",100,"left","ro","보고자 구분",{hidden:true}),new FingerDataGridColumn("safe_step_name",80,"center","ro","처리상태"),new FingerDataGridColumn("report_type_name",300,"left","ro","보고자 구분"),new FingerDataGridColumn("report_type_detail",200,"left","ro","보고자 구분 상세",{hidden:true}),new FingerDataGridColumn("company_name",200,"left","ro","소속기관 "),new FingerDataGridColumn("contact_info",140,"center","ro","성별 / 나이"),new FingerDataGridColumn("product_code",120,"center","ro","제품",{hidden:true}),new FingerDataGridColumn("product_name",120,"center","ro","제품"),new FingerDataGridColumn("indication",400,"left","ron","적응증"),new FingerDataGridColumn("observe_date",100,"center","ro","최초인지일자","yyyy-MM-dd"),new FingerDataGridColumn("create_time",100,"center","ro","작성일자","yyyy-MM-dd"),new FingerDataGridColumn("complete_date",100,"center","ro","완료일자","yyyy-MM-dd"),new FingerDataGridColumn("pv_employee_name",120,"center","ron","PV담당자")]);$.grdList.setBorder(false);$.grdList.init({panel:$.panList,scroll:"xy"});$.grdExtList.setColumns([new FingerDataGridColumn("ext_name",140,"left","ro","이상사례",{hidden:true}),new FingerDataGridColumn("ext_detail",180,"left","ro","특수상황",{hidden:true}),new FingerDataGridColumn("ext",250,"left","ro","이상사례/특수상황"),new FingerDataGridColumn("ext_start_case",150,"center","ro","발생일"),new FingerDataGridColumn("ext_end_case",150,"center","ro","종료일"),new FingerDataGridColumn("pass",340,"left","ron","경과",{hidden:true}),new FingerDataGridColumn("pass_name",340,"left","ron","경과"),new FingerDataGridColumn("evaluation",340,"left","ron","인과관계 평가",{hidden:true}),new FingerDataGridColumn("evaluation_name",340,"left","ron","인과관계 평가")]);$.grdExtList.setBorder(false);$.grdExtList.init();$.grdMemoList.setColumns([new FingerDataGridColumn("seq",120,"center","ro","피드백 순번",{hidden:true,readonly:true}),new FingerDataGridColumn("safe_id",120,"center","ro","부작용보고서ID",{hidden:true,readonly:true}),new FingerDataGridColumn("create_time",160,"center","ro","작성일시",{readonly:true},"yyyy-MM-dd HH:mm:ss"),new FingerDataGridColumn("comment",865,"left","ro","메모",{readonly:false}),new FingerDataGridColumn("create_user",160,"center","ro","작성자",{readonly:true}),new FingerDataGridColumn("create_id",160,"center","ro","작성자",{hidden:true,readonly:true})]);$.grdMemoList.setBorder(false);$.grdMemoList.init({eventCellReadOnly:true});$.grdMemoList.setEditable(true);$.host=host;$.args=args};$.start=function(){$.panQuery.add($.btnSearch);$.panQuery.add($.dteDateFrQ);$.panQuery.add($.dteDateToQ);$.panQuery.add($.lblTerm);$.panQuery.add($.lblStepQ);$.panQuery.add($.cmbStepQ);$.panQuery.add($.lblDeptNameQ);$.panQuery.add($.lblDateQ);$.panQuery.add($.lblProduct);$.panQuery.add($.cmbProductQ);$.panQuery.add($.cmbDeptQ);$.panQuery.add($.cmbEmpQ);$.panList.add($.grdList);$.panForm.add($.lblName);$.panForm.add($.txtEmpName);$.panForm.add($.lblObserveDate);$.panForm.add($.txtObserveDate);$.panForm.add($.lblReportType);$.panForm.add($.cmbReportType);$.panForm.add($.txtReportTypeDetail);$.panForm.add($.lblCompanyName);$.panForm.add($.txtCompanyName);$.panForm.add($.lblSurveyYn);$.panForm.add($.cmbSurveyYn);$.panForm.add($.lblContactName);$.panForm.add($.txtContactName);$.panForm.add($.lblContactSex);$.panForm.add($.cmbContactSex);$.panForm.add($.lblContactAge);$.panForm.add($.txtContactAge);$.panForm.add($.lblProductName);$.panForm.add($.cmbProductCode);$.panForm.add($.lblIndication);$.panForm.add($.txtIndication);$.panForm.add($.lbldose);$.panForm.add($.txtDose);$.panForm.add($.lblStartTake);$.panForm.add($.txtStartTake);$.panForm.add($.lblEndTake);$.panForm.add($.txtEndTake);$.panForm.add($.txtActionTake);$.panForm.add($.lblDetailMsg);$.panForm.add($.meDetailMsg);$.panForm.add($.lblActionTake);$.panForm.add($.lblCompleteYn);$.panForm.add($.cmbCompleteYn);$.panForm.add($.lblDoubt);$.panForm.add($.txtDoubt);$.panMain.add($.panQuery);$.panMain.add($.panList);$.panMain.add($.panForm);$.panMain.add($.panExtList);$.panMain.add($.panMemoList);$.panExtList.add($.grdExtList);$.panMemoList.add($.grdMemoList);initConditions();var ds=commCodeData2($,"","SF011");setComboBind([$.cmbStepQ],ds);var subQuery=" and sales_dept_yn = 'Y'";var ds=bizComponentData2($,"Q4","L_CRM0051",subQuery);$.cmbDeptQ.setColumn("dept_code","dept_name");setComboBind([$.cmbDeptQ],ds);initControl();initSearch()};$.callback=function(type,ds){if(type=="COMM_LIST"){if(ds.resultList&&ds.resultList.length){setComboBind([$.cmbProductQ,$.cmbReportType,$.cmbSurveyYn,$.cmbContactSex,$.cmbProductCode,$.cmbCompleteYn],ds)}}else{if(type=="Q1"){setDataGrid([$.grdList],ds);$.panList.setText("보고 조회 결과 ["+setComma($.grdList.getRowCount())+"건]");if($.grdList.getGridRowIndex("safe_id",rowId)>0&&returnType=="U"){$.grdList.selectRow($.grdList.getGridRowIndex("safe_id",rowId))}else{$.grdList.selectRow(0)}if($.cmbStepQ.getValue()=="Y"){$.cmbCompleteYn.setReadOnly(true)}else{$.cmbCompleteYn.setReadOnly(false)}var rId=$.grdList.getSelectedRowIdx();if($.grdList.getValue(rId,"safe_step")=="D"){$.cmbCompleteYn.setReadOnly(true)}else{$.cmbCompleteYn.setReadOnly(false)}}else{if(type=="Q2"){setDataGrid([$.grdExtList],ds);$.panExtList.setText("안전성 정보 조회 결과 ["+setComma($.grdExtList.getRowCount())+"건]")}else{if(type=="Q3"){setDataGrid([$.grdMemoList],ds);$.panMemoList.setText("Memo 이력 조회 결과 ["+setComma($.grdMemoList.getRowCount())+"건]")}else{if(type=="Q4"){var arrSheet0=[];var arrSheet1=[];var arrSheet2=[];var arrSheet3=[];var arrSheet4=[];var arrSheet5=[];if(ds&&ds.resultList){for(var i=0;i<ds.resultList[0].length;i++){var clsRow=ds.resultList[0][i];arrSheet0.push({pv0:clsRow.safe_id,pv1:clsRow.observe_date,pv2:"",pv3:"",pv4:"",pv5:"",pv6:"",pv7:"",pv8:"",pv9:"",pv10:"",pv11:"",pv12:"",pv13:"",pv14:"",pv15:"",pv16:"",pv17:"",pv18:"",pv19:"",pv20:"",pv21:"",pv22:"",pv23:"",pv24:"",pv25:"",pv26:"",pv27:"",pv28:"",pv29:"",pv30:"",pv31:"",pv32:"",pv33:"",pv34:"",pv35:"",pv36:"",pv37:clsRow.report_type,pv38:clsRow.company_name,pv39:"",pv40:"",pv41:"",pv42:"",pv43:"",pv44:"",pv45:"",pv46:""});arrSheet1.push({pv0:clsRow.safe_id,pv1:clsRow.contact_name,pv2:"",pv3:clsRow.contact_age,pv4:clsRow.contact_ages,pv5:clsRow.contact_sex,pv6:"",pv7:"",pv8:"",pv9:"",pv10:"",pv11:"",pv12:"",pv13:"",pv14:"",pv15:"",pv16:"",pv17:"",pv18:"",pv19:"",pv20:"",pv21:"",pv22:"",pv23:""});arrSheet3.push({pv0:"",pv1:"",pv2:"",pv3:"",pv4:"",pv5:"",pv6:""});if(clsRow.action_take=="03"){clsRow.action_take=="02"}arrSheet4.push({pv0:clsRow.safe_id,pv1:"",pv2:"",pv3:clsRow.product_code,pv4:"",pv5:clsRow.indication,pv6:clsRow.action_take,pv7:"",pv8:clsRow.dose,pv9:"",pv10:"",pv11:"",pv12:"",pv13:clsRow.start_take,pv14:clsRow.end_take,pv15:"",pv16:"",pv17:"",pv18:""})}for(var i=0;i<ds.resultList[1].length;i++){var clsRow=ds.resultList[1][i];arrSheet2.push({pv0:clsRow.safe_id,pv1:clsRow.ext_detail+" / "+clsRow.detail_msg,pv2:"",pv3:"",pv4:clsRow.pass,pv5:clsRow.ext_start_case,pv6:"",pv7:"",pv8:"",pv9:clsRow.ext_end_case,pv10:"",pv11:"",pv12:"",pv13:"",pv14:"",pv15:""});arrSheet5.push({pv0:clsRow.safe_id,pv1:"",pv2:"",pv3:"",pv4:"",pv5:clsRow.evaluation,pv6:"",pv7:"",pv8:"",pv9:clsRow.ext_end_case,pv10:"",pv11:"",pv12:"",pv13:""})}}var params={sheet0:arrSheet0,sheet1:arrSheet1,sheet2:arrSheet2,sheet3:arrSheet3,sheet4:arrSheet4,sheet5:arrSheet5,};exportSafeNotice(params,"PV_Report.xls");return}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){returnType="";initForm();searchList()}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){$.popUpCallId=id;if(id=="bteDeptNameQ"){var param=[];param.dept_code=$.varDeptCode;param.dept_name=$.bteDeptNameQ.getText();g_main.openPopup("popDept.html","popDept","부서 조회",305,495,"","",param,"","")}};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){if(id=="cmbDeptQ"){if($.cmbDeptQ.getValue()==null||$.cmbDeptQ.getValue()==""){$.cmbEmpQ.setReadOnly(true)}else{$.cmbEmpQ.setReadOnly(false);$.cmbEmpQ.clear();var strQuery=" and dept_code ='"+$.cmbDeptQ.getValue()+"' and delete_yn <> 'Y'";var ds=bizComponentData2($,"Q4","L_CRM0052",strQuery);$.cmbEmpQ.setColumn("employee_id","emp_name");setComboBind([$.cmbEmpQ],ds)}}else{if(id=="cmbStepQ"){initControl()}}};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdList"){initForm();var rId=$.grdList.getSelectedRowIdx();if(rId<0){return}$.txtEmpName.setValue($.grdList.getValue(rId,"employee_name"));$.txtObserveDate.setValue($.grdList.getValue(rId,"observe_date"));$.cmbReportType.setValue($.grdList.getValue(rId,"report_type"));$.txtReportTypeDetail.setValue($.grdList.getValue(rId,"report_type_detail"));$.cmbSurveyYn.setValue($.grdList.getValue(rId,"survey_yn"));$.txtCompanyName.setValue($.grdList.getValue(rId,"company_name"));$.txtContactName.setValue($.grdList.getValue(rId,"contact_name"));$.cmbContactSex.setValue($.grdList.getValue(rId,"contact_sex"));$.txtContactAge.setValue($.grdList.getValue(rId,"contact_age"));$.cmbProductCode.setValue($.grdList.getValue(rId,"product_code"));$.cmbCompleteYn.setValue($.grdList.getValue(rId,"complete_yn"));$.txtIndication.setValue($.grdList.getValue(rId,"indication"));$.txtDose.setValue($.grdList.getValue(rId,"dose"));$.txtStartTake.setValue($.grdList.getValue(rId,"start_take"));$.txtEndTake.setValue($.grdList.getValue(rId,"end_take"));$.txtActionTake.setValue($.grdList.getValue(rId,"action_take_name"));$.meDetailMsg.setValue($.grdList.getValue(rId,"detail_msg"));$.txtDoubt.setValue($.grdList.getValue(rId,"doubt_product"));$.varRowId=$.grdList.getValue(rId,"safe_id");rowId=$.grdList.getValue(rId,"safe_id");if($.grdList.getValue(rId,"safe_step")=="D"){$.cmbCompleteYn.setReadOnly(true)}else{$.cmbCompleteYn.setReadOnly(false)}searchExtCaseList();searchMemoList()}else{if(id=="grdMemoList"){var rId=$.grdMemoList.getSelectedRowIdx();var grdRow=$.grdMemoList.getValue(rId);var objInfo=g_main.session.obj;$.varMemoSeq=$.grdMemoList.getValue(rId,"seq");if(grdRow.create_id!=""&grdRow.create_id!=null){if(objInfo.UserID!=grdRow.create_id){grdRow.comment_readonly=true}}}}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){if((id=="txtCondition")&&value=="13"){searchList()}};$.fingeredit_lostfocus=function(id,value){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panList"){if(btnId=="btnPrint"){searchBatchPrint()}}else{if(panelId=="panForm"){var rowId=$.grdList.getSelectedRowIdx();var grdRow=$.grdList.getValue(rowId);if(grdRow.safe_step=="D"){MessageBoxShow("삭제된 건은 저장할 수 없습니다.");return}if(btnId=="btnSave"){saveForm("U")}}else{if(panelId=="panMemoList"){var rowId=$.grdList.getSelectedRowIdx();var grdRow=$.grdList.getValue(rowId);if(grdRow.safe_step=="D"){MessageBoxShow("삭제된 건은 메모를 추가/수정/삭제할 수 없습니다.");return}if(btnId=="btnAdd"){if($.varRowId==""){MessageBoxShow("PV부작용 보고서가 선택되지 않았습니다.");return}if($.varMemoFlag=="1"){MessageBoxShow("메모는 1회 1건만 등록이 가능합니다. 내용을 입력하여 저장 및 메일발송을 진행해 주세요.");return}var grdMemoRowCnt=$.grdMemoList.getRowCount();$.grdMemoList.addRow({memo_seq:"",safe_id:$.varRowId,create_date:getTodateTime("-"),comment:""});$.varMemoFlag=1}else{if(btnId=="btnSave"){confirmBoxShow("메모를 저장하시겠습니까?",function(){if(g_main.msgShare==true){saveList("")}})}else{if(btnId=="btnDelete"){var rId=$.grdMemoList.getSelectedRowIdx();if(!rId){return}if($.grdMemoList.getRowStatus(rId)!="N"){if(grdRow.safe_step=="Y"){MessageBoxShow("처리상태가 완료된 건은 삭제할 수 없습니다..");return}confirmBoxShow("메모를 삭제하시겠습니까?",function(){if(g_main.msgShare==true){saveList("D")}})}else{$.varMemoFlag=0;$.grdMemoList.deleteCurrentRow()}}}}}}}};$.fingerpopup_close=function(id){if(g_main.popShare!=null){var popResult=g_main.popShare;if(id=="popDept"){if($.popUpCallId=="bteDeptNameQ"){$.varDeptCode=popResult[0];$.bteDeptNameQ.setValue(popResult[1])}}}};$.fingerpopup2_close=function(id){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerscheduler_view_display=function(id,view){};$.fingertree_refresh=function(id){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerradiobox_change=function(id,value){};$.fingerimage_click=function(id){}};</script>