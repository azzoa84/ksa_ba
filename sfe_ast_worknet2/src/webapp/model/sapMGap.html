<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panTop=null;$.lblDate=null;$.dteDate=null;$.btnSearch=null;$.panTab=null;$.panLeft=null;$.panRight=null;$.grdLList=null;$.grdLList2=null;$.grdLList1=null;$.grdRList=null;$.grdRList1=null;$.grdRList2=null;$.btnSave=null;$.session=g_main.session.obj;$.deleteRows=[];function createJSON_Q(workType){var json=createExecuteParamInfo("SAP..P_sapMGap_Q",[workType,$.dteDate.getValue()]);return json}function createJSON_S(workType){var rows=[];var changedRows=$.grdLList1.getChangedRows();if(changedRows.length==0){return false}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,getFormatDate(changedRows[i].YearMonth,"yyyyMM").substr(0,6)||"",changedRows[i].title,Number(changedRows[i].SUM)||0,Number(changedRows[i].PRG)||0,Number(changedRows[i].HA)||0,Number(changedRows[i].VC)||0,Number(changedRows[i].NA)||0,Number(changedRows[i].BER)||0,Number(changedRows[i].OL)||0,Number(changedRows[i].PD_I)||0,Number(changedRows[i].PRT)||0,Number(changedRows[i].LO)||0,Number(changedRows[i].MCFG)||0,Number(changedRows[i].GA)||0,Number(changedRows[i].AD)||0,Number(changedRows[i].IB)||0,Number(changedRows[i].RPM)||0,Number(changedRows[i].XT)||0,Number(changedRows[i].BET)||0,Number(changedRows[i].SGL)||0,Number(changedRows[i].ETC)||0,Number(changedRows[i].Updatedate)||"",Number(changedRows[i].seq)||0])}var json=createExecuteParamInfo("SAP..P_sapMGap_S",rows);return json}function createJSON_S1(workType){var rows=[];var changedRows=$.grdRList1.getChangedRows();if(changedRows.length==0){return false}for(var i in changedRows){workType=changedRows[i].rowType;rows.push([workType,getFormatDate(changedRows[i].YearMonth,"yyyyMM").substr(0,6)||"",changedRows[i].title,Number(changedRows[i].SUM)||0,Number(changedRows[i].PRG)||0,Number(changedRows[i].HA)||0,Number(changedRows[i].VC)||0,Number(changedRows[i].NA)||0,Number(changedRows[i].BER)||0,Number(changedRows[i].OL)||0,Number(changedRows[i].PD_I)||0,Number(changedRows[i].PRT)||0,Number(changedRows[i].LO)||0,Number(changedRows[i].MCFG)||0,Number(changedRows[i].GA)||0,Number(changedRows[i].AD)||0,Number(changedRows[i].IB)||0,Number(changedRows[i].RPM)||0,Number(changedRows[i].XT)||0,Number(changedRows[i].BET)||0,Number(changedRows[i].SGL)||0,Number(changedRows[i].ETC)||0,Number(changedRows[i].Updatedate)||"",Number(changedRows[i].seq)||0])}var json=createExecuteParamInfo("SAP_old..P_sapMGap_2_S",rows);return json}function searchList(workType){if(!$.panTop.validateControls()){return}var json=createJSON_Q(workType);callQuery(["req",json],workType,$)}function saveLList(workType){var json=createJSON_S(workType);if(json){callExecute(["req",json],"LSAVE",$)}else{saveRList("")}}function saveRList(workType){var json=createJSON_S1(workType);if(json){callExecute(["req",json],"RSAVE",$)}else{MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q")}}function calcTotal(){var SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;var x=4;var y=9;var z=12;SUM1=SUM1+Number($.grdLList1.getValue(x,"PRG"))+Number($.grdLList1.getValue(y,"PRG"))+Number($.grdLList1.getValue(z,"PRG"));SUM2=SUM2+Number($.grdLList1.getValue(x,"HA"))+Number($.grdLList1.getValue(y,"HA"))+Number($.grdLList1.getValue(z,"HA"));SUM3=SUM3+Number($.grdLList1.getValue(x,"VC"))+Number($.grdLList1.getValue(y,"VC"))+Number($.grdLList1.getValue(z,"VC"));SUM4=SUM4+Number($.grdLList1.getValue(x,"NA"))+Number($.grdLList1.getValue(y,"NA"))+Number($.grdLList1.getValue(z,"NA"));SUM5=SUM5+Number($.grdLList1.getValue(x,"BER"))+Number($.grdLList1.getValue(y,"BER"))+Number($.grdLList1.getValue(z,"BER"));SUM6=SUM6+Number($.grdLList1.getValue(x,"OL"))+Number($.grdLList1.getValue(y,"OL"))+Number($.grdLList1.getValue(z,"OL"));SUM7=SUM7+Number($.grdLList1.getValue(x,"PD_I"))+Number($.grdLList1.getValue(y,"PD_I"))+Number($.grdLList1.getValue(z,"PD_I"));SUM8=SUM8+Number($.grdLList1.getValue(x,"PRT"))+Number($.grdLList1.getValue(y,"PRT"))+Number($.grdLList1.getValue(z,"PRT"));SUM9=SUM9+Number($.grdLList1.getValue(x,"LO"))+Number($.grdLList1.getValue(y,"LO"))+Number($.grdLList1.getValue(z,"LO"));SUM10=SUM10+Number($.grdLList1.getValue(x,"MCFG"))+Number($.grdLList1.getValue(y,"MCFG"))+Number($.grdLList1.getValue(z,"MCFG"));SUM11=SUM11+Number($.grdLList1.getValue(x,"GA"))+Number($.grdLList1.getValue(y,"GA"))+Number($.grdLList1.getValue(z,"GA"));SUM12=SUM12+Number($.grdLList1.getValue(x,"AD"))+Number($.grdLList1.getValue(y,"AD"))+Number($.grdLList1.getValue(z,"AD"));SUM13=SUM13+Number($.grdLList1.getValue(x,"IB"))+Number($.grdLList1.getValue(y,"IB"))+Number($.grdLList1.getValue(z,"IB"));SUM14=SUM14+Number($.grdLList1.getValue(x,"RPM"))+Number($.grdLList1.getValue(y,"RPM"))+Number($.grdLList1.getValue(z,"RPM"));SUM15=SUM15+Number($.grdLList1.getValue(x,"ETC"))+Number($.grdLList1.getValue(y,"ETC"))+Number($.grdLList1.getValue(z,"ETC"));SUM16=SUM16+Number($.grdLList1.getValue(x,"XT"))+Number($.grdLList1.getValue(y,"XT"))+Number($.grdLList1.getValue(z,"XT"));SUM17=SUM17+Number($.grdLList1.getValue(x,"BET"))+Number($.grdLList1.getValue(y,"BET"))+Number($.grdLList1.getValue(z,"BET"));SUM18=SUM18+Number($.grdLList1.getValue(x,"SGL"))+Number($.grdLList1.getValue(y,"SGL"))+Number($.grdLList1.getValue(z,"SGL"));$.grdLList1.setValue(13,"PRG",SUM1);$.grdLList1.setValue(13,"HA",SUM2);$.grdLList1.setValue(13,"VC",SUM3);$.grdLList1.setValue(13,"NA",SUM4);$.grdLList1.setValue(13,"BER",SUM5);$.grdLList1.setValue(13,"OL",SUM6);$.grdLList1.setValue(13,"PD_I",SUM7);$.grdLList1.setValue(13,"PRT",SUM8);$.grdLList1.setValue(13,"LO",SUM9);$.grdLList1.setValue(13,"MCFG",SUM10);$.grdLList1.setValue(13,"GA",SUM11);$.grdLList1.setValue(13,"AD",SUM12);$.grdLList1.setValue(13,"IB",SUM13);$.grdLList1.setValue(13,"RPM",SUM14);$.grdLList1.setValue(13,"ETC",SUM15);$.grdLList1.setValue(13,"XT",SUM16);$.grdLList1.setValue(13,"BET",SUM17);$.grdLList1.setValue(13,"SGL",SUM18);$.grdLList1.setValue(13,"SUM",SUM1+SUM2+SUM3+SUM4+SUM5+SUM6+SUM7+SUM8+SUM9+SUM10+SUM11+SUM12+SUM13+SUM14+SUM15+SUM16+SUM17+SUM18);x=3,y=13;SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;SUM1=SUM1+Number($.grdLList1.getValue(x,"PRG"))-Number($.grdLList1.getValue(y,"PRG"));SUM2=SUM2+Number($.grdLList1.getValue(x,"HA"))-Number($.grdLList1.getValue(y,"HA"));SUM3=SUM3+Number($.grdLList1.getValue(x,"VC"))-Number($.grdLList1.getValue(y,"VC"));SUM4=SUM4+Number($.grdLList1.getValue(x,"NA"))-Number($.grdLList1.getValue(y,"NA"));SUM5=SUM5+Number($.grdLList1.getValue(x,"BER"))-Number($.grdLList1.getValue(y,"BER"));SUM6=SUM6+Number($.grdLList1.getValue(x,"OL"))-Number($.grdLList1.getValue(y,"OL"));SUM7=SUM7+Number($.grdLList1.getValue(x,"PD_I"))-Number($.grdLList1.getValue(y,"PD_I"));SUM8=SUM8+Number($.grdLList1.getValue(x,"PRT"))-Number($.grdLList1.getValue(y,"PRT"));SUM9=SUM9+Number($.grdLList1.getValue(x,"LO"))-Number($.grdLList1.getValue(y,"LO"));SUM10=SUM10+Number($.grdLList1.getValue(x,"MCFG"))-Number($.grdLList1.getValue(y,"MCFG"));SUM11=SUM11+Number($.grdLList1.getValue(x,"GA"))-Number($.grdLList1.getValue(y,"GA"));SUM12=SUM12+Number($.grdLList1.getValue(x,"AD"))-Number($.grdLList1.getValue(y,"AD"));SUM13=SUM13+Number($.grdLList1.getValue(x,"IB"))-Number($.grdLList1.getValue(y,"IB"));SUM14=SUM14+Number($.grdLList1.getValue(x,"RPM"))-Number($.grdLList1.getValue(y,"RPM"));SUM15=SUM15+Number($.grdLList1.getValue(x,"ETC"))-Number($.grdLList1.getValue(y,"ETC"));SUM16=SUM16+Number($.grdLList1.getValue(x,"XT"))-Number($.grdLList1.getValue(y,"XT"));SUM17=SUM17+Number($.grdLList1.getValue(x,"BET"))-Number($.grdLList1.getValue(y,"BET"));SUM18=SUM18+Number($.grdLList1.getValue(x,"SGL"))-Number($.grdLList1.getValue(y,"SGL"));$.grdLList1.setValue(14,"PRG",SUM1);$.grdLList1.setValue(14,"HA",SUM2);$.grdLList1.setValue(14,"VC",SUM3);$.grdLList1.setValue(14,"NA",SUM4);$.grdLList1.setValue(14,"BER",SUM5);$.grdLList1.setValue(14,"OL",SUM6);$.grdLList1.setValue(14,"PD_I",SUM7);$.grdLList1.setValue(14,"PRT",SUM8);$.grdLList1.setValue(14,"LO",SUM9);$.grdLList1.setValue(14,"MCFG",SUM10);$.grdLList1.setValue(14,"GA",SUM11);$.grdLList1.setValue(14,"AD",SUM12);$.grdLList1.setValue(14,"IB",SUM13);$.grdLList1.setValue(14,"RPM",SUM14);$.grdLList1.setValue(14,"ETC",SUM15);$.grdLList1.setValue(14,"XT",SUM16);$.grdLList1.setValue(14,"BET",SUM17);$.grdLList1.setValue(14,"SGL",SUM18);$.grdLList1.setValue(14,"SUM",SUM1+SUM2+SUM3+SUM4+SUM5+SUM6+SUM7+SUM8+SUM9+SUM10+SUM11+SUM12+SUM13+SUM14+SUM15+SUM16+SUM17+SUM18)}function calcTotal_2(){var SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;var x=3;var y=8;var z=11;SUM1=SUM1+Number($.grdRList1.getValue(x,"PRG"))+Number($.grdRList1.getValue(y,"PRG"))+Number($.grdRList1.getValue(z,"PRG"));SUM2=SUM2+Number($.grdRList1.getValue(x,"HA"))+Number($.grdRList1.getValue(y,"HA"))+Number($.grdRList1.getValue(z,"HA"));SUM3=SUM3+Number($.grdRList1.getValue(x,"VC"))+Number($.grdRList1.getValue(y,"VC"))+Number($.grdRList1.getValue(z,"VC"));SUM4=SUM4+Number($.grdRList1.getValue(x,"NA"))+Number($.grdRList1.getValue(y,"NA"))+Number($.grdRList1.getValue(z,"NA"));SUM5=SUM5+Number($.grdRList1.getValue(x,"BER"))+Number($.grdRList1.getValue(y,"BER"))+Number($.grdRList1.getValue(z,"BER"));SUM6=SUM6+Number($.grdRList1.getValue(x,"OL"))+Number($.grdRList1.getValue(y,"OL"))+Number($.grdRList1.getValue(z,"OL"));SUM7=SUM7+Number($.grdRList1.getValue(x,"PD_I"))+Number($.grdRList1.getValue(y,"PD_I"))+Number($.grdRList1.getValue(z,"PD_I"));SUM8=SUM8+Number($.grdRList1.getValue(x,"PRT"))+Number($.grdRList1.getValue(y,"PRT"))+Number($.grdRList1.getValue(z,"PRT"));SUM9=SUM9+Number($.grdRList1.getValue(x,"LO"))+Number($.grdRList1.getValue(y,"LO"))+Number($.grdRList1.getValue(z,"LO"));SUM10=SUM10+Number($.grdRList1.getValue(x,"MCFG"))+Number($.grdRList1.getValue(y,"MCFG"))+Number($.grdRList1.getValue(z,"MCFG"));SUM11=SUM11+Number($.grdRList1.getValue(x,"GA"))+Number($.grdRList1.getValue(y,"GA"))+Number($.grdRList1.getValue(z,"GA"));SUM12=SUM12+Number($.grdRList1.getValue(x,"AD"))+Number($.grdRList1.getValue(y,"AD"))+Number($.grdRList1.getValue(z,"AD"));SUM13=SUM13+Number($.grdRList1.getValue(x,"IB"))+Number($.grdRList1.getValue(y,"IB"))+Number($.grdRList1.getValue(z,"IB"));SUM14=SUM14+Number($.grdRList1.getValue(x,"RPM"))+Number($.grdRList1.getValue(y,"RPM"))+Number($.grdRList1.getValue(z,"RPM"));SUM15=SUM15+Number($.grdRList1.getValue(x,"ETC"))+Number($.grdRList1.getValue(y,"ETC"))+Number($.grdRList1.getValue(z,"ETC"));SUM16=SUM16+Number($.grdRList1.getValue(x,"XT"))+Number($.grdRList1.getValue(y,"XT"))+Number($.grdRList1.getValue(z,"XT"));SUM17=SUM17+Number($.grdRList1.getValue(x,"BET"))+Number($.grdRList1.getValue(y,"BET"))+Number($.grdRList1.getValue(z,"BET"));SUM18=SUM18+Number($.grdRList1.getValue(x,"SGL"))+Number($.grdRList1.getValue(y,"SGL"))+Number($.grdRList1.getValue(z,"SGL"));$.grdRList1.setValue(12,"PRG",SUM1);$.grdRList1.setValue(12,"HA",SUM2);$.grdRList1.setValue(12,"VC",SUM3);$.grdRList1.setValue(12,"NA",SUM4);$.grdRList1.setValue(12,"BER",SUM5);$.grdRList1.setValue(12,"OL",SUM6);$.grdRList1.setValue(12,"PD_I",SUM7);$.grdRList1.setValue(12,"PRT",SUM8);$.grdRList1.setValue(12,"LO",SUM9);$.grdRList1.setValue(12,"MCFG",SUM10);$.grdRList1.setValue(12,"GA",SUM11);$.grdRList1.setValue(12,"AD",SUM12);$.grdRList1.setValue(12,"IB",SUM13);$.grdRList1.setValue(12,"RPM",SUM14);$.grdRList1.setValue(12,"ETC",SUM15);$.grdRList1.setValue(12,"XT",SUM16);$.grdRList1.setValue(12,"BET",SUM17);$.grdRList1.setValue(12,"SGL",SUM18);$.grdRList1.setValue(12,"SUM",SUM1+SUM2+SUM3+SUM4+SUM5+SUM6+SUM7+SUM8+SUM9+SUM10+SUM11+SUM12+SUM13+SUM14+SUM15+SUM16+SUM17+SUM18);x=0,y=12;SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;SUM1=SUM1+Number($.grdRList1.getValue(x,"PRG"))-Number($.grdRList1.getValue(y,"PRG"));SUM2=SUM2+Number($.grdRList1.getValue(x,"HA"))-Number($.grdRList1.getValue(y,"HA"));SUM3=SUM3+Number($.grdRList1.getValue(x,"VC"))-Number($.grdRList1.getValue(y,"VC"));SUM4=SUM4+Number($.grdRList1.getValue(x,"NA"))-Number($.grdRList1.getValue(y,"NA"));SUM5=SUM5+Number($.grdRList1.getValue(x,"BER"))-Number($.grdRList1.getValue(y,"BER"));SUM6=SUM6+Number($.grdRList1.getValue(x,"OL"))-Number($.grdRList1.getValue(y,"OL"));SUM7=SUM7+Number($.grdRList1.getValue(x,"PD_I"))-Number($.grdRList1.getValue(y,"PD_I"));SUM8=SUM8+Number($.grdRList1.getValue(x,"PRT"))-Number($.grdRList1.getValue(y,"PRT"));SUM9=SUM9+Number($.grdRList1.getValue(x,"LO"))-Number($.grdRList1.getValue(y,"LO"));SUM10=SUM10+Number($.grdRList1.getValue(x,"MCFG"))-Number($.grdRList1.getValue(y,"MCFG"));SUM11=SUM11+Number($.grdRList1.getValue(x,"GA"))-Number($.grdRList1.getValue(y,"GA"));SUM12=SUM12+Number($.grdRList1.getValue(x,"AD"))-Number($.grdRList1.getValue(y,"AD"));SUM13=SUM13+Number($.grdRList1.getValue(x,"IB"))-Number($.grdRList1.getValue(y,"IB"));SUM14=SUM14+Number($.grdRList1.getValue(x,"RPM"))-Number($.grdRList1.getValue(y,"RPM"));SUM15=SUM15+Number($.grdRList1.getValue(x,"ETC"))-Number($.grdRList1.getValue(y,"ETC"));SUM16=SUM16+Number($.grdRList1.getValue(x,"XT"))-Number($.grdRList1.getValue(y,"XT"));SUM17=SUM17+Number($.grdRList1.getValue(x,"BET"))-Number($.grdRList1.getValue(y,"BET"));SUM18=SUM18+Number($.grdRList1.getValue(x,"SGL"))-Number($.grdRList1.getValue(y,"SGL"));$.grdRList1.setValue(13,"PRG",SUM1);$.grdRList1.setValue(13,"HA",SUM2);$.grdRList1.setValue(13,"VC",SUM3);$.grdRList1.setValue(13,"NA",SUM4);$.grdRList1.setValue(13,"BER",SUM5);$.grdRList1.setValue(13,"OL",SUM6);$.grdRList1.setValue(13,"PD_I",SUM7);$.grdRList1.setValue(13,"PRT",SUM8);$.grdRList1.setValue(13,"LO",SUM9);$.grdRList1.setValue(13,"MCFG",SUM10);$.grdRList1.setValue(13,"GA",SUM11);$.grdRList1.setValue(13,"AD",SUM12);$.grdRList1.setValue(13,"IB",SUM13);$.grdRList1.setValue(13,"RPM",SUM14);$.grdRList1.setValue(13,"ETC",SUM15);$.grdRList1.setValue(13,"XT",SUM16);$.grdRList1.setValue(13,"BET",SUM17);$.grdRList1.setValue(13,"SGL",SUM18);$.grdRList1.setValue(13,"SUM",SUM1+SUM2+SUM3+SUM4+SUM5+SUM6+SUM7+SUM8+SUM9+SUM10+SUM11+SUM12+SUM13+SUM14+SUM15+SUM16+SUM17+SUM18)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,1090);$.panMain.setText("");$.panMain.setBottomLine(true);$.panTop=new FingerPanel(host,"panTop",0,0,1200,55);$.panTop.setText("");$.panTop.setBottomLine();$.lblDate=new FingerLabel(host,"lblDate",0,15,100,20);$.lblDate.setText("기간");$.dteDate=new FingerDateEdit(host,"dteDate",105,15,140,20);$.btnSearch=new FingerButton(host,"btnSearch",1120,15,80,20);$.btnSearch.setText("조회");$.panTab=new FingerTab(host,"panTab",0,65,1200,1015);$.panLeft=new FingerPanel(host,"panLeft",0,0,1200,965);$.panLeft.setText("관리회계");$.panLeft.setBottomLine(true);$.panRight=new FingerPanel(host,"panRight",0,0,1200,965);$.panRight.setText("재무회계");$.panRight.setBottomLine(true);$.grdLList=new FingerDataGrid(host,"grdLList",0,0,1198,300);$.grdLList2=new FingerDataGrid(host,"grdLList2",0,620,1198,300);$.grdLList1=new FingerDataGrid(host,"grdLList1",0,310,1198,300);$.grdRList=new FingerDataGrid(host,"grdRList",0,0,1198,300);$.grdRList1=new FingerDataGrid(host,"grdRList1",0,310,1198,300);$.grdRList2=new FingerDataGrid(host,"grdRList2",0,620,1198,300);$.btnSave=new FingerButton(host,"btnSave",1125,100,90,30);$.btnSave.setText("저장");$.panTop.setBorder(true);$.panTab.addTab([{text:"관리회계",body:$.panLeft,width:150},{text:"재무회계",body:$.panRight,width:150}]);$.dteDate.setDateFormat("yyyymm");$.btnSave.setClass("btn_save");$.dteDate.setDateFormat("yyyymm");$.dteDate.setAllowBlank(false,"기간");$.grdLList.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym",readonly:true}),new FingerDataGridColumn("title",140,"left","string","title",{readonly:true}),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3"}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("Updatedate",0,"left","string","Updatedate",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","seq",{hidden:true})]);$.grdLList.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdLList.setBorder(false);$.grdLList1.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym",readonly:true}),new FingerDataGridColumn("title",140,"left","string","title",{readonly:true}),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3",readonly:true}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("Updatedate",0,"left","string","Updatedate",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","seq",{hidden:true})]);$.grdLList1.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdLList1.setEditable(true);$.grdLList1.setBorder(false);$.grdLList2.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym"}),new FingerDataGridColumn("title",140,"left","string","title"),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3"}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("seq",0,"left","string","seq",{hidden:true})]);$.grdLList2.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdLList2.setBorder(false);$.grdRList.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym"}),new FingerDataGridColumn("title",140,"left","string","title"),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3"}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("Updatedate",0,"left","string","Updatedate",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","seq",{hidden:true})]);$.grdRList.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdRList.setBorder(false);$.grdRList1.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym",readonly:true}),new FingerDataGridColumn("title",140,"left","string","title",{readonly:true}),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3"}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("Updatedate",0,"left","string","Updatedate",{hidden:true}),new FingerDataGridColumn("seq",0,"left","string","seq",{hidden:true})]);$.grdRList1.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdRList1.setEditable(true);$.grdRList1.setBorder(false);$.grdRList2.setColumns([new FingerDataGridColumn("YearMonth",110,"left","string","YearMonth",{format:"ym"}),new FingerDataGridColumn("title",140,"left","string","title"),new FingerDataGridColumn("SUM",100,"right","int","SUM",{format:"floor_comma_3"}),new FingerDataGridColumn("PRG",100,"right","int","PRG",{format:"floor_comma_3"}),new FingerDataGridColumn("HA",100,"right","int","HA",{format:"floor_comma_3"}),new FingerDataGridColumn("VC",100,"right","int","VC",{format:"floor_comma_3"}),new FingerDataGridColumn("NA",100,"right","int","NA",{format:"floor_comma_3"}),new FingerDataGridColumn("BER",100,"right","int","BER",{format:"floor_comma_3"}),new FingerDataGridColumn("OL",100,"right","int","OL",{format:"floor_comma_3"}),new FingerDataGridColumn("PD_I",100,"right","int","PD_I",{format:"floor_comma_3"}),new FingerDataGridColumn("PRT",100,"right","int","PRT",{format:"floor_comma_3"}),new FingerDataGridColumn("LO",100,"right","int","LO",{format:"floor_comma_3"}),new FingerDataGridColumn("MCFG",100,"right","int","MCFG",{format:"floor_comma_3"}),new FingerDataGridColumn("GA",100,"right","int","GA",{format:"floor_comma_3"}),new FingerDataGridColumn("AD",100,"right","int","AD",{format:"floor_comma_3"}),new FingerDataGridColumn("IB",100,"right","int","IB",{format:"floor_comma_3"}),new FingerDataGridColumn("RPM",100,"right","int","RPM",{format:"floor_comma_3"}),new FingerDataGridColumn("XT",100,"right","int","XT",{format:"floor_comma_3"}),new FingerDataGridColumn("BET",100,"right","int","BET",{format:"floor_comma_3"}),new FingerDataGridColumn("SGL",100,"right","int","SGL",{format:"floor_comma_3"}),new FingerDataGridColumn("ETC",100,"right","int","ETC",{format:"floor_comma_3"}),new FingerDataGridColumn("seq",0,"left","int","seq",{hidden:true})]);$.grdRList2.init({scroll:"xy",isFilter:false,nonExcel:true,leftSplit:2});$.grdRList2.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.panTop);$.panMain.add($.panTab);$.panTop.add($.lblDate);$.panTop.add($.dteDate);$.panTop.add($.btnSearch);$.panTop.add($.btnSave);$.panLeft.add($.grdLList);$.panLeft.add($.grdLList2);$.panLeft.add($.grdLList1);$.panRight.add($.grdRList2);$.panRight.add($.grdRList1);$.panRight.add($.grdRList);$.dteDate.setValue(getToday())};$.callback=function(type,ds){if(type=="Q"){if(ds&&ds.resultList.length){for(var i=0;i<ds.resultList[0].length;i++){if(ds.resultList[0][i].YearMonth){ds.resultList[0][i].YearMonth=ds.resultList[0][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}for(var i=0;i<ds.resultList[1].length;i++){if(ds.resultList[1][i].YearMonth){ds.resultList[1][i].YearMonth=ds.resultList[1][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}for(var i=0;i<ds.resultList[2].length;i++){if(ds.resultList[2][i].YearMonth){ds.resultList[2][i].YearMonth=ds.resultList[2][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}for(var i=0;i<ds.resultList[3].length;i++){if(ds.resultList[3][i].YearMonth){ds.resultList[3][i].YearMonth=ds.resultList[3][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}for(var i=0;i<ds.resultList[4].length;i++){if(ds.resultList[4][i].YearMonth){ds.resultList[4][i].YearMonth=ds.resultList[4][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}for(var i=0;i<ds.resultList[5].length;i++){if(ds.resultList[5][i].YearMonth){ds.resultList[5][i].YearMonth=ds.resultList[5][i].YearMonth.substr(0,4)+"-"+ds.resultList[0][i].YearMonth.substr(4,2)}}}setDataGrid([$.grdLList],ds.resultList[0],true);setDataGrid([$.grdList1],ds.resultList[1],true);setDataGrid([$.grdList2],ds.resultList[2],true);setDataGrid([$.grdRList],ds.resultList[3],true);setDataGrid([$.grdList1],ds.resultList[4],true);setDataGrid([$.grdList2],ds.resultList[5],true);if($.grdLList1.getRowCount()<1){for(var i=0;i<$.grdLList.getRowCount();i++){var obj={title:$.grdLList.getValue(i,"title"),seq:$.grdLList.getValue(i,"seq"),YearMonth:$.grdLList.getValue(i,"YearMonth"),SUM_readonly:true,title_readonly:true,PRG:"0",HA:"0",VC:"0",NA:"0",BER:"0",OL:"0",PD_I:"0",PRT:"0",LO:"0",MCFG:"0",GA:"0",AD:"0",IB:"0",RPM:"0",ETC:"0",XT:"0",BET:"0",SGL:"0",SUM:"0"};if(i==2||i==3||i==4||i==9||i==13||i==14||i==15){obj.PRG_readonly=true;obj.HA_readonly=true;obj.VC_readonly=true;obj.NA_readonly=true;obj.BER_readonly=true;obj.OL_readonly=true;obj.PD_I_readonly=true;obj.PRT_readonly=true;obj.LO_readonly=true;obj.MCFG_readonly=true;obj.GA_readonly=true;obj.AD_readonly=true;obj.IB_readonly=true;obj.RPM_readonly=true;obj.ETC_readonly=true;obj.XT_readonly=true;obj.BET_readonly=true;obj.SGL_readonly=true}$.grdLList1.addRow(obj,$.grdLList1.getRowCount(),true)}}if($.grdRList1.getRowCount()<1){for(var i=0;i<$.grdRList.getRowCount();i++){var obj={title:$.grdLList.getValue(i,"title"),seq:$.grdLList.getValue(i,"seq"),YearMonth:$.grdLList.getValue(i,"YearMonth"),SUM_readonly:true,title_readonly:true,PRG:"0",HA:"0",VC:"0",NA:"0",BER:"0",OL:"0",PD_I:"0",PRT:"0",LO:"0",MCFG:"0",GA:"0",AD:"0",IB:"0",RPM:"0",ETC:"0",XT:"0",BET:"0",SGL:"0",SUM:"0"};if(i==1||i==2||i==3||i==8||i==12||i==13||i==14){obj.PRG_readonly=true;obj.HA_readonly=true;obj.VC_readonly=true;obj.NA_readonly=true;obj.BER_readonly=true;obj.OL_readonly=true;obj.PD_I_readonly=true;obj.PRT_readonly=true;obj.LO_readonly=true;obj.MCFG_readonly=true;obj.GA_readonly=true;obj.AD_readonly=true;obj.IB_readonly=true;obj.RPM_readonly=true;obj.ETC_readonly=true;obj.XT_readonly=true;obj.BET_readonly=true;obj.SGL_readonly=true}$.grdRList1.addRow(obj,$.grdRList1.getRowCount(),true)}}}else{if(type=="LSAVE"){if(ds){var rs=ds.resultList;var msg="";if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){msg=rs[i].errorCode+"</br>"+rs[i].errorMsg}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){msg=ds.errorCode+"</br>"+ds.errorMsg}}if(msg!=""){MessageBoxShow(msg)}else{saveRList("")}}}else{if(type=="RSAVE"){if(ds){var rs=ds.resultList;var msg="";if(rs.length>1){for(var i in rs){if(rs[i].errorCode.substring(0,1)=="P"||rs[i].errorCode.substring(0,1)=="E"){msg=rs[i].errorCode+"</br>"+rs[i].errorMsg}}}else{if(ds.errorCode.substring(0,1)=="P"||ds.errorCode.substring(0,1)=="E"){msg=ds.errorCode+"</br>"+ds.errorMsg}}if(msg!=""){MessageBoxShow(msg)}else{MessageBoxShow("정상적으로 저장되었습니다.");searchList("Q")}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){if(id=="btnSearch"){searchList("Q")}else{if(id=="btnSave"){$.grdLList1.editStop();$.grdRList1.editStop();confirmBoxShow("저장 하시겠습니까?",function(){if(g_main.msgShare==true){saveLList("")}})}}};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){};$.fingerdatagrid_selectionchange=function(id,rId){};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){if(id=="grdLList1"){if(cInd!="YearMonth"&&cInd=="title"){var inputData=nValue.toString();if(inputData.trim()==""||isNaN(inputData)){$.grdLList1.setValue(rId,cInd,oValue==""?0:oValue)}}var dt=$.grdLList1.getValue(rId);var index=$.grdLList1.getGridIndexById()-1;var SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;if(dt.title=="販賣費 內 人件費"||dt.title=="販賣費 內 販促費1"||dt.title=="販賣費 內 販促費2"||dt.title=="販賣費 內 その他"&&index>3&&index<8){if($.grdLList1.getRowCount()==16){for(var i=5;i<9;i++){SUM1+=Number($.grdLList1.getValue(i,"PRG"));SUM2+=Number($.grdLList1.getValue(i,"HA"));SUM3+=Number($.grdLList1.getValue(i,"VC"));SUM4+=Number($.grdLList1.getValue(i,"NA"));SUM5+=Number($.grdLList1.getValue(i,"BER"));SUM6+=Number($.grdLList1.getValue(i,"OL"));SUM7+=Number($.grdLList1.getValue(i,"PD_I"));SUM8+=Number($.grdLList1.getValue(i,"PRT"));SUM9+=Number($.grdLList1.getValue(i,"LO"));SUM10+=Number($.grdLList1.getValue(i,"MCFG"));SUM11+=Number($.grdLList1.getValue(i,"GA"));SUM12+=Number($.grdLList1.getValue(i,"AD"));SUM13+=Number($.grdLList1.getValue(i,"IB"));SUM14+=Number($.grdLList1.getValue(i,"RPM"));SUM15+=Number($.grdLList1.getValue(i,"ETC"));SUM16+=Number($.grdLList1.getValue(i,"XT"));SUM17+=Number($.grdLList1.getValue(i,"BET"));SUM18+=Number($.grdLList1.getValue(i,"SGL"))}$.grdLList1.setValue(4,"PRG",SUM1);$.grdLList1.setValue(4,"HA",SUM2);$.grdLList1.setValue(4,"VC",SUM3);$.grdLList1.setValue(4,"NA",SUM4);$.grdLList1.setValue(4,"BER",SUM5);$.grdLList1.setValue(4,"OL",SUM6);$.grdLList1.setValue(4,"PD_I",SUM7);$.grdLList1.setValue(4,"PRT",SUM8);$.grdLList1.setValue(4,"LO",SUM9);$.grdLList1.setValue(4,"MCFG",SUM10);$.grdLList1.setValue(4,"GA",SUM11);$.grdLList1.setValue(4,"AD",SUM12);$.grdLList1.setValue(4,"IB",SUM13);$.grdLList1.setValue(4,"RPM",SUM14);$.grdLList1.setValue(4,"ETC",SUM15);$.grdLList1.setValue(4,"XT",SUM16);$.grdLList1.setValue(4,"BET",SUM17);$.grdLList1.setValue(4,"SGL",SUM18);calcTotal()}}if(dt.title=="管理費 內 人件費"||dt.title=="管理費 內 他管理費"){if($.grdLList1.getRowCount()==16){for(var i=10;i<12;i++){SUM1+=Number($.grdLList1.getValue(i,"PRG"));SUM2+=Number($.grdLList1.getValue(i,"HA"));SUM3+=Number($.grdLList1.getValue(i,"VC"));SUM4+=Number($.grdLList1.getValue(i,"NA"));SUM5+=Number($.grdLList1.getValue(i,"BER"));SUM6+=Number($.grdLList1.getValue(i,"OL"));SUM7+=Number($.grdLList1.getValue(i,"PD_I"));SUM8+=Number($.grdLList1.getValue(i,"PRT"));SUM9+=Number($.grdLList1.getValue(i,"LO"));SUM10+=Number($.grdLList1.getValue(i,"MCFG"));SUM11+=Number($.grdLList1.getValue(i,"GA"));SUM12+=Number($.grdLList1.getValue(i,"AD"));SUM13+=Number($.grdLList1.getValue(i,"IB"));SUM14+=Number($.grdLList1.getValue(i,"RPM"));SUM15+=Number($.grdLList1.getValue(i,"ETC"));SUM16+=Number($.grdLList1.getValue(i,"XT"));SUM17+=Number($.grdLList1.getValue(i,"BET"));SUM18+=Number($.grdLList1.getValue(i,"SGL"))}$.grdLList1.setValue(9,"PRG",SUM1);$.grdLList1.setValue(9,"HA",SUM2);$.grdLList1.setValue(9,"VC",SUM3);$.grdLList1.setValue(9,"NA",SUM4);$.grdLList1.setValue(9,"BER",SUM5);$.grdLList1.setValue(9,"OL",SUM6);$.grdLList1.setValue(9,"PD_I",SUM7);$.grdLList1.setValue(9,"PRT",SUM8);$.grdLList1.setValue(9,"LO",SUM9);$.grdLList1.setValue(9,"MCFG",SUM10);$.grdLList1.setValue(9,"GA",SUM11);$.grdLList1.setValue(9,"AD",SUM12);$.grdLList1.setValue(9,"IB",SUM13);$.grdLList1.setValue(9,"RPM",SUM14);$.grdLList1.setValue(9,"ETC",SUM15);$.grdLList1.setValue(9,"XT",SUM16);$.grdLList1.setValue(9,"BET",SUM17);$.grdLList1.setValue(9,"SGL",SUM18);calcTotal()}}if(dt.title=="R&D"){if($.grdLList1.getRowCount()==16){calcTotal()}}if(dt.title=="賣上高"||dt.title=="原價"){if($.grdLList1.getRowCount()==16){var x=0,y=1;SUM1=Number($.grdLList1.getValue(x,"PRG"))-Number($.grdLList1.getValue(y,"PRG"));SUM2=Number($.grdLList1.getValue(x,"HA"))-Number($.grdLList1.getValue(y,"HA"));SUM3=Number($.grdLList1.getValue(x,"VC"))-Number($.grdLList1.getValue(y,"VC"));SUM4=Number($.grdLList1.getValue(x,"NA"))-Number($.grdLList1.getValue(y,"NA"));SUM5=Number($.grdLList1.getValue(x,"BER"))-Number($.grdLList1.getValue(y,"BER"));SUM6=Number($.grdLList1.getValue(x,"OL"))-Number($.grdLList1.getValue(y,"OL"));SUM7=Number($.grdLList1.getValue(x,"PD_I"))-Number($.grdLList1.getValue(y,"PD_I"));SUM8=Number($.grdLList1.getValue(x,"PRT"))-Number($.grdLList1.getValue(y,"PRT"));SUM9=Number($.grdLList1.getValue(x,"LO"))-Number($.grdLList1.getValue(y,"LO"));SUM10=Number($.grdLList1.getValue(x,"MCFG"))-Number($.grdLList1.getValue(y,"MCFG"));SUM11=Number($.grdLList1.getValue(x,"GA"))-Number($.grdLList1.getValue(y,"GA"));SUM12=Number($.grdLList1.getValue(x,"AD"))-Number($.grdLList1.getValue(y,"AD"));SUM13=Number($.grdLList1.getValue(x,"IB"))-Number($.grdLList1.getValue(y,"IB"));SUM14=Number($.grdLList1.getValue(x,"RPM"))-Number($.grdLList1.getValue(y,"RPM"));SUM15=Number($.grdLList1.getValue(x,"ETC"))-Number($.grdLList1.getValue(y,"ETC"));SUM16=Number($.grdLList1.getValue(x,"XT"))-Number($.grdLList1.getValue(y,"XT"));SUM17=Number($.grdLList1.getValue(x,"BET"))-Number($.grdLList1.getValue(y,"BET"));SUM18=Number($.grdLList1.getValue(x,"SGL"))-Number($.grdLList1.getValue(y,"SGL"));$.grdLList1.setValue(3,"PRG",SUM1);$.grdLList1.setValue(3,"HA",SUM2);$.grdLList1.setValue(3,"VC",SUM3);$.grdLList1.setValue(3,"NA",SUM4);$.grdLList1.setValue(3,"BER",SUM5);$.grdLList1.setValue(3,"OL",SUM6);$.grdLList1.setValue(3,"PD_I",SUM7);$.grdLList1.setValue(3,"PRT",SUM8);$.grdLList1.setValue(3,"LO",SUM9);$.grdLList1.setValue(3,"MCFG",SUM10);$.grdLList1.setValue(3,"GA",SUM11);$.grdLList1.setValue(3,"AD",SUM12);$.grdLList1.setValue(3,"IB",SUM13);$.grdLList1.setValue(3,"RPM",SUM14);$.grdLList1.setValue(3,"ETC",SUM15);$.grdLList1.setValue(3,"XT",SUM16);$.grdLList1.setValue(3,"BET",SUM17);$.grdLList1.setValue(3,"SGL",SUM18);calcTotal()}}if(cInd!="SUM"){var Sum=Number($.grdLList1.getValue(rId,"PRG"))+Number($.grdLList1.getValue(rId,"HA"))+Number($.grdLList1.getValue(rId,"VC"))+Number($.grdLList1.getValue(rId,"NA"))+Number($.grdLList1.getValue(rId,"BER"))+Number($.grdLList1.getValue(rId,"OL"))+Number($.grdLList1.getValue(rId,"PD_I"))+Number($.grdLList1.getValue(rId,"PRT"))+Number($.grdLList1.getValue(rId,"LO"))+Number($.grdLList1.getValue(rId,"MCFG"))+Number($.grdLList1.getValue(rId,"GA"))+Number($.grdLList1.getValue(rId,"AD"))+Number($.grdLList1.getValue(rId,"IB"))+Number($.grdLList1.getValue(rId,"RPM"))+Number($.grdLList1.getValue(rId,"ETC"))+Number($.grdLList1.getValue(rId,"XT"))+Number($.grdLList1.getValue(rId,"BET"))+Number($.grdLList1.getValue(rId,"SGL"));$.grdLList1.setValue(rId,"SUM",Sum)}if($.grdLList1.getRowCount()==16&&index>=0&&index<=3){SUM1=0;SUM1=Number($.grdLList1.getValue(0,"SUM"))-Number($.grdLList1.getValue(1,"SUM"));$.grdLList1.setValue(3,"SUM",SUM1);SUM1=Number($.grdLList1.getValue(0,cInd))-Number($.grdLList1.getValue(1,cInd));$.grdLList1.setValue(3,cInd,SUM1);calcTotal()}if($.grdLList1.getRowCount()==16&&index>4&&index<=9){SUM1=0;SUM2=0;for(var i=5;i<9;i++){SUM1+=Number($.grdLList1.getValue(i,"SUM"));SUM2+=Number($.grdLList1.getValue(i,cInd))}$.grdLList1.setValue(4,"SUM",SUM1);$.grdLList1.setValue(4,cInd,SUM2);calcTotal()}if($.grdLList1.getRowCount()==16&&index>9&&index<=12){SUM1=0;SUM2=0;for(var i=10;i<12;i++){SUM1+=Number($.grdLList1.getValue(i,"SUM"));SUM2+=Number($.grdLList1.getValue(i,cInd))}$.grdLList1.setValue(9,"SUM",SUM1);$.grdLList1.setValue(9,cInd,SUM2);calcTotal()}if($.grdLList1.getRowCount()==16&&index==15){$.grdLList1.setValue(15,"SUM",1);return}}else{if(id=="grdRList1"){if(cInd!="YearMonth"&&cInd=="title"){var inputData=nValue.toString();if(inputData.trim()==""||isNaN(inputData)){$.grdRList1.setValue(rId,cInd,oValue==""?0:oValue)}}var dt=$.grdRList1.getValue(rId);var index=$.grdRList1.getGridIndexById()-1;var SUM1=0,SUM2=0,SUM3=0,SUM4=0,SUM5=0,SUM6=0,SUM7=0,SUM8=0,SUM9=0,SUM10=0,SUM11=0,SUM12=0,SUM13=0,SUM14=0,SUM15=0,SUM16=0,SUM17=0,SUM18=0;if(dt.title=="販賣費 內 人件費"||dt.title=="販賣費 內 販促費1"||dt.title=="販賣費 內 販促費2"||dt.title=="販賣費 內 その他"&&index>3&&index<8){if($.grdRList1.getRowCount()==15){for(var i=4;i<8;i++){SUM1+=Number($.grdRList1.getValue(i,"PRG"));SUM2+=Number($.grdRList1.getValue(i,"HA"));SUM3+=Number($.grdRList1.getValue(i,"VC"));SUM4+=Number($.grdRList1.getValue(i,"NA"));SUM5+=Number($.grdRList1.getValue(i,"BER"));SUM6+=Number($.grdRList1.getValue(i,"OL"));SUM7+=Number($.grdRList1.getValue(i,"PD_I"));SUM8+=Number($.grdRList1.getValue(i,"PRT"));SUM9+=Number($.grdRList1.getValue(i,"LO"));SUM10+=Number($.grdRList1.getValue(i,"MCFG"));SUM11+=Number($.grdRList1.getValue(i,"GA"));SUM12+=Number($.grdRList1.getValue(i,"AD"));SUM13+=Number($.grdRList1.getValue(i,"IB"));SUM14+=Number($.grdRList1.getValue(i,"RPM"));SUM15+=Number($.grdRList1.getValue(i,"ETC"));SUM16+=Number($.grdRList1.getValue(i,"XT"));SUM17+=Number($.grdRList1.getValue(i,"BET"));SUM18+=Number($.grdRList1.getValue(i,"SGL"))}$.grdRList1.setValue(3,"PRG",SUM1);$.grdRList1.setValue(3,"HA",SUM2);$.grdRList1.setValue(3,"VC",SUM3);$.grdRList1.setValue(3,"NA",SUM4);$.grdRList1.setValue(3,"BER",SUM5);$.grdRList1.setValue(3,"OL",SUM6);$.grdRList1.setValue(3,"PD_I",SUM7);$.grdRList1.setValue(3,"PRT",SUM8);$.grdRList1.setValue(3,"LO",SUM9);$.grdRList1.setValue(3,"MCFG",SUM10);$.grdRList1.setValue(3,"GA",SUM11);$.grdRList1.setValue(3,"AD",SUM12);$.grdRList1.setValue(3,"IB",SUM13);$.grdRList1.setValue(3,"RPM",SUM14);$.grdRList1.setValue(3,"ETC",SUM15);$.grdRList1.setValue(3,"XT",SUM16);$.grdRList1.setValue(3,"BET",SUM17);$.grdRList1.setValue(3,"SGL",SUM18);calcTotal_2()}}if(dt.title=="管理費 內 人件費"||dt.title=="管理費 內 他管理費"){if($.grdRList1.getRowCount()==15){for(var i=9;i<11;i++){SUM1+=Number($.grdRList1.getValue(i,"PRG"));SUM2+=Number($.grdRList1.getValue(i,"HA"));SUM3+=Number($.grdRList1.getValue(i,"VC"));SUM4+=Number($.grdRList1.getValue(i,"NA"));SUM5+=Number($.grdRList1.getValue(i,"BER"));SUM6+=Number($.grdRList1.getValue(i,"OL"));SUM7+=Number($.grdRList1.getValue(i,"PD_I"));SUM8+=Number($.grdRList1.getValue(i,"PRT"));SUM9+=Number($.grdRList1.getValue(i,"LO"));SUM10+=Number($.grdRList1.getValue(i,"MCFG"));SUM11+=Number($.grdRList1.getValue(i,"GA"));SUM12+=Number($.grdRList1.getValue(i,"AD"));SUM13+=Number($.grdRList1.getValue(i,"IB"));SUM14+=Number($.grdRList1.getValue(i,"RPM"));SUM15+=Number($.grdRList1.getValue(i,"ETC"));SUM16+=Number($.grdRList1.getValue(i,"XT"));SUM17+=Number($.grdRList1.getValue(i,"BET"));SUM18+=Number($.grdRList1.getValue(i,"SGL"))}$.grdRList1.setValue(8,"PRG",SUM1);$.grdRList1.setValue(8,"HA",SUM2);$.grdRList1.setValue(8,"VC",SUM3);$.grdRList1.setValue(8,"NA",SUM4);$.grdRList1.setValue(8,"BER",SUM5);$.grdRList1.setValue(8,"OL",SUM6);$.grdRList1.setValue(8,"PD_I",SUM7);$.grdRList1.setValue(8,"PRT",SUM8);$.grdRList1.setValue(8,"LO",SUM9);$.grdRList1.setValue(8,"MCFG",SUM10);$.grdRList1.setValue(8,"GA",SUM11);$.grdRList1.setValue(8,"AD",SUM12);$.grdRList1.setValue(8,"IB",SUM13);$.grdRList1.setValue(8,"RPM",SUM14);$.grdRList1.setValue(8,"ETC",SUM15);$.grdRList1.setValue(8,"XT",SUM16);$.grdRList1.setValue(8,"BET",SUM17);$.grdRList1.setValue(8,"SGL",SUM18);calcTotal_2()}}if(dt.title=="R&D"){if($.grdRList1.getRowCount()==15){calcTotal_2()}}if(dt.title=="賣上高"||dt.title=="原價"){if($.grdRList1.getRowCount()==15){var x=0,y=1;SUM1=Number($.grdRList1.getValue(x,"PRG"))-Number($.grdRList1.getValue(y,"PRG"));SUM2=Number($.grdRList1.getValue(x,"HA"))-Number($.grdRList1.getValue(y,"HA"));SUM3=Number($.grdRList1.getValue(x,"VC"))-Number($.grdRList1.getValue(y,"VC"));SUM4=Number($.grdRList1.getValue(x,"NA"))-Number($.grdRList1.getValue(y,"NA"));SUM5=Number($.grdRList1.getValue(x,"BER"))-Number($.grdRList1.getValue(y,"BER"));SUM6=Number($.grdRList1.getValue(x,"OL"))-Number($.grdRList1.getValue(y,"OL"));SUM7=Number($.grdRList1.getValue(x,"PD_I"))-Number($.grdRList1.getValue(y,"PD_I"));SUM8=Number($.grdRList1.getValue(x,"PRT"))-Number($.grdRList1.getValue(y,"PRT"));SUM9=Number($.grdRList1.getValue(x,"LO"))-Number($.grdRList1.getValue(y,"LO"));SUM10=Number($.grdRList1.getValue(x,"MCFG"))-Number($.grdRList1.getValue(y,"MCFG"));SUM11=Number($.grdRList1.getValue(x,"GA"))-Number($.grdRList1.getValue(y,"GA"));SUM12=Number($.grdRList1.getValue(x,"AD"))-Number($.grdRList1.getValue(y,"AD"));SUM13=Number($.grdRList1.getValue(x,"IB"))-Number($.grdRList1.getValue(y,"IB"));SUM14=Number($.grdRList1.getValue(x,"RPM"))-Number($.grdRList1.getValue(y,"RPM"));SUM15=Number($.grdRList1.getValue(x,"ETC"))-Number($.grdRList1.getValue(y,"ETC"));SUM16=Number($.grdRList1.getValue(x,"XT"))-Number($.grdRList1.getValue(y,"XT"));SUM17=Number($.grdRList1.getValue(x,"BET"))-Number($.grdRList1.getValue(y,"BET"));SUM18=Number($.grdRList1.getValue(x,"SGL"))-Number($.grdRList1.getValue(y,"SGL"));$.grdRList1.setValue(2,"PRG",SUM1);$.grdRList1.setValue(2,"HA",SUM2);$.grdRList1.setValue(2,"VC",SUM3);$.grdRList1.setValue(2,"NA",SUM4);$.grdRList1.setValue(2,"BER",SUM5);$.grdRList1.setValue(2,"OL",SUM6);$.grdRList1.setValue(2,"PD_I",SUM7);$.grdRList1.setValue(2,"PRT",SUM8);$.grdRList1.setValue(2,"LO",SUM9);$.grdRList1.setValue(2,"MCFG",SUM10);$.grdRList1.setValue(2,"GA",SUM11);$.grdRList1.setValue(2,"AD",SUM12);$.grdRList1.setValue(2,"IB",SUM13);$.grdRList1.setValue(2,"RPM",SUM14);$.grdRList1.setValue(2,"ETC",SUM15);$.grdRList1.setValue(2,"XT",SUM16);$.grdRList1.setValue(2,"BET",SUM17);$.grdRList1.setValue(2,"SGL",SUM18);calcTotal_2()}}if(cInd!="SUM"){var Sum=Number($.grdRList1.getValue(rId,"PRG"))+Number($.grdRList1.getValue(rId,"HA"))+Number($.grdRList1.getValue(rId,"VC"))+Number($.grdRList1.getValue(rId,"NA"))+Number($.grdRList1.getValue(rId,"BER"))+Number($.grdRList1.getValue(rId,"OL"))+Number($.grdRList1.getValue(rId,"PD_I"))+Number($.grdRList1.getValue(rId,"PRT"))+Number($.grdRList1.getValue(rId,"LO"))+Number($.grdRList1.getValue(rId,"MCFG"))+Number($.grdRList1.getValue(rId,"GA"))+Number($.grdRList1.getValue(rId,"AD"))+Number($.grdRList1.getValue(rId,"IB"))+Number($.grdRList1.getValue(rId,"RPM"))+Number($.grdRList1.getValue(rId,"ETC"))+Number($.grdRList1.getValue(rId,"XT"))+Number($.grdRList1.getValue(rId,"BET"))+Number($.grdRList1.getValue(rId,"SGL"));$.grdRList1.setValue(rId,"SUM",Sum)}if($.grdRList1.getRowCount()==15&&index>3&&index<8){SUM1=0;SUM2=0;for(var i=4;i<8;i++){SUM1+=Number($.grdRList1.getValue(i,"SUM"));SUM2+=Number($.grdRList1.getValue(i,cInd))}$.grdRList1.setValue(3,"SUM",SUM1);$.grdRList1.setValue(3,cInd,SUM2);calcTotal_2();return}if($.grdRList1.getRowCount()==15&&index>8&&index<=11){SUM1=0;SUM2=0;for(var i=9;i<11;i++){SUM1+=Number($.grdRList1.getValue(i,"SUM"));SUM2+=Number($.grdRList1.getValue(i,cInd))}$.grdRList1.setValue(8,"SUM",SUM1);$.grdRList1.setValue(8,cInd,SUM2);calcTotal_2();return}if($.grdRList1.getRowCount()==15&&index>=0&&index<=2){SUM1=0;SUM2=0;SUM1=Number($.grdRList1.getValue(0,"SUM"))-Number($.grdRList1.getValue(1,"SUM"));SUM2=Number($.grdRList1.getValue(0,cInd))-Number($.grdRList1.getValue(1,cInd));$.grdRList1.setValue(2,"SUM",SUM1);$.grdRList1.setValue(2,cInd,SUM2);calcTotal_2();return}if($.grdRList1.getRowCount()==15&&index==14){$.grdRList1.setValue(14,"SUM",1);return}}}};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){};$.fingerpopup_close=function(id){};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){}};</script>