<script>function Main(){var $=this;$.host=null;$.panMain=null;$.panQAAuthList=null;$.grdQAAuthList=null;$.panQAAuthEmp=null;$.grdQAAuthEmp=null;$.panQAAuthInfo=null;$.panAuthGroupDetail=null;$.grdAuthGroupDetail=null;$.lblAuthCode=null;$.txtAuthCode=null;$.lblAuthName=null;$.txtAuthName=null;$.lblRemark=null;$.memRemark=null;$.tabMain=null;$.panQAAuthSet=null;$.panQADetailSet=null;$.panQADetailSetList=null;$.grdQADetailSetList=null;$.varQaAuthCode="";$.varSaveStatus="N";$.deleteRows=[];function searchList(){searchStQAAuth("Q_LIST","");searchStQAAuth("Q_ALL","")}function searchStQAAuth(workType,authDetailUseYn){var json=createJSON_Q(workType,authDetailUseYn);callQuery(["req",json],workType,$)}function saveStQAAuthEmp(workType){var json=createJSON_S(workType);callExecute(["req",json],workType,$)}function saveStQAAuth(workType){if(!$.panQAAuthInfo.validateControls()){return}var json=createJSON_S1(workType);callExecute(["req",json],workType,$)}function saveStQAAuthDetail(workType){var json=createJSON_S2(workType);if(json){callExecute(["req",json],workType,$)}}function createJSON_Q(workType,authDetailUseYn){var json=createExecuteParamInfo("P_stQAAuth_Q",[workType,workType=="Q_LIST"||workType=="Q_ALL"?"":$.varQaAuthCode,authDetailUseYn,"","#UserID#"]);return json}function createJSON_S(workType){var dt=$.grdQAAuthEmp.getAllRows();var rows=[];var iCount=1;for(var i in dt){rows.push([workType,$.varQaAuthCode,"","",dt[i].employee_id,"","","","","",iCount,"#UserID#"]);iCount++}if(!rows.length){rows.push([workType,$.varQaAuthCode,"","","","","","","","",0,"#UserID#"])}var json=createExecuteParamInfo("P_stQAAuth_S",rows);return json}function createJSON_S1(workType){var json=createExecuteParamInfo("P_stQAAuth_S",[workType,$.txtAuthCode.getValue(),$.txtAuthName.getValue(),$.memRemark.getValue()||"","","","","","","",0,"#UserID#"]);return json}function createJSON_S2(workType){var dt=[];if(workType=="N_DETAIL"){dt=$.grdAuthGroupDetail.getCheckedRows("auth_yn",true)}else{if(workType=="N_ALL"){dt=$.grdQADetailSetList.getChangedRows("use_yn",true)}else{var rId=$.grdQADetailSetList.getSelectedRowIdx();dt.push($.grdQADetailSetList.getValue(rId))}if(!dt.length){MessageBoxShow("변경된 내역이 없습니다.");return false}}var rows=[];var iCount=1;for(var i in dt){if(workType=="N_DETAIL"){rows.push([workType,$.varQaAuthCode,"","","",dt[i].perm_code,"","","","",iCount,"#UserID#"])}else{workType=dt[i].rowType+"_ALL";rows.push([workType,"","","","",dt[i].perm_code,dt[i].perm_name,dt[i].menu_id,dt[i].remark||"",dt[i].use_yn,iCount,"#UserID#"])}iCount++}if(!rows.length&&workType=="Q_DETAIL"){rows.push([workType,$.varQaAuthCode,"","","","","","","","",0,"#UserID#"])}var json=createExecuteParamInfo("P_stQAAuth_S",rows);return json}function newClick(){$.grdQAAuthList.clearSelect();$.grdQAAuthEmp.clear();$.panQAAuthInfo.clear();$.varSaveStatus="N";$.varQaAuthCode="";$.deleteRows=[];for(var i=0;i<$.grdAuthGroupDetail.getRowCount();i++){$.grdAuthGroupDetail.setValue(i,"auth_yn","N")}$.txtAuthCode.setReadOnly(false)}$.init=function(host,args){$.panMain=new FingerPanel(host,"panMain",0,0,1200,855);$.panMain.setText("");$.panMain.setBottomLine(true);$.panQAAuthList=new FingerPanel(host,"panQAAuthList",0,0,400,400);$.panQAAuthList.setText("QA 권한 목록");$.panQAAuthList.setBottomLine(true);$.grdQAAuthList=new FingerDataGrid(host,"grdQAAuthList",0,0,400,355);$.panQAAuthEmp=new FingerPanel(host,"panQAAuthEmp",0,415,400,400);$.panQAAuthEmp.setText("QA 권한 담당자");$.panQAAuthEmp.setBottomLine(true);$.grdQAAuthEmp=new FingerDataGrid(host,"grdQAAuthEmp",0,0,400,355);$.panQAAuthInfo=new FingerPanel(host,"panQAAuthInfo",410,0,788,180);$.panQAAuthInfo.setText("QA 권한 정보");$.panQAAuthInfo.setBottomLine(true);$.panAuthGroupDetail=new FingerPanel(host,"panAuthGroupDetail",410,190,788,625);$.panAuthGroupDetail.setText("권한그룹별 세부 권한 내역");$.panAuthGroupDetail.setBottomLine(true);$.grdAuthGroupDetail=new FingerDataGrid(host,"grdAuthGroupDetail",0,0,788,580);$.lblAuthCode=new FingerLabel(host,"lblAuthCode",0,15,100,20);$.lblAuthCode.setText("권한코드");$.txtAuthCode=new FingerEdit(host,"txtAuthCode",105,15,140,20);$.lblAuthName=new FingerLabel(host,"lblAuthName",320,15,100,20);$.lblAuthName.setText("권한명");$.txtAuthName=new FingerEdit(host,"txtAuthName",425,15,185,20);$.lblRemark=new FingerLabel(host,"lblRemark",0,45,100,20);$.lblRemark.setText("비고");$.memRemark=new FingerMemoEdit(host,"memRemark",105,45,500,70);$.tabMain=new FingerTab(host,"tabMain",0,0,1200,855);$.panQAAuthSet=new FingerPanel(host,"panQAAuthSet",0,0,1200,825);$.panQAAuthSet.setText("");$.panQAAuthSet.setBottomLine(true);$.panQADetailSet=new FingerPanel(host,"panQADetailSet",0,0,1200,825);$.panQADetailSet.setText("");$.panQADetailSet.setBottomLine(true);$.panQADetailSetList=new FingerPanel(host,"panQADetailSetList",0,0,1198,700);$.panQADetailSetList.setText("권한그룹별 세부 권한 내역");$.panQADetailSetList.setBottomLine(true);$.grdQADetailSetList=new FingerDataGrid(host,"grdQADetailSetList",0,0,1198,655);$.panQAAuthEmp.addButtons(["btnDelete","btnSave","btnAdd"]);$.panQAAuthInfo.addButtons(["btnDelete","btnSave","btnNew"]);$.panAuthGroupDetail.addButtons(["btnSave"]);$.panQADetailSetList.addButtons(["btnDelete","btnSave","btnAdd"]);$.txtAuthCode.setAllowBlank(false,"권한코드");$.txtAuthName.setAllowBlank(false,"권한명");$.txtAuthCode.setReadOnly(true);$.tabMain.addTab([{text:"QA 권한설정",body:$.panQAAuthSet,width:130},{text:"QA 세부권한관리",body:$.panQADetailSet,width:130}]);$.grdQAAuthList.setColumns([new FingerDataGridColumn("qa_auth_code",190,"left","string","권한코드"),new FingerDataGridColumn("qa_auth_name",193,"left","string","권한명")]);$.grdQAAuthList.init({scroll:"xy"});$.grdQAAuthList.setBorder(false);$.grdQAAuthEmp.setColumns([new FingerDataGridColumn("dept_name",150,"left","string","부서"),new FingerDataGridColumn("emp_name",120,"left","string","사용자"),new FingerDataGridColumn("reg_date",113,"left","string","변경일자",{format:"s_ymd"}),new FingerDataGridColumn("dept_code",0,"left","string","",{hidden:true}),new FingerDataGridColumn("employee_id",0,"left","string","",{hidden:true})]);$.grdQAAuthEmp.init({scroll:"xy"});$.grdQAAuthEmp.setBorder(false);$.grdAuthGroupDetail.setColumns([new FingerDataGridColumn("menu_name",200,"left","string","메뉴",{rowSpan:true,verticalMiddle:true}),new FingerDataGridColumn("perm_code",181,"left","string","기능코드"),new FingerDataGridColumn("perm_name",280,"left","string","세부기능"),new FingerDataGridColumn("auth_yn",110,"center","checkbox","권한여부")]);$.grdAuthGroupDetail.init({scroll:"xy"});$.grdAuthGroupDetail.setBorder(false);$.grdQADetailSetList.setColumns([new FingerDataGridColumn("menu_name",200,"left","string","메뉴",{rowSpan:true,verticalMiddle:true,readonly:true}),new FingerDataGridColumn("perm_code",300,"left","string","기능코드"),new FingerDataGridColumn("perm_name",500,"left","string","세부기능"),new FingerDataGridColumn("use_yn",183,"center","checkbox","사용여부"),new FingerDataGridColumn("menu_id",0,"center","string","",{hidden:true})]);$.grdQADetailSetList.init({scroll:"xy"});$.grdQADetailSetList.setEditable(true);$.grdQADetailSetList.setBorder(false);$.host=host;$.args=args};$.start=function(){$.panMain.add($.tabMain);$.panQAAuthList.add($.grdQAAuthList);$.panQAAuthEmp.add($.grdQAAuthEmp);$.panQAAuthInfo.add($.lblAuthCode);$.panQAAuthInfo.add($.txtAuthCode);$.panQAAuthInfo.add($.lblAuthName);$.panQAAuthInfo.add($.txtAuthName);$.panQAAuthInfo.add($.lblRemark);$.panQAAuthInfo.add($.memRemark);$.panAuthGroupDetail.add($.grdAuthGroupDetail);$.panQAAuthSet.add($.panQAAuthList);$.panQAAuthSet.add($.panQAAuthEmp);$.panQAAuthSet.add($.panQAAuthInfo);$.panQAAuthSet.add($.panAuthGroupDetail);$.panQADetailSet.add($.panQADetailSetList);$.panQADetailSetList.add($.grdQADetailSetList);searchList()};$.callback=function(type,ds){if(type=="Q_LIST"){setDataGrid([$.grdQAAuthList],ds);if($.varQaAuthCode){var index=$.grdQAAuthList.getGridRowIndex("qa_auth_code",$.varQaAuthCode);$.grdQAAuthList.selectRow(index)}}else{if(type=="Q_EMP"){setDataGrid([$.grdQAAuthEmp],ds)}else{if(type=="Q_DETAIL"){setDataGrid([$.grdAuthGroupDetail],ds)}else{if(type=="Q_ALL"){setDataGrid([$.grdQADetailSetList],ds)}else{if(type=="N_EMP"){if(ds){MessageBoxShow("정상적으로 저장 되었습니다.");searchStQAAuth("Q_EMP","")}}else{if(type=="N_AUTH"){if(ds){MessageBoxShow("정상적으로 저장 되었습니다.");$.varQaAuthCode=$.txtAuthCode.getValue();searchStQAAuth("Q_LIST","")}}else{if(type=="D_AUTH"){if(ds){MessageBoxShow("정상적으로 삭제 되었습니다.");newClick();searchStQAAuth("Q_LIST","")}}else{if(type=="N_DETAIL"){if(ds){MessageBoxShow("정상적으로 저장 되었습니다.");searchStQAAuth("Q_DETAIL","Y")}}else{if(type=="N_ALL"||type=="D_ALL"){if(ds){MessageBoxShow("정상적으로 저장 되었습니다.");$.deleteRows=[];searchList()}}}}}}}}}}};$.update=function(args){$.args=args};$.executeScript=function(script){eval(script)};$.fingerbutton_click=function(id){};$.fingermultiselect_checkchange=function(id,index){};$.fingermultiselect_itemchange=function(id){};$.fingerbuttonedit_click=function(id){};$.fingerbuttonedit_change=function(id,value){};$.fingerbuttonedit_keypress=function(id,value){};$.fingerbuttonedit_lostfocus=function(id,value){};$.fingercheckbox_change=function(id,value){};$.fingercombobox_change=function(id,value){};$.fingerdateedit_click=function(id){};$.fingerdateedit_change=function(id,value){};$.fingerdatagrid_itemclick=function(id,rId,cInd){$.varRowId=rId;if(id=="grdQAAuthEmp"){if(cInd=="dept_name"||cInd=="emp_name"){var param={emp_name:""};g_main.openPopup("popEmp.html","popEmp","",0,0,"","",param,"","")}}else{if(id=="grdQADetailSetList"){if(cInd=="menu_name"){var param={};g_main.openPopup("popQAMenu.html","popQAMenu","",0,0,"","",param,"","")}}}};$.fingerdatagrid_selectionchange=function(id,rId){if(id=="grdQAAuthList"){$.varSaveStatus="U";$.txtAuthCode.setReadOnly(true);var dt=$.grdQAAuthList.getValue(rId);$.varQaAuthCode=dt.qa_auth_code;$.txtAuthCode.setValue(dt.qa_auth_code);$.txtAuthName.setValue(dt.qa_auth_name);$.memRemark.setValue(dt.remark);searchStQAAuth("Q_EMP","");searchStQAAuth("Q_DETAIL","Y")}};$.fingerdatagrid_cellvaluechange=function(id,rId,cInd,nValue,oValue){};$.fingerdatagrid_rowdblclicked=function(id,rId,cInd){};$.fingerdatagrid_celllink_click=function(e,gridid,rId,cId,value){};$.fingerdatagrid_popupcelldblclicked=function(id,rId,cInd){};$.fingerdatagrid_drag=function(id,sId,tId,sObj,tObj,sInd,tInd){};$.fingeredit_change=function(id,value){};$.fingeredit_keypress=function(id,value){};$.fingeredit_lostfocus=function(id,value){};$.fingerimage_click=function(id){};$.fingerlayout_panelresizefinish=function(id){};$.fingerlayout_resizefinish=function(id){};$.fingerpanel_button_click=function(panelId,btnId){if(panelId=="panQAAuthEmp"){$.grdQAAuthList.editStop();if(btnId=="btnAdd"){var tag='<div style="text-align: center;"><span style="color: blue; cursor: pointer;">[CLICK]</span></div>';$.grdQAAuthEmp.addRow({dept_name:tag,emp_name:tag,reg_date:getToday()})}else{if(btnId=="btnDelete"){var rId=$.grdQAAuthEmp.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제 할 담당자를 선택하세요.");return}$.grdQAAuthEmp.deleteRow(rId)}else{if(btnId=="btnSave"){var rId=$.grdQAAuthList.getSelectedRowIdx();if(!rId){MessageBoxShow("담당자를 추가 할 QA 권한 목록을 선택하세요.");return}var dt=$.grdQAAuthEmp.getAllRows();var bResult=true;for(var i=0;i<dt.length;i++){if(!dt[i].dept_code||!dt[i].employee_id){bResult=false;$.grdQAAuthEmp.selectRow(i);break}}if(!bResult){MessageBoxShow("담당자 정보는 필수 입력사항 입니다.");return}confirmBoxShow("저장 하시겠습니까?.",function(){if(g_main.msgShare==true){saveStQAAuthEmp("N_EMP")}})}}}}else{if(panelId=="panQAAuthInfo"){if(btnId=="btnNew"){newClick()}else{if(btnId=="btnSave"){confirmBoxShow("저장 하시겠습니까?.",function(){if(g_main.msgShare==true){saveStQAAuth("N_AUTH")}})}else{if(btnId=="btnDelete"){var rId=$.grdQAAuthList.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 QA 권한 목록을 선택하세요.");return}confirmBoxShow("삭제 하시겠습니까?.",function(){if(g_main.msgShare==true){saveStQAAuth("D_AUTH")}})}}}}else{if(panelId=="panAuthGroupDetail"){if(btnId=="btnSave"){if(!$.varQaAuthCode){MessageBoxShow("권한을 부여할 QA 권한 목록을 선택하세요.");return}confirmBoxShow("저장 하시겠습니까?.",function(){if(g_main.msgShare==true){saveStQAAuthDetail("N_DETAIL")}})}}else{if(panelId=="panQADetailSetList"){$.grdQADetailSetList.editStop();if(btnId=="btnAdd"){var tag='<div style="text-align: center;"><span style="color: blue; cursor: pointer;">[CLICK]</span></div>';$.grdQADetailSetList.addRow({menu_name:tag,use_yn:"Y"},$.grdQADetailSetList.getRowCount())}else{if(btnId=="btnDelete"){var rId=$.grdQADetailSetList.getSelectedRowIdx();if(!rId){MessageBoxShow("삭제할 내역을 선택하세요.");return}if($.grdQADetailSetList.getRowStatus(rId)!="N"){confirmBoxShow("삭제 하시겠습니까?",function(){if(g_main.msgShare==true){$.grdQADetailSetList.getItem(rId).rowType="D";saveStQAAuthDetail("D_ALL")}})}else{$.grdQADetailSetList.deleteCurrentRow()}}else{if(btnId=="btnSave"){var dt=$.grdQADetailSetList.getAllRows();for(var i in dt){if(!dt[i].menu_id){$.grdQADetailSetList.selectRow(i);MessageBoxShow("메뉴는 필수 입력사항입니다.");return}if(!dt[i].perm_code){$.grdQADetailSetList.selectRow(i);MessageBoxShow("기능코드는 필수 입력사항입니다.");return}if(!dt[i].perm_name){$.grdQADetailSetList.selectRow(i);MessageBoxShow("세부기능은 필수입력 사항입니다.");return}}confirmBoxShow("저장 하시겠습니까?.",function(){if(g_main.msgShare==true){saveStQAAuthDetail("N_ALL")}})}}}}}}}};$.fingerpopup_close=function(id){var popResult=g_popupStack.shareData;if(popResult){if(id=="popEmp"){$.grdQAAuthEmp.setValue($.varRowId,"emp_name",popResult.emp_name);$.grdQAAuthEmp.setValue($.varRowId,"employee_id",popResult.employee_id);$.grdQAAuthEmp.setValue($.varRowId,"dept_name",popResult.dept_name);$.grdQAAuthEmp.setValue($.varRowId,"dept_code",popResult.dept_code)}else{if(id=="popQAMenu"){$.grdQADetailSetList.setValue($.varRowId,"menu_id",popResult.form_id);$.grdQADetailSetList.setValue($.varRowId,"menu_name",popResult.menu_name)}}}};$.fingerpopup2_close=function(id){};$.fingerradiobox_change=function(id,value){};$.fingertab_selectionchange=function(id,tabid){};$.fingertab_ontabclose=function(id,tabid){};$.fingertree_select=function(id,value){};$.fingertree_dblclick=function(id,nodeid){};$.fingertree_refresh=function(id){};$.fingerscheduler_before_event_changed=function(id,event_object,native_event,is_new,unmodified_event){};$.fingerscheduler_before_event_delete=function(id,event_id,event_object){};$.fingerscheduler_event_click=function(id,event_id,event_object,native_event_object){};$.fingerscheduler_ready=function(id){};$.fingerscheduler_before_event_created=function(id,start_date,end_date){};$.fingerscheduler_view_display=function(id,view){};$.fingerscheduler_event_reg=function(id,obj){};$.fingerfilepanel_upload_click=function(id,fileId,fileName){};$.fingerfilepanel_download_click=function(id,fileId,fileName){};$.fingerfilepanel_delete_click=function(id,fileId,fileName){};$.fingerimage_change=function(id,value){};$.fingerimage_rotate=function(id,value){};$.fingertab_click=function(id,tabid){};$.fingerpopup_click_x_button=function(){};$.fingeriframe_onload=function(id){};$.fingerhtmlview_click=function(id){}};</script>